(window.webpackJsonp = window.webpackJsonp || []).push([[31], {
    hdLw: function (t, e, i) {
        t.exports = function () {
            "use strict";
            var n, a, o;

            function t(t, e) {
                if (!n) n = e; else if (!a) a = e; else {
                    var i = "var sharedChunk = {}; (" + n + ")(sharedChunk); (" + a + ")(sharedChunk);";
                    var r = {};
                    n(r);
                    o = e(r);
                    if (typeof window !== "undefined") o.workerUrl = window.URL.createObjectURL(new Blob([i], {type: "text/javascript"}))
                }
            }

            if (t(["exports"], function (t) {
                "use strict";

                function z(t, e) {
                    return t(e = {exports: {}}, e.exports), e.exports
                }

                var k = D;

                function D(t, e, i, r) {
                    this.cx = 3 * t, this.bx = 3 * (i - t) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e, this.by = 3 * (r - e) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t, this.p1y = r, this.p2x = i, this.p2y = r
                }

                D.prototype.sampleCurveX = function (t) {
                    return ((this.ax * t + this.bx) * t + this.cx) * t
                }, D.prototype.sampleCurveY = function (t) {
                    return ((this.ay * t + this.by) * t + this.cy) * t
                }, D.prototype.sampleCurveDerivativeX = function (t) {
                    return (3 * this.ax * t + 2 * this.bx) * t + this.cx
                }, D.prototype.solveCurveX = function (t, e) {
                    var i, r, n, a, o;
                    for (void 0 === e && (e = 1e-6), n = t, o = 0; o < 8; o++) {
                        if (a = this.sampleCurveX(n) - t, Math.abs(a) < e) return n;
                        var s = this.sampleCurveDerivativeX(n);
                        if (Math.abs(s) < 1e-6) break;
                        n -= a / s
                    }
                    if ((n = t) < (i = 0)) return i;
                    if (n > (r = 1)) return r;
                    for (; i < r;) {
                        if (a = this.sampleCurveX(n), Math.abs(a - t) < e) return n;
                        t > a ? i = n : r = n, n = .5 * (r - i) + i
                    }
                    return n
                }, D.prototype.solve = function (t, e) {
                    return this.sampleCurveY(this.solveCurveX(t, e))
                };
                var W = R;

                function R(t, e) {
                    this.x = t, this.y = e
                }

                R.prototype = {
                    clone: function () {
                        return new R(this.x, this.y)
                    }, add: function (t) {
                        return this.clone()._add(t)
                    }, sub: function (t) {
                        return this.clone()._sub(t)
                    }, multByPoint: function (t) {
                        return this.clone()._multByPoint(t)
                    }, divByPoint: function (t) {
                        return this.clone()._divByPoint(t)
                    }, mult: function (t) {
                        return this.clone()._mult(t)
                    }, div: function (t) {
                        return this.clone()._div(t)
                    }, rotate: function (t) {
                        return this.clone()._rotate(t)
                    }, rotateAround: function (t, e) {
                        return this.clone()._rotateAround(t, e)
                    }, matMult: function (t) {
                        return this.clone()._matMult(t)
                    }, unit: function () {
                        return this.clone()._unit()
                    }, perp: function () {
                        return this.clone()._perp()
                    }, round: function () {
                        return this.clone()._round()
                    }, mag: function () {
                        return Math.sqrt(this.x * this.x + this.y * this.y)
                    }, equals: function (t) {
                        return this.x === t.x && this.y === t.y
                    }, dist: function (t) {
                        return Math.sqrt(this.distSqr(t))
                    }, distSqr: function (t) {
                        var e = t.x - this.x, i = t.y - this.y;
                        return e * e + i * i
                    }, angle: function () {
                        return Math.atan2(this.y, this.x)
                    }, angleTo: function (t) {
                        return Math.atan2(this.y - t.y, this.x - t.x)
                    }, angleWith: function (t) {
                        return this.angleWithSep(t.x, t.y)
                    }, angleWithSep: function (t, e) {
                        return Math.atan2(this.x * e - this.y * t, this.x * t + this.y * e)
                    }, _matMult: function (t) {
                        var e = t[2] * this.x + t[3] * this.y;
                        return this.x = t[0] * this.x + t[1] * this.y, this.y = e, this
                    }, _add: function (t) {
                        return this.x += t.x, this.y += t.y, this
                    }, _sub: function (t) {
                        return this.x -= t.x, this.y -= t.y, this
                    }, _mult: function (t) {
                        return this.x *= t, this.y *= t, this
                    }, _div: function (t) {
                        return this.x /= t, this.y /= t, this
                    }, _multByPoint: function (t) {
                        return this.x *= t.x, this.y *= t.y, this
                    }, _divByPoint: function (t) {
                        return this.x /= t.x, this.y /= t.y, this
                    }, _unit: function () {
                        return this._div(this.mag()), this
                    }, _perp: function () {
                        var t = this.y;
                        return this.y = this.x, this.x = -t, this
                    }, _rotate: function (t) {
                        var e = Math.cos(t), i = Math.sin(t), r = i * this.x + e * this.y;
                        return this.x = e * this.x - i * this.y, this.y = r, this
                    }, _rotateAround: function (t, e) {
                        var i = Math.cos(t), r = Math.sin(t), n = e.y + r * (this.x - e.x) + i * (this.y - e.y);
                        return this.x = e.x + i * (this.x - e.x) - r * (this.y - e.y), this.y = n, this
                    }, _round: function () {
                        return this.x = Math.round(this.x), this.y = Math.round(this.y), this
                    }
                }, R.convert = function (t) {
                    return t instanceof R ? t : Array.isArray(t) ? new R(t[0], t[1]) : t
                };
                var c = "undefined" != typeof self ? self : {}, B = Math.pow(2, 53) - 1;

                function O(t, e, i, r) {
                    var n = new k(t, e, i, r);
                    return function (t) {
                        return n.solve(t)
                    }
                }

                var F = O(.25, .1, .25, 1);

                function U(t, e, i) {
                    return Math.min(i, Math.max(e, t))
                }

                function N(t, e, i) {
                    var r = i - e, n = ((t - e) % r + r) % r + e;
                    return n === e ? i : n
                }

                function V(t) {
                    for (var e = [], i = arguments.length - 1; i-- > 0;) e[i] = arguments[i + 1];
                    for (var r = 0, n = e; r < n.length; r += 1) {
                        var a = n[r];
                        for (var o in a) t[o] = a[o]
                    }
                    return t
                }

                var q = 1;

                function G() {
                    return q++
                }

                function Z() {
                    return function t(e) {
                        return e ? (e ^ 16 * Math.random() >> e / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t)
                    }()
                }

                function X(t) {
                    return !!t && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)
                }

                function H(t, e) {
                    t.forEach(function (t) {
                        e[t] && (e[t] = e[t].bind(e))
                    })
                }

                function Y(t, e) {
                    return -1 !== t.indexOf(e, t.length - e.length)
                }

                function J(t, e, i) {
                    var r = {};
                    for (var n in t) r[n] = e.call(i || this, t[n], n, t);
                    return r
                }

                function Q(t, e, i) {
                    var r = {};
                    for (var n in t) e.call(i || this, t[n], n, t) && (r[n] = t[n]);
                    return r
                }

                function $(t) {
                    return Array.isArray(t) ? t.map($) : "object" == typeof t && t ? J(t, $) : t
                }

                var tt = {};

                function ht(t) {
                    tt[t] || ("undefined" != typeof console && console.warn(t), tt[t] = !0)
                }

                function et(t, e, i) {
                    return (i.y - t.y) * (e.x - t.x) > (e.y - t.y) * (i.x - t.x)
                }

                function it(t) {
                    for (var e = 0, i = 0, r = t.length, n = r - 1, a = void 0, o = void 0; i < r; n = i++) e += ((o = t[n]).x - (a = t[i]).x) * (a.y + o.y);
                    return e
                }

                function rt() {
                    return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope
                }

                function nt(t) {
                    var a = {};
                    if (t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, function (t, e, i, r) {
                        var n = i || r;
                        return a[e] = !n || n.toLowerCase(), ""
                    }), a["max-age"]) {
                        var e = parseInt(a["max-age"], 10);
                        isNaN(e) ? delete a["max-age"] : a["max-age"] = e
                    }
                    return a
                }

                var at = null;

                function ot(t) {
                    if (null == at) {
                        var e = t.navigator ? t.navigator.userAgent : null;
                        at = !!t.safari || !(!e || !(/\b(iPad|iPhone|iPod)\b/.test(e) || e.match("Safari") && !e.match("Chrome")))
                    }
                    return at
                }

                function st(t) {
                    try {
                        var e = c[t];
                        return e.setItem("_mapbox_test_", 1), e.removeItem("_mapbox_test_"), !0
                    } catch (t) {
                        return !1
                    }
                }

                var lt, ct, pt, ft,
                    dt = c.performance && c.performance.now ? c.performance.now.bind(c.performance) : Date.now.bind(Date),
                    mt = c.requestAnimationFrame || c.mozRequestAnimationFrame || c.webkitRequestAnimationFrame || c.msRequestAnimationFrame,
                    yt = c.cancelAnimationFrame || c.mozCancelAnimationFrame || c.webkitCancelAnimationFrame || c.msCancelAnimationFrame,
                    gt = {
                        now: dt,
                        frame: function (t) {
                            var e = mt(t);
                            return {
                                cancel: function () {
                                    return yt(e)
                                }
                            }
                        },
                        getImageData: function (t, e) {
                            void 0 === e && (e = 0);
                            var i = c.document.createElement("canvas"), r = i.getContext("2d");
                            if (!r) throw new Error("failed to create canvas 2d context");
                            return i.width = t.width, i.height = t.height, r.drawImage(t, 0, 0, t.width, t.height), r.getImageData(-e, -e, t.width + 2 * e, t.height + 2 * e)
                        },
                        resolveURL: function (t) {
                            return lt || (lt = c.document.createElement("a")), lt.href = t, lt.href
                        },
                        hardwareConcurrency: c.navigator && c.navigator.hardwareConcurrency || 4,
                        get devicePixelRatio() {
                            return c.devicePixelRatio
                        },
                        get prefersReducedMotion() {
                            return !!c.matchMedia && (null == ct && (ct = c.matchMedia("(prefers-reduced-motion: reduce)")), ct.matches)
                        }
                    }, u = {
                        API_URL: "https://api.mapbox.com",
                        get EVENTS_URL() {
                            return this.API_URL ? 0 === this.API_URL.indexOf("https://api.mapbox.cn") ? "https://events.mapbox.cn/events/v2" : 0 === this.API_URL.indexOf("https://api.mapbox.com") ? "https://events.mapbox.com/events/v2" : null : null
                        },
                        FEEDBACK_URL: "https://apps.mapbox.com/feedback",
                        REQUIRE_ACCESS_TOKEN: !0,
                        ACCESS_TOKEN: null,
                        MAX_PARALLEL_IMAGE_REQUESTS: 16
                    }, _t = {
                        supported: !1, testSupport: function (t) {
                            !vt && ft && (xt ? bt(t) : pt = t)
                        }
                    }, vt = !1, xt = !1;

                function bt(t) {
                    var e = t.createTexture();
                    t.bindTexture(t.TEXTURE_2D, e);
                    try {
                        if (t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, ft), t.isContextLost()) return;
                        _t.supported = !0
                    } catch (t) {
                    }
                    t.deleteTexture(e), vt = !0
                }

                c.document && ((ft = c.document.createElement("img")).onload = function () {
                    pt && bt(pt), pt = null, xt = !0
                }, ft.onerror = function () {
                    vt = !0, pt = null
                }, ft.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
                var wt = "01", Mt = 484813681109536e-20, C = Math.PI / 2, St = .017453292519943295,
                    Et = 57.29577951308232, M = Math.PI / 4, It = 2 * Math.PI, _ = 3.14159265359, Tt = {
                        greenwich: 0,
                        lisbon: -9.131906111111,
                        paris: 2.337229166667,
                        bogota: -74.080916666667,
                        madrid: -3.687938888889,
                        rome: 12.452333333333,
                        bern: 7.439583333333,
                        jakarta: 106.807719444444,
                        ferro: -17.666666666667,
                        brussels: 4.367975,
                        stockholm: 18.058277777778,
                        athens: 23.7163375,
                        oslo: 10.722916666667
                    }, Ct = {ft: {to_meter: .3048}, "us-ft": {to_meter: 1200 / 3937}}, Pt = /[\s_\-\/\(\)]/g;

                function At(t, e) {
                    if (t[e]) return t[e];
                    for (var i, r = Object.keys(t), n = e.toLowerCase().replace(Pt, ""), a = -1; ++a < r.length;) if ((i = r[a]).toLowerCase().replace(Pt, "") === n) return t[i]
                }

                function zt(t) {
                    var e, i, r, n = {}, a = t.split("+").map(function (t) {
                        return t.trim()
                    }).filter(function (t) {
                        return t
                    }).reduce(function (t, e) {
                        var i = e.split("=");
                        return i.push(!0), t[i[0].toLowerCase()] = i[1], t
                    }, {}), o = {
                        proj: "projName", datum: "datumCode", rf: function (t) {
                            n.rf = parseFloat(t)
                        }, lat_0: function (t) {
                            n.lat0 = t * St
                        }, lat_1: function (t) {
                            n.lat1 = t * St
                        }, lat_2: function (t) {
                            n.lat2 = t * St
                        }, lat_ts: function (t) {
                            n.lat_ts = t * St
                        }, lon_0: function (t) {
                            n.long0 = t * St
                        }, lon_1: function (t) {
                            n.long1 = t * St
                        }, lon_2: function (t) {
                            n.long2 = t * St
                        }, alpha: function (t) {
                            n.alpha = parseFloat(t) * St
                        }, gamma: function (t) {
                            n.rectified_grid_angle = parseFloat(t)
                        }, lonc: function (t) {
                            n.longc = t * St
                        }, x_0: function (t) {
                            n.x0 = parseFloat(t)
                        }, y_0: function (t) {
                            n.y0 = parseFloat(t)
                        }, k_0: function (t) {
                            n.k0 = parseFloat(t)
                        }, k: function (t) {
                            n.k0 = parseFloat(t)
                        }, a: function (t) {
                            n.a = parseFloat(t)
                        }, b: function (t) {
                            n.b = parseFloat(t)
                        }, r_a: function () {
                            n.R_A = !0
                        }, zone: function (t) {
                            n.zone = parseInt(t, 10)
                        }, south: function () {
                            n.utmSouth = !0
                        }, towgs84: function (t) {
                            n.datum_params = t.split(",").map(function (t) {
                                return parseFloat(t)
                            })
                        }, to_meter: function (t) {
                            n.to_meter = parseFloat(t)
                        }, units: function (t) {
                            n.units = t;
                            var e = At(Ct, t);
                            e && (n.to_meter = e.to_meter)
                        }, from_greenwich: function (t) {
                            n.from_greenwich = t * St
                        }, pm: function (t) {
                            var e = At(Tt, t);
                            n.from_greenwich = (e || parseFloat(t)) * St
                        }, nadgrids: function (t) {
                            "@null" === t ? n.datumCode = "none" : n.nadgrids = t
                        }, axis: function (t) {
                            3 === t.length && -1 !== "ewnsud".indexOf(t.substr(0, 1)) && -1 !== "ewnsud".indexOf(t.substr(1, 1)) && -1 !== "ewnsud".indexOf(t.substr(2, 1)) && (n.axis = t)
                        }, approx: function () {
                            n.approx = !0
                        }
                    };
                    for (e in a) i = a[e], e in o ? "function" == typeof (r = o[e]) ? r(i) : n[r] = i : n[e] = i;
                    return "string" == typeof n.datumCode && "WGS84" !== n.datumCode && (n.datumCode = n.datumCode.toLowerCase()), n
                }

                var kt = /\s/, Lt = /[A-Za-z]/, Dt = /[A-Za-z84_]/, Rt = /[,\]]/, Bt = /[\d\.E\-\+]/;

                function Ot(t) {
                    if ("string" != typeof t) throw new Error("not a string");
                    this.text = t.trim(), this.level = 0, this.place = 0, this.root = null, this.stack = [], this.currentObject = null, this.state = 1
                }

                function Ft(t, e, i) {
                    Array.isArray(e) && (i.unshift(e), e = null);
                    var r = i.reduce(function (t, e) {
                        return Ut(e, t), t
                    }, e ? {} : t);
                    e && (t[e] = r)
                }

                function Ut(t, e) {
                    if (Array.isArray(t)) {
                        var i = t.shift();
                        if ("PARAMETER" === i && (i = t.shift()), 1 === t.length) return Array.isArray(t[0]) ? (e[i] = {}, void Ut(t[0], e[i])) : void (e[i] = t[0]);
                        if (t.length) if ("TOWGS84" !== i) {
                            if ("AXIS" === i) return i in e || (e[i] = []), void e[i].push(t);
                            var r;
                            switch (Array.isArray(i) || (e[i] = {}), i) {
                                case"UNIT":
                                case"PRIMEM":
                                case"VERT_DATUM":
                                    return e[i] = {
                                        name: t[0].toLowerCase(),
                                        convert: t[1]
                                    }, void (3 === t.length && Ut(t[2], e[i]));
                                case"SPHEROID":
                                case"ELLIPSOID":
                                    return e[i] = {
                                        name: t[0],
                                        a: t[1],
                                        rf: t[2]
                                    }, void (4 === t.length && Ut(t[3], e[i]));
                                case"PROJECTEDCRS":
                                case"PROJCRS":
                                case"GEOGCS":
                                case"GEOCCS":
                                case"PROJCS":
                                case"LOCAL_CS":
                                case"GEODCRS":
                                case"GEODETICCRS":
                                case"GEODETICDATUM":
                                case"EDATUM":
                                case"ENGINEERINGDATUM":
                                case"VERT_CS":
                                case"VERTCRS":
                                case"VERTICALCRS":
                                case"COMPD_CS":
                                case"COMPOUNDCRS":
                                case"ENGINEERINGCRS":
                                case"ENGCRS":
                                case"FITTED_CS":
                                case"LOCAL_DATUM":
                                case"DATUM":
                                    return t[0] = ["name", t[0]], void Ft(e, i, t);
                                default:
                                    for (r = -1; ++r < t.length;) if (!Array.isArray(t[r])) return Ut(t, e[i]);
                                    return Ft(e, i, t)
                            }
                        } else e[i] = t; else e[i] = !0
                    } else e[t] = !0
                }

                function Nt(t) {
                    return .017453292519943295 * t
                }

                function Vt(t) {
                    var e = new Ot(t).output(), i = e.shift(), r = e.shift();
                    e.unshift(["name", r]), e.unshift(["type", i]);
                    var n = {};
                    return Ut(e, n), function (e) {
                        if ("GEOGCS" === e.type ? e.projName = "longlat" : "LOCAL_CS" === e.type ? (e.projName = "identity", e.local = !0) : e.projName = "object" == typeof e.PROJECTION ? Object.keys(e.PROJECTION)[0] : e.PROJECTION, e.AXIS) {
                            for (var t = "", i = 0, r = e.AXIS.length; i < r; ++i) {
                                var n = [e.AXIS[i][0].toLowerCase(), e.AXIS[i][1].toLowerCase()];
                                -1 !== n[0].indexOf("north") || ("y" === n[0] || "lat" === n[0]) && "north" === n[1] ? t += "n" : -1 !== n[0].indexOf("south") || ("y" === n[0] || "lat" === n[0]) && "south" === n[1] ? t += "s" : -1 !== n[0].indexOf("east") || ("x" === n[0] || "lon" === n[0]) && "east" === n[1] ? t += "e" : -1 === n[0].indexOf("west") && ("x" !== n[0] && "lon" !== n[0] || "west" !== n[1]) || (t += "w")
                            }
                            2 === t.length && (t += "u"), 3 === t.length && (e.axis = t)
                        }
                        e.UNIT && (e.units = e.UNIT.name.toLowerCase(), "metre" === e.units && (e.units = "meter"), e.UNIT.convert && ("GEOGCS" === e.type ? e.DATUM && e.DATUM.SPHEROID && (e.to_meter = e.UNIT.convert * e.DATUM.SPHEROID.a) : e.to_meter = e.UNIT.convert));
                        var a = e.GEOGCS;

                        function o(t) {
                            return t * (e.to_meter || 1)
                        }

                        "GEOGCS" === e.type && (a = e), a && (e.datumCode = a.DATUM ? a.DATUM.name.toLowerCase() : a.name.toLowerCase(), "d_" === e.datumCode.slice(0, 2) && (e.datumCode = e.datumCode.slice(2)), "new_zealand_geodetic_datum_1949" !== e.datumCode && "new_zealand_1949" !== e.datumCode || (e.datumCode = "nzgd49"), "wgs_1984" !== e.datumCode && "world_geodetic_system_1984" !== e.datumCode || ("Mercator_Auxiliary_Sphere" === e.PROJECTION && (e.sphere = !0), e.datumCode = "wgs84"), "_ferro" === e.datumCode.slice(-6) && (e.datumCode = e.datumCode.slice(0, -6)), "_jakarta" === e.datumCode.slice(-8) && (e.datumCode = e.datumCode.slice(0, -8)), ~e.datumCode.indexOf("belge") && (e.datumCode = "rnb72"), a.DATUM && a.DATUM.SPHEROID && (e.ellps = a.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk"), "international" === e.ellps.toLowerCase().slice(0, 13) && (e.ellps = "intl"), e.a = a.DATUM.SPHEROID.a, e.rf = parseFloat(a.DATUM.SPHEROID.rf, 10)), a.DATUM && a.DATUM.TOWGS84 && (e.datum_params = a.DATUM.TOWGS84), ~e.datumCode.indexOf("osgb_1936") && (e.datumCode = "osgb36"), ~e.datumCode.indexOf("osni_1952") && (e.datumCode = "osni52"), (~e.datumCode.indexOf("tm65") || ~e.datumCode.indexOf("geodetic_datum_of_1965")) && (e.datumCode = "ire65"), "ch1903+" === e.datumCode && (e.datumCode = "ch1903"), ~e.datumCode.indexOf("israel") && (e.datumCode = "isr93")), e.b && !isFinite(e.b) && (e.b = e.a), [["standard_parallel_1", "Standard_Parallel_1"], ["standard_parallel_1", "Latitude of 1st standard parallel"], ["standard_parallel_2", "Standard_Parallel_2"], ["standard_parallel_2", "Latitude of 2nd standard parallel"], ["false_easting", "False_Easting"], ["false_easting", "False easting"], ["false-easting", "Easting at false origin"], ["false_northing", "False_Northing"], ["false_northing", "False northing"], ["false_northing", "Northing at false origin"], ["central_meridian", "Central_Meridian"], ["central_meridian", "Longitude of natural origin"], ["central_meridian", "Longitude of false origin"], ["latitude_of_origin", "Latitude_Of_Origin"], ["latitude_of_origin", "Central_Parallel"], ["latitude_of_origin", "Latitude of natural origin"], ["latitude_of_origin", "Latitude of false origin"], ["scale_factor", "Scale_Factor"], ["k0", "scale_factor"], ["latitude_of_center", "Latitude_Of_Center"], ["latitude_of_center", "Latitude_of_center"], ["lat0", "latitude_of_center", Nt], ["longitude_of_center", "Longitude_Of_Center"], ["longitude_of_center", "Longitude_of_center"], ["longc", "longitude_of_center", Nt], ["x0", "false_easting", o], ["y0", "false_northing", o], ["long0", "central_meridian", Nt], ["lat0", "latitude_of_origin", Nt], ["lat0", "standard_parallel_1", Nt], ["lat1", "standard_parallel_1", Nt], ["lat2", "standard_parallel_2", Nt], ["azimuth", "Azimuth"], ["alpha", "azimuth", Nt], ["srsCode", "name"]].forEach(function (t) {
                            return function (t, e) {
                                var i = e[0], r = e[1];
                                !(i in t) && r in t && (t[i] = t[r], 3 === e.length && (t[i] = e[2](t[i])))
                            }(e, t)
                        }), e.long0 || !e.longc || "Albers_Conic_Equal_Area" !== e.projName && "Lambert_Azimuthal_Equal_Area" !== e.projName || (e.long0 = e.longc), e.lat_ts || !e.lat1 || "Stereographic_South_Pole" !== e.projName && "Polar Stereographic (variant B)" !== e.projName || (e.lat0 = Nt(e.lat1 > 0 ? 90 : -90), e.lat_ts = e.lat1)
                    }(n), n
                }

                function jt(t) {
                    var e = this;
                    if (2 === arguments.length) {
                        var i = arguments[1];
                        jt[t] = "string" == typeof i ? "+" === i.charAt(0) ? zt(arguments[1]) : Vt(arguments[1]) : i
                    } else if (1 === arguments.length) {
                        if (Array.isArray(t)) return t.map(function (t) {
                            Array.isArray(t) ? jt.apply(e, t) : jt(t)
                        });
                        if ("string" == typeof t) {
                            if (t in jt) return jt[t]
                        } else "EPSG" in t ? jt["EPSG:" + t.EPSG] = t : "ESRI" in t ? jt["ESRI:" + t.ESRI] = t : "IAU2000" in t ? jt["IAU2000:" + t.IAU2000] = t : console.log(t);
                        return
                    }
                }

                Ot.prototype.readCharicter = function () {
                    var t = this.text[this.place++];
                    if (4 !== this.state) for (; kt.test(t);) {
                        if (this.place >= this.text.length) return;
                        t = this.text[this.place++]
                    }
                    switch (this.state) {
                        case 1:
                            return this.neutral(t);
                        case 2:
                            return this.keyword(t);
                        case 4:
                            return this.quoted(t);
                        case 5:
                            return this.afterquote(t);
                        case 3:
                            return this.number(t);
                        case-1:
                            return
                    }
                }, Ot.prototype.afterquote = function (t) {
                    if ('"' === t) return this.word += '"', void (this.state = 4);
                    if (Rt.test(t)) return this.word = this.word.trim(), void this.afterItem(t);
                    throw new Error("havn't handled \"" + t + '" in afterquote yet, index ' + this.place)
                }, Ot.prototype.afterItem = function (t) {
                    return "," === t ? (null !== this.word && this.currentObject.push(this.word), this.word = null, void (this.state = 1)) : "]" === t ? (this.level--, null !== this.word && (this.currentObject.push(this.word), this.word = null), this.state = 1, this.currentObject = this.stack.pop(), void (this.currentObject || (this.state = -1))) : void 0
                }, Ot.prototype.number = function (t) {
                    if (!Bt.test(t)) {
                        if (Rt.test(t)) return this.word = parseFloat(this.word), void this.afterItem(t);
                        throw new Error("havn't handled \"" + t + '" in number yet, index ' + this.place)
                    }
                    this.word += t
                }, Ot.prototype.quoted = function (t) {
                    '"' !== t ? this.word += t : this.state = 5
                }, Ot.prototype.keyword = function (t) {
                    if (Dt.test(t)) this.word += t; else {
                        if ("[" === t) {
                            var e = [];
                            return e.push(this.word), this.level++, null === this.root ? this.root = e : this.currentObject.push(e), this.stack.push(this.currentObject), this.currentObject = e, void (this.state = 1)
                        }
                        if (!Rt.test(t)) throw new Error("havn't handled \"" + t + '" in keyword yet, index ' + this.place);
                        this.afterItem(t)
                    }
                }, Ot.prototype.neutral = function (t) {
                    if (Lt.test(t)) return this.word = t, void (this.state = 2);
                    if ('"' === t) return this.word = "", void (this.state = 4);
                    if (Bt.test(t)) return this.word = t, void (this.state = 3);
                    if (!Rt.test(t)) throw new Error("havn't handled \"" + t + '" in neutral yet, index ' + this.place);
                    this.afterItem(t)
                }, Ot.prototype.output = function () {
                    for (; this.place < this.text.length;) this.readCharicter();
                    if (-1 === this.state) return this.root;
                    throw new Error('unable to parse string "' + this.text + '". State is ' + this.state)
                }, function (t) {
                    t("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), t("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"), t("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"), t.WGS84 = t["EPSG:4326"], t["EPSG:3785"] = t["EPSG:3857"], t.GOOGLE = t["EPSG:3857"], t["EPSG:900913"] = t["EPSG:3857"], t["EPSG:102113"] = t["EPSG:3857"]
                }(jt);
                var qt = ["PROJECTEDCRS", "PROJCRS", "GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS", "GEODCRS", "GEODETICCRS", "GEODETICDATUM", "ENGCRS", "ENGINEERINGCRS"],
                    Gt = ["3857", "900913", "3785", "102113"];

                function Zt(t) {
                    if (!function (t) {
                        return "string" == typeof t
                    }(t)) return t;
                    if (function (t) {
                        return t in jt
                    }(t)) return jt[t];
                    if (function (e) {
                        return qt.some(function (t) {
                            return e.indexOf(t) > -1
                        })
                    }(t)) {
                        var e = Vt(t);
                        if (function (t) {
                            var e = At(t, "authority");
                            if (e) {
                                var i = At(e, "epsg");
                                return i && Gt.indexOf(i) > -1
                            }
                        }(e)) return jt["EPSG:3857"];
                        var i = function (t) {
                            var e = At(t, "extension");
                            if (e) return At(e, "proj4")
                        }(e);
                        return i ? zt(i) : e
                    }
                    return function (t) {
                        return "+" === t[0]
                    }(t) ? zt(t) : void 0
                }

                function Wt(t, e) {
                    var i, r;
                    if (t = t || {}, !e) return t;
                    for (r in e) void 0 !== (i = e[r]) && (t[r] = i);
                    return t
                }

                function Xt(t, e, i) {
                    var r = t * e;
                    return i / Math.sqrt(1 - r * r)
                }

                function Ht(t) {
                    return t < 0 ? -1 : 1
                }

                function P(t) {
                    return Math.abs(t) <= _ ? t : t - Ht(t) * It
                }

                function Kt(t, e, i) {
                    var r = t * i;
                    return r = Math.pow((1 - r) / (1 + r), .5 * t), Math.tan(.5 * (C - e)) / r
                }

                function Yt(t, e) {
                    for (var i, r, n = .5 * t, a = C - 2 * Math.atan(e), o = 0; o <= 15; o++) if (i = t * Math.sin(a), a += r = C - 2 * Math.atan(e * Math.pow((1 - i) / (1 + i), n)) - a, Math.abs(r) <= 1e-10) return a;
                    return -9999
                }

                function Jt(t) {
                    return t
                }

                var Qt = [{
                    init: function () {
                        var t = this.b / this.a;
                        this.es = 1 - t * t, "x0" in this || (this.x0 = 0), "y0" in this || (this.y0 = 0), this.e = Math.sqrt(this.es), this.lat_ts ? this.k0 = this.sphere ? Math.cos(this.lat_ts) : Xt(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) : this.k0 || (this.k0 = this.k ? this.k : 1)
                    },
                    forward: function (t) {
                        var e, i, r = t.x, n = t.y;
                        if (n * Et > 90 && n * Et < -90 && r * Et > 180 && r * Et < -180) return null;
                        if (Math.abs(Math.abs(n) - C) <= 1e-10) return null;
                        if (this.sphere) e = this.x0 + this.a * this.k0 * P(r - this.long0), i = this.y0 + this.a * this.k0 * Math.log(Math.tan(M + .5 * n)); else {
                            var a = Math.sin(n), o = Kt(this.e, n, a);
                            e = this.x0 + this.a * this.k0 * P(r - this.long0), i = this.y0 - this.a * this.k0 * Math.log(o)
                        }
                        return t.x = e, t.y = i, t
                    },
                    inverse: function (t) {
                        var e, i, r = t.x - this.x0, n = t.y - this.y0;
                        if (this.sphere) i = C - 2 * Math.atan(Math.exp(-n / (this.a * this.k0))); else {
                            var a = Math.exp(-n / (this.a * this.k0));
                            if (-9999 === (i = Yt(this.e, a))) return null
                        }
                        return e = P(this.long0 + r / (this.a * this.k0)), t.x = e, t.y = i, t
                    },
                    names: ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"]
                }, {
                    init: function () {
                    }, forward: Jt, inverse: Jt, names: ["longlat", "identity"]
                }], $t = {}, te = [];

                function ee(t, e) {
                    var i = te.length;
                    return t.names ? (te[i] = t, t.names.forEach(function (t) {
                        $t[t.toLowerCase()] = i
                    }), this) : (console.log(e), !0)
                }

                var ie = {
                    start: function () {
                        Qt.forEach(ee)
                    }, add: ee, get: function (t) {
                        if (!t) return !1;
                        var e = t.toLowerCase();
                        return void 0 !== $t[e] && te[$t[e]] ? te[$t[e]] : void 0
                    }
                }, re = {
                    MERIT: {a: 6378137, rf: 298.257, ellipseName: "MERIT 1983"},
                    SGS85: {a: 6378136, rf: 298.257, ellipseName: "Soviet Geodetic System 85"},
                    GRS80: {a: 6378137, rf: 298.257222101, ellipseName: "GRS 1980(IUGG, 1980)"},
                    IAU76: {a: 6378140, rf: 298.257, ellipseName: "IAU 1976"},
                    airy: {a: 6377563.396, b: 6356256.91, ellipseName: "Airy 1830"},
                    APL4: {a: 6378137, rf: 298.25, ellipseName: "Appl. Physics. 1965"},
                    NWL9D: {a: 6378145, rf: 298.25, ellipseName: "Naval Weapons Lab., 1965"},
                    mod_airy: {a: 6377340.189, b: 6356034.446, ellipseName: "Modified Airy"},
                    andrae: {a: 6377104.43, rf: 300, ellipseName: "Andrae 1876 (Den., Iclnd.)"},
                    aust_SA: {a: 6378160, rf: 298.25, ellipseName: "Australian Natl & S. Amer. 1969"},
                    GRS67: {a: 6378160, rf: 298.247167427, ellipseName: "GRS 67(IUGG 1967)"},
                    bessel: {a: 6377397.155, rf: 299.1528128, ellipseName: "Bessel 1841"},
                    bess_nam: {a: 6377483.865, rf: 299.1528128, ellipseName: "Bessel 1841 (Namibia)"},
                    clrk66: {a: 6378206.4, b: 6356583.8, ellipseName: "Clarke 1866"},
                    clrk80: {a: 6378249.145, rf: 293.4663, ellipseName: "Clarke 1880 mod."},
                    clrk80ign: {a: 6378249.2, b: 6356515, rf: 293.4660213, ellipseName: "Clarke 1880 (IGN)"},
                    clrk58: {a: 6378293.645208759, rf: 294.2606763692654, ellipseName: "Clarke 1858"},
                    CPM: {a: 6375738.7, rf: 334.29, ellipseName: "Comm. des Poids et Mesures 1799"},
                    delmbr: {a: 6376428, rf: 311.5, ellipseName: "Delambre 1810 (Belgium)"},
                    engelis: {a: 6378136.05, rf: 298.2566, ellipseName: "Engelis 1985"},
                    evrst30: {a: 6377276.345, rf: 300.8017, ellipseName: "Everest 1830"},
                    evrst48: {a: 6377304.063, rf: 300.8017, ellipseName: "Everest 1948"},
                    evrst56: {a: 6377301.243, rf: 300.8017, ellipseName: "Everest 1956"},
                    evrst69: {a: 6377295.664, rf: 300.8017, ellipseName: "Everest 1969"},
                    evrstSS: {a: 6377298.556, rf: 300.8017, ellipseName: "Everest (Sabah & Sarawak)"},
                    fschr60: {a: 6378166, rf: 298.3, ellipseName: "Fischer (Mercury Datum) 1960"},
                    fschr60m: {a: 6378155, rf: 298.3, ellipseName: "Fischer 1960"},
                    fschr68: {a: 6378150, rf: 298.3, ellipseName: "Fischer 1968"},
                    helmert: {a: 6378200, rf: 298.3, ellipseName: "Helmert 1906"},
                    hough: {a: 6378270, rf: 297, ellipseName: "Hough"},
                    intl: {a: 6378388, rf: 297, ellipseName: "International 1909 (Hayford)"},
                    kaula: {a: 6378163, rf: 298.24, ellipseName: "Kaula 1961"},
                    lerch: {a: 6378139, rf: 298.257, ellipseName: "Lerch 1979"},
                    mprts: {a: 6397300, rf: 191, ellipseName: "Maupertius 1738"},
                    new_intl: {a: 6378157.5, b: 6356772.2, ellipseName: "New International 1967"},
                    plessis: {a: 6376523, rf: 6355863, ellipseName: "Plessis 1817 (France)"},
                    krass: {a: 6378245, rf: 298.3, ellipseName: "Krassovsky, 1942"},
                    SEasia: {a: 6378155, b: 6356773.3205, ellipseName: "Southeast Asia"},
                    walbeck: {a: 6376896, b: 6355834.8467, ellipseName: "Walbeck"},
                    WGS60: {a: 6378165, rf: 298.3, ellipseName: "WGS 60"},
                    WGS66: {a: 6378145, rf: 298.25, ellipseName: "WGS 66"},
                    WGS7: {a: 6378135, rf: 298.26, ellipseName: "WGS 72"}
                }, ne = re.WGS84 = {a: 6378137, rf: 298.257223563, ellipseName: "WGS 84"};
                re.sphere = {a: 6370997, b: 6370997, ellipseName: "Normal Sphere (r=6370997)"};
                var ae = {
                    wgs84: {towgs84: "0,0,0", ellipse: "WGS84", datumName: "WGS84"},
                    ch1903: {towgs84: "674.374,15.056,405.346", ellipse: "bessel", datumName: "swiss"},
                    ggrs87: {
                        towgs84: "-199.87,74.79,246.62",
                        ellipse: "GRS80",
                        datumName: "Greek_Geodetic_Reference_System_1987"
                    },
                    nad83: {towgs84: "0,0,0", ellipse: "GRS80", datumName: "North_American_Datum_1983"},
                    nad27: {
                        nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",
                        ellipse: "clrk66",
                        datumName: "North_American_Datum_1927"
                    },
                    potsdam: {
                        towgs84: "598.1,73.7,418.2,0.202,0.045,-2.455,6.7",
                        ellipse: "bessel",
                        datumName: "Potsdam Rauenberg 1950 DHDN"
                    },
                    carthage: {towgs84: "-263.0,6.0,431.0", ellipse: "clark80", datumName: "Carthage 1934 Tunisia"},
                    hermannskogel: {
                        towgs84: "577.326,90.129,463.919,5.137,1.474,5.297,2.4232",
                        ellipse: "bessel",
                        datumName: "Hermannskogel"
                    },
                    osni52: {
                        towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
                        ellipse: "airy",
                        datumName: "Irish National"
                    },
                    ire65: {
                        towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
                        ellipse: "mod_airy",
                        datumName: "Ireland 1965"
                    },
                    rassadiran: {towgs84: "-133.63,-157.5,-158.62", ellipse: "intl", datumName: "Rassadiran"},
                    nzgd49: {
                        towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
                        ellipse: "intl",
                        datumName: "New Zealand Geodetic Datum 1949"
                    },
                    osgb36: {
                        towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",
                        ellipse: "airy",
                        datumName: "Airy 1830"
                    },
                    s_jtsk: {towgs84: "589,76,480", ellipse: "bessel", datumName: "S-JTSK (Ferro)"},
                    beduaram: {towgs84: "-106,-87,188", ellipse: "clrk80", datumName: "Beduaram"},
                    gunung_segara: {towgs84: "-403,684,41", ellipse: "bessel", datumName: "Gunung Segara Jakarta"},
                    rnb72: {
                        towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",
                        ellipse: "intl",
                        datumName: "Reseau National Belge 1972"
                    }
                }, oe = {};

                function se(t) {
                    if (0 === t.length) return null;
                    var e = "@" === t[0];
                    return e && (t = t.slice(1)), "null" === t ? {
                        name: "null",
                        mandatory: !e,
                        grid: null,
                        isNull: !0
                    } : {name: t, mandatory: !e, grid: oe[t] || null, isNull: !1}
                }

                function le(t) {
                    return t / 3600 * Math.PI / 180
                }

                function ue(t, e, i) {
                    return String.fromCharCode.apply(null, new Uint8Array(t.buffer.slice(e, i)))
                }

                function he(t) {
                    return t.map(function (t) {
                        return [le(t.longitudeShift), le(t.latitudeShift)]
                    })
                }

                function ce(t, e, i) {
                    return {
                        name: ue(t, e + 8, e + 16).trim(),
                        parent: ue(t, e + 24, e + 24 + 8).trim(),
                        lowerLatitude: t.getFloat64(e + 72, i),
                        upperLatitude: t.getFloat64(e + 88, i),
                        lowerLongitude: t.getFloat64(e + 104, i),
                        upperLongitude: t.getFloat64(e + 120, i),
                        latitudeInterval: t.getFloat64(e + 136, i),
                        longitudeInterval: t.getFloat64(e + 152, i),
                        gridNodeCount: t.getInt32(e + 168, i)
                    }
                }

                function pe(t, e, i, r) {
                    for (var n = e + 176, a = [], o = 0; o < i.gridNodeCount; o++) {
                        var s = {
                            latitudeShift: t.getFloat32(n + 16 * o, r),
                            longitudeShift: t.getFloat32(n + 16 * o + 4, r),
                            latitudeAccuracy: t.getFloat32(n + 16 * o + 8, r),
                            longitudeAccuracy: t.getFloat32(n + 16 * o + 12, r)
                        };
                        a.push(s)
                    }
                    return a
                }

                function fe(t, e) {
                    if (!(this instanceof fe)) return new fe(t);
                    e = e || function (t) {
                        if (t) throw t
                    };
                    var i = Zt(t);
                    if ("object" == typeof i) {
                        var r = fe.projections.get(i.projName);
                        if (r) {
                            if (i.datumCode && "none" !== i.datumCode) {
                                var n = At(ae, i.datumCode);
                                n && (i.datum_params = i.datum_params || (n.towgs84 ? n.towgs84.split(",") : null), i.ellps = n.ellipse, i.datumName = n.datumName ? n.datumName : i.datumCode)
                            }
                            i.k0 = i.k0 || 1, i.axis = i.axis || "enu", i.ellps = i.ellps || "wgs84", i.lat1 = i.lat1 || i.lat0;
                            var a, o, s, l, u, h, c = function (t, e, i, r, n) {
                                    if (!t) {
                                        var a = At(re, r);
                                        a || (a = ne), t = a.a, e = a.b, i = a.rf
                                    }
                                    return i && !e && (e = (1 - 1 / i) * t), (0 === i || Math.abs(t - e) < 1e-10) && (n = !0, e = t), {
                                        a: t,
                                        b: e,
                                        rf: i,
                                        sphere: n
                                    }
                                }(i.a, i.b, i.rf, i.ellps, i.sphere),
                                p = (u = ((s = (a = c.a) * a) - (l = (o = c.b) * o)) / s, h = 0, i.R_A ? (s = (a *= 1 - u * (.16666666666666666 + u * (.04722222222222222 + .022156084656084655 * u))) * a, u = 0) : h = Math.sqrt(u), {
                                    es: u,
                                    e: h,
                                    ep2: (s - l) / l
                                }), f = function (t) {
                                    return void 0 === t ? null : t.split(",").map(se)
                                }(i.nadgrids), d = i.datum || function (t, e, i, r, n, a, o) {
                                    var s = {};
                                    return s.datum_type = void 0 === t || "none" === t ? 5 : 4, e && (s.datum_params = e.map(parseFloat), 0 === s.datum_params[0] && 0 === s.datum_params[1] && 0 === s.datum_params[2] || (s.datum_type = 1), s.datum_params.length > 3 && (0 === s.datum_params[3] && 0 === s.datum_params[4] && 0 === s.datum_params[5] && 0 === s.datum_params[6] || (s.datum_type = 2, s.datum_params[3] *= Mt, s.datum_params[4] *= Mt, s.datum_params[5] *= Mt, s.datum_params[6] = s.datum_params[6] / 1e6 + 1))), o && (s.datum_type = 3, s.grids = o), s.a = i, s.b = r, s.es = n, s.ep2 = a, s
                                }(i.datumCode, i.datum_params, c.a, c.b, p.es, p.ep2, f);
                            Wt(this, i), Wt(this, r), this.a = c.a, this.b = c.b, this.rf = c.rf, this.sphere = c.sphere, this.es = p.es, this.e = p.e, this.ep2 = p.ep2, this.datum = d, this.init(), e(null, this)
                        } else e(t)
                    } else e(t)
                }

                function de(t, e, i) {
                    var r, n, a, o = t.x, s = t.y, l = t.z ? t.z : 0;
                    if (s < -C && s > -1.001 * C) s = -C; else if (s > C && s < 1.001 * C) s = C; else {
                        if (s < -C) return {x: -1 / 0, y: -1 / 0, z: t.z};
                        if (s > C) return {x: 1 / 0, y: 1 / 0, z: t.z}
                    }
                    return o > Math.PI && (o -= 2 * Math.PI), n = Math.sin(s), a = Math.cos(s), {
                        x: ((r = i / Math.sqrt(1 - e * (n * n))) + l) * a * Math.cos(o),
                        y: (r + l) * a * Math.sin(o),
                        z: (r * (1 - e) + l) * n
                    }
                }

                function me(t, e, i, r) {
                    var n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v = t.x, x = t.y, b = t.z ? t.z : 0;
                    if (n = Math.sqrt(v * v + x * x), a = Math.sqrt(v * v + x * x + b * b), n / i < 1e-12) {
                        if (g = 0, a / i < 1e-12) return _ = -r, {x: t.x, y: t.y, z: t.z}
                    } else g = Math.atan2(x, v);
                    o = b / a, c = (s = n / a) * (1 - e) * (l = 1 / Math.sqrt(1 - e * (2 - e) * s * s)), p = o * l, y = 0;
                    do {
                        y++, u = e * (h = i / Math.sqrt(1 - e * p * p)) / (h + (_ = n * c + b * p - h * (1 - e * p * p))), m = (d = o * (l = 1 / Math.sqrt(1 - u * (2 - u) * s * s))) * c - (f = s * (1 - u) * l) * p, c = f, p = d
                    } while (m * m > 1e-24 && y < 30);
                    return {x: g, y: Math.atan(d / Math.abs(f)), z: _}
                }

                function ye(t) {
                    return 1 === t || 2 === t
                }

                function ge(t, e, i) {
                    if (null === t.grids || 0 === t.grids.length) return console.log("Grid shift grids not found"), -1;
                    for (var r = {x: -i.x, y: i.y}, n = {
                        x: Number.NaN,
                        y: Number.NaN
                    }, a = [], o = 0; o < t.grids.length; o++) {
                        var s = t.grids[o];
                        if (a.push(s.name), s.isNull) {
                            n = r;
                            break
                        }
                        if (null !== s.grid) {
                            var l = s.grid.subgrids[0], u = (Math.abs(l.del[1]) + Math.abs(l.del[0])) / 1e4;
                            if (!(l.ll[1] - u > r.y || l.ll[0] - u > r.x || l.ll[1] + (l.lim[1] - 1) * l.del[1] + u < r.y || l.ll[0] + (l.lim[0] - 1) * l.del[0] + u < r.x || (n = _e(r, e, l), isNaN(n.x)))) break
                        } else if (s.mandatory) return console.log("Unable to find mandatory grid '" + s.name + "'"), -1
                    }
                    return isNaN(n.x) ? (console.log("Failed to find a grid shift table for location '" + -r.x * Et + " " + r.y * Et + " tried: '" + a + "'"), -1) : (i.x = -n.x, i.y = n.y, 0)
                }

                function _e(t, e, i) {
                    var r = {x: Number.NaN, y: Number.NaN};
                    if (isNaN(t.x)) return r;
                    var n = {x: t.x, y: t.y};
                    n.x -= i.ll[0], n.y -= i.ll[1], n.x = P(n.x - Math.PI) + Math.PI;
                    var a = ve(n, i);
                    if (e) {
                        if (isNaN(a.x)) return r;
                        a.x = n.x - a.x, a.y = n.y - a.y;
                        var o, s, l = 9;
                        do {
                            if (s = ve(a, i), isNaN(s.x)) {
                                console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");
                                break
                            }
                            a.x += (o = {x: n.x - (s.x + a.x), y: n.y - (s.y + a.y)}).x, a.y += o.y
                        } while (l-- && Math.abs(o.x) > 1e-12 && Math.abs(o.y) > 1e-12);
                        if (l < 0) return console.log("Inverse grid shift iterator failed to converge."), r;
                        r.x = P(a.x + i.ll[0]), r.y = a.y + i.ll[1]
                    } else isNaN(a.x) || (r.x = t.x + a.x, r.y = t.y + a.y);
                    return r
                }

                function ve(t, e) {
                    var i, r = {x: t.x / e.del[0], y: t.y / e.del[1]}, n = Math.floor(r.x), a = Math.floor(r.y),
                        o = r.x - 1 * n, s = r.y - 1 * a, l = {x: Number.NaN, y: Number.NaN};
                    if (n < 0 || n >= e.lim[0]) return l;
                    if (a < 0 || a >= e.lim[1]) return l;
                    var u = e.cvs[i = a * e.lim[0] + n][0], h = e.cvs[i][1];
                    i++;
                    var c = e.cvs[i][0], p = e.cvs[i][1], f = e.cvs[i += e.lim[0]][0], d = e.cvs[i][1];
                    i--;
                    var m = e.cvs[i][1], y = o * s, g = o * (1 - s), _ = (1 - o) * (1 - s), v = (1 - o) * s;
                    return l.x = _ * u + g * c + v * e.cvs[i][0] + y * f, l.y = _ * h + g * p + v * m + y * d, l
                }

                function xe(t, e, i) {
                    var r, n, a, o = i.x, s = i.y, l = i.z || 0, u = {};
                    for (a = 0; a < 3; a++) if (!e || 2 !== a || void 0 !== i.z) switch (0 === a ? (r = o, n = -1 !== "ew".indexOf(t.axis[a]) ? "x" : "y") : 1 === a ? (r = s, n = -1 !== "ns".indexOf(t.axis[a]) ? "y" : "x") : (r = l, n = "z"), t.axis[a]) {
                        case"e":
                            u[n] = r;
                            break;
                        case"w":
                            u[n] = -r;
                            break;
                        case"n":
                            u[n] = r;
                            break;
                        case"s":
                            u[n] = -r;
                            break;
                        case"u":
                            void 0 !== i[n] && (u.z = r);
                            break;
                        case"d":
                            void 0 !== i[n] && (u.z = -r);
                            break;
                        default:
                            return null
                    }
                    return u
                }

                function be(t) {
                    var e = {x: t[0], y: t[1]};
                    return t.length > 2 && (e.z = t[2]), t.length > 3 && (e.m = t[3]), e
                }

                function we(t) {
                    if ("function" == typeof Number.isFinite) {
                        if (Number.isFinite(t)) return;
                        throw new TypeError("coordinates must be finite numbers")
                    }
                    if ("number" != typeof t || t != t || !isFinite(t)) throw new TypeError("coordinates must be finite numbers")
                }

                function Me(t, e, i, r) {
                    var n, a = void 0 !== (i = Array.isArray(i) ? be(i) : {x: i.x, y: i.y, z: i.z, m: i.m}).z;
                    if (function (t) {
                        we(t.x), we(t.y)
                    }(i), t.datum && e.datum && function (t, e) {
                        return (1 === t.datum.datum_type || 2 === t.datum.datum_type || 3 === t.datum.datum_type) && "WGS84" !== e.datumCode || (1 === e.datum.datum_type || 2 === e.datum.datum_type || 3 === e.datum.datum_type) && "WGS84" !== t.datumCode
                    }(t, e) && (i = Me(t, n = new fe("WGS84"), i, r), t = n), r && "enu" !== t.axis && (i = xe(t, !1, i)), "longlat" === t.projName) i = {
                        x: i.x * St,
                        y: i.y * St,
                        z: i.z || 0
                    }; else if (t.to_meter && (i = {
                        x: i.x * t.to_meter,
                        y: i.y * t.to_meter,
                        z: i.z || 0
                    }), !(i = t.inverse(i))) return;
                    if (t.from_greenwich && (i.x += t.from_greenwich), i = function (t, e, i) {
                        if (function (t, e) {
                            return t.datum_type === e.datum_type && !(t.a !== e.a || Math.abs(t.es - e.es) > 5e-11) && (1 === t.datum_type ? t.datum_params[0] === e.datum_params[0] && t.datum_params[1] === e.datum_params[1] && t.datum_params[2] === e.datum_params[2] : 2 !== t.datum_type || t.datum_params[0] === e.datum_params[0] && t.datum_params[1] === e.datum_params[1] && t.datum_params[2] === e.datum_params[2] && t.datum_params[3] === e.datum_params[3] && t.datum_params[4] === e.datum_params[4] && t.datum_params[5] === e.datum_params[5] && t.datum_params[6] === e.datum_params[6])
                        }(t, e)) return i;
                        if (5 === t.datum_type || 5 === e.datum_type) return i;
                        var r = t.a, n = t.es;
                        if (3 === t.datum_type) {
                            if (0 !== ge(t, !1, i)) return;
                            r = 6378137, n = .0066943799901413165
                        }
                        var a = e.a, o = e.b, s = e.es;
                        return 3 === e.datum_type && (a = 6378137, o = 6356752.314, s = .0066943799901413165), n !== s || r !== a || ye(t.datum_type) || ye(e.datum_type) ? (i = de(i, n, r), ye(t.datum_type) && (i = function (t, e, i) {
                            if (1 === e) return {x: t.x + i[0], y: t.y + i[1], z: t.z + i[2]};
                            if (2 === e) {
                                var r = i[3], n = i[4], a = i[5], o = i[6];
                                return {
                                    x: o * (t.x - a * t.y + n * t.z) + i[0],
                                    y: o * (a * t.x + t.y - r * t.z) + i[1],
                                    z: o * (-n * t.x + r * t.y + t.z) + i[2]
                                }
                            }
                        }(i, t.datum_type, t.datum_params)), ye(e.datum_type) && (i = function (t, e, i) {
                            if (1 === e) return {x: t.x - i[0], y: t.y - i[1], z: t.z - i[2]};
                            if (2 === e) {
                                var r = i[3], n = i[4], a = i[5], o = i[6], s = (t.x - i[0]) / o, l = (t.y - i[1]) / o,
                                    u = (t.z - i[2]) / o;
                                return {x: s + a * l - n * u, y: -a * s + l + r * u, z: n * s - r * l + u}
                            }
                        }(i, e.datum_type, e.datum_params)), i = me(i, s, a, o), 3 !== e.datum_type || 0 === ge(e, !0, i) ? i : void 0) : i
                    }(t.datum, e.datum, i)) return e.from_greenwich && (i = {
                        x: i.x - e.from_greenwich,
                        y: i.y,
                        z: i.z || 0
                    }), "longlat" === e.projName ? i = {
                        x: i.x * Et,
                        y: i.y * Et,
                        z: i.z || 0
                    } : (i = e.forward(i), e.to_meter && (i = {
                        x: i.x / e.to_meter,
                        y: i.y / e.to_meter,
                        z: i.z || 0
                    })), r && "enu" !== e.axis ? xe(e, !0, i) : (a || delete i.z, i)
                }

                (fe.projections = ie).start();
                var Se = fe("WGS84");

                function Ee(e, i, r, t) {
                    var n, a, o;
                    return Array.isArray(r) ? (n = Me(e, i, r, t) || {
                        x: NaN,
                        y: NaN
                    }, r.length > 2 ? void 0 !== e.name && "geocent" === e.name || void 0 !== i.name && "geocent" === i.name ? "number" == typeof n.z ? [n.x, n.y, n.z].concat(r.splice(3)) : [n.x, n.y, r[2]].concat(r.splice(3)) : [n.x, n.y].concat(r.splice(2)) : [n.x, n.y]) : (a = Me(e, i, r, t), 2 === (o = Object.keys(r)).length || o.forEach(function (t) {
                        if (void 0 !== e.name && "geocent" === e.name || void 0 !== i.name && "geocent" === i.name) {
                            if ("x" === t || "y" === t || "z" === t) return
                        } else if ("x" === t || "y" === t) return;
                        a[t] = r[t]
                    }), a)
                }

                function Ie(t) {
                    return t instanceof fe ? t : t.oProj ? t.oProj : fe(t)
                }

                function Te(i, r, t) {
                    i = Ie(i);
                    var e, n = !1;
                    return void 0 === r ? (r = i, i = Se, n = !0) : (void 0 !== r.x || Array.isArray(r)) && (t = r, r = i, i = Se, n = !0), r = Ie(r), t ? Ee(i, r, t) : (e = {
                        forward: function (t, e) {
                            return Ee(i, r, t, e)
                        }, inverse: function (t, e) {
                            return Ee(r, i, t, e)
                        }
                    }, n && (e.oProj = r), e)
                }

                var Ce = 65, Pe = 73, Ae = 79, ze = {
                    forward: ke, inverse: function (t) {
                        var e = Be(Fe(t.toUpperCase()));
                        return e.lat && e.lon ? [e.lon, e.lat, e.lon, e.lat] : [e.left, e.bottom, e.right, e.top]
                    }, toPoint: Le
                };

                function ke(t, e) {
                    return e = e || 5, function (t, e) {
                        var i, r, n, a, o, s, l, u, h, c, p, f = "00000" + t.easting, d = "00000" + t.northing;
                        return t.zoneNumber + t.zoneLetter + (h = t.easting, c = t.northing, p = Oe(t.zoneNumber), i = Math.floor(h / 1e5), r = Math.floor(c / 1e5) % 20, a = "AJSAJS".charCodeAt(n = p - 1), o = "AFAFAF".charCodeAt(n), u = !1, (s = a + i - 1) > 90 && (s = s - 90 + Ce - 1, u = !0), (s === Pe || a < Pe && s > Pe || (s > Pe || a < Pe) && u) && s++, (s === Ae || a < Ae && s > Ae || (s > Ae || a < Ae) && u) && ++s === Pe && s++, s > 90 && (s = s - 90 + Ce - 1), (l = o + r) > 86 ? (l = l - 86 + Ce - 1, u = !0) : u = !1, (l === Pe || o < Pe && l > Pe || (l > Pe || o < Pe) && u) && l++, (l === Ae || o < Ae && l > Ae || (l > Ae || o < Ae) && u) && ++l === Pe && l++, l > 86 && (l = l - 86 + Ce - 1), String.fromCharCode(s) + String.fromCharCode(l)) + f.substr(f.length - 5, e) + d.substr(d.length - 5, e)
                    }(function (t) {
                        var e, i, r, n, a, o, s = t.lat, l = t.lon, u = 6378137, h = De(s), c = De(l);
                        o = Math.floor((l + 180) / 6) + 1, 180 === l && (o = 60), s >= 56 && s < 64 && l >= 3 && l < 12 && (o = 32), s >= 72 && s < 84 && (l >= 0 && l < 9 ? o = 31 : l >= 9 && l < 21 ? o = 33 : l >= 21 && l < 33 ? o = 35 : l >= 33 && l < 42 && (o = 37)), a = De(6 * (o - 1) - 180 + 3), e = u / Math.sqrt(1 - .00669438 * Math.sin(h) * Math.sin(h)), i = Math.tan(h) * Math.tan(h), r = .006739496752268451 * Math.cos(h) * Math.cos(h);
                        var p, f,
                            d = .9996 * e * ((n = Math.cos(h) * (c - a)) + (1 - i + r) * n * n * n / 6 + (5 - 18 * i + i * i + 72 * r - .39089081163157013) * n * n * n * n * n / 120) + 5e5,
                            m = .9996 * (u * (.9983242984503243 * h - .002514607064228144 * Math.sin(2 * h) + 2639046602129982e-21 * Math.sin(4 * h) - 3.418046101696858e-9 * Math.sin(6 * h)) + e * Math.tan(h) * (n * n / 2 + (5 - i + 9 * r + 4 * r * r) * n * n * n * n / 24 + (61 - 58 * i + i * i + 600 * r - 2.2240339282485886) * n * n * n * n * n * n / 720));
                        return s < 0 && (m += 1e7), {
                            northing: Math.round(m),
                            easting: Math.round(d),
                            zoneNumber: o,
                            zoneLetter: (p = s, f = "Z", 84 >= p && p >= 72 ? f = "X" : 72 > p && p >= 64 ? f = "W" : 64 > p && p >= 56 ? f = "V" : 56 > p && p >= 48 ? f = "U" : 48 > p && p >= 40 ? f = "T" : 40 > p && p >= 32 ? f = "S" : 32 > p && p >= 24 ? f = "R" : 24 > p && p >= 16 ? f = "Q" : 16 > p && p >= 8 ? f = "P" : 8 > p && p >= 0 ? f = "N" : 0 > p && p >= -8 ? f = "M" : -8 > p && p >= -16 ? f = "L" : -16 > p && p >= -24 ? f = "K" : -24 > p && p >= -32 ? f = "J" : -32 > p && p >= -40 ? f = "H" : -40 > p && p >= -48 ? f = "G" : -48 > p && p >= -56 ? f = "F" : -56 > p && p >= -64 ? f = "E" : -64 > p && p >= -72 ? f = "D" : -72 > p && p >= -80 && (f = "C"), f)
                        }
                    }({lat: t[1], lon: t[0]}), e)
                }

                function Le(t) {
                    var e = Be(Fe(t.toUpperCase()));
                    return e.lat && e.lon ? [e.lon, e.lat] : [(e.left + e.right) / 2, (e.top + e.bottom) / 2]
                }

                function De(t) {
                    return t * (Math.PI / 180)
                }

                function Re(t) {
                    return t / Math.PI * 180
                }

                function Be(t) {
                    var e = t.northing, i = t.easting, r = t.zoneLetter, n = t.zoneNumber;
                    if (n < 0 || n > 60) return null;
                    var a, o, s, l, u, h, c, p, f = 6378137,
                        d = (1 - Math.sqrt(.99330562)) / (1 + Math.sqrt(.99330562)), m = i - 5e5, y = e;
                    r < "N" && (y -= 1e7), h = 6 * (n - 1) - 180 + 3, p = (c = y / .9996 / 6367449.145945056) + (3 * d / 2 - 27 * d * d * d / 32) * Math.sin(2 * c) + (21 * d * d / 16 - 55 * d * d * d * d / 32) * Math.sin(4 * c) + 151 * d * d * d / 96 * Math.sin(6 * c), a = f / Math.sqrt(1 - .00669438 * Math.sin(p) * Math.sin(p)), o = Math.tan(p) * Math.tan(p), s = .006739496752268451 * Math.cos(p) * Math.cos(p), l = .99330562 * f / Math.pow(1 - .00669438 * Math.sin(p) * Math.sin(p), 1.5), u = m / (.9996 * a);
                    var g = p - a * Math.tan(p) / l * (u * u / 2 - (5 + 3 * o + 10 * s - 4 * s * s - .06065547077041606) * u * u * u * u / 24 + (61 + 90 * o + 298 * s + 45 * o * o - 1.6983531815716497 - 3 * s * s) * u * u * u * u * u * u / 720);
                    g = Re(g);
                    var _,
                        v = (u - (1 + 2 * o + s) * u * u * u / 6 + (5 - 2 * s + 28 * o - 3 * s * s + .05391597401814761 + 24 * o * o) * u * u * u * u * u / 120) / Math.cos(p);
                    if (v = h + Re(v), t.accuracy) {
                        var x = Be({
                            northing: t.northing + t.accuracy,
                            easting: t.easting + t.accuracy,
                            zoneLetter: t.zoneLetter,
                            zoneNumber: t.zoneNumber
                        });
                        _ = {top: x.lat, right: x.lon, bottom: g, left: v}
                    } else _ = {lat: g, lon: v};
                    return _
                }

                function Oe(t) {
                    var e = t % 6;
                    return 0 === e && (e = 6), e
                }

                function Fe(t) {
                    if (t && 0 === t.length) throw "MGRSPoint coverting from nothing";
                    for (var e, i = t.length, r = null, n = "", a = 0; !/[A-Z]/.test(e = t.charAt(a));) {
                        if (a >= 2) throw "MGRSPoint bad conversion from: " + t;
                        n += e, a++
                    }
                    var o = parseInt(n, 10);
                    if (0 === a || a + 3 > i) throw "MGRSPoint bad conversion from: " + t;
                    var s = t.charAt(a++);
                    if (s <= "A" || "B" === s || "Y" === s || s >= "Z" || "I" === s || "O" === s) throw "MGRSPoint zone letter " + s + " not handled: " + t;
                    r = t.substring(a, a += 2);
                    for (var l = Oe(o), u = function (t, e) {
                        for (var i = "AJSAJS".charCodeAt(e - 1), r = 1e5, n = !1; i !== t.charCodeAt(0);) {
                            if (++i === Pe && i++, i === Ae && i++, i > 90) {
                                if (n) throw "Bad character: " + t;
                                i = Ce, n = !0
                            }
                            r += 1e5
                        }
                        return r
                    }(r.charAt(0), l), h = function (t, e) {
                        if (t > "V") throw "MGRSPoint given invalid Northing " + t;
                        for (var i = "AFAFAF".charCodeAt(e - 1), r = 0, n = !1; i !== t.charCodeAt(0);) {
                            if (++i === Pe && i++, i === Ae && i++, i > 86) {
                                if (n) throw "Bad character: " + t;
                                i = Ce, n = !0
                            }
                            r += 1e5
                        }
                        return r
                    }(r.charAt(1), l); h < Ue(s);) h += 2e6;
                    var c = i - a;
                    if (c % 2 != 0) throw "MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + t;
                    var p, f, d, m = c / 2, y = 0, g = 0;
                    return m > 0 && (p = 1e5 / Math.pow(10, m), f = t.substring(a, a + m), y = parseFloat(f) * p, d = t.substring(a + m), g = parseFloat(d) * p), {
                        easting: y + u,
                        northing: g + h,
                        zoneLetter: s,
                        zoneNumber: o,
                        accuracy: p
                    }
                }

                function Ue(t) {
                    var e;
                    switch (t) {
                        case"C":
                            e = 11e5;
                            break;
                        case"D":
                            e = 2e6;
                            break;
                        case"E":
                            e = 28e5;
                            break;
                        case"F":
                            e = 37e5;
                            break;
                        case"G":
                            e = 46e5;
                            break;
                        case"H":
                            e = 55e5;
                            break;
                        case"J":
                            e = 64e5;
                            break;
                        case"K":
                            e = 73e5;
                            break;
                        case"L":
                            e = 82e5;
                            break;
                        case"M":
                            e = 91e5;
                            break;
                        case"N":
                            e = 0;
                            break;
                        case"P":
                            e = 8e5;
                            break;
                        case"Q":
                            e = 17e5;
                            break;
                        case"R":
                            e = 26e5;
                            break;
                        case"S":
                            e = 35e5;
                            break;
                        case"T":
                            e = 44e5;
                            break;
                        case"U":
                            e = 53e5;
                            break;
                        case"V":
                            e = 62e5;
                            break;
                        case"W":
                            e = 7e6;
                            break;
                        case"X":
                            e = 79e5;
                            break;
                        default:
                            e = -1
                    }
                    if (e >= 0) return e;
                    throw "Invalid zone letter: " + t
                }

                function Ne(t, e, i) {
                    if (!(this instanceof Ne)) return new Ne(t, e, i);
                    if (Array.isArray(t)) this.x = t[0], this.y = t[1], this.z = t[2] || 0; else if ("object" == typeof t) this.x = t.x, this.y = t.y, this.z = t.z || 0; else if ("string" == typeof t && void 0 === e) {
                        var r = t.split(",");
                        this.x = parseFloat(r[0], 10), this.y = parseFloat(r[1], 10), this.z = parseFloat(r[2], 10) || 0
                    } else this.x = t, this.y = e, this.z = i || 0;
                    console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")
                }

                Ne.fromMGRS = function (t) {
                    return new Ne(Le(t))
                }, Ne.prototype.toMGRS = function (t) {
                    return ke([this.x, this.y], t)
                };
                var Ve = .01068115234375;

                function je(t) {
                    var e = [];
                    e[0] = 1 - t * (.25 + t * (.046875 + t * (.01953125 + t * Ve))), e[1] = t * (.75 - t * (.046875 + t * (.01953125 + t * Ve)));
                    var i = t * t;
                    return e[2] = i * (.46875 - t * (.013020833333333334 + .007120768229166667 * t)), e[3] = (i *= t) * (.3645833333333333 - .005696614583333333 * t), e[4] = i * t * .3076171875, e
                }

                function qe(t, e, i, r) {
                    return r[0] * t - (i *= e) * (r[1] + (e *= e) * (r[2] + e * (r[3] + e * r[4])))
                }

                function Ge(t, e, i) {
                    for (var r = 1 / (1 - e), n = t, a = 20; a; --a) {
                        var o = Math.sin(n), s = 1 - e * o * o;
                        if (n -= s = (qe(n, o, Math.cos(n), i) - t) * (s * Math.sqrt(s)) * r, Math.abs(s) < 1e-10) return n
                    }
                    return n
                }

                var Ze = {
                    init: function () {
                        this.x0 = void 0 !== this.x0 ? this.x0 : 0, this.y0 = void 0 !== this.y0 ? this.y0 : 0, this.long0 = void 0 !== this.long0 ? this.long0 : 0, this.lat0 = void 0 !== this.lat0 ? this.lat0 : 0, this.es && (this.en = je(this.es), this.ml0 = qe(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en))
                    }, forward: function (t) {
                        var e, i, r, n = t.y, a = P(t.x - this.long0), o = Math.sin(n), s = Math.cos(n);
                        if (this.es) {
                            var l = s * a, u = Math.pow(l, 2), h = this.ep2 * Math.pow(s, 2), c = Math.pow(h, 2),
                                p = Math.abs(s) > 1e-10 ? Math.tan(n) : 0, f = Math.pow(p, 2), d = Math.pow(f, 2);
                            e = 1 - this.es * Math.pow(o, 2), l /= Math.sqrt(e);
                            var m = qe(n, o, s, this.en);
                            i = this.a * (this.k0 * l * (1 + u / 6 * (1 - f + h + u / 20 * (5 - 18 * f + d + 14 * h - 58 * f * h + u / 42 * (61 + 179 * d - d * f - 479 * f))))) + this.x0, r = this.a * (this.k0 * (m - this.ml0 + o * a * l / 2 * (1 + u / 12 * (5 - f + 9 * h + 4 * c + u / 30 * (61 + d - 58 * f + 270 * h - 330 * f * h + u / 56 * (1385 + 543 * d - d * f - 3111 * f)))))) + this.y0
                        } else {
                            var y = s * Math.sin(a);
                            if (Math.abs(Math.abs(y) - 1) < 1e-10) return 93;
                            if (i = .5 * this.a * this.k0 * Math.log((1 + y) / (1 - y)) + this.x0, r = s * Math.cos(a) / Math.sqrt(1 - Math.pow(y, 2)), (y = Math.abs(r)) >= 1) {
                                if (y - 1 > 1e-10) return 93;
                                r = 0
                            } else r = Math.acos(r);
                            n < 0 && (r = -r), r = this.a * this.k0 * (r - this.lat0) + this.y0
                        }
                        return t.x = i, t.y = r, t
                    }, inverse: function (t) {
                        var e, i, r, n, a = 1 / this.a * (t.x - this.x0), o = 1 / this.a * (t.y - this.y0);
                        if (this.es) if (i = Ge(e = this.ml0 + o / this.k0, this.es, this.en), Math.abs(i) < C) {
                            var s = Math.sin(i), l = Math.cos(i), u = Math.abs(l) > 1e-10 ? Math.tan(i) : 0,
                                h = this.ep2 * Math.pow(l, 2), c = Math.pow(h, 2), p = Math.pow(u, 2),
                                f = Math.pow(p, 2);
                            e = 1 - this.es * Math.pow(s, 2);
                            var d = a * Math.sqrt(e) / this.k0, m = Math.pow(d, 2);
                            r = i - (e *= u) * m / (1 - this.es) * .5 * (1 - m / 12 * (5 + 3 * p - 9 * h * p + h - 4 * c - m / 30 * (61 + 90 * p - 252 * h * p + 45 * f + 46 * h - m / 56 * (1385 + 3633 * p + 4095 * f + 1574 * f * p)))), n = P(this.long0 + d * (1 - m / 6 * (1 + 2 * p + h - m / 20 * (5 + 28 * p + 24 * f + 8 * h * p + 6 * h - m / 42 * (61 + 662 * p + 1320 * f + 720 * f * p)))) / l)
                        } else r = C * Ht(o), n = 0; else {
                            var y = Math.exp(a / this.k0), g = .5 * (y - 1 / y), _ = Math.cos(this.lat0 + o / this.k0);
                            e = Math.sqrt((1 - Math.pow(_, 2)) / (1 + Math.pow(g, 2))), r = Math.asin(e), o < 0 && (r = -r), n = 0 === g && 0 === _ ? 0 : P(Math.atan2(g, _) + this.long0)
                        }
                        return t.x = n, t.y = r, t
                    }, names: ["Fast_Transverse_Mercator", "Fast Transverse Mercator"]
                };

                function We(t) {
                    var e = Math.exp(t);
                    return (e - 1 / e) / 2
                }

                function Xe(t, e) {
                    t = Math.abs(t), e = Math.abs(e);
                    var i = Math.max(t, e), r = Math.min(t, e) / (i || 1);
                    return i * Math.sqrt(1 + Math.pow(r, 2))
                }

                function He(t, e) {
                    for (var i, r = 2 * Math.cos(2 * e), n = t.length - 1, a = t[n], o = 0; --n >= 0;) i = r * a - o + t[n], o = a, a = i;
                    return e + i * Math.sin(2 * e)
                }

                function Ke(t, e, i) {
                    for (var r, n, a = Math.sin(e), o = Math.cos(e), s = We(i), l = function (t) {
                        var e = Math.exp(t);
                        return (e + 1 / e) / 2
                    }(i), u = 2 * o * l, h = -2 * a * s, c = t.length - 1, p = t[c], f = 0, d = 0, m = 0; --c >= 0;) r = d, n = f, p = u * (d = p) - r - h * (f = m) + t[c], m = h * d - n + u * f;
                    return [(u = a * l) * p - (h = o * s) * m, u * m + h * p]
                }

                var Ye = {
                    init: function () {
                        if (!this.approx && (isNaN(this.es) || this.es <= 0)) throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');
                        this.approx && (Ze.init.apply(this), this.forward = Ze.forward, this.inverse = Ze.inverse), this.x0 = void 0 !== this.x0 ? this.x0 : 0, this.y0 = void 0 !== this.y0 ? this.y0 : 0, this.long0 = void 0 !== this.long0 ? this.long0 : 0, this.lat0 = void 0 !== this.lat0 ? this.lat0 : 0, this.cgb = [], this.cbg = [], this.utg = [], this.gtu = [];
                        var t = this.es / (1 + Math.sqrt(1 - this.es)), e = t / (2 - t), i = e;
                        this.cgb[0] = e * (2 + e * (-2 / 3 + e * (e * (116 / 45 + e * (26 / 45 + e * (-2854 / 675))) - 2))), this.cbg[0] = e * (e * (2 / 3 + e * (4 / 3 + e * (-82 / 45 + e * (32 / 45 + e * (4642 / 4725))))) - 2), this.cgb[1] = (i *= e) * (7 / 3 + e * (e * (-227 / 45 + e * (2704 / 315 + e * (2323 / 945))) - 1.6)), this.cbg[1] = i * (5 / 3 + e * (-16 / 15 + e * (-13 / 9 + e * (904 / 315 + e * (-1522 / 945))))), this.cgb[2] = (i *= e) * (56 / 15 + e * (-136 / 35 + e * (-1262 / 105 + e * (73814 / 2835)))), this.cbg[2] = i * (-26 / 15 + e * (34 / 21 + e * (1.6 + e * (-12686 / 2835)))), this.cgb[3] = (i *= e) * (4279 / 630 + e * (-332 / 35 + e * (-399572 / 14175))), this.cbg[3] = i * (1237 / 630 + e * (e * (-24832 / 14175) - 2.4)), this.cgb[4] = (i *= e) * (4174 / 315 + e * (-144838 / 6237)), this.cbg[4] = i * (-734 / 315 + e * (109598 / 31185)), this.cgb[5] = (i *= e) * (601676 / 22275), this.cbg[5] = i * (444337 / 155925), i = Math.pow(e, 2), this.Qn = this.k0 / (1 + e) * (1 + i * (1 / 4 + i * (1 / 64 + i / 256))), this.utg[0] = e * (e * (2 / 3 + e * (-37 / 96 + e * (1 / 360 + e * (81 / 512 + e * (-96199 / 604800))))) - .5), this.gtu[0] = e * (.5 + e * (-2 / 3 + e * (5 / 16 + e * (41 / 180 + e * (-127 / 288 + e * (7891 / 37800)))))), this.utg[1] = i * (-1 / 48 + e * (-1 / 15 + e * (437 / 1440 + e * (-46 / 105 + e * (1118711 / 3870720))))), this.gtu[1] = i * (13 / 48 + e * (e * (557 / 1440 + e * (281 / 630 + e * (-1983433 / 1935360))) - .6)), this.utg[2] = (i *= e) * (-17 / 480 + e * (37 / 840 + e * (209 / 4480 + e * (-5569 / 90720)))), this.gtu[2] = i * (61 / 240 + e * (-103 / 140 + e * (15061 / 26880 + e * (167603 / 181440)))), this.utg[3] = (i *= e) * (-4397 / 161280 + e * (11 / 504 + e * (830251 / 7257600))), this.gtu[3] = i * (49561 / 161280 + e * (-179 / 168 + e * (6601661 / 7257600))), this.utg[4] = (i *= e) * (-4583 / 161280 + e * (108847 / 3991680)), this.gtu[4] = i * (34729 / 80640 + e * (-3418889 / 1995840)), this.utg[5] = (i *= e) * (-20648693 / 638668800), this.gtu[5] = .6650675310896665 * i;
                        var r = He(this.cbg, this.lat0);
                        this.Zb = -this.Qn * (r + function (t, e) {
                            for (var i, r = 2 * Math.cos(e), n = t.length - 1, a = t[n], o = 0; --n >= 0;) i = r * a - o + t[n], o = a, a = i;
                            return Math.sin(e) * i
                        }(this.gtu, 2 * r))
                    },
                    forward: function (t) {
                        var e = P(t.x - this.long0), i = t.y;
                        i = He(this.cbg, i);
                        var r = Math.sin(i), n = Math.cos(i), a = Math.sin(e), o = Math.cos(e);
                        i = Math.atan2(r, o * n), e = Math.atan2(a * n, Xe(r, n * o)), e = function (t) {
                            var e = Math.abs(t);
                            return e = function (t) {
                                var e = 1 + t, i = e - 1;
                                return 0 === i ? t : t * Math.log(e) / i
                            }(e * (1 + e / (Xe(1, e) + 1))), t < 0 ? -e : e
                        }(Math.tan(e));
                        var s, l, u = Ke(this.gtu, 2 * i, 2 * e);
                        return i += u[0], e += u[1], Math.abs(e) <= 2.623395162778 ? (s = this.a * (this.Qn * e) + this.x0, l = this.a * (this.Qn * i + this.Zb) + this.y0) : (s = 1 / 0, l = 1 / 0), t.x = s, t.y = l, t
                    },
                    inverse: function (t) {
                        var e, i, r = 1 / this.a * (t.x - this.x0), n = 1 / this.a * (t.y - this.y0);
                        if (n = (n - this.Zb) / this.Qn, r /= this.Qn, Math.abs(r) <= 2.623395162778) {
                            var a = Ke(this.utg, 2 * n, 2 * r);
                            n += a[0], r += a[1], r = Math.atan(We(r));
                            var o = Math.sin(n), s = Math.cos(n), l = Math.sin(r), u = Math.cos(r);
                            n = Math.atan2(o * u, Xe(l, u * s)), e = P((r = Math.atan2(l, u * s)) + this.long0), i = He(this.cgb, n)
                        } else e = 1 / 0, i = 1 / 0;
                        return t.x = e, t.y = i, t
                    },
                    names: ["Extended_Transverse_Mercator", "Extended Transverse Mercator", "etmerc", "Transverse_Mercator", "Transverse Mercator", "tmerc"]
                }, Je = {
                    init: function () {
                        var t = function (t, e) {
                            if (void 0 === t) {
                                if ((t = Math.floor(30 * (P(e) + Math.PI) / Math.PI) + 1) < 0) return 0;
                                if (t > 60) return 60
                            }
                            return t
                        }(this.zone, this.long0);
                        if (void 0 === t) throw new Error("unknown utm zone");
                        this.lat0 = 0, this.long0 = (6 * Math.abs(t) - 183) * St, this.x0 = 5e5, this.y0 = this.utmSouth ? 1e7 : 0, this.k0 = .9996, Ye.init.apply(this), this.forward = Ye.forward, this.inverse = Ye.inverse
                    }, names: ["Universal Transverse Mercator System", "utm"], dependsOn: "etmerc"
                };

                function Qe(t, e) {
                    return Math.pow((1 - t) / (1 + t), e)
                }

                var $e = {
                    init: function () {
                        var t = Math.sin(this.lat0), e = Math.cos(this.lat0);
                        e *= e, this.rc = Math.sqrt(1 - this.es) / (1 - this.es * t * t), this.C = Math.sqrt(1 + this.es * e * e / (1 - this.es)), this.phic0 = Math.asin(t / this.C), this.ratexp = .5 * this.C * this.e, this.K = Math.tan(.5 * this.phic0 + M) / (Math.pow(Math.tan(.5 * this.lat0 + M), this.C) * Qe(this.e * t, this.ratexp))
                    }, forward: function (t) {
                        var e = t.x, i = t.y;
                        return t.y = 2 * Math.atan(this.K * Math.pow(Math.tan(.5 * i + M), this.C) * Qe(this.e * Math.sin(i), this.ratexp)) - C, t.x = this.C * e, t
                    }, inverse: function (t) {
                        for (var e = t.x / this.C, i = t.y, r = Math.pow(Math.tan(.5 * i + M) / this.K, 1 / this.C), n = 20; n > 0 && (i = 2 * Math.atan(r * Qe(this.e * Math.sin(t.y), -.5 * this.e)) - C, !(Math.abs(i - t.y) < 1e-14)); --n) t.y = i;
                        return n ? (t.x = e, t.y = i, t) : null
                    }, names: ["gauss"]
                }, ti = {
                    init: function () {
                        $e.init.apply(this), this.rc && (this.sinc0 = Math.sin(this.phic0), this.cosc0 = Math.cos(this.phic0), this.R2 = 2 * this.rc, this.title || (this.title = "Oblique Stereographic Alternative"))
                    },
                    forward: function (t) {
                        var e, i, r, n;
                        return t.x = P(t.x - this.long0), $e.forward.apply(this, [t]), e = Math.sin(t.y), i = Math.cos(t.y), r = Math.cos(t.x), t.x = (n = this.k0 * this.R2 / (1 + this.sinc0 * e + this.cosc0 * i * r)) * i * Math.sin(t.x), t.y = n * (this.cosc0 * e - this.sinc0 * i * r), t.x = this.a * t.x + this.x0, t.y = this.a * t.y + this.y0, t
                    },
                    inverse: function (t) {
                        var e, i, r, n, a;
                        if (t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, t.x /= this.k0, t.y /= this.k0, a = Math.sqrt(t.x * t.x + t.y * t.y)) {
                            var o = 2 * Math.atan2(a, this.R2);
                            e = Math.sin(o), i = Math.cos(o), n = Math.asin(i * this.sinc0 + t.y * e * this.cosc0 / a), r = Math.atan2(t.x * e, a * this.cosc0 * i - t.y * this.sinc0 * e)
                        } else n = this.phic0, r = 0;
                        return t.x = r, t.y = n, $e.inverse.apply(this, [t]), t.x = P(t.x + this.long0), t
                    },
                    names: ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative", "Double_Stereographic"]
                }, ei = {
                    init: function () {
                        this.coslat0 = Math.cos(this.lat0), this.sinlat0 = Math.sin(this.lat0), this.sphere ? 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= 1e-10 && (this.k0 = .5 * (1 + Ht(this.lat0) * Math.sin(this.lat_ts))) : (Math.abs(this.coslat0) <= 1e-10 && (this.con = this.lat0 > 0 ? 1 : -1), this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e)), 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= 1e-10 && (this.k0 = .5 * this.cons * Xt(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / Kt(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts))), this.ms1 = Xt(this.e, this.sinlat0, this.coslat0), this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - C, this.cosX0 = Math.cos(this.X0), this.sinX0 = Math.sin(this.X0))
                    },
                    forward: function (t) {
                        var e, i, r, n, a, o, s = t.x, l = t.y, u = Math.sin(l), h = Math.cos(l), c = P(s - this.long0);
                        return Math.abs(Math.abs(s - this.long0) - Math.PI) <= 1e-10 && Math.abs(l + this.lat0) <= 1e-10 ? (t.x = NaN, t.y = NaN, t) : this.sphere ? (e = 2 * this.k0 / (1 + this.sinlat0 * u + this.coslat0 * h * Math.cos(c)), t.x = this.a * e * h * Math.sin(c) + this.x0, t.y = this.a * e * (this.coslat0 * u - this.sinlat0 * h * Math.cos(c)) + this.y0, t) : (i = 2 * Math.atan(this.ssfn_(l, u, this.e)) - C, n = Math.cos(i), r = Math.sin(i), Math.abs(this.coslat0) <= 1e-10 ? (a = Kt(this.e, l * this.con, this.con * u), t.x = this.x0 + (o = 2 * this.a * this.k0 * a / this.cons) * Math.sin(s - this.long0), t.y = this.y0 - this.con * o * Math.cos(s - this.long0), t) : (Math.abs(this.sinlat0) < 1e-10 ? (e = 2 * this.a * this.k0 / (1 + n * Math.cos(c)), t.y = e * r) : (e = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * r + this.cosX0 * n * Math.cos(c))), t.y = e * (this.cosX0 * r - this.sinX0 * n * Math.cos(c)) + this.y0), t.x = e * n * Math.sin(c) + this.x0, t))
                    },
                    inverse: function (t) {
                        var e, i, r, n;
                        t.x -= this.x0, t.y -= this.y0;
                        var a = Math.sqrt(t.x * t.x + t.y * t.y);
                        if (this.sphere) {
                            var o = 2 * Math.atan(a / (2 * this.a * this.k0));
                            return e = this.long0, i = this.lat0, a <= 1e-10 ? (t.x = e, t.y = i, t) : (i = Math.asin(Math.cos(o) * this.sinlat0 + t.y * Math.sin(o) * this.coslat0 / a), e = Math.abs(this.coslat0) < 1e-10 ? P(this.lat0 > 0 ? this.long0 + Math.atan2(t.x, -1 * t.y) : this.long0 + Math.atan2(t.x, t.y)) : P(this.long0 + Math.atan2(t.x * Math.sin(o), a * this.coslat0 * Math.cos(o) - t.y * this.sinlat0 * Math.sin(o))), t.x = e, t.y = i, t)
                        }
                        if (Math.abs(this.coslat0) <= 1e-10) {
                            if (a <= 1e-10) return i = this.lat0, t.x = e = this.long0, t.y = i, t;
                            t.x *= this.con, t.y *= this.con, i = this.con * Yt(this.e, a * this.cons / (2 * this.a * this.k0)), e = this.con * P(this.con * this.long0 + Math.atan2(t.x, -1 * t.y))
                        } else r = 2 * Math.atan(a * this.cosX0 / (2 * this.a * this.k0 * this.ms1)), e = this.long0, a <= 1e-10 ? n = this.X0 : (n = Math.asin(Math.cos(r) * this.sinX0 + t.y * Math.sin(r) * this.cosX0 / a), e = P(this.long0 + Math.atan2(t.x * Math.sin(r), a * this.cosX0 * Math.cos(r) - t.y * this.sinX0 * Math.sin(r)))), i = -1 * Yt(this.e, Math.tan(.5 * (C + n)));
                        return t.x = e, t.y = i, t
                    },
                    names: ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"],
                    ssfn_: function (t, e, i) {
                        return e *= i, Math.tan(.5 * (C + t)) * Math.pow((1 - e) / (1 + e), .5 * i)
                    }
                }, ii = {
                    init: function () {
                        var t = this.lat0;
                        this.lambda0 = this.long0;
                        var e = Math.sin(t), i = this.a, r = 1 / this.rf, n = 2 * r - Math.pow(r, 2),
                            a = this.e = Math.sqrt(n);
                        this.R = this.k0 * i * Math.sqrt(1 - n) / (1 - n * Math.pow(e, 2)), this.alpha = Math.sqrt(1 + n / (1 - n) * Math.pow(Math.cos(t), 4)), this.b0 = Math.asin(e / this.alpha);
                        var o = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2)),
                            s = Math.log(Math.tan(Math.PI / 4 + t / 2)), l = Math.log((1 + a * e) / (1 - a * e));
                        this.K = o - this.alpha * s + this.alpha * a / 2 * l
                    }, forward: function (t) {
                        var e = Math.log(Math.tan(Math.PI / 4 - t.y / 2)),
                            i = this.e / 2 * Math.log((1 + this.e * Math.sin(t.y)) / (1 - this.e * Math.sin(t.y))),
                            r = 2 * (Math.atan(Math.exp(-this.alpha * (e + i) + this.K)) - Math.PI / 4),
                            n = this.alpha * (t.x - this.lambda0),
                            a = Math.atan(Math.sin(n) / (Math.sin(this.b0) * Math.tan(r) + Math.cos(this.b0) * Math.cos(n))),
                            o = Math.asin(Math.cos(this.b0) * Math.sin(r) - Math.sin(this.b0) * Math.cos(r) * Math.cos(n));
                        return t.y = this.R / 2 * Math.log((1 + Math.sin(o)) / (1 - Math.sin(o))) + this.y0, t.x = this.R * a + this.x0, t
                    }, inverse: function (t) {
                        for (var e = (t.x - this.x0) / this.R, i = 2 * (Math.atan(Math.exp((t.y - this.y0) / this.R)) - Math.PI / 4), r = Math.asin(Math.cos(this.b0) * Math.sin(i) + Math.sin(this.b0) * Math.cos(i) * Math.cos(e)), n = Math.atan(Math.sin(e) / (Math.cos(this.b0) * Math.cos(e) - Math.sin(this.b0) * Math.tan(i))), a = this.lambda0 + n / this.alpha, o = 0, s = r, l = -1e3, u = 0; Math.abs(s - l) > 1e-7;) {
                            if (++u > 20) return;
                            o = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + r / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(s)) / 2)), l = s, s = 2 * Math.atan(Math.exp(o)) - Math.PI / 2
                        }
                        return t.x = a, t.y = s, t
                    }, names: ["somerc"]
                }, ri = {
                    init: function () {
                        var t, e, i, r, n, a, o, s, l, u, h, c, p, f = 0, d = 0, m = 0, y = 0, g = 0, _ = 0, v = 0;
                        this.no_off = (p = "object" == typeof (c = this).PROJECTION ? Object.keys(c.PROJECTION)[0] : c.PROJECTION, "no_uoff" in c || "no_off" in c || -1 !== ["Hotine_Oblique_Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(p)), this.no_rot = "no_rot" in this;
                        var x = !1;
                        "alpha" in this && (x = !0);
                        var b = !1;
                        if ("rectified_grid_angle" in this && (b = !0), x && (v = this.alpha), b && (f = this.rectified_grid_angle * St), x || b) d = this.longc; else if (m = this.long1, g = this.lat1, y = this.long2, _ = this.lat2, Math.abs(g - _) <= 1e-7 || (t = Math.abs(g)) <= 1e-7 || Math.abs(t - C) <= 1e-7 || Math.abs(Math.abs(this.lat0) - C) <= 1e-7 || Math.abs(Math.abs(_) - C) <= 1e-7) throw new Error;
                        var w = 1 - this.es;
                        e = Math.sqrt(w), Math.abs(this.lat0) > 1e-10 ? (s = Math.sin(this.lat0), i = Math.cos(this.lat0), t = 1 - this.es * s * s, this.B = i * i, this.B = Math.sqrt(1 + this.es * this.B * this.B / w), this.A = this.B * this.k0 * e / t, (n = (r = this.B * e / (i * Math.sqrt(t))) * r - 1) <= 0 ? n = 0 : (n = Math.sqrt(n), this.lat0 < 0 && (n = -n)), this.E = n += r, this.E *= Math.pow(Kt(this.e, this.lat0, s), this.B)) : (this.B = 1 / e, this.A = this.k0, this.E = r = n = 1), x || b ? (x ? (h = Math.asin(Math.sin(v) / r), b || (f = v)) : (h = f, v = Math.asin(r * Math.sin(h))), this.lam0 = d - Math.asin(.5 * (n - 1 / n) * Math.tan(h)) / this.B) : (a = Math.pow(Kt(this.e, g, Math.sin(g)), this.B), o = Math.pow(Kt(this.e, _, Math.sin(_)), this.B), n = this.E / a, l = (o - a) / (o + a), u = ((u = this.E * this.E) - o * a) / (u + o * a), (t = m - y) < -Math.pi ? y -= It : t > Math.pi && (y += It), this.lam0 = P(.5 * (m + y) - Math.atan(u * Math.tan(.5 * this.B * (m - y)) / l) / this.B), h = Math.atan(2 * Math.sin(this.B * P(m - this.lam0)) / (n - 1 / n)), f = v = Math.asin(r * Math.sin(h))), this.singam = Math.sin(h), this.cosgam = Math.cos(h), this.sinrot = Math.sin(f), this.cosrot = Math.cos(f), this.rB = 1 / this.B, this.ArB = this.A * this.rB, this.BrA = 1 / this.ArB, this.no_off ? this.u_0 = 0 : (this.u_0 = Math.abs(this.ArB * Math.atan(Math.sqrt(r * r - 1) / Math.cos(v))), this.lat0 < 0 && (this.u_0 = -this.u_0)), n = .5 * h, this.v_pole_n = this.ArB * Math.log(Math.tan(M - n)), this.v_pole_s = this.ArB * Math.log(Math.tan(M + n))
                    },
                    forward: function (t) {
                        var e, i, r, n, a, o, s, l, u = {};
                        if (t.x = t.x - this.lam0, Math.abs(Math.abs(t.y) - C) > 1e-10) {
                            if (e = .5 * ((a = this.E / Math.pow(Kt(this.e, t.y, Math.sin(t.y)), this.B)) - (o = 1 / a)), i = .5 * (a + o), n = Math.sin(this.B * t.x), r = (e * this.singam - n * this.cosgam) / i, Math.abs(Math.abs(r) - 1) < 1e-10) throw new Error;
                            l = .5 * this.ArB * Math.log((1 - r) / (1 + r)), o = Math.cos(this.B * t.x), s = Math.abs(o) < 1e-7 ? this.A * t.x : this.ArB * Math.atan2(e * this.cosgam + n * this.singam, o)
                        } else l = t.y > 0 ? this.v_pole_n : this.v_pole_s, s = this.ArB * t.y;
                        return this.no_rot ? (u.x = s, u.y = l) : (u.x = l * this.cosrot + (s -= this.u_0) * this.sinrot, u.y = s * this.cosrot - l * this.sinrot), u.x = this.a * u.x + this.x0, u.y = this.a * u.y + this.y0, u
                    },
                    inverse: function (t) {
                        var e, i, r, n, a, o, s, l = {};
                        if (t.x = 1 / this.a * (t.x - this.x0), t.y = 1 / this.a * (t.y - this.y0), this.no_rot ? (i = t.y, e = t.x) : (i = t.x * this.cosrot - t.y * this.sinrot, e = t.y * this.cosrot + t.x * this.sinrot + this.u_0), n = .5 * ((r = Math.exp(-this.BrA * i)) - 1 / r), a = .5 * (r + 1 / r), s = ((o = Math.sin(this.BrA * e)) * this.cosgam + n * this.singam) / a, Math.abs(Math.abs(s) - 1) < 1e-10) l.x = 0, l.y = s < 0 ? -C : C; else {
                            if (l.y = this.E / Math.sqrt((1 + s) / (1 - s)), l.y = Yt(this.e, Math.pow(l.y, 1 / this.B)), l.y === 1 / 0) throw new Error;
                            l.x = -this.rB * Math.atan2(n * this.cosgam - o * this.singam, Math.cos(this.BrA * e))
                        }
                        return l.x += this.lam0, l
                    },
                    names: ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Two_Point_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "Oblique_Mercator", "omerc"]
                }, ni = {
                    init: function () {
                        if (this.lat2 || (this.lat2 = this.lat1), this.k0 || (this.k0 = 1), this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, !(Math.abs(this.lat1 + this.lat2) < 1e-10)) {
                            var t = this.b / this.a;
                            this.e = Math.sqrt(1 - t * t);
                            var e = Math.sin(this.lat1), i = Math.cos(this.lat1), r = Xt(this.e, e, i),
                                n = Kt(this.e, this.lat1, e), a = Math.sin(this.lat2), o = Math.cos(this.lat2),
                                s = Xt(this.e, a, o), l = Kt(this.e, this.lat2, a),
                                u = Kt(this.e, this.lat0, Math.sin(this.lat0));
                            this.ns = Math.abs(this.lat1 - this.lat2) > 1e-10 ? Math.log(r / s) / Math.log(n / l) : e, isNaN(this.ns) && (this.ns = e), this.f0 = r / (this.ns * Math.pow(n, this.ns)), this.rh = this.a * this.f0 * Math.pow(u, this.ns), this.title || (this.title = "Lambert Conformal Conic")
                        }
                    },
                    forward: function (t) {
                        var e = t.x, i = t.y;
                        Math.abs(2 * Math.abs(i) - Math.PI) <= 1e-10 && (i = Ht(i) * (C - 2e-10));
                        var r, n, a = Math.abs(Math.abs(i) - C);
                        if (a > 1e-10) r = Kt(this.e, i, Math.sin(i)), n = this.a * this.f0 * Math.pow(r, this.ns); else {
                            if ((a = i * this.ns) <= 0) return null;
                            n = 0
                        }
                        var o = this.ns * P(e - this.long0);
                        return t.x = this.k0 * (n * Math.sin(o)) + this.x0, t.y = this.k0 * (this.rh - n * Math.cos(o)) + this.y0, t
                    },
                    inverse: function (t) {
                        var e, i, r, n, a, o = (t.x - this.x0) / this.k0, s = this.rh - (t.y - this.y0) / this.k0;
                        this.ns > 0 ? (e = Math.sqrt(o * o + s * s), i = 1) : (e = -Math.sqrt(o * o + s * s), i = -1);
                        var l = 0;
                        if (0 !== e && (l = Math.atan2(i * o, i * s)), 0 !== e || this.ns > 0) {
                            if (i = 1 / this.ns, r = Math.pow(e / (this.a * this.f0), i), -9999 === (n = Yt(this.e, r))) return null
                        } else n = -C;
                        return a = P(l / this.ns + this.long0), t.x = a, t.y = n, t
                    },
                    names: ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_1SP", "Lambert_Conformal_Conic_2SP", "lcc", "Lambert Conic Conformal (1SP)", "Lambert Conic Conformal (2SP)"]
                }, ai = {
                    init: function () {
                        this.a = 6377397.155, this.es = .006674372230614, this.e = Math.sqrt(this.es), this.lat0 || (this.lat0 = .863937979737193), this.long0 || (this.long0 = .4334234309119251), this.k0 || (this.k0 = .9999), this.s45 = .785398163397448, this.s90 = 2 * this.s45, this.fi0 = this.lat0, this.e2 = this.es, this.e = Math.sqrt(this.e2), this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2)), this.uq = 1.04216856380474, this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa), this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2), this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g, this.k1 = this.k0, this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)), this.s0 = 1.37008346281555, this.n = Math.sin(this.s0), this.ro0 = this.k1 * this.n0 / Math.tan(this.s0), this.ad = this.s90 - this.uq
                    }, forward: function (t) {
                        var e, i, r, n, a, o, s, l = t.y, u = P(t.x - this.long0);
                        return e = Math.pow((1 + this.e * Math.sin(l)) / (1 - this.e * Math.sin(l)), this.alfa * this.e / 2), i = 2 * (Math.atan(this.k * Math.pow(Math.tan(l / 2 + this.s45), this.alfa) / e) - this.s45), r = -u * this.alfa, n = Math.asin(Math.cos(this.ad) * Math.sin(i) + Math.sin(this.ad) * Math.cos(i) * Math.cos(r)), a = Math.asin(Math.cos(i) * Math.sin(r) / Math.cos(n)), o = this.n * a, s = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(n / 2 + this.s45), this.n), t.y = s * Math.cos(o) / 1, t.x = s * Math.sin(o) / 1, this.czech || (t.y *= -1, t.x *= -1), t
                    }, inverse: function (t) {
                        var e, i, r, n, a, o, s, l = t.x;
                        t.x = t.y, t.y = l, this.czech || (t.y *= -1, t.x *= -1), a = Math.sqrt(t.x * t.x + t.y * t.y), n = Math.atan2(t.y, t.x) / Math.sin(this.s0), r = 2 * (Math.atan(Math.pow(this.ro0 / a, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45), e = Math.asin(Math.cos(this.ad) * Math.sin(r) - Math.sin(this.ad) * Math.cos(r) * Math.cos(n)), i = Math.asin(Math.cos(r) * Math.sin(n) / Math.cos(e)), t.x = this.long0 - i / this.alfa, o = e, s = 0;
                        var u = 0;
                        do {
                            t.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(e / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(o)) / (1 - this.e * Math.sin(o)), this.e / 2)) - this.s45), Math.abs(o - t.y) < 1e-10 && (s = 1), o = t.y, u += 1
                        } while (0 === s && u < 15);
                        return u >= 15 ? null : t
                    }, names: ["Krovak", "krovak"]
                };

                function oi(t, e, i, r, n) {
                    return t * n - e * Math.sin(2 * n) + i * Math.sin(4 * n) - r * Math.sin(6 * n)
                }

                function si(t) {
                    return 1 - .25 * t * (1 + t / 16 * (3 + 1.25 * t))
                }

                function li(t) {
                    return .375 * t * (1 + .25 * t * (1 + .46875 * t))
                }

                function ui(t) {
                    return .05859375 * t * t * (1 + .75 * t)
                }

                function hi(t) {
                    return t * t * t * (35 / 3072)
                }

                function ci(t, e, i) {
                    var r = e * i;
                    return t / Math.sqrt(1 - r * r)
                }

                function pi(t) {
                    return Math.abs(t) < C ? t : t - Ht(t) * Math.PI
                }

                function fi(t, e, i, r, n) {
                    var a, o;
                    a = t / e;
                    for (var s = 0; s < 15; s++) if (a += o = (t - (e * a - i * Math.sin(2 * a) + r * Math.sin(4 * a) - n * Math.sin(6 * a))) / (e - 2 * i * Math.cos(2 * a) + 4 * r * Math.cos(4 * a) - 6 * n * Math.cos(6 * a)), Math.abs(o) <= 1e-10) return a;
                    return NaN
                }

                var di = {
                    init: function () {
                        this.sphere || (this.e0 = si(this.es), this.e1 = li(this.es), this.e2 = ui(this.es), this.e3 = hi(this.es), this.ml0 = this.a * oi(this.e0, this.e1, this.e2, this.e3, this.lat0))
                    }, forward: function (t) {
                        var e, i, r = t.x, n = t.y;
                        if (r = P(r - this.long0), this.sphere) e = this.a * Math.asin(Math.cos(n) * Math.sin(r)), i = this.a * (Math.atan2(Math.tan(n), Math.cos(r)) - this.lat0); else {
                            var a = Math.sin(n), o = Math.cos(n), s = ci(this.a, this.e, a),
                                l = Math.tan(n) * Math.tan(n), u = r * Math.cos(n), h = u * u,
                                c = this.es * o * o / (1 - this.es);
                            e = s * u * (1 - h * l * (1 / 6 - (8 - l + 8 * c) * h / 120)), i = this.a * oi(this.e0, this.e1, this.e2, this.e3, n) - this.ml0 + s * a / o * h * (.5 + (5 - l + 6 * c) * h / 24)
                        }
                        return t.x = e + this.x0, t.y = i + this.y0, t
                    }, inverse: function (t) {
                        t.x -= this.x0, t.y -= this.y0;
                        var e, i, r = t.x / this.a, n = t.y / this.a;
                        if (this.sphere) {
                            var a = n + this.lat0;
                            e = Math.asin(Math.sin(a) * Math.cos(r)), i = Math.atan2(Math.tan(r), Math.cos(a))
                        } else {
                            var o = fi(this.ml0 / this.a + n, this.e0, this.e1, this.e2, this.e3);
                            if (Math.abs(Math.abs(o) - C) <= 1e-10) return t.x = this.long0, t.y = C, n < 0 && (t.y *= -1), t;
                            var s = ci(this.a, this.e, Math.sin(o)), l = s * s * s / this.a / this.a * (1 - this.es),
                                u = Math.pow(Math.tan(o), 2), h = r * this.a / s, c = h * h;
                            e = o - s * Math.tan(o) / l * h * h * (.5 - (1 + 3 * u) * h * h / 24), i = h * (1 - c * (u / 3 + (1 + 3 * u) * u * c / 15)) / Math.cos(o)
                        }
                        return t.x = P(i + this.long0), t.y = pi(e), t
                    }, names: ["Cassini", "Cassini_Soldner", "cass"]
                };

                function mi(t, e) {
                    var i;
                    return t > 1e-7 ? (1 - t * t) * (e / (1 - (i = t * e) * i) - .5 / t * Math.log((1 - i) / (1 + i))) : 2 * e
                }

                var yi = {
                    init: function () {
                        var t, e = Math.abs(this.lat0);
                        if (this.mode = Math.abs(e - C) < 1e-10 ? this.lat0 < 0 ? this.S_POLE : this.N_POLE : Math.abs(e) < 1e-10 ? this.EQUIT : this.OBLIQ, this.es > 0) switch (this.qp = mi(this.e, 1), this.mmf = .5 / (1 - this.es), this.apa = function (t) {
                            var e, i = [];
                            return i[0] = .3333333333333333 * t, i[0] += .17222222222222222 * (e = t * t), i[1] = .06388888888888888 * e, i[0] += .10257936507936508 * (e *= t), i[1] += .0664021164021164 * e, i[2] = .016415012942191543 * e, i
                        }(this.es), this.mode) {
                            case this.N_POLE:
                            case this.S_POLE:
                                this.dd = 1;
                                break;
                            case this.EQUIT:
                                this.rq = Math.sqrt(.5 * this.qp), this.dd = 1 / this.rq, this.xmf = 1, this.ymf = .5 * this.qp;
                                break;
                            case this.OBLIQ:
                                this.rq = Math.sqrt(.5 * this.qp), t = Math.sin(this.lat0), this.sinb1 = mi(this.e, t) / this.qp, this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1), this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * t * t) * this.rq * this.cosb1), this.ymf = (this.xmf = this.rq) / this.dd, this.xmf *= this.dd
                        } else this.mode === this.OBLIQ && (this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0))
                    },
                    forward: function (t) {
                        var e, i, r, n, a, o, s, l, u, h, c = t.x, p = t.y;
                        if (c = P(c - this.long0), this.sphere) {
                            if (a = Math.sin(p), h = Math.cos(p), r = Math.cos(c), this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                                if ((i = this.mode === this.EQUIT ? 1 + h * r : 1 + this.sinph0 * a + this.cosph0 * h * r) <= 1e-10) return null;
                                e = (i = Math.sqrt(2 / i)) * h * Math.sin(c), i *= this.mode === this.EQUIT ? a : this.cosph0 * a - this.sinph0 * h * r
                            } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                                if (this.mode === this.N_POLE && (r = -r), Math.abs(p + this.lat0) < 1e-10) return null;
                                i = M - .5 * p, e = (i = 2 * (this.mode === this.S_POLE ? Math.cos(i) : Math.sin(i))) * Math.sin(c), i *= r
                            }
                        } else {
                            switch (s = 0, l = 0, u = 0, r = Math.cos(c), n = Math.sin(c), a = Math.sin(p), o = mi(this.e, a), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (s = o / this.qp, l = Math.sqrt(1 - s * s)), this.mode) {
                                case this.OBLIQ:
                                    u = 1 + this.sinb1 * s + this.cosb1 * l * r;
                                    break;
                                case this.EQUIT:
                                    u = 1 + l * r;
                                    break;
                                case this.N_POLE:
                                    u = C + p, o = this.qp - o;
                                    break;
                                case this.S_POLE:
                                    u = p - C, o = this.qp + o
                            }
                            if (Math.abs(u) < 1e-10) return null;
                            switch (this.mode) {
                                case this.OBLIQ:
                                case this.EQUIT:
                                    u = Math.sqrt(2 / u), i = this.mode === this.OBLIQ ? this.ymf * u * (this.cosb1 * s - this.sinb1 * l * r) : (u = Math.sqrt(2 / (1 + l * r))) * s * this.ymf, e = this.xmf * u * l * n;
                                    break;
                                case this.N_POLE:
                                case this.S_POLE:
                                    o >= 0 ? (e = (u = Math.sqrt(o)) * n, i = r * (this.mode === this.S_POLE ? u : -u)) : e = i = 0
                            }
                        }
                        return t.x = this.a * e + this.x0, t.y = this.a * i + this.y0, t
                    },
                    inverse: function (t) {
                        t.x -= this.x0, t.y -= this.y0;
                        var e, i, r, n, a, o, s, l, u, h, c = t.x / this.a, p = t.y / this.a;
                        if (this.sphere) {
                            var f, d = 0, m = 0;
                            if ((i = .5 * (f = Math.sqrt(c * c + p * p))) > 1) return null;
                            switch (i = 2 * Math.asin(i), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (m = Math.sin(i), d = Math.cos(i)), this.mode) {
                                case this.EQUIT:
                                    i = Math.abs(f) <= 1e-10 ? 0 : Math.asin(p * m / f), c *= m, p = d * f;
                                    break;
                                case this.OBLIQ:
                                    i = Math.abs(f) <= 1e-10 ? this.lat0 : Math.asin(d * this.sinph0 + p * m * this.cosph0 / f), c *= m * this.cosph0, p = (d - Math.sin(i) * this.sinph0) * f;
                                    break;
                                case this.N_POLE:
                                    p = -p, i = C - i;
                                    break;
                                case this.S_POLE:
                                    i -= C
                            }
                            e = 0 !== p || this.mode !== this.EQUIT && this.mode !== this.OBLIQ ? Math.atan2(c, p) : 0
                        } else {
                            if (s = 0, this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                                if (c /= this.dd, p *= this.dd, (o = Math.sqrt(c * c + p * p)) < 1e-10) return t.x = this.long0, t.y = this.lat0, t;
                                n = 2 * Math.asin(.5 * o / this.rq), r = Math.cos(n), c *= n = Math.sin(n), this.mode === this.OBLIQ ? (a = this.qp * (s = r * this.sinb1 + p * n * this.cosb1 / o), p = o * this.cosb1 * r - p * this.sinb1 * n) : (a = this.qp * (s = p * n / o), p = o * r)
                            } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                                if (this.mode === this.N_POLE && (p = -p), !(a = c * c + p * p)) return t.x = this.long0, t.y = this.lat0, t;
                                s = 1 - a / this.qp, this.mode === this.S_POLE && (s = -s)
                            }
                            e = Math.atan2(c, p), h = (l = Math.asin(s)) + l, i = l + (u = this.apa)[0] * Math.sin(h) + u[1] * Math.sin(h + h) + u[2] * Math.sin(h + h + h)
                        }
                        return t.x = P(this.long0 + e), t.y = i, t
                    },
                    names: ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"],
                    S_POLE: 1,
                    N_POLE: 2,
                    EQUIT: 3,
                    OBLIQ: 4
                };

                function gi(t) {
                    return Math.abs(t) > 1 && (t = t > 1 ? 1 : -1), Math.asin(t)
                }

                var _i = {
                    init: function () {
                        Math.abs(this.lat1 + this.lat2) < 1e-10 || (this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e3 = Math.sqrt(this.es), this.sin_po = Math.sin(this.lat1), this.cos_po = Math.cos(this.lat1), this.t1 = this.sin_po, this.con = this.sin_po, this.ms1 = Xt(this.e3, this.sin_po, this.cos_po), this.qs1 = mi(this.e3, this.sin_po), this.sin_po = Math.sin(this.lat2), this.cos_po = Math.cos(this.lat2), this.t2 = this.sin_po, this.ms2 = Xt(this.e3, this.sin_po, this.cos_po), this.qs2 = mi(this.e3, this.sin_po), this.sin_po = Math.sin(this.lat0), this.cos_po = Math.cos(this.lat0), this.t3 = this.sin_po, this.qs0 = mi(this.e3, this.sin_po), this.ns0 = Math.abs(this.lat1 - this.lat2) > 1e-10 ? (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1) : this.con, this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1, this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0)
                    }, forward: function (t) {
                        var e = t.x, i = t.y;
                        this.sin_phi = Math.sin(i), this.cos_phi = Math.cos(i);
                        var r = mi(this.e3, this.sin_phi), n = this.a * Math.sqrt(this.c - this.ns0 * r) / this.ns0,
                            a = this.ns0 * P(e - this.long0), o = n * Math.sin(a) + this.x0,
                            s = this.rh - n * Math.cos(a) + this.y0;
                        return t.x = o, t.y = s, t
                    }, inverse: function (t) {
                        var e, i, r, n, a;
                        return t.x -= this.x0, t.y = this.rh - t.y + this.y0, this.ns0 >= 0 ? (e = Math.sqrt(t.x * t.x + t.y * t.y), i = 1) : (e = -Math.sqrt(t.x * t.x + t.y * t.y), i = -1), r = 0, 0 !== e && (r = Math.atan2(i * t.x, i * t.y)), i = e * this.ns0 / this.a, a = this.sphere ? Math.asin((this.c - i * i) / (2 * this.ns0)) : this.phi1z(this.e3, (this.c - i * i) / this.ns0), n = P(r / this.ns0 + this.long0), t.x = n, t.y = a, t
                    }, names: ["Albers_Conic_Equal_Area", "Albers", "aea"], phi1z: function (t, e) {
                        var i, r, n, a, o = gi(.5 * e);
                        if (t < 1e-10) return o;
                        for (var s = t * t, l = 1; l <= 25; l++) if (o += a = .5 * (n = 1 - (r = t * (i = Math.sin(o))) * r) * n / Math.cos(o) * (e / (1 - s) - i / n + .5 / t * Math.log((1 - r) / (1 + r))), Math.abs(a) <= 1e-7) return o;
                        return null
                    }
                }, vi = {
                    init: function () {
                        this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0), this.infinity_dist = 1e3 * this.a, this.rc = 1
                    }, forward: function (t) {
                        var e, i, r, n, a, o, s, l = t.y;
                        return r = P(t.x - this.long0), e = Math.sin(l), i = Math.cos(l), n = Math.cos(r), (a = this.sin_p14 * e + this.cos_p14 * i * n) > 0 || Math.abs(a) <= 1e-10 ? (o = this.x0 + 1 * this.a * i * Math.sin(r) / a, s = this.y0 + 1 * this.a * (this.cos_p14 * e - this.sin_p14 * i * n) / a) : (o = this.x0 + this.infinity_dist * i * Math.sin(r), s = this.y0 + this.infinity_dist * (this.cos_p14 * e - this.sin_p14 * i * n)), t.x = o, t.y = s, t
                    }, inverse: function (t) {
                        var e, i, r, n, a, o;
                        return t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, t.x /= this.k0, t.y /= this.k0, (e = Math.sqrt(t.x * t.x + t.y * t.y)) ? (n = Math.atan2(e, this.rc), i = Math.sin(n), o = gi((r = Math.cos(n)) * this.sin_p14 + t.y * i * this.cos_p14 / e), a = Math.atan2(t.x * i, e * this.cos_p14 * r - t.y * this.sin_p14 * i), a = P(this.long0 + a)) : (o = this.phic0, a = 0), t.x = a, t.y = o, t
                    }, names: ["gnom"]
                }, xi = {
                    init: function () {
                        this.sphere || (this.k0 = Xt(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)))
                    }, forward: function (t) {
                        var e, i, r = t.y, n = P(t.x - this.long0);
                        if (this.sphere) e = this.x0 + this.a * n * Math.cos(this.lat_ts), i = this.y0 + this.a * Math.sin(r) / Math.cos(this.lat_ts); else {
                            var a = mi(this.e, Math.sin(r));
                            e = this.x0 + this.a * this.k0 * n, i = this.y0 + this.a * a * .5 / this.k0
                        }
                        return t.x = e, t.y = i, t
                    }, inverse: function (t) {
                        var e, i;
                        return t.x -= this.x0, t.y -= this.y0, this.sphere ? (e = P(this.long0 + t.x / this.a / Math.cos(this.lat_ts)), i = Math.asin(t.y / this.a * Math.cos(this.lat_ts))) : (i = function (t, e) {
                            var i = 1 - (1 - t * t) / (2 * t) * Math.log((1 - t) / (1 + t));
                            if (Math.abs(Math.abs(e) - i) < 1e-6) return e < 0 ? -1 * C : C;
                            for (var r, n, a, o, s = Math.asin(.5 * e), l = 0; l < 30; l++) if (n = Math.sin(s), a = Math.cos(s), o = t * n, s += r = Math.pow(1 - o * o, 2) / (2 * a) * (e / (1 - t * t) - n / (1 - o * o) + .5 / t * Math.log((1 - o) / (1 + o))), Math.abs(r) <= 1e-10) return s;
                            return NaN
                        }(this.e, 2 * t.y * this.k0 / this.a), e = P(this.long0 + t.x / (this.a * this.k0))), t.x = e, t.y = i, t
                    }, names: ["cea"]
                }, bi = {
                    init: function () {
                        this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Equidistant Cylindrical (Plate Carre)", this.rc = Math.cos(this.lat_ts)
                    }, forward: function (t) {
                        var e = t.y, i = P(t.x - this.long0), r = pi(e - this.lat0);
                        return t.x = this.x0 + this.a * i * this.rc, t.y = this.y0 + this.a * r, t
                    }, inverse: function (t) {
                        var e = t.y;
                        return t.x = P(this.long0 + (t.x - this.x0) / (this.a * this.rc)), t.y = pi(this.lat0 + (e - this.y0) / this.a), t
                    }, names: ["Equirectangular", "Equidistant_Cylindrical", "eqc"]
                }, wi = {
                    init: function () {
                        this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = si(this.es), this.e1 = li(this.es), this.e2 = ui(this.es), this.e3 = hi(this.es), this.ml0 = this.a * oi(this.e0, this.e1, this.e2, this.e3, this.lat0)
                    }, forward: function (t) {
                        var e, i, r, n = t.y, a = P(t.x - this.long0);
                        if (r = a * Math.sin(n), this.sphere) Math.abs(n) <= 1e-10 ? (e = this.a * a, i = -1 * this.a * this.lat0) : (e = this.a * Math.sin(r) / Math.tan(n), i = this.a * (pi(n - this.lat0) + (1 - Math.cos(r)) / Math.tan(n))); else if (Math.abs(n) <= 1e-10) e = this.a * a, i = -1 * this.ml0; else {
                            var o = ci(this.a, this.e, Math.sin(n)) / Math.tan(n);
                            e = o * Math.sin(r), i = this.a * oi(this.e0, this.e1, this.e2, this.e3, n) - this.ml0 + o * (1 - Math.cos(r))
                        }
                        return t.x = e + this.x0, t.y = i + this.y0, t
                    }, inverse: function (t) {
                        var e, i, r, n, a, o, s, l, u;
                        if (r = t.x - this.x0, n = t.y - this.y0, this.sphere) if (Math.abs(n + this.a * this.lat0) <= 1e-10) e = P(r / this.a + this.long0), i = 0; else {
                            var h;
                            for (s = r * r / this.a / this.a + (o = this.lat0 + n / this.a) * o, l = o, a = 20; a; --a) if (l += u = -1 * (o * (l * (h = Math.tan(l)) + 1) - l - .5 * (l * l + s) * h) / ((l - o) / h - 1), Math.abs(u) <= 1e-10) {
                                i = l;
                                break
                            }
                            e = P(this.long0 + Math.asin(r * Math.tan(l) / this.a) / Math.sin(i))
                        } else if (Math.abs(n + this.ml0) <= 1e-10) i = 0, e = P(this.long0 + r / this.a); else {
                            var c, p, f, d, m;
                            for (s = r * r / this.a / this.a + (o = (this.ml0 + n) / this.a) * o, l = o, a = 20; a; --a) if (m = this.e * Math.sin(l), c = Math.sqrt(1 - m * m) * Math.tan(l), p = this.a * oi(this.e0, this.e1, this.e2, this.e3, l), f = this.e0 - 2 * this.e1 * Math.cos(2 * l) + 4 * this.e2 * Math.cos(4 * l) - 6 * this.e3 * Math.cos(6 * l), l -= u = (o * (c * (d = p / this.a) + 1) - d - .5 * c * (d * d + s)) / (this.es * Math.sin(2 * l) * (d * d + s - 2 * o * d) / (4 * c) + (o - d) * (c * f - 2 / Math.sin(2 * l)) - f), Math.abs(u) <= 1e-10) {
                                i = l;
                                break
                            }
                            c = Math.sqrt(1 - this.es * Math.pow(Math.sin(i), 2)) * Math.tan(i), e = P(this.long0 + Math.asin(r * c / this.a) / Math.sin(i))
                        }
                        return t.x = e, t.y = i, t
                    }, names: ["Polyconic", "poly"]
                }, Mi = {
                    init: function () {
                        this.A = [], this.A[1] = .6399175073, this.A[2] = -.1358797613, this.A[3] = .063294409, this.A[4] = -.02526853, this.A[5] = .0117879, this.A[6] = -.0055161, this.A[7] = .0026906, this.A[8] = -.001333, this.A[9] = 67e-5, this.A[10] = -34e-5, this.B_re = [], this.B_im = [], this.B_re[1] = .7557853228, this.B_im[1] = 0, this.B_re[2] = .249204646, this.B_im[2] = .003371507, this.B_re[3] = -.001541739, this.B_im[3] = .04105856, this.B_re[4] = -.10162907, this.B_im[4] = .01727609, this.B_re[5] = -.26623489, this.B_im[5] = -.36249218, this.B_re[6] = -.6870983, this.B_im[6] = -1.1651967, this.C_re = [], this.C_im = [], this.C_re[1] = 1.3231270439, this.C_im[1] = 0, this.C_re[2] = -.577245789, this.C_im[2] = -.007809598, this.C_re[3] = .508307513, this.C_im[3] = -.112208952, this.C_re[4] = -.15094762, this.C_im[4] = .18200602, this.C_re[5] = 1.01418179, this.C_im[5] = 1.64497696, this.C_re[6] = 1.9660549, this.C_im[6] = 2.5127645, this.D = [], this.D[1] = 1.5627014243, this.D[2] = .5185406398, this.D[3] = -.03333098, this.D[4] = -.1052906, this.D[5] = -.0368594, this.D[6] = .007317, this.D[7] = .0122, this.D[8] = .00394, this.D[9] = -.0013
                    }, forward: function (t) {
                        var e, i = (t.y - this.lat0) / Mt * 1e-5, r = t.x - this.long0, n = 1, a = 0;
                        for (e = 1; e <= 10; e++) a += this.A[e] * (n *= i);
                        var o, s = a, l = r, u = 1, h = 0, c = 0, p = 0;
                        for (e = 1; e <= 6; e++) o = h * s + u * l, c = c + this.B_re[e] * (u = u * s - h * l) - this.B_im[e] * (h = o), p = p + this.B_im[e] * u + this.B_re[e] * h;
                        return t.x = p * this.a + this.x0, t.y = c * this.a + this.y0, t
                    }, inverse: function (t) {
                        var e, i, r = (t.y - this.y0) / this.a, n = (t.x - this.x0) / this.a, a = 1, o = 0, s = 0,
                            l = 0;
                        for (e = 1; e <= 6; e++) i = o * r + a * n, s = s + this.C_re[e] * (a = a * r - o * n) - this.C_im[e] * (o = i), l = l + this.C_im[e] * a + this.C_re[e] * o;
                        for (var u = 0; u < this.iterations; u++) {
                            var h, c = s, p = l, f = r, d = n;
                            for (e = 2; e <= 6; e++) h = p * s + c * l, f += (e - 1) * (this.B_re[e] * (c = c * s - p * l) - this.B_im[e] * (p = h)), d += (e - 1) * (this.B_im[e] * c + this.B_re[e] * p);
                            c = 1, p = 0;
                            var m = this.B_re[1], y = this.B_im[1];
                            for (e = 2; e <= 6; e++) h = p * s + c * l, m += e * (this.B_re[e] * (c = c * s - p * l) - this.B_im[e] * (p = h)), y += e * (this.B_im[e] * c + this.B_re[e] * p);
                            var g = m * m + y * y;
                            s = (f * m + d * y) / g, l = (d * m - f * y) / g
                        }
                        var _ = s, v = l, x = 1, b = 0;
                        for (e = 1; e <= 9; e++) b += this.D[e] * (x *= _);
                        var w = this.lat0 + b * Mt * 1e5;
                        return t.x = this.long0 + v, t.y = w, t
                    }, names: ["New_Zealand_Map_Grid", "nzmg"]
                }, Si = {
                    init: function () {
                    }, forward: function (t) {
                        var e = t.y, i = P(t.x - this.long0), r = this.x0 + this.a * i,
                            n = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + e / 2.5)) * 1.25;
                        return t.x = r, t.y = n, t
                    }, inverse: function (t) {
                        t.x -= this.x0, t.y -= this.y0;
                        var e = P(this.long0 + t.x / this.a),
                            i = 2.5 * (Math.atan(Math.exp(.8 * t.y / this.a)) - Math.PI / 4);
                        return t.x = e, t.y = i, t
                    }, names: ["Miller_Cylindrical", "mill"]
                }, Ei = {
                    init: function () {
                        this.sphere ? (this.n = 1, this.m = 0, this.es = 0, this.C_y = Math.sqrt((this.m + 1) / this.n), this.C_x = this.C_y / (this.m + 1)) : this.en = je(this.es)
                    }, forward: function (t) {
                        var e, i, r = t.x, n = t.y;
                        if (r = P(r - this.long0), this.sphere) {
                            if (this.m) for (var a = this.n * Math.sin(n), o = 20; o; --o) {
                                var s = (this.m * n + Math.sin(n) - a) / (this.m + Math.cos(n));
                                if (n -= s, Math.abs(s) < 1e-10) break
                            } else n = 1 !== this.n ? Math.asin(this.n * Math.sin(n)) : n;
                            e = this.a * this.C_x * r * (this.m + Math.cos(n)), i = this.a * this.C_y * n
                        } else {
                            var l = Math.sin(n), u = Math.cos(n);
                            i = this.a * qe(n, l, u, this.en), e = this.a * r * u / Math.sqrt(1 - this.es * l * l)
                        }
                        return t.x = e, t.y = i, t
                    }, inverse: function (t) {
                        var e, i, r;
                        return t.x -= this.x0, i = t.x / this.a, t.y -= this.y0, e = t.y / this.a, this.sphere ? (e /= this.C_y, i /= this.C_x * (this.m + Math.cos(e)), this.m ? e = gi((this.m * e + Math.sin(e)) / this.n) : 1 !== this.n && (e = gi(Math.sin(e) / this.n)), i = P(i + this.long0), e = pi(e)) : (e = Ge(t.y / this.a, this.es, this.en), (r = Math.abs(e)) < C ? (r = Math.sin(e), i = P(this.long0 + t.x * Math.sqrt(1 - this.es * r * r) / (this.a * Math.cos(e)))) : r - 1e-10 < C && (i = this.long0)), t.x = i, t.y = e, t
                    }, names: ["Sinusoidal", "sinu"]
                }, Ii = {
                    init: function () {
                    }, forward: function (t) {
                        for (var e = t.y, i = P(t.x - this.long0), r = e, n = Math.PI * Math.sin(e); ;) {
                            var a = -(r + Math.sin(r) - n) / (1 + Math.cos(r));
                            if (r += a, Math.abs(a) < 1e-10) break
                        }
                        r /= 2, Math.PI / 2 - Math.abs(e) < 1e-10 && (i = 0);
                        var o = .900316316158 * this.a * i * Math.cos(r) + this.x0,
                            s = 1.4142135623731 * this.a * Math.sin(r) + this.y0;
                        return t.x = o, t.y = s, t
                    }, inverse: function (t) {
                        var e, i;
                        t.x -= this.x0, t.y -= this.y0, i = t.y / (1.4142135623731 * this.a), Math.abs(i) > .999999999999 && (i = .999999999999), e = Math.asin(i);
                        var r = P(this.long0 + t.x / (.900316316158 * this.a * Math.cos(e)));
                        r < -Math.PI && (r = -Math.PI), r > Math.PI && (r = Math.PI), i = (2 * e + Math.sin(2 * e)) / Math.PI, Math.abs(i) > 1 && (i = 1);
                        var n = Math.asin(i);
                        return t.x = r, t.y = n, t
                    }, names: ["Mollweide", "moll"]
                }, Ti = {
                    init: function () {
                        Math.abs(this.lat1 + this.lat2) < 1e-10 || (this.lat2 = this.lat2 || this.lat1, this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = si(this.es), this.e1 = li(this.es), this.e2 = ui(this.es), this.e3 = hi(this.es), this.sinphi = Math.sin(this.lat1), this.cosphi = Math.cos(this.lat1), this.ms1 = Xt(this.e, this.sinphi, this.cosphi), this.ml1 = oi(this.e0, this.e1, this.e2, this.e3, this.lat1), Math.abs(this.lat1 - this.lat2) < 1e-10 ? this.ns = this.sinphi : (this.sinphi = Math.sin(this.lat2), this.cosphi = Math.cos(this.lat2), this.ms2 = Xt(this.e, this.sinphi, this.cosphi), this.ml2 = oi(this.e0, this.e1, this.e2, this.e3, this.lat2), this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1)), this.g = this.ml1 + this.ms1 / this.ns, this.ml0 = oi(this.e0, this.e1, this.e2, this.e3, this.lat0), this.rh = this.a * (this.g - this.ml0))
                    }, forward: function (t) {
                        var e, i = t.x, r = t.y;
                        if (this.sphere) e = this.a * (this.g - r); else {
                            var n = oi(this.e0, this.e1, this.e2, this.e3, r);
                            e = this.a * (this.g - n)
                        }
                        var a = this.ns * P(i - this.long0), o = this.x0 + e * Math.sin(a),
                            s = this.y0 + this.rh - e * Math.cos(a);
                        return t.x = o, t.y = s, t
                    }, inverse: function (t) {
                        var e, i, r, n;
                        t.x -= this.x0, t.y = this.rh - t.y + this.y0, this.ns >= 0 ? (i = Math.sqrt(t.x * t.x + t.y * t.y), e = 1) : (i = -Math.sqrt(t.x * t.x + t.y * t.y), e = -1);
                        var a = 0;
                        return 0 !== i && (a = Math.atan2(e * t.x, e * t.y)), this.sphere ? (n = P(this.long0 + a / this.ns), r = pi(this.g - i / this.a), t.x = n, t.y = r, t) : (r = fi(this.g - i / this.a, this.e0, this.e1, this.e2, this.e3), n = P(this.long0 + a / this.ns), t.x = n, t.y = r, t)
                    }, names: ["Equidistant_Conic", "eqdc"]
                }, Ci = {
                    init: function () {
                        this.R = this.a
                    }, forward: function (t) {
                        var e, i, r = t.y, n = P(t.x - this.long0);
                        Math.abs(r) <= 1e-10 && (e = this.x0 + this.R * n, i = this.y0);
                        var a = gi(2 * Math.abs(r / Math.PI));
                        (Math.abs(n) <= 1e-10 || Math.abs(Math.abs(r) - C) <= 1e-10) && (e = this.x0, i = r >= 0 ? this.y0 + Math.PI * this.R * Math.tan(.5 * a) : this.y0 + Math.PI * this.R * -Math.tan(.5 * a));
                        var o = .5 * Math.abs(Math.PI / n - n / Math.PI), s = o * o, l = Math.sin(a), u = Math.cos(a),
                            h = u / (l + u - 1), c = h * (2 / l - 1), p = c * c,
                            f = Math.PI * this.R * (o * (h - p) + Math.sqrt(s * (h - p) * (h - p) - (p + s) * (h * h - p))) / (p + s);
                        n < 0 && (f = -f), e = this.x0 + f;
                        var d = s + h;
                        return f = Math.PI * this.R * (c * d - o * Math.sqrt((p + s) * (s + 1) - d * d)) / (p + s), i = r >= 0 ? this.y0 + f : this.y0 - f, t.x = e, t.y = i, t
                    }, inverse: function (t) {
                        var e, i, r, n, a, o, s, l, u, h, c, p;
                        return t.x -= this.x0, t.y -= this.y0, c = Math.PI * this.R, a = (r = t.x / c) * r + (n = t.y / c) * n, c = 3 * (n * n / (l = -2 * (o = -Math.abs(n) * (1 + a)) + 1 + 2 * n * n + a * a) + (2 * (s = o - 2 * n * n + r * r) * s * s / l / l / l - 9 * o * s / l / l) / 27) / (u = (o - s * s / 3 / l) / l) / (h = 2 * Math.sqrt(-u / 3)), Math.abs(c) > 1 && (c = c >= 0 ? 1 : -1), p = Math.acos(c) / 3, i = t.y >= 0 ? (-h * Math.cos(p + Math.PI / 3) - s / 3 / l) * Math.PI : -(-h * Math.cos(p + Math.PI / 3) - s / 3 / l) * Math.PI, e = Math.abs(r) < 1e-10 ? this.long0 : P(this.long0 + Math.PI * (a - 1 + Math.sqrt(1 + 2 * (r * r - n * n) + a * a)) / 2 / r), t.x = e, t.y = i, t
                    }, names: ["Van_der_Grinten_I", "VanDerGrinten", "vandg"]
                }, Pi = {
                    init: function () {
                        this.sin_p12 = Math.sin(this.lat0), this.cos_p12 = Math.cos(this.lat0)
                    }, forward: function (t) {
                        var e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v, x, b, w, M = t.x, S = t.y,
                            E = Math.sin(t.y), I = Math.cos(t.y), T = P(M - this.long0);
                        return this.sphere ? Math.abs(this.sin_p12 - 1) <= 1e-10 ? (t.x = this.x0 + this.a * (C - S) * Math.sin(T), t.y = this.y0 - this.a * (C - S) * Math.cos(T), t) : Math.abs(this.sin_p12 + 1) <= 1e-10 ? (t.x = this.x0 + this.a * (C + S) * Math.sin(T), t.y = this.y0 + this.a * (C + S) * Math.cos(T), t) : (_ = this.sin_p12 * E + this.cos_p12 * I * Math.cos(T), g = (y = Math.acos(_)) ? y / Math.sin(y) : 1, t.x = this.x0 + this.a * g * I * Math.sin(T), t.y = this.y0 + this.a * g * (this.cos_p12 * E - this.sin_p12 * I * Math.cos(T)), t) : (e = si(this.es), i = li(this.es), r = ui(this.es), n = hi(this.es), Math.abs(this.sin_p12 - 1) <= 1e-10 ? (a = this.a * oi(e, i, r, n, C), o = this.a * oi(e, i, r, n, S), t.x = this.x0 + (a - o) * Math.sin(T), t.y = this.y0 - (a - o) * Math.cos(T), t) : Math.abs(this.sin_p12 + 1) <= 1e-10 ? (a = this.a * oi(e, i, r, n, C), o = this.a * oi(e, i, r, n, S), t.x = this.x0 + (a + o) * Math.sin(T), t.y = this.y0 + (a + o) * Math.cos(T), t) : (s = E / I, l = ci(this.a, this.e, this.sin_p12), u = ci(this.a, this.e, E), h = Math.atan((1 - this.es) * s + this.es * l * this.sin_p12 / (u * I)), v = 0 === (c = Math.atan2(Math.sin(T), this.cos_p12 * Math.tan(h) - this.sin_p12 * Math.cos(T))) ? Math.asin(this.cos_p12 * Math.sin(h) - this.sin_p12 * Math.cos(h)) : Math.abs(Math.abs(c) - Math.PI) <= 1e-10 ? -Math.asin(this.cos_p12 * Math.sin(h) - this.sin_p12 * Math.cos(h)) : Math.asin(Math.sin(T) * Math.cos(h) / Math.sin(c)), p = this.e * this.sin_p12 / Math.sqrt(1 - this.es), f = this.e * this.cos_p12 * Math.cos(c) / Math.sqrt(1 - this.es), t.x = this.x0 + (y = l * v * (1 - (x = v * v) * (m = f * f) * (1 - m) / 6 + (b = x * v) / 8 * (d = p * f) * (1 - 2 * m) + (w = b * v) / 120 * (m * (4 - 7 * m) - 3 * p * p * (1 - 7 * m)) - w * v / 48 * d)) * Math.sin(c), t.y = this.y0 + y * Math.cos(c), t))
                    }, inverse: function (t) {
                        var e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v, x, b, w, M;
                        if (t.x -= this.x0, t.y -= this.y0, this.sphere) {
                            if ((e = Math.sqrt(t.x * t.x + t.y * t.y)) > 2 * C * this.a) return;
                            return i = e / this.a, r = Math.sin(i), n = Math.cos(i), a = this.long0, Math.abs(e) <= 1e-10 ? o = this.lat0 : (o = gi(n * this.sin_p12 + t.y * r * this.cos_p12 / e), s = Math.abs(this.lat0) - C, a = Math.abs(s) <= 1e-10 ? P(this.lat0 >= 0 ? this.long0 + Math.atan2(t.x, -t.y) : this.long0 - Math.atan2(-t.x, t.y)) : P(this.long0 + Math.atan2(t.x * r, e * this.cos_p12 * n - t.y * this.sin_p12 * r))), t.x = a, t.y = o, t
                        }
                        return l = si(this.es), u = li(this.es), h = ui(this.es), c = hi(this.es), Math.abs(this.sin_p12 - 1) <= 1e-10 ? (o = fi(((p = this.a * oi(l, u, h, c, C)) - (e = Math.sqrt(t.x * t.x + t.y * t.y))) / this.a, l, u, h, c), a = P(this.long0 + Math.atan2(t.x, -1 * t.y)), t.x = a, t.y = o, t) : Math.abs(this.sin_p12 + 1) <= 1e-10 ? (p = this.a * oi(l, u, h, c, C), o = fi(((e = Math.sqrt(t.x * t.x + t.y * t.y)) - p) / this.a, l, u, h, c), a = P(this.long0 + Math.atan2(t.x, t.y)), t.x = a, t.y = o, t) : (e = Math.sqrt(t.x * t.x + t.y * t.y), m = Math.atan2(t.x, t.y), f = ci(this.a, this.e, this.sin_p12), y = Math.cos(m), v = 3 * this.es * (1 - (_ = -(g = this.e * this.cos_p12 * y) * g / (1 - this.es))) * this.sin_p12 * this.cos_p12 * y / (1 - this.es), w = 1 - _ * (b = (x = e / f) - _ * (1 + _) * Math.pow(x, 3) / 6 - v * (1 + 3 * _) * Math.pow(x, 4) / 24) * b / 2 - x * b * b * b / 6, d = Math.asin(this.sin_p12 * Math.cos(b) + this.cos_p12 * Math.sin(b) * y), a = P(this.long0 + Math.asin(Math.sin(m) * Math.sin(b) / Math.cos(d))), M = Math.sin(d), o = Math.atan2((M - this.es * w * this.sin_p12) * Math.tan(d), M * (1 - this.es)), t.x = a, t.y = o, t)
                    }, names: ["Azimuthal_Equidistant", "aeqd"]
                }, Ai = {
                    init: function () {
                        this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0)
                    }, forward: function (t) {
                        var e, i, r, n, a, o, s, l = t.y;
                        return r = P(t.x - this.long0), e = Math.sin(l), i = Math.cos(l), n = Math.cos(r), ((a = this.sin_p14 * e + this.cos_p14 * i * n) > 0 || Math.abs(a) <= 1e-10) && (o = 1 * this.a * i * Math.sin(r), s = this.y0 + 1 * this.a * (this.cos_p14 * e - this.sin_p14 * i * n)), t.x = o, t.y = s, t
                    }, inverse: function (t) {
                        var e, i, r, n, a, o, s;
                        return t.x -= this.x0, t.y -= this.y0, i = gi((e = Math.sqrt(t.x * t.x + t.y * t.y)) / this.a), r = Math.sin(i), n = Math.cos(i), o = this.long0, Math.abs(e) <= 1e-10 ? (s = this.lat0, t.x = o, t.y = s, t) : (s = gi(n * this.sin_p14 + t.y * r * this.cos_p14 / e), a = Math.abs(this.lat0) - C, Math.abs(a) <= 1e-10 ? (o = P(this.lat0 >= 0 ? this.long0 + Math.atan2(t.x, -t.y) : this.long0 - Math.atan2(-t.x, t.y)), t.x = o, t.y = s, t) : (o = P(this.long0 + Math.atan2(t.x * r, e * this.cos_p14 * n - t.y * this.sin_p14 * r)), t.x = o, t.y = s, t))
                    }, names: ["ortho"]
                };

                function zi(t, e, i, r) {
                    var n;
                    return t < 1e-10 ? (r.value = 1, n = 0) : (n = Math.atan2(e, i), Math.abs(n) <= M ? r.value = 1 : n > M && n <= C + M ? (r.value = 2, n -= C) : n > C + M || n <= -(C + M) ? (r.value = 3, n = n >= 0 ? n - _ : n + _) : (r.value = 4, n += C)), n
                }

                function ki(t, e) {
                    var i = t + e;
                    return i < -_ ? i += It : i > +_ && (i -= It), i
                }

                var Li = {
                        init: function () {
                            this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Quadrilateralized Spherical Cube", this.face = this.lat0 >= C - M / 2 ? 5 : this.lat0 <= -(C - M / 2) ? 6 : Math.abs(this.long0) <= M ? 1 : Math.abs(this.long0) <= C + M ? this.long0 > 0 ? 2 : 4 : 3, 0 !== this.es && (this.one_minus_f = 1 - (this.a - this.b) / this.a, this.one_minus_f_squared = this.one_minus_f * this.one_minus_f)
                        }, forward: function (t) {
                            var e, i, r, n, a, o, s = {x: 0, y: 0}, l = {value: 0};
                            if (t.x -= this.long0, e = 0 !== this.es ? Math.atan(this.one_minus_f_squared * Math.tan(t.y)) : t.y, i = t.x, 5 === this.face) n = C - e, i >= M && i <= C + M ? (l.value = 1, r = i - C) : i > C + M || i <= -(C + M) ? (l.value = 2, r = i > 0 ? i - _ : i + _) : i > -(C + M) && i <= -M ? (l.value = 3, r = i + C) : (l.value = 4, r = i); else if (6 === this.face) n = C + e, i >= M && i <= C + M ? (l.value = 1, r = -i + C) : i < M && i >= -M ? (l.value = 2, r = -i) : i < -M && i >= -(C + M) ? (l.value = 3, r = -i - C) : (l.value = 4, r = i > 0 ? -i + _ : -i - _); else {
                                var u, h, c, p, f, d;
                                2 === this.face ? i = ki(i, +C) : 3 === this.face ? i = ki(i, +_) : 4 === this.face && (i = ki(i, -C)), p = Math.sin(e), f = Math.cos(e), d = Math.sin(i), u = f * Math.cos(i), h = f * d, c = p, 1 === this.face ? r = zi(n = Math.acos(u), c, h, l) : 2 === this.face ? r = zi(n = Math.acos(h), c, -u, l) : 3 === this.face ? r = zi(n = Math.acos(-u), c, -h, l) : 4 === this.face ? r = zi(n = Math.acos(-h), c, u, l) : (n = r = 0, l.value = 1)
                            }
                            return o = Math.atan(12 / _ * (r + Math.acos(Math.sin(r) * Math.cos(M)) - C)), a = Math.sqrt((1 - Math.cos(n)) / (Math.cos(o) * Math.cos(o)) / (1 - Math.cos(Math.atan(1 / Math.cos(r))))), 2 === l.value ? o += C : 3 === l.value ? o += _ : 4 === l.value && (o += 1.5 * _), s.x = a * Math.cos(o), s.y = a * Math.sin(o), s.x = s.x * this.a + this.x0, s.y = s.y * this.a + this.y0, t.x = s.x, t.y = s.y, t
                        }, inverse: function (t) {
                            var e, i, r, n, a, o, s, l, u, h, c, p, f = {lam: 0, phi: 0}, d = {value: 0};
                            if (t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, i = Math.atan(Math.sqrt(t.x * t.x + t.y * t.y)), e = Math.atan2(t.y, t.x), t.x >= 0 && t.x >= Math.abs(t.y) ? d.value = 1 : t.y >= 0 && t.y >= Math.abs(t.x) ? (d.value = 2, e -= C) : t.x < 0 && -t.x >= Math.abs(t.y) ? (d.value = 3, e = e < 0 ? e + _ : e - _) : (d.value = 4, e += C), u = _ / 12 * Math.tan(e), a = Math.sin(u) / (Math.cos(u) - 1 / Math.sqrt(2)), o = Math.atan(a), (s = 1 - (r = Math.cos(e)) * r * (n = Math.tan(i)) * n * (1 - Math.cos(Math.atan(1 / Math.cos(o))))) < -1 ? s = -1 : s > 1 && (s = 1), 5 === this.face) l = Math.acos(s), f.phi = C - l, f.lam = 1 === d.value ? o + C : 2 === d.value ? o < 0 ? o + _ : o - _ : 3 === d.value ? o - C : o; else if (6 === this.face) l = Math.acos(s), f.phi = l - C, f.lam = 1 === d.value ? -o + C : 2 === d.value ? -o : 3 === d.value ? -o - C : o < 0 ? -o - _ : -o + _; else {
                                var m, y, g;
                                u = (m = s) * m, y = (u += (g = u >= 1 ? 0 : Math.sqrt(1 - u) * Math.sin(o)) * g) >= 1 ? 0 : Math.sqrt(1 - u), 2 === d.value ? (u = y, y = -g, g = u) : 3 === d.value ? (y = -y, g = -g) : 4 === d.value && (u = y, y = g, g = -u), 2 === this.face ? (u = m, m = -y, y = u) : 3 === this.face ? (m = -m, y = -y) : 4 === this.face && (u = m, m = y, y = -u), f.phi = Math.acos(-g) - C, f.lam = Math.atan2(y, m), 2 === this.face ? f.lam = ki(f.lam, -C) : 3 === this.face ? f.lam = ki(f.lam, -_) : 4 === this.face && (f.lam = ki(f.lam, +C))
                            }
                            return 0 !== this.es && (h = f.phi < 0 ? 1 : 0, c = Math.tan(f.phi), p = this.b / Math.sqrt(c * c + this.one_minus_f_squared), f.phi = Math.atan(Math.sqrt(this.a * this.a - p * p) / (this.one_minus_f * p)), h && (f.phi = -f.phi)), f.lam += this.long0, t.x = f.lam, t.y = f.phi, t
                        }, names: ["Quadrilateralized Spherical Cube", "Quadrilateralized_Spherical_Cube", "qsc"]
                    },
                    Di = [[1, 22199e-21, -715515e-10, 31103e-10], [.9986, -482243e-9, -24897e-9, -13309e-10], [.9954, -83103e-8, -448605e-10, -9.86701e-7], [.99, -.00135364, -59661e-9, 36777e-10], [.9822, -.00167442, -449547e-11, -572411e-11], [.973, -.00214868, -903571e-10, 1.8736e-8], [.96, -.00305085, -900761e-10, 164917e-11], [.9427, -.00382792, -653386e-10, -26154e-10], [.9216, -.00467746, -10457e-8, 481243e-11], [.8962, -.00536223, -323831e-10, -543432e-11], [.8679, -.00609363, -113898e-9, 332484e-11], [.835, -.00698325, -640253e-10, 9.34959e-7], [.7986, -.00755338, -500009e-10, 9.35324e-7], [.7597, -.00798324, -35971e-9, -227626e-11], [.7186, -.00851367, -701149e-10, -86303e-10], [.6732, -.00986209, -199569e-9, 191974e-10], [.6213, -.010418, 883923e-10, 624051e-11], [.5722, -.00906601, 182e-6, 624051e-11], [.5322, -.00677797, 275608e-9, 624051e-11]],
                    Ri = [[-520417e-23, .0124, 121431e-23, -845284e-16], [.062, .0124, -1.26793e-9, 4.22642e-10], [.124, .0124, 5.07171e-9, -1.60604e-9], [.186, .0123999, -1.90189e-8, 6.00152e-9], [.248, .0124002, 7.10039e-8, -2.24e-8], [.31, .0123992, -2.64997e-7, 8.35986e-8], [.372, .0124029, 9.88983e-7, -3.11994e-7], [.434, .0123893, -369093e-11, -4.35621e-7], [.4958, .0123198, -102252e-10, -3.45523e-7], [.5571, .0121916, -154081e-10, -5.82288e-7], [.6176, .0119938, -241424e-10, -5.25327e-7], [.6769, .011713, -320223e-10, -5.16405e-7], [.7346, .0113541, -397684e-10, -6.09052e-7], [.7903, .0109107, -489042e-10, -104739e-11], [.8435, .0103431, -64615e-9, -1.40374e-9], [.8936, .00969686, -64636e-9, -8547e-9], [.9394, .00840947, -192841e-9, -42106e-10], [.9761, .00616527, -256e-6, -42106e-10], [1, .00328947, -319159e-9, -42106e-10]],
                    Bi = function (t, e) {
                        return t[0] + e * (t[1] + e * (t[2] + e * t[3]))
                    }, Oi = {
                        init: function () {
                            this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.long0 = this.long0 || 0, this.es = 0, this.title = this.title || "Robinson"
                        }, forward: function (t) {
                            var e = P(t.x - this.long0), i = Math.abs(t.y), r = Math.floor(11.459155902616464 * i);
                            r < 0 ? r = 0 : r >= 18 && (r = 17);
                            var n = {x: Bi(Di[r], i = Et * (i - .08726646259971647 * r)) * e, y: Bi(Ri[r], i)};
                            return t.y < 0 && (n.y = -n.y), n.x = n.x * this.a * .8487 + this.x0, n.y = n.y * this.a * 1.3523 + this.y0, n
                        }, inverse: function (t) {
                            var e = {x: (t.x - this.x0) / (.8487 * this.a), y: Math.abs(t.y - this.y0) / (1.3523 * this.a)};
                            if (e.y >= 1) e.x /= Di[18][0], e.y = t.y < 0 ? -C : C; else {
                                var i = Math.floor(18 * e.y);
                                for (i < 0 ? i = 0 : i >= 18 && (i = 17); ;) if (Ri[i][0] > e.y) --i; else {
                                    if (!(Ri[i + 1][0] <= e.y)) break;
                                    ++i
                                }
                                var r = Ri[i], n = 5 * (e.y - r[0]) / (Ri[i + 1][0] - r[0]);
                                n = function (t, e, i, r) {
                                    for (var n = e; r; --r) {
                                        var a = t(n);
                                        if (n -= a, Math.abs(a) < 1e-10) break
                                    }
                                    return n
                                }(function (t) {
                                    return (Bi(r, t) - e.y) / function (t, e) {
                                        return t[1] + e * (2 * t[2] + 3 * e * t[3])
                                    }(r, t)
                                }, n, 0, 100), e.x /= Bi(Di[i], n), e.y = (5 * i + n) * St, t.y < 0 && (e.y = -e.y)
                            }
                            return e.x = P(e.x + this.long0), e
                        }, names: ["Robinson", "robin"]
                    }, Fi = {
                        init: function () {
                            this.name = "geocent"
                        }, forward: function (t) {
                            return de(t, this.es, this.a)
                        }, inverse: function (t) {
                            return me(t, this.es, this.a, this.b)
                        }, names: ["Geocentric", "geocentric", "geocent", "Geocent"]
                    }, Ui = {
                        h: {def: 1e5, num: !0},
                        azi: {def: 0, num: !0, degrees: !0},
                        tilt: {def: 0, num: !0, degrees: !0},
                        long0: {def: 0, num: !0},
                        lat0: {def: 0, num: !0}
                    }, Ni = {
                        init: function () {
                            if (Object.keys(Ui).forEach(function (t) {
                                if (void 0 === this[t]) this[t] = Ui[t].def; else {
                                    if (Ui[t].num && isNaN(this[t])) throw new Error("Invalid parameter value, must be numeric " + t + " = " + this[t]);
                                    Ui[t].num && (this[t] = parseFloat(this[t]))
                                }
                                Ui[t].degrees && (this[t] = this[t] * St)
                            }.bind(this)), Math.abs(Math.abs(this.lat0) - C) < 1e-10 ? this.mode = this.lat0 < 0 ? 1 : 0 : Math.abs(this.lat0) < 1e-10 ? this.mode = 2 : (this.mode = 3, this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0)), this.pn1 = this.h / this.a, this.pn1 <= 0 || this.pn1 > 1e10) throw new Error("Invalid height");
                            this.p = 1 + this.pn1, this.rp = 1 / this.p, this.h1 = 1 / this.pn1, this.pfact = (this.p + 1) * this.h1, this.es = 0;
                            var t = this.tilt, e = this.azi;
                            this.cg = Math.cos(e), this.sg = Math.sin(e), this.cw = Math.cos(t), this.sw = Math.sin(t)
                        }, forward: function (t) {
                            t.x -= this.long0;
                            var e, i, r, n, a = Math.sin(t.y), o = Math.cos(t.y), s = Math.cos(t.x);
                            switch (this.mode) {
                                case 3:
                                    i = this.sinph0 * a + this.cosph0 * o * s;
                                    break;
                                case 2:
                                    i = o * s;
                                    break;
                                case 1:
                                    i = -a;
                                    break;
                                case 0:
                                    i = a
                            }
                            switch (e = (i = this.pn1 / (this.p - i)) * o * Math.sin(t.x), this.mode) {
                                case 3:
                                    i *= this.cosph0 * a - this.sinph0 * o * s;
                                    break;
                                case 2:
                                    i *= a;
                                    break;
                                case 0:
                                    i *= -o * s;
                                    break;
                                case 1:
                                    i *= o * s
                            }
                            return e = (e * this.cg - i * this.sg) * this.cw * (n = 1 / ((r = i * this.cg + e * this.sg) * this.sw * this.h1 + this.cw)), i = r * n, t.x = e * this.a, t.y = i * this.a, t
                        }, inverse: function (t) {
                            t.x /= this.a, t.y /= this.a;
                            var e, i, r, n = {x: t.x, y: t.y};
                            t.x = (e = this.pn1 * t.x * (r = 1 / (this.pn1 - t.y * this.sw))) * this.cg + (i = this.pn1 * t.y * this.cw * r) * this.sg, t.y = i * this.cg - e * this.sg;
                            var a = Xe(t.x, t.y);
                            if (Math.abs(a) < 1e-10) n.x = 0, n.y = t.y; else {
                                var o, s;
                                switch (s = 1 - a * a * this.pfact, s = (this.p - Math.sqrt(s)) / (this.pn1 / a + a / this.pn1), o = Math.sqrt(1 - s * s), this.mode) {
                                    case 3:
                                        n.y = Math.asin(o * this.sinph0 + t.y * s * this.cosph0 / a), t.y = (o - this.sinph0 * Math.sin(n.y)) * a, t.x *= s * this.cosph0;
                                        break;
                                    case 2:
                                        n.y = Math.asin(t.y * s / a), t.y = o * a, t.x *= s;
                                        break;
                                    case 0:
                                        n.y = Math.asin(o), t.y = -t.y;
                                        break;
                                    case 1:
                                        n.y = -Math.asin(o)
                                }
                                n.x = Math.atan2(t.x, t.y)
                            }
                            return t.x = n.x + this.long0, t.y = n.y, t
                        }, names: ["Tilted_Perspective", "tpers"]
                    }, Vi = {
                        init: function () {
                            if (this.flip_axis = "x" === this.sweep ? 1 : 0, this.h = Number(this.h), this.radius_g_1 = this.h / this.a, this.radius_g_1 <= 0 || this.radius_g_1 > 1e10) throw new Error;
                            if (this.radius_g = 1 + this.radius_g_1, this.C = this.radius_g * this.radius_g - 1, 0 !== this.es) {
                                var t = 1 - this.es, e = 1 / t;
                                this.radius_p = Math.sqrt(t), this.radius_p2 = t, this.radius_p_inv2 = e, this.shape = "ellipse"
                            } else this.radius_p = 1, this.radius_p2 = 1, this.radius_p_inv2 = 1, this.shape = "sphere";
                            this.title || (this.title = "Geostationary Satellite View")
                        }, forward: function (t) {
                            var e, i, r, n, a = t.x, o = t.y;
                            if (a -= this.long0, "ellipse" === this.shape) {
                                o = Math.atan(this.radius_p2 * Math.tan(o));
                                var s = this.radius_p / Xe(this.radius_p * Math.cos(o), Math.sin(o));
                                if (i = s * Math.cos(a) * Math.cos(o), r = s * Math.sin(a) * Math.cos(o), n = s * Math.sin(o), (this.radius_g - i) * i - r * r - n * n * this.radius_p_inv2 < 0) return t.x = Number.NaN, t.y = Number.NaN, t;
                                e = this.radius_g - i, this.flip_axis ? (t.x = this.radius_g_1 * Math.atan(r / Xe(n, e)), t.y = this.radius_g_1 * Math.atan(n / e)) : (t.x = this.radius_g_1 * Math.atan(r / e), t.y = this.radius_g_1 * Math.atan(n / Xe(r, e)))
                            } else "sphere" === this.shape && (e = Math.cos(o), i = Math.cos(a) * e, r = Math.sin(a) * e, n = Math.sin(o), e = this.radius_g - i, this.flip_axis ? (t.x = this.radius_g_1 * Math.atan(r / Xe(n, e)), t.y = this.radius_g_1 * Math.atan(n / e)) : (t.x = this.radius_g_1 * Math.atan(r / e), t.y = this.radius_g_1 * Math.atan(n / Xe(r, e))));
                            return t.x = t.x * this.a, t.y = t.y * this.a, t
                        }, inverse: function (t) {
                            var e, i, r, n, a = -1, o = 0, s = 0;
                            if (t.x = t.x / this.a, t.y = t.y / this.a, "ellipse" === this.shape) {
                                this.flip_axis ? (s = Math.tan(t.y / this.radius_g_1), o = Math.tan(t.x / this.radius_g_1) * Xe(1, s)) : (o = Math.tan(t.x / this.radius_g_1), s = Math.tan(t.y / this.radius_g_1) * Xe(1, o));
                                var l = s / this.radius_p;
                                if ((r = (i = 2 * this.radius_g * a) * i - 4 * (e = o * o + l * l + a * a) * this.C) < 0) return t.x = Number.NaN, t.y = Number.NaN, t;
                                n = (-i - Math.sqrt(r)) / (2 * e), a = this.radius_g + n * a, o *= n, s *= n, t.x = Math.atan2(o, a), t.y = Math.atan(s * Math.cos(t.x) / a), t.y = Math.atan(this.radius_p_inv2 * Math.tan(t.y))
                            } else if ("sphere" === this.shape) {
                                if (this.flip_axis ? (s = Math.tan(t.y / this.radius_g_1), o = Math.tan(t.x / this.radius_g_1) * Math.sqrt(1 + s * s)) : (o = Math.tan(t.x / this.radius_g_1), s = Math.tan(t.y / this.radius_g_1) * Math.sqrt(1 + o * o)), (r = (i = 2 * this.radius_g * a) * i - 4 * (e = o * o + s * s + a * a) * this.C) < 0) return t.x = Number.NaN, t.y = Number.NaN, t;
                                n = (-i - Math.sqrt(r)) / (2 * e), a = this.radius_g + n * a, o *= n, s *= n, t.x = Math.atan2(o, a), t.y = Math.atan(s * Math.cos(t.x) / a)
                            }
                            return t.x = t.x + this.long0, t
                        }, names: ["Geostationary Satellite View", "Geostationary_Satellite", "geos"]
                    };
                Te.defaultDatum = "WGS84", Te.Proj = fe, Te.WGS84 = new Te.Proj("WGS84"), Te.Point = Ne, Te.toPoint = be, Te.defs = jt, Te.nadgrid = function (t, e) {
                    var i = new DataView(e), r = function (t) {
                        var e = t.getInt32(8, !1);
                        return 11 !== e && (11 !== (e = t.getInt32(8, !0)) && console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"), !0)
                    }(i), n = function (t, e) {
                        return {
                            nFields: t.getInt32(8, e),
                            nSubgridFields: t.getInt32(24, e),
                            nSubgrids: t.getInt32(40, e),
                            shiftType: ue(t, 56, 64).trim(),
                            fromSemiMajorAxis: t.getFloat64(120, e),
                            fromSemiMinorAxis: t.getFloat64(136, e),
                            toSemiMajorAxis: t.getFloat64(152, e),
                            toSemiMinorAxis: t.getFloat64(168, e)
                        }
                    }(i, r);
                    n.nSubgrids > 1 && console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");
                    var a = {
                        header: n, subgrids: function (t, e, i) {
                            for (var r = [], n = 0; n < e.nSubgrids; n++) {
                                var a = ce(t, 176, i), o = pe(t, 176, a, i),
                                    s = Math.round(1 + (a.upperLongitude - a.lowerLongitude) / a.longitudeInterval),
                                    l = Math.round(1 + (a.upperLatitude - a.lowerLatitude) / a.latitudeInterval);
                                r.push({
                                    ll: [le(a.lowerLongitude), le(a.lowerLatitude)],
                                    del: [le(a.longitudeInterval), le(a.latitudeInterval)],
                                    lim: [s, l],
                                    count: a.gridNodeCount,
                                    cvs: he(o)
                                })
                            }
                            return r
                        }(i, n, r)
                    };
                    return oe[t] = a, a
                }, Te.transform = Me, Te.mgrs = ze, Te.version = "__VERSION__", function (t) {
                    t.Proj.projections.add(Ze), t.Proj.projections.add(Ye), t.Proj.projections.add(Je), t.Proj.projections.add(ti), t.Proj.projections.add(ei), t.Proj.projections.add(ii), t.Proj.projections.add(ri), t.Proj.projections.add(ni), t.Proj.projections.add(ai), t.Proj.projections.add(di), t.Proj.projections.add(yi), t.Proj.projections.add(_i), t.Proj.projections.add(vi), t.Proj.projections.add(xi), t.Proj.projections.add(bi), t.Proj.projections.add(wi), t.Proj.projections.add(Mi), t.Proj.projections.add(Si), t.Proj.projections.add(Ei), t.Proj.projections.add(Ii), t.Proj.projections.add(Ti), t.Proj.projections.add(Ci), t.Proj.projections.add(Pi), t.Proj.projections.add(Ai), t.Proj.projections.add(Li), t.Proj.projections.add(Oi), t.Proj.projections.add(Fi), t.Proj.projections.add(Ni), t.Proj.projections.add(Vi)
                }(Te);
                var ji = function (t, e) {
                    this._transformRequestFn = t, this._customAccessToken = e, this._createSkuToken()
                };

                function qi(t) {
                    return 0 === t.indexOf("mapbox:")
                }

                ji.prototype._createSkuToken = function () {
                    var t = function () {
                        for (var t = "", e = 0; e < 10; e++) t += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62 * Math.random())];
                        return {token: ["1", wt, t].join(""), tokenExpiresAt: Date.now() + 432e5}
                    }();
                    this._skuToken = t.token, this._skuTokenExpiresAt = t.tokenExpiresAt
                }, ji.prototype._isSkuTokenExpired = function () {
                    return Date.now() > this._skuTokenExpiresAt
                }, ji.prototype.transformRequest = function (t, e) {
                    return this._transformRequestFn && this._transformRequestFn(t, e) || {url: t}
                }, ji.prototype.normalizeStyleURL = function (t, e) {
                    if (!qi(t)) return t;
                    var i = Xi(t);
                    return i.path = "/styles/v1" + i.path, this._makeAPIURL(i, this._customAccessToken || e)
                }, ji.prototype.normalizeGlyphsURL = function (t, e) {
                    if (!qi(t)) return t;
                    var i = Xi(t);
                    return i.path = "/fonts/v1" + i.path, this._makeAPIURL(i, this._customAccessToken || e)
                }, ji.prototype.normalizeSourceURL = function (t, e) {
                    if (!qi(t)) return t;
                    var i = Xi(t);
                    return i.path = "/v4/" + i.authority + ".json", i.params.push("secure"), this._makeAPIURL(i, this._customAccessToken || e)
                }, ji.prototype.normalizeSpriteURL = function (t, e, i, r) {
                    var n = Xi(t);
                    return n && !n.protocol && n.path ? (n.path += "" + e + i, n.path) : qi(t) ? (n.path = "/styles/v1" + n.path + "/sprite" + e + i, this._makeAPIURL(n, this._customAccessToken || r)) : (n.path += "" + e + i, Hi(n))
                }, ji.prototype.normalizeTileURL = function (t, e) {
                    if (this._isSkuTokenExpired() && this._createSkuToken(), t && !qi(t)) return t;
                    var i = Xi(t);
                    i.path = i.path.replace(/(\.(png|jpg)\d*)(?=$)/, (gt.devicePixelRatio >= 2 || 512 === e ? "@2x" : "") + (_t.supported ? ".webp" : "$1")), i.path = i.path.replace(/^.+\/v4\//, "/"), i.path = "/v4" + i.path;
                    var r = this._customAccessToken || function (t) {
                        for (var e = 0, i = t; e < i.length; e += 1) {
                            var r = i[e].match(/^access_token=(.*)$/);
                            if (r) return r[1]
                        }
                        return null
                    }(i.params) || u.ACCESS_TOKEN;
                    return u.REQUIRE_ACCESS_TOKEN && r && this._skuToken && i.params.push("sku=" + this._skuToken), this._makeAPIURL(i, r)
                }, ji.prototype.canonicalizeTileURL = function (t, e) {
                    var i = Xi(t);
                    if (!i.path.match(/(^\/v4\/)/) || !i.path.match(/\.[\w]+$/)) return t;
                    var r = "mapbox://tiles/";
                    r += i.path.replace("/v4/", "");
                    var n = i.params;
                    return e && (n = n.filter(function (t) {
                        return !t.match(/^access_token=/)
                    })), n.length && (r += "?" + n.join("&")), r
                }, ji.prototype.canonicalizeTileset = function (t, e) {
                    for (var i = !!e && qi(e), r = [], n = 0, a = t.tiles || []; n < a.length; n += 1) {
                        var o = a[n];
                        Zi(o) ? r.push(this.canonicalizeTileURL(o, i)) : r.push(o)
                    }
                    return r
                }, ji.prototype._makeAPIURL = function (t, e) {
                    var i = "See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",
                        r = Xi(u.API_URL);
                    if (t.protocol = r.protocol, t.authority = r.authority, "/" !== r.path && (t.path = "" + r.path + t.path), !u.REQUIRE_ACCESS_TOKEN) return Hi(t);
                    if (!(e = e || u.ACCESS_TOKEN)) throw new Error("An API access token is required to use Mapbox GL. " + i);
                    if ("s" === e[0]) throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). " + i);
                    return t.params = t.params.filter(function (t) {
                        return -1 === t.indexOf("access_token")
                    }), t.params.push("access_token=" + e), Hi(t)
                };
                var Gi = /^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;

                function Zi(t) {
                    return Gi.test(t)
                }

                var Wi = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;

                function Xi(t) {
                    var e = t.match(Wi);
                    return e ? {
                        protocol: e[1],
                        authority: e[2],
                        path: e[3] || "/",
                        params: e[4] ? e[4].split("&") : []
                    } : {path: t, params: []}
                }

                function Hi(t) {
                    var e = t.params.length ? "?" + t.params.join("&") : "";
                    return t.protocol + "://" + t.authority + t.path + e
                }

                function Ki(t) {
                    if (!t) return null;
                    var e = t.split(".");
                    if (!e || 3 !== e.length) return null;
                    try {
                        return JSON.parse(decodeURIComponent(c.atob(e[1]).split("").map(function (t) {
                            return "%" + ("00" + t.charCodeAt(0).toString(16)).slice(-2)
                        }).join("")))
                    } catch (t) {
                        return null
                    }
                }

                var Yi = function (t) {
                    this.type = t, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null
                };
                Yi.prototype.getStorageKey = function (t) {
                    var e, i = Ki(u.ACCESS_TOKEN);
                    return e = i && i.u ? c.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g, function (t, e) {
                        return String.fromCharCode(Number("0x" + e))
                    })) : u.ACCESS_TOKEN || "", t ? "mapbox.eventData." + t + ":" + e : "mapbox.eventData:" + e
                }, Yi.prototype.fetchEventData = function () {
                    var t = st("localStorage"), e = this.getStorageKey(), i = this.getStorageKey("uuid");
                    if (t) try {
                        var r = c.localStorage.getItem(e);
                        r && (this.eventData = JSON.parse(r));
                        var n = c.localStorage.getItem(i);
                        n && (this.anonId = n)
                    } catch (t) {
                        ht("Unable to read from LocalStorage")
                    }
                }, Yi.prototype.saveEventData = function () {
                    var t = st("localStorage"), e = this.getStorageKey(), i = this.getStorageKey("uuid");
                    if (t) try {
                        c.localStorage.setItem(i, this.anonId), Object.keys(this.eventData).length >= 1 && c.localStorage.setItem(e, JSON.stringify(this.eventData))
                    } catch (t) {
                        ht("Unable to write to LocalStorage")
                    }
                }, Yi.prototype.processRequests = function (t) {
                }, Yi.prototype.postEvent = function (t, e, i, r) {
                    var n = this;
                    if (u.EVENTS_URL) {
                        var a = Xi(u.EVENTS_URL);
                        a.params.push("access_token=" + (r || u.ACCESS_TOKEN || ""));
                        var o = {
                                event: this.type,
                                created: new Date(t).toISOString(),
                                sdkIdentifier: "mapbox-gl-js",
                                sdkVersion: "1.12.1-3",
                                skuId: wt,
                                userId: this.anonId
                            }, s = e ? V(o, e) : o,
                            l = {url: Hi(a), headers: {"Content-Type": "text/plain"}, body: JSON.stringify([s])};
                        this.pendingRequest = _r(l, function (t) {
                            n.pendingRequest = null, i(t), n.saveEventData(), n.processRequests(r)
                        })
                    }
                }, Yi.prototype.queueRequest = function (t, e) {
                    this.queue.push(t), this.processRequests(e)
                };
                var Ji, Qi, $i = function (t) {
                        function e() {
                            t.call(this, "map.load"), this.success = {}, this.skuToken = ""
                        }

                        return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.postMapLoadEvent = function (t, e, i, r) {
                            this.skuToken = i, (u.EVENTS_URL && r || u.ACCESS_TOKEN && Array.isArray(t) && t.some(function (t) {
                                return qi(t) || Zi(t)
                            })) && this.queueRequest({id: e, timestamp: Date.now()}, r)
                        }, e.prototype.processRequests = function (t) {
                            var e = this;
                            if (!this.pendingRequest && 0 !== this.queue.length) {
                                var i = this.queue.shift(), r = i.id, n = i.timestamp;
                                r && this.success[r] || (this.anonId || this.fetchEventData(), X(this.anonId) || (this.anonId = Z()), this.postEvent(n, {skuToken: this.skuToken}, function (t) {
                                    t || r && (e.success[r] = !0)
                                }, t))
                            }
                        }, e
                    }(Yi), tr = new (function (e) {
                        function t(t) {
                            e.call(this, "appUserTurnstile"), this._customAccessToken = t
                        }

                        return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.postTurnstileEvent = function (t, e) {
                            u.EVENTS_URL && u.ACCESS_TOKEN && Array.isArray(t) && t.some(function (t) {
                                return qi(t) || Zi(t)
                            }) && this.queueRequest(Date.now(), e)
                        }, t.prototype.processRequests = function (t) {
                            var e = this;
                            if (!this.pendingRequest && 0 !== this.queue.length) {
                                this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
                                var i = Ki(u.ACCESS_TOKEN), r = i ? i.u : u.ACCESS_TOKEN, n = r !== this.eventData.tokenU;
                                X(this.anonId) || (this.anonId = Z(), n = !0);
                                var a = this.queue.shift();
                                if (this.eventData.lastSuccess) {
                                    var o = new Date(this.eventData.lastSuccess), s = new Date(a),
                                        l = (a - this.eventData.lastSuccess) / 864e5;
                                    n = n || l >= 1 || l < -1 || o.getDate() !== s.getDate()
                                } else n = !0;
                                if (!n) return this.processRequests();
                                this.postEvent(a, {"enabled.telemetry": !1}, function (t) {
                                    t || (e.eventData.lastSuccess = a, e.eventData.tokenU = r)
                                }, t)
                            }
                        }, t
                    }(Yi)), er = tr.postTurnstileEvent.bind(tr), ir = new $i, rr = ir.postMapLoadEvent.bind(ir), nr = 500,
                    ar = 50;

                function or() {
                    c.caches && !Ji && (Ji = c.caches.open("mapbox-tiles"))
                }

                function sr(t) {
                    var e = t.indexOf("?");
                    return e < 0 ? t : t.slice(0, e)
                }

                var lr, ur = 1 / 0;

                function hr() {
                    return null == lr && (lr = c.OffscreenCanvas && new c.OffscreenCanvas(1, 1).getContext("2d") && "function" == typeof c.createImageBitmap), lr
                }

                var cr = {
                    Unknown: "Unknown",
                    Style: "Style",
                    Source: "Source",
                    Tile: "Tile",
                    Glyphs: "Glyphs",
                    SpriteImage: "SpriteImage",
                    SpriteJSON: "SpriteJSON",
                    Image: "Image"
                };
                "function" == typeof Object.freeze && Object.freeze(cr);
                var pr = function (r) {
                    function t(t, e, i) {
                        401 === e && Zi(i) && (t += ": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"), r.call(this, t), this.status = e, this.url = i, this.name = this.constructor.name, this.message = t
                    }

                    return r && (t.__proto__ = r), (t.prototype = Object.create(r && r.prototype)).constructor = t, t.prototype.toString = function () {
                        return this.name + ": " + this.message + " (" + this.status + "): " + this.url
                    }, t
                }(Error), fr = rt() ? function () {
                    return self.worker && self.worker.referrer
                } : function () {
                    return ("blob:" === c.location.protocol ? c.parent : c).location.href
                };
                var dr, mr, yr = function (t, e) {
                    if (!(/^file:/.test(i = t.url) || /^file:/.test(fr()) && !/^\w+:/.test(i))) {
                        if (c.fetch && c.Request && c.AbortController && c.Request.prototype.hasOwnProperty("signal")) return function (n, a) {
                            var t, e = new c.AbortController, o = new c.Request(n.url, {
                                method: n.method || "GET",
                                body: n.body,
                                credentials: n.credentials,
                                headers: n.headers,
                                referrer: fr(),
                                signal: e.signal
                            }), s = !1, l = !1, u = (t = o.url).indexOf("sku=") > 0 && Zi(t);
                            "json" === n.type && o.headers.set("Accept", "application/json");
                            var i = function (t, e, i) {
                                if (!l) {
                                    if (t && "SecurityError" !== t.message && ht(t), e && i) return h(e);
                                    var r = Date.now();
                                    c.fetch(o).then(function (t) {
                                        if (t.ok) {
                                            var e = u ? t.clone() : null;
                                            return h(t, e, r)
                                        }
                                        return a(new pr(t.statusText, t.status, n.url))
                                    }).catch(function (t) {
                                        20 !== t.code && a(new Error(t.message))
                                    })
                                }
                            }, h = function (e, i, r) {
                                ("arrayBuffer" === n.type ? e.arrayBuffer() : "json" === n.type ? e.json() : e.text()).then(function (t) {
                                    l || (i && r && function (i, t, e) {
                                        if (or(), Ji) {
                                            var r = {
                                                status: t.status,
                                                statusText: t.statusText,
                                                headers: new c.Headers
                                            };
                                            t.headers.forEach(function (t, e) {
                                                return r.headers.set(e, t)
                                            });
                                            var n = nt(t.headers.get("Cache-Control") || "");
                                            n["no-store"] || (n["max-age"] && r.headers.set("Expires", new Date(e + 1e3 * n["max-age"]).toUTCString()), new Date(r.headers.get("Expires")).getTime() - e < 42e4 || function (t, e) {
                                                if (void 0 === Qi) try {
                                                    new Response(new ReadableStream), Qi = !0
                                                } catch (t) {
                                                    Qi = !1
                                                }
                                                Qi ? e(t.body) : t.blob().then(e)
                                            }(t, function (t) {
                                                var e = new c.Response(t, r);
                                                or(), Ji && Ji.then(function (t) {
                                                    return t.put(sr(i.url), e)
                                                }).catch(function (t) {
                                                    return ht(t.message)
                                                })
                                            }))
                                        }
                                    }(o, i, r), s = !0, a(null, t, e.headers.get("Cache-Control"), e.headers.get("Expires")))
                                }).catch(function (t) {
                                    l || a(new Error(t.message))
                                })
                            };
                            return u ? function (t, r) {
                                if (or(), !Ji) return r(null);
                                var n = sr(t.url);
                                Ji.then(function (i) {
                                    i.match(n).then(function (t) {
                                        var e = function (t) {
                                            if (!t) return !1;
                                            var e = new Date(t.headers.get("Expires") || 0),
                                                i = nt(t.headers.get("Cache-Control") || "");
                                            return e > Date.now() && !i["no-cache"]
                                        }(t);
                                        i.delete(n), e && i.put(n, t.clone()), r(null, t, e)
                                    }).catch(r)
                                }).catch(r)
                            }(o, i) : i(null, null), {
                                cancel: function () {
                                    l = !0, s || e.abort()
                                }
                            }
                        }(t, e);
                        if (rt() && self.worker && self.worker.actor) return self.worker.actor.send("getResource", t, e, void 0, !0)
                    }
                    var i;
                    return function (e, i) {
                        var r = new c.XMLHttpRequest;
                        for (var t in r.open(e.method || "GET", e.url, !0), "arrayBuffer" === e.type && (r.responseType = "arraybuffer"), e.headers) r.setRequestHeader(t, e.headers[t]);
                        return "json" === e.type && (r.responseType = "text", r.setRequestHeader("Accept", "application/json")), r.withCredentials = "include" === e.credentials, r.onerror = function () {
                            i(new Error(r.statusText))
                        }, r.onload = function () {
                            if ((r.status >= 200 && r.status < 300 || 0 === r.status) && null !== r.response) {
                                var t = r.response;
                                if ("json" === e.type) try {
                                    t = JSON.parse(r.response)
                                } catch (t) {
                                    return i(t)
                                }
                                i(null, t, r.getResponseHeader("Cache-Control"), r.getResponseHeader("Expires"))
                            } else i(new pr(r.statusText, r.status, e.url))
                        }, r.send(e.body), {
                            cancel: function () {
                                return r.abort()
                            }
                        }
                    }(t, e)
                }, gr = function (t, e) {
                    return yr(V(t, {type: "arrayBuffer"}), e)
                }, _r = function (t, e) {
                    return yr(V(t, {method: "POST"}), e)
                };
                dr = [], mr = 0;
                var vr = function (t, n) {
                    if (_t.supported && (t.headers || (t.headers = {}), t.headers.accept = "image/webp,*/*"), mr >= u.MAX_PARALLEL_IMAGE_REQUESTS) {
                        var e = {
                            requestParameters: t, callback: n, cancelled: !1, cancel: function () {
                                this.cancelled = !0
                            }
                        };
                        return dr.push(e), e
                    }
                    mr++;
                    var i = !1, a = function () {
                        if (!i) for (i = !0, mr--; dr.length && mr < u.MAX_PARALLEL_IMAGE_REQUESTS;) {
                            var t = dr.shift();
                            t.cancelled || (t.cancel = vr(t.requestParameters, t.callback).cancel)
                        }
                    }, r = gr(t, function (t, e, i, r) {
                        a(), t ? n(t) : e && (hr() ? function (t, e) {
                            var i = new c.Blob([new Uint8Array(t)], {type: "image/png"});
                            c.createImageBitmap(i).then(function (t) {
                                e(null, t)
                            }).catch(function (t) {
                                e(new Error("Could not load image because of " + t.message + ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))
                            })
                        }(e, n) : function (t, e, i, r) {
                            var n = new c.Image, a = c.URL;
                            n.onload = function () {
                                e(null, n), a.revokeObjectURL(n.src)
                            }, n.onerror = function () {
                                return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))
                            };
                            var o = new c.Blob([new Uint8Array(t)], {type: "image/png"});
                            n.cacheControl = i, n.expires = r, n.src = t.byteLength ? a.createObjectURL(o) : "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="
                        }(e, n, i, r))
                    });
                    return {
                        cancel: function () {
                            r.cancel(), a()
                        }
                    }
                }, xr = br;

                function br(t, e, i) {
                    var r = this.cells = [];
                    if (t instanceof ArrayBuffer) {
                        this.arrayBuffer = t;
                        var n = new Int32Array(this.arrayBuffer);
                        t = n[0], this.d = (e = n[1]) + 2 * (i = n[2]);
                        for (var a = 0; a < this.d * this.d; a++) {
                            var o = n[3 + a], s = n[3 + a + 1];
                            r.push(o === s ? null : n.subarray(o, s))
                        }
                        var l = n[3 + r.length + 1];
                        this.keys = n.subarray(n[3 + r.length], l), this.bboxes = n.subarray(l), this.insert = this._insertReadonly
                    } else {
                        this.d = e + 2 * i;
                        for (var u = 0; u < this.d * this.d; u++) r.push([]);
                        this.keys = [], this.bboxes = []
                    }
                    this.n = e, this.extent = t, this.padding = i, this.scale = e / t, this.uid = 0;
                    var h = i / e * t;
                    this.min = -h, this.max = t + h
                }

                br.prototype.insert = function (t, e, i, r, n) {
                    this._forEachCell(e, i, r, n, this._insertCell, this.uid++), this.keys.push(t), this.bboxes.push(e), this.bboxes.push(i), this.bboxes.push(r), this.bboxes.push(n)
                }, br.prototype._insertReadonly = function () {
                    throw "Cannot insert into a GridIndex created from an ArrayBuffer."
                }, br.prototype._insertCell = function (t, e, i, r, n, a) {
                    this.cells[n].push(a)
                }, br.prototype.query = function (t, e, i, r, n) {
                    var a = this.min, o = this.max;
                    if (t <= a && e <= a && o <= i && o <= r && !n) return Array.prototype.slice.call(this.keys);
                    var s = [];
                    return this._forEachCell(t, e, i, r, this._queryCell, s, {}, n), s
                }, br.prototype._queryCell = function (t, e, i, r, n, a, o, s) {
                    var l = this.cells[n];
                    if (null !== l) for (var u = this.keys, h = this.bboxes, c = 0; c < l.length; c++) {
                        var p = l[c];
                        if (void 0 === o[p]) {
                            var f = 4 * p;
                            (s ? s(h[f + 0], h[f + 1], h[f + 2], h[f + 3]) : t <= h[f + 2] && e <= h[f + 3] && i >= h[f + 0] && r >= h[f + 1]) ? (o[p] = !0, a.push(u[p])) : o[p] = !1
                        }
                    }
                }, br.prototype._forEachCell = function (t, e, i, r, n, a, o, s) {
                    for (var l = this._convertToCellCoord(t), u = this._convertToCellCoord(e), h = this._convertToCellCoord(i), c = this._convertToCellCoord(r), p = l; p <= h; p++) for (var f = u; f <= c; f++) {
                        var d = this.d * f + p;
                        if ((!s || s(this._convertFromCellCoord(p), this._convertFromCellCoord(f), this._convertFromCellCoord(p + 1), this._convertFromCellCoord(f + 1))) && n.call(this, t, e, i, r, d, a, o, s)) return
                    }
                }, br.prototype._convertFromCellCoord = function (t) {
                    return (t - this.padding) / this.scale
                }, br.prototype._convertToCellCoord = function (t) {
                    return Math.max(0, Math.min(this.d - 1, Math.floor(t * this.scale) + this.padding))
                }, br.prototype.toArrayBuffer = function () {
                    if (this.arrayBuffer) return this.arrayBuffer;
                    for (var t = this.cells, e = 3 + this.cells.length + 1 + 1, i = 0, r = 0; r < this.cells.length; r++) i += this.cells[r].length;
                    var n = new Int32Array(e + i + this.keys.length + this.bboxes.length);
                    n[0] = this.extent, n[1] = this.n, n[2] = this.padding;
                    for (var a = e, o = 0; o < t.length; o++) {
                        var s = t[o];
                        n[3 + o] = a, n.set(s, a), a += s.length
                    }
                    return n[3 + t.length] = a, n.set(this.keys, a), n[3 + t.length + 1] = a += this.keys.length, n.set(this.bboxes, a), a += this.bboxes.length, n.buffer
                };
                var wr = z(function (t, e) {
                    var f = {
                        transparent: [0, 0, 0, 0],
                        aliceblue: [240, 248, 255, 1],
                        antiquewhite: [250, 235, 215, 1],
                        aqua: [0, 255, 255, 1],
                        aquamarine: [127, 255, 212, 1],
                        azure: [240, 255, 255, 1],
                        beige: [245, 245, 220, 1],
                        bisque: [255, 228, 196, 1],
                        black: [0, 0, 0, 1],
                        blanchedalmond: [255, 235, 205, 1],
                        blue: [0, 0, 255, 1],
                        blueviolet: [138, 43, 226, 1],
                        brown: [165, 42, 42, 1],
                        burlywood: [222, 184, 135, 1],
                        cadetblue: [95, 158, 160, 1],
                        chartreuse: [127, 255, 0, 1],
                        chocolate: [210, 105, 30, 1],
                        coral: [255, 127, 80, 1],
                        cornflowerblue: [100, 149, 237, 1],
                        cornsilk: [255, 248, 220, 1],
                        crimson: [220, 20, 60, 1],
                        cyan: [0, 255, 255, 1],
                        darkblue: [0, 0, 139, 1],
                        darkcyan: [0, 139, 139, 1],
                        darkgoldenrod: [184, 134, 11, 1],
                        darkgray: [169, 169, 169, 1],
                        darkgreen: [0, 100, 0, 1],
                        darkgrey: [169, 169, 169, 1],
                        darkkhaki: [189, 183, 107, 1],
                        darkmagenta: [139, 0, 139, 1],
                        darkolivegreen: [85, 107, 47, 1],
                        darkorange: [255, 140, 0, 1],
                        darkorchid: [153, 50, 204, 1],
                        darkred: [139, 0, 0, 1],
                        darksalmon: [233, 150, 122, 1],
                        darkseagreen: [143, 188, 143, 1],
                        darkslateblue: [72, 61, 139, 1],
                        darkslategray: [47, 79, 79, 1],
                        darkslategrey: [47, 79, 79, 1],
                        darkturquoise: [0, 206, 209, 1],
                        darkviolet: [148, 0, 211, 1],
                        deeppink: [255, 20, 147, 1],
                        deepskyblue: [0, 191, 255, 1],
                        dimgray: [105, 105, 105, 1],
                        dimgrey: [105, 105, 105, 1],
                        dodgerblue: [30, 144, 255, 1],
                        firebrick: [178, 34, 34, 1],
                        floralwhite: [255, 250, 240, 1],
                        forestgreen: [34, 139, 34, 1],
                        fuchsia: [255, 0, 255, 1],
                        gainsboro: [220, 220, 220, 1],
                        ghostwhite: [248, 248, 255, 1],
                        gold: [255, 215, 0, 1],
                        goldenrod: [218, 165, 32, 1],
                        gray: [128, 128, 128, 1],
                        green: [0, 128, 0, 1],
                        greenyellow: [173, 255, 47, 1],
                        grey: [128, 128, 128, 1],
                        honeydew: [240, 255, 240, 1],
                        hotpink: [255, 105, 180, 1],
                        indianred: [205, 92, 92, 1],
                        indigo: [75, 0, 130, 1],
                        ivory: [255, 255, 240, 1],
                        khaki: [240, 230, 140, 1],
                        lavender: [230, 230, 250, 1],
                        lavenderblush: [255, 240, 245, 1],
                        lawngreen: [124, 252, 0, 1],
                        lemonchiffon: [255, 250, 205, 1],
                        lightblue: [173, 216, 230, 1],
                        lightcoral: [240, 128, 128, 1],
                        lightcyan: [224, 255, 255, 1],
                        lightgoldenrodyellow: [250, 250, 210, 1],
                        lightgray: [211, 211, 211, 1],
                        lightgreen: [144, 238, 144, 1],
                        lightgrey: [211, 211, 211, 1],
                        lightpink: [255, 182, 193, 1],
                        lightsalmon: [255, 160, 122, 1],
                        lightseagreen: [32, 178, 170, 1],
                        lightskyblue: [135, 206, 250, 1],
                        lightslategray: [119, 136, 153, 1],
                        lightslategrey: [119, 136, 153, 1],
                        lightsteelblue: [176, 196, 222, 1],
                        lightyellow: [255, 255, 224, 1],
                        lime: [0, 255, 0, 1],
                        limegreen: [50, 205, 50, 1],
                        linen: [250, 240, 230, 1],
                        magenta: [255, 0, 255, 1],
                        maroon: [128, 0, 0, 1],
                        mediumaquamarine: [102, 205, 170, 1],
                        mediumblue: [0, 0, 205, 1],
                        mediumorchid: [186, 85, 211, 1],
                        mediumpurple: [147, 112, 219, 1],
                        mediumseagreen: [60, 179, 113, 1],
                        mediumslateblue: [123, 104, 238, 1],
                        mediumspringgreen: [0, 250, 154, 1],
                        mediumturquoise: [72, 209, 204, 1],
                        mediumvioletred: [199, 21, 133, 1],
                        midnightblue: [25, 25, 112, 1],
                        mintcream: [245, 255, 250, 1],
                        mistyrose: [255, 228, 225, 1],
                        moccasin: [255, 228, 181, 1],
                        navajowhite: [255, 222, 173, 1],
                        navy: [0, 0, 128, 1],
                        oldlace: [253, 245, 230, 1],
                        olive: [128, 128, 0, 1],
                        olivedrab: [107, 142, 35, 1],
                        orange: [255, 165, 0, 1],
                        orangered: [255, 69, 0, 1],
                        orchid: [218, 112, 214, 1],
                        palegoldenrod: [238, 232, 170, 1],
                        palegreen: [152, 251, 152, 1],
                        paleturquoise: [175, 238, 238, 1],
                        palevioletred: [219, 112, 147, 1],
                        papayawhip: [255, 239, 213, 1],
                        peachpuff: [255, 218, 185, 1],
                        peru: [205, 133, 63, 1],
                        pink: [255, 192, 203, 1],
                        plum: [221, 160, 221, 1],
                        powderblue: [176, 224, 230, 1],
                        purple: [128, 0, 128, 1],
                        rebeccapurple: [102, 51, 153, 1],
                        red: [255, 0, 0, 1],
                        rosybrown: [188, 143, 143, 1],
                        royalblue: [65, 105, 225, 1],
                        saddlebrown: [139, 69, 19, 1],
                        salmon: [250, 128, 114, 1],
                        sandybrown: [244, 164, 96, 1],
                        seagreen: [46, 139, 87, 1],
                        seashell: [255, 245, 238, 1],
                        sienna: [160, 82, 45, 1],
                        silver: [192, 192, 192, 1],
                        skyblue: [135, 206, 235, 1],
                        slateblue: [106, 90, 205, 1],
                        slategray: [112, 128, 144, 1],
                        slategrey: [112, 128, 144, 1],
                        snow: [255, 250, 250, 1],
                        springgreen: [0, 255, 127, 1],
                        steelblue: [70, 130, 180, 1],
                        tan: [210, 180, 140, 1],
                        teal: [0, 128, 128, 1],
                        thistle: [216, 191, 216, 1],
                        tomato: [255, 99, 71, 1],
                        turquoise: [64, 224, 208, 1],
                        violet: [238, 130, 238, 1],
                        wheat: [245, 222, 179, 1],
                        white: [255, 255, 255, 1],
                        whitesmoke: [245, 245, 245, 1],
                        yellow: [255, 255, 0, 1],
                        yellowgreen: [154, 205, 50, 1]
                    };

                    function d(t) {
                        return (t = Math.round(t)) < 0 ? 0 : t > 255 ? 255 : t
                    }

                    function m(t) {
                        return d("%" === t[t.length - 1] ? parseFloat(t) / 100 * 255 : parseInt(t))
                    }

                    function y(t) {
                        return (e = "%" === t[t.length - 1] ? parseFloat(t) / 100 : parseFloat(t)) < 0 ? 0 : e > 1 ? 1 : e;
                        var e
                    }

                    function g(t, e, i) {
                        return i < 0 ? i += 1 : i > 1 && (i -= 1), 6 * i < 1 ? t + (e - t) * i * 6 : 2 * i < 1 ? e : 3 * i < 2 ? t + (e - t) * (2 / 3 - i) * 6 : t
                    }

                    try {
                        e.parseCSSColor = function (t) {
                            var e, i = t.replace(/ /g, "").toLowerCase();
                            if (i in f) return f[i].slice();
                            if ("#" === i[0]) return 4 === i.length ? (e = parseInt(i.substr(1), 16)) >= 0 && e <= 4095 ? [(3840 & e) >> 4 | (3840 & e) >> 8, 240 & e | (240 & e) >> 4, 15 & e | (15 & e) << 4, 1] : null : 7 === i.length && (e = parseInt(i.substr(1), 16)) >= 0 && e <= 16777215 ? [(16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 1] : null;
                            var r = i.indexOf("("), n = i.indexOf(")");
                            if (-1 !== r && n + 1 === i.length) {
                                var a = i.substr(0, r), o = i.substr(r + 1, n - (r + 1)).split(","), s = 1;
                                switch (a) {
                                    case"rgba":
                                        if (4 !== o.length) return null;
                                        s = y(o.pop());
                                    case"rgb":
                                        return 3 !== o.length ? null : [m(o[0]), m(o[1]), m(o[2]), s];
                                    case"hsla":
                                        if (4 !== o.length) return null;
                                        s = y(o.pop());
                                    case"hsl":
                                        if (3 !== o.length) return null;
                                        var l = (parseFloat(o[0]) % 360 + 360) % 360 / 360, u = y(o[1]), h = y(o[2]),
                                            c = h <= .5 ? h * (u + 1) : h + u - h * u, p = 2 * h - c;
                                        return [d(255 * g(p, c, l + 1 / 3)), d(255 * g(p, c, l)), d(255 * g(p, c, l - 1 / 3)), s];
                                    default:
                                        return null
                                }
                            }
                            return null
                        }
                    } catch (t) {
                    }
                }).parseCSSColor, S = function (t, e, i, r) {
                    void 0 === r && (r = 1), this.r = t, this.g = e, this.b = i, this.a = r
                };

                function Mr(t) {
                    for (var e = [], i = arguments.length - 1; i-- > 0;) e[i] = arguments[i + 1];
                    for (var r = 0, n = e; r < n.length; r += 1) {
                        var a = n[r];
                        for (var o in a) t[o] = a[o]
                    }
                    return t
                }

                S.parse = function (t) {
                    if (t) {
                        if (t instanceof S) return t;
                        if ("string" == typeof t) {
                            var e = wr(t);
                            if (e) return new S(e[0] / 255 * e[3], e[1] / 255 * e[3], e[2] / 255 * e[3], e[3])
                        }
                    }
                }, S.prototype.toString = function () {
                    var t = this.toArray(), e = t[1], i = t[2], r = t[3];
                    return "rgba(" + Math.round(t[0]) + "," + Math.round(e) + "," + Math.round(i) + "," + r + ")"
                }, S.prototype.toArray = function () {
                    var t = this.a;
                    return 0 === t ? [0, 0, 0, 0] : [255 * this.r / t, 255 * this.g / t, 255 * this.b / t, t]
                }, S.black = new S(0, 0, 0, 1), S.white = new S(1, 1, 1, 1), S.transparent = new S(0, 0, 0, 0), S.red = new S(1, 0, 0, 1);
                var Sr = function (i) {
                    function t(t, e) {
                        i.call(this, e), this.message = e, this.key = t
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t
                }(Error), Er = function (t, e) {
                    void 0 === e && (e = []), this.parent = t, this.bindings = {};
                    for (var i = 0, r = e; i < r.length; i += 1) {
                        var n = r[i];
                        this.bindings[n[0]] = n[1]
                    }
                };
                Er.prototype.concat = function (t) {
                    return new Er(this, t)
                }, Er.prototype.get = function (t) {
                    if (this.bindings[t]) return this.bindings[t];
                    if (this.parent) return this.parent.get(t);
                    throw new Error(t + " not found in scope.")
                }, Er.prototype.has = function (t) {
                    return !!this.bindings[t] || !!this.parent && this.parent.has(t)
                };
                var Ir = {kind: "null"}, y = {kind: "number"}, f = {kind: "string"}, p = {kind: "boolean"},
                    Tr = {kind: "color"}, Cr = {kind: "object"}, g = {kind: "value"}, Pr = {kind: "collator"},
                    Ar = {kind: "formatted"}, zr = {kind: "resolvedImage"};

                function kr(t, e) {
                    return {kind: "array", itemType: t, N: e}
                }

                function T(t) {
                    if ("array" === t.kind) {
                        var e = T(t.itemType);
                        return "number" == typeof t.N ? "array<" + e + ", " + t.N + ">" : "value" === t.itemType.kind ? "array" : "array<" + e + ">"
                    }
                    return t.kind
                }

                var Lr = [Ir, y, f, p, Tr, Ar, Cr, kr(g), zr];

                function Dr(t, e) {
                    if ("error" === e.kind) return null;
                    if ("array" === t.kind) {
                        if ("array" === e.kind && (0 === e.N && "value" === e.itemType.kind || !Dr(t.itemType, e.itemType)) && ("number" != typeof t.N || t.N === e.N)) return null
                    } else {
                        if (t.kind === e.kind) return null;
                        if ("value" === t.kind) for (var i = 0, r = Lr; i < r.length; i += 1) if (!Dr(r[i], e)) return null
                    }
                    return "Expected " + T(t) + " but found " + T(e) + " instead."
                }

                function Rr(e, t) {
                    return t.some(function (t) {
                        return t.kind === e.kind
                    })
                }

                function Br(e, t) {
                    return t.some(function (t) {
                        return "null" === t ? null === e : "array" === t ? Array.isArray(e) : "object" === t ? e && !Array.isArray(e) && "object" == typeof e : t === typeof e
                    })
                }

                var Or = function (t, e, i) {
                    this.sensitivity = t ? e ? "variant" : "case" : e ? "accent" : "base", this.locale = i, this.collator = new Intl.Collator(this.locale ? this.locale : [], {
                        sensitivity: this.sensitivity,
                        usage: "search"
                    })
                };
                Or.prototype.compare = function (t, e) {
                    return this.collator.compare(t, e)
                }, Or.prototype.resolvedLocale = function () {
                    return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale
                };
                var Fr = function (t, e, i, r, n) {
                    this.text = t, this.image = e, this.scale = i, this.fontStack = r, this.textColor = n
                }, Ur = function (t) {
                    this.sections = t
                };
                Ur.fromString = function (t) {
                    return new Ur([new Fr(t, null, null, null, null)])
                }, Ur.prototype.isEmpty = function () {
                    return 0 === this.sections.length || !this.sections.some(function (t) {
                        return 0 !== t.text.length || t.image && 0 !== t.image.name.length
                    })
                }, Ur.factory = function (t) {
                    return t instanceof Ur ? t : Ur.fromString(t)
                }, Ur.prototype.toString = function () {
                    return 0 === this.sections.length ? "" : this.sections.map(function (t) {
                        return t.text
                    }).join("")
                }, Ur.prototype.serialize = function () {
                    for (var t = ["format"], e = 0, i = this.sections; e < i.length; e += 1) {
                        var r = i[e];
                        if (r.image) t.push(["image", r.image.name]); else {
                            t.push(r.text);
                            var n = {};
                            r.fontStack && (n["text-font"] = ["literal", r.fontStack.split(",")]), r.scale && (n["font-scale"] = r.scale), r.textColor && (n["text-color"] = ["rgba"].concat(r.textColor.toArray())), t.push(n)
                        }
                    }
                    return t
                };
                var Nr = function (t) {
                    this.name = t.name, this.available = t.available
                };

                function Vr(t, e, i, r) {
                    return "number" == typeof t && t >= 0 && t <= 255 && "number" == typeof e && e >= 0 && e <= 255 && "number" == typeof i && i >= 0 && i <= 255 ? void 0 === r || "number" == typeof r && r >= 0 && r <= 1 ? null : "Invalid rgba value [" + [t, e, i, r].join(", ") + "]: 'a' must be between 0 and 1." : "Invalid rgba value [" + ("number" == typeof r ? [t, e, i, r] : [t, e, i]).join(", ") + "]: 'r', 'g', and 'b' must be between 0 and 255."
                }

                function jr(t) {
                    if (null === t) return !0;
                    if ("string" == typeof t) return !0;
                    if ("boolean" == typeof t) return !0;
                    if ("number" == typeof t) return !0;
                    if (t instanceof S) return !0;
                    if (t instanceof Or) return !0;
                    if (t instanceof Ur) return !0;
                    if (t instanceof Nr) return !0;
                    if (Array.isArray(t)) {
                        for (var e = 0, i = t; e < i.length; e += 1) if (!jr(i[e])) return !1;
                        return !0
                    }
                    if ("object" == typeof t) {
                        for (var r in t) if (!jr(t[r])) return !1;
                        return !0
                    }
                    return !1
                }

                function v(t) {
                    if (null === t) return Ir;
                    if ("string" == typeof t) return f;
                    if ("boolean" == typeof t) return p;
                    if ("number" == typeof t) return y;
                    if (t instanceof S) return Tr;
                    if (t instanceof Or) return Pr;
                    if (t instanceof Ur) return Ar;
                    if (t instanceof Nr) return zr;
                    if (Array.isArray(t)) {
                        for (var e, i = t.length, r = 0, n = t; r < n.length; r += 1) {
                            var a = v(n[r]);
                            if (e) {
                                if (e === a) continue;
                                e = g;
                                break
                            }
                            e = a
                        }
                        return kr(e || g, i)
                    }
                    return Cr
                }

                function qr(t) {
                    var e = typeof t;
                    return null === t ? "" : "string" === e || "number" === e || "boolean" === e ? String(t) : t instanceof S || t instanceof Ur || t instanceof Nr ? t.toString() : JSON.stringify(t)
                }

                Nr.prototype.toString = function () {
                    return this.name
                }, Nr.fromString = function (t) {
                    return t ? new Nr({name: t, available: !1}) : null
                }, Nr.prototype.serialize = function () {
                    return ["image", this.name]
                };
                var Gr = function (t, e) {
                    this.type = t, this.value = e
                };
                Gr.parse = function (t, e) {
                    if (2 !== t.length) return e.error("'literal' expression requires exactly one argument, but found " + (t.length - 1) + " instead.");
                    if (!jr(t[1])) return e.error("invalid value");
                    var i = t[1], r = v(i), n = e.expectedType;
                    return "array" !== r.kind || 0 !== r.N || !n || "array" !== n.kind || "number" == typeof n.N && 0 !== n.N || (r = n), new Gr(r, i)
                }, Gr.prototype.evaluate = function () {
                    return this.value
                }, Gr.prototype.eachChild = function () {
                }, Gr.prototype.outputDefined = function () {
                    return !0
                }, Gr.prototype.serialize = function () {
                    return "array" === this.type.kind || "object" === this.type.kind ? ["literal", this.value] : this.value instanceof S ? ["rgba"].concat(this.value.toArray()) : this.value instanceof Ur ? this.value.serialize() : this.value
                };
                var Zr = function (t) {
                    this.name = "ExpressionEvaluationError", this.message = t
                };
                Zr.prototype.toJSON = function () {
                    return this.message
                };
                var Wr = {string: f, number: y, boolean: p, object: Cr}, Xr = function (t, e) {
                    this.type = t, this.args = e
                };
                Xr.parse = function (t, e) {
                    if (t.length < 2) return e.error("Expected at least one argument.");
                    var i, r = 1, n = t[0];
                    if ("array" === n) {
                        var a, o;
                        if (t.length > 2) {
                            var s = t[1];
                            if ("string" != typeof s || !(s in Wr) || "object" === s) return e.error('The item type argument of "array" must be one of string, number, boolean', 1);
                            a = Wr[s], r++
                        } else a = g;
                        if (t.length > 3) {
                            if (null !== t[2] && ("number" != typeof t[2] || t[2] < 0 || t[2] !== Math.floor(t[2]))) return e.error('The length argument to "array" must be a positive integer literal', 2);
                            o = t[2], r++
                        }
                        i = kr(a, o)
                    } else i = Wr[n];
                    for (var l = []; r < t.length; r++) {
                        var u = e.parse(t[r], r, g);
                        if (!u) return null;
                        l.push(u)
                    }
                    return new Xr(i, l)
                }, Xr.prototype.evaluate = function (t) {
                    for (var e = 0; e < this.args.length; e++) {
                        var i = this.args[e].evaluate(t);
                        if (!Dr(this.type, v(i))) return i;
                        if (e === this.args.length - 1) throw new Zr("Expected value to be of type " + T(this.type) + ", but found " + T(v(i)) + " instead.")
                    }
                    return null
                }, Xr.prototype.eachChild = function (t) {
                    this.args.forEach(t)
                }, Xr.prototype.outputDefined = function () {
                    return this.args.every(function (t) {
                        return t.outputDefined()
                    })
                }, Xr.prototype.serialize = function () {
                    var t = this.type, e = [t.kind];
                    if ("array" === t.kind) {
                        var i = t.itemType;
                        if ("string" === i.kind || "number" === i.kind || "boolean" === i.kind) {
                            e.push(i.kind);
                            var r = t.N;
                            ("number" == typeof r || this.args.length > 1) && e.push(r)
                        }
                    }
                    return e.concat(this.args.map(function (t) {
                        return t.serialize()
                    }))
                };
                var Hr = function (t) {
                    this.type = Ar, this.sections = t
                };
                Hr.parse = function (t, e) {
                    if (t.length < 2) return e.error("Expected at least one argument.");
                    var i = t[1];
                    if (!Array.isArray(i) && "object" == typeof i) return e.error("First argument must be an image or text section.");
                    for (var r = [], n = !1, a = 1; a <= t.length - 1; ++a) {
                        var o = t[a];
                        if (n && "object" == typeof o && !Array.isArray(o)) {
                            n = !1;
                            var s = null;
                            if (o["font-scale"] && !(s = e.parse(o["font-scale"], 1, y))) return null;
                            var l = null;
                            if (o["text-font"] && !(l = e.parse(o["text-font"], 1, kr(f)))) return null;
                            var u = null;
                            if (o["text-color"] && !(u = e.parse(o["text-color"], 1, Tr))) return null;
                            var h = r[r.length - 1];
                            h.scale = s, h.font = l, h.textColor = u
                        } else {
                            var c = e.parse(t[a], 1, g);
                            if (!c) return null;
                            var p = c.type.kind;
                            if ("string" !== p && "value" !== p && "null" !== p && "resolvedImage" !== p) return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
                            n = !0, r.push({content: c, scale: null, font: null, textColor: null})
                        }
                    }
                    return new Hr(r)
                }, Hr.prototype.evaluate = function (i) {
                    return new Ur(this.sections.map(function (t) {
                        var e = t.content.evaluate(i);
                        return v(e) === zr ? new Fr("", e, null, null, null) : new Fr(qr(e), null, t.scale ? t.scale.evaluate(i) : null, t.font ? t.font.evaluate(i).join(",") : null, t.textColor ? t.textColor.evaluate(i) : null)
                    }))
                }, Hr.prototype.eachChild = function (t) {
                    for (var e = 0, i = this.sections; e < i.length; e += 1) {
                        var r = i[e];
                        t(r.content), r.scale && t(r.scale), r.font && t(r.font), r.textColor && t(r.textColor)
                    }
                }, Hr.prototype.outputDefined = function () {
                    return !1
                }, Hr.prototype.serialize = function () {
                    for (var t = ["format"], e = 0, i = this.sections; e < i.length; e += 1) {
                        var r = i[e];
                        t.push(r.content.serialize());
                        var n = {};
                        r.scale && (n["font-scale"] = r.scale.serialize()), r.font && (n["text-font"] = r.font.serialize()), r.textColor && (n["text-color"] = r.textColor.serialize()), t.push(n)
                    }
                    return t
                };
                var Kr = function (t) {
                    this.type = zr, this.input = t
                };
                Kr.parse = function (t, e) {
                    if (2 !== t.length) return e.error("Expected two arguments.");
                    var i = e.parse(t[1], 1, f);
                    return i ? new Kr(i) : e.error("No image name provided.")
                }, Kr.prototype.evaluate = function (t) {
                    var e = this.input.evaluate(t), i = Nr.fromString(e);
                    return i && t.availableImages && (i.available = t.availableImages.indexOf(e) > -1), i
                }, Kr.prototype.eachChild = function (t) {
                    t(this.input)
                }, Kr.prototype.outputDefined = function () {
                    return !1
                }, Kr.prototype.serialize = function () {
                    return ["image", this.input.serialize()]
                };
                var Yr = {"to-boolean": p, "to-color": Tr, "to-number": y, "to-string": f}, Jr = function (t, e) {
                    this.type = t, this.args = e
                };
                Jr.parse = function (t, e) {
                    if (t.length < 2) return e.error("Expected at least one argument.");
                    var i = t[0];
                    if (("to-boolean" === i || "to-string" === i) && 2 !== t.length) return e.error("Expected one argument.");
                    for (var r = Yr[i], n = [], a = 1; a < t.length; a++) {
                        var o = e.parse(t[a], a, g);
                        if (!o) return null;
                        n.push(o)
                    }
                    return new Jr(r, n)
                }, Jr.prototype.evaluate = function (t) {
                    if ("boolean" === this.type.kind) return Boolean(this.args[0].evaluate(t));
                    if ("color" === this.type.kind) {
                        for (var e, i, r = 0, n = this.args; r < n.length; r += 1) {
                            if (i = null, (e = n[r].evaluate(t)) instanceof S) return e;
                            if ("string" == typeof e) {
                                var a = t.parseColor(e);
                                if (a) return a
                            } else if (Array.isArray(e) && !(i = e.length < 3 || e.length > 4 ? "Invalid rbga value " + JSON.stringify(e) + ": expected an array containing either three or four numeric values." : Vr(e[0], e[1], e[2], e[3]))) return new S(e[0] / 255, e[1] / 255, e[2] / 255, e[3])
                        }
                        throw new Zr(i || "Could not parse color from value '" + ("string" == typeof e ? e : String(JSON.stringify(e))) + "'")
                    }
                    if ("number" === this.type.kind) {
                        for (var o = null, s = 0, l = this.args; s < l.length; s += 1) {
                            if (null === (o = l[s].evaluate(t))) return 0;
                            var u = Number(o);
                            if (!isNaN(u)) return u
                        }
                        throw new Zr("Could not convert " + JSON.stringify(o) + " to number.")
                    }
                    return "formatted" === this.type.kind ? Ur.fromString(qr(this.args[0].evaluate(t))) : "resolvedImage" === this.type.kind ? Nr.fromString(qr(this.args[0].evaluate(t))) : qr(this.args[0].evaluate(t))
                }, Jr.prototype.eachChild = function (t) {
                    this.args.forEach(t)
                }, Jr.prototype.outputDefined = function () {
                    return this.args.every(function (t) {
                        return t.outputDefined()
                    })
                }, Jr.prototype.serialize = function () {
                    if ("formatted" === this.type.kind) return new Hr([{
                        content: this.args[0],
                        scale: null,
                        font: null,
                        textColor: null
                    }]).serialize();
                    if ("resolvedImage" === this.type.kind) return new Kr(this.args[0]).serialize();
                    var e = ["to-" + this.type.kind];
                    return this.eachChild(function (t) {
                        e.push(t.serialize())
                    }), e
                };
                var Qr = ["Unknown", "Point", "LineString", "Polygon"], $r = function () {
                    this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null
                };
                $r.prototype.id = function () {
                    return this.feature && "id" in this.feature ? this.feature.id : null
                }, $r.prototype.geometryType = function () {
                    return this.feature ? "number" == typeof this.feature.type ? Qr[this.feature.type] : this.feature.type : null
                }, $r.prototype.geometry = function () {
                    return this.feature && "geometry" in this.feature ? this.feature.geometry : null
                }, $r.prototype.canonicalID = function () {
                    return this.canonical
                }, $r.prototype.properties = function () {
                    return this.feature && this.feature.properties || {}
                }, $r.prototype.parseColor = function (t) {
                    var e = this._parseColorCache[t];
                    return e || (e = this._parseColorCache[t] = S.parse(t)), e
                };
                var tn = function (t, e, i, r) {
                    this.name = t, this.type = e, this._evaluate = i, this.args = r
                };
                tn.prototype.evaluate = function (t) {
                    return this._evaluate(t, this.args)
                }, tn.prototype.eachChild = function (t) {
                    this.args.forEach(t)
                }, tn.prototype.outputDefined = function () {
                    return !1
                }, tn.prototype.serialize = function () {
                    return [this.name].concat(this.args.map(function (t) {
                        return t.serialize()
                    }))
                }, tn.parse = function (i, t) {
                    var e, r = i[0], n = tn.definitions[r];
                    if (!n) return t.error('Unknown expression "' + r + '". If you wanted a literal array, use ["literal", [...]].', 0);
                    for (var a = Array.isArray(n) ? n[0] : n.type, o = Array.isArray(n) ? [[n[1], n[2]]] : n.overloads, s = o.filter(function (t) {
                        var e = t[0];
                        return !Array.isArray(e) || e.length === i.length - 1
                    }), l = null, u = 0, h = s; u < h.length; u += 1) {
                        var c = h[u], p = c[0], f = c[1];
                        l = new Mn(t.registry, t.path, null, t.scope);
                        for (var d = [], m = !1, y = 1; y < i.length; y++) {
                            var g = i[y], _ = Array.isArray(p) ? p[y - 1] : p.type, v = l.parse(g, 1 + d.length, _);
                            if (!v) {
                                m = !0;
                                break
                            }
                            d.push(v)
                        }
                        if (!m) if (Array.isArray(p) && p.length !== d.length) l.error("Expected " + p.length + " arguments, but found " + d.length + " instead."); else {
                            for (var x = 0; x < d.length; x++) {
                                var b = Array.isArray(p) ? p[x] : p.type, w = d[x];
                                l.concat(x + 1).checkSubtype(b, w.type)
                            }
                            if (0 === l.errors.length) return new tn(r, a, f, d)
                        }
                    }
                    if (1 === s.length) (e = t.errors).push.apply(e, l.errors); else {
                        for (var M = (s.length ? s : o).map(function (t) {
                            var e;
                            return e = t[0], Array.isArray(e) ? "(" + e.map(T).join(", ") + ")" : "(" + T(e.type) + "...)"
                        }).join(" | "), S = [], E = 1; E < i.length; E++) {
                            var I = t.parse(i[E], 1 + S.length);
                            if (!I) return null;
                            S.push(T(I.type))
                        }
                        t.error("Expected arguments of type " + M + ", but found (" + S.join(", ") + ") instead.")
                    }
                    return null
                }, tn.register = function (t, e) {
                    for (var i in tn.definitions = e, e) t[i] = tn
                };
                var en = function (t, e, i) {
                    this.type = Pr, this.locale = i, this.caseSensitive = t, this.diacriticSensitive = e
                };

                function rn(t, e) {
                    t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.max(t[2], e[0]), t[3] = Math.max(t[3], e[1])
                }

                function nn(t, e) {
                    return !(t[0] <= e[0] || t[2] >= e[2] || t[1] <= e[1] || t[3] >= e[3])
                }

                function an(t, e) {
                    var i = (180 + t[0]) / 360,
                        r = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360))) / 360,
                        n = Math.pow(2, e.z);
                    return [Math.round(i * n * 8192), Math.round(r * n * 8192)]
                }

                function on(t, e, i) {
                    return e[1] > t[1] != i[1] > t[1] && t[0] < (i[0] - e[0]) * (t[1] - e[1]) / (i[1] - e[1]) + e[0]
                }

                function sn(t, e) {
                    for (var i, r, n, a, o, s, l, u = !1, h = 0, c = e.length; h < c; h++) for (var p = e[h], f = 0, d = p.length; f < d - 1; f++) {
                        if ((a = (i = t)[0] - (r = p[f])[0]) * (l = i[1] - (n = p[f + 1])[1]) - (s = i[0] - n[0]) * (o = i[1] - r[1]) == 0 && a * s <= 0 && o * l <= 0) return !1;
                        on(t, p[f], p[f + 1]) && (u = !u)
                    }
                    return u
                }

                function ln(t, e) {
                    for (var i = 0; i < e.length; i++) if (sn(t, e[i])) return !0;
                    return !1
                }

                function un(t, e, i, r) {
                    var n = r[0] - i[0], a = r[1] - i[1], o = (t[0] - i[0]) * a - n * (t[1] - i[1]),
                        s = (e[0] - i[0]) * a - n * (e[1] - i[1]);
                    return o > 0 && s < 0 || o < 0 && s > 0
                }

                function hn(t, e, i) {
                    for (var r = 0, n = i; r < n.length; r += 1) for (var a = n[r], o = 0; o < a.length - 1; ++o) if (0 != (c = [(h = a[o + 1])[0] - (u = a[o])[0], h[1] - u[1]])[0] * (p = [(l = e)[0] - (s = t)[0], l[1] - s[1]])[1] - c[1] * p[0] && un(s, l, u, h) && un(u, h, s, l)) return !0;
                    var s, l, u, h, c, p;
                    return !1
                }

                function cn(t, e) {
                    for (var i = 0; i < t.length; ++i) if (!sn(t[i], e)) return !1;
                    for (var r = 0; r < t.length - 1; ++r) if (hn(t[r], t[r + 1], e)) return !1;
                    return !0
                }

                function pn(t, e) {
                    for (var i = 0; i < e.length; i++) if (cn(t, e[i])) return !0;
                    return !1
                }

                function fn(t, e, i) {
                    for (var r = [], n = 0; n < t.length; n++) {
                        for (var a = [], o = 0; o < t[n].length; o++) {
                            var s = an(t[n][o], i);
                            rn(e, s), a.push(s)
                        }
                        r.push(a)
                    }
                    return r
                }

                function dn(t, e, i) {
                    for (var r = [], n = 0; n < t.length; n++) {
                        var a = fn(t[n], e, i);
                        r.push(a)
                    }
                    return r
                }

                function mn(t, e, i, r) {
                    if (t[0] < i[0] || t[0] > i[2]) {
                        var n = .5 * r, a = t[0] - i[0] > n ? -r : i[0] - t[0] > n ? r : 0;
                        0 === a && (a = t[0] - i[2] > n ? -r : i[2] - t[0] > n ? r : 0), t[0] += a
                    }
                    rn(e, t)
                }

                function yn(t, e, i, r) {
                    for (var n = 8192 * Math.pow(2, r.z), a = [8192 * r.x, 8192 * r.y], o = [], s = 0, l = t; s < l.length; s += 1) for (var u = 0, h = l[s]; u < h.length; u += 1) {
                        var c = h[u], p = [c.x + a[0], c.y + a[1]];
                        mn(p, e, i, n), o.push(p)
                    }
                    return o
                }

                function gn(t, e, i, r) {
                    for (var n, a = 8192 * Math.pow(2, r.z), o = [8192 * r.x, 8192 * r.y], s = [], l = 0, u = t; l < u.length; l += 1) {
                        for (var h = [], c = 0, p = u[l]; c < p.length; c += 1) {
                            var f = p[c], d = [f.x + o[0], f.y + o[1]];
                            rn(e, d), h.push(d)
                        }
                        s.push(h)
                    }
                    if (e[2] - e[0] <= a / 2) {
                        (n = e)[0] = n[1] = 1 / 0, n[2] = n[3] = -1 / 0;
                        for (var m = 0, y = s; m < y.length; m += 1) for (var g = 0, _ = y[m]; g < _.length; g += 1) mn(_[g], e, i, a)
                    }
                    return s
                }

                en.parse = function (t, e) {
                    if (2 !== t.length) return e.error("Expected one argument.");
                    var i = t[1];
                    if ("object" != typeof i || Array.isArray(i)) return e.error("Collator options argument must be an object.");
                    var r = e.parse(void 0 !== i["case-sensitive"] && i["case-sensitive"], 1, p);
                    if (!r) return null;
                    var n = e.parse(void 0 !== i["diacritic-sensitive"] && i["diacritic-sensitive"], 1, p);
                    if (!n) return null;
                    var a = null;
                    return i.locale && !(a = e.parse(i.locale, 1, f)) ? null : new en(r, n, a)
                }, en.prototype.evaluate = function (t) {
                    return new Or(this.caseSensitive.evaluate(t), this.diacriticSensitive.evaluate(t), this.locale ? this.locale.evaluate(t) : null)
                }, en.prototype.eachChild = function (t) {
                    t(this.caseSensitive), t(this.diacriticSensitive), this.locale && t(this.locale)
                }, en.prototype.outputDefined = function () {
                    return !1
                }, en.prototype.serialize = function () {
                    var t = {};
                    return t["case-sensitive"] = this.caseSensitive.serialize(), t["diacritic-sensitive"] = this.diacriticSensitive.serialize(), this.locale && (t.locale = this.locale.serialize()), ["collator", t]
                };
                var _n = function (t, e) {
                    this.type = p, this.geojson = t, this.geometries = e
                };

                function vn(t) {
                    if (t instanceof tn) {
                        if ("get" === t.name && 1 === t.args.length) return !1;
                        if ("feature-state" === t.name) return !1;
                        if ("has" === t.name && 1 === t.args.length) return !1;
                        if ("properties" === t.name || "geometry-type" === t.name || "id" === t.name) return !1;
                        if (/^filter-/.test(t.name)) return !1
                    }
                    if (t instanceof _n) return !1;
                    var e = !0;
                    return t.eachChild(function (t) {
                        e && !vn(t) && (e = !1)
                    }), e
                }

                function xn(t) {
                    if (t instanceof tn && "feature-state" === t.name) return !1;
                    var e = !0;
                    return t.eachChild(function (t) {
                        e && !xn(t) && (e = !1)
                    }), e
                }

                function bn(t, e) {
                    if (t instanceof tn && e.indexOf(t.name) >= 0) return !1;
                    var i = !0;
                    return t.eachChild(function (t) {
                        i && !bn(t, e) && (i = !1)
                    }), i
                }

                _n.parse = function (t, e) {
                    if (2 !== t.length) return e.error("'within' expression requires exactly one argument, but found " + (t.length - 1) + " instead.");
                    if (jr(t[1])) {
                        var i = t[1];
                        if ("FeatureCollection" === i.type) for (var r = 0; r < i.features.length; ++r) {
                            var n = i.features[r].geometry.type;
                            if ("Polygon" === n || "MultiPolygon" === n) return new _n(i, i.features[r].geometry)
                        } else if ("Feature" === i.type) {
                            var a = i.geometry.type;
                            if ("Polygon" === a || "MultiPolygon" === a) return new _n(i, i.geometry)
                        } else if ("Polygon" === i.type || "MultiPolygon" === i.type) return new _n(i, i)
                    }
                    return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")
                }, _n.prototype.evaluate = function (t) {
                    if (null != t.geometry() && null != t.canonicalID()) {
                        if ("Point" === t.geometryType()) return function (t, e) {
                            var i = [1 / 0, 1 / 0, -1 / 0, -1 / 0], r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                                n = t.canonicalID();
                            if ("Polygon" === e.type) {
                                var a = fn(e.coordinates, r, n), o = yn(t.geometry(), i, r, n);
                                if (!nn(i, r)) return !1;
                                for (var s = 0, l = o; s < l.length; s += 1) if (!sn(l[s], a)) return !1
                            }
                            if ("MultiPolygon" === e.type) {
                                var u = dn(e.coordinates, r, n), h = yn(t.geometry(), i, r, n);
                                if (!nn(i, r)) return !1;
                                for (var c = 0, p = h; c < p.length; c += 1) if (!ln(p[c], u)) return !1
                            }
                            return !0
                        }(t, this.geometries);
                        if ("LineString" === t.geometryType()) return function (t, e) {
                            var i = [1 / 0, 1 / 0, -1 / 0, -1 / 0], r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                                n = t.canonicalID();
                            if ("Polygon" === e.type) {
                                var a = fn(e.coordinates, r, n), o = gn(t.geometry(), i, r, n);
                                if (!nn(i, r)) return !1;
                                for (var s = 0, l = o; s < l.length; s += 1) if (!cn(l[s], a)) return !1
                            }
                            if ("MultiPolygon" === e.type) {
                                var u = dn(e.coordinates, r, n), h = gn(t.geometry(), i, r, n);
                                if (!nn(i, r)) return !1;
                                for (var c = 0, p = h; c < p.length; c += 1) if (!pn(p[c], u)) return !1
                            }
                            return !0
                        }(t, this.geometries)
                    }
                    return !1
                }, _n.prototype.eachChild = function () {
                }, _n.prototype.outputDefined = function () {
                    return !0
                }, _n.prototype.serialize = function () {
                    return ["within", this.geojson]
                };
                var wn = function (t, e) {
                    this.type = e.type, this.name = t, this.boundExpression = e
                };
                wn.parse = function (t, e) {
                    if (2 !== t.length || "string" != typeof t[1]) return e.error("'var' expression requires exactly one string literal argument.");
                    var i = t[1];
                    return e.scope.has(i) ? new wn(i, e.scope.get(i)) : e.error('Unknown variable "' + i + '". Make sure "' + i + '" has been bound in an enclosing "let" expression before using it.', 1)
                }, wn.prototype.evaluate = function (t) {
                    return this.boundExpression.evaluate(t)
                }, wn.prototype.eachChild = function () {
                }, wn.prototype.outputDefined = function () {
                    return !1
                }, wn.prototype.serialize = function () {
                    return ["var", this.name]
                };
                var Mn = function (t, e, i, r, n) {
                    void 0 === e && (e = []), void 0 === r && (r = new Er), void 0 === n && (n = []), this.registry = t, this.path = e, this.key = e.map(function (t) {
                        return "[" + t + "]"
                    }).join(""), this.scope = r, this.errors = n, this.expectedType = i
                };

                function Sn(t, e) {
                    for (var i, r = t.length - 1, n = 0, a = r, o = 0; n <= a;) if ((i = t[o = Math.floor((n + a) / 2)]) <= e) {
                        if (o === r || e < t[o + 1]) return o;
                        n = o + 1
                    } else {
                        if (!(i > e)) throw new Zr("Input is not a number.");
                        a = o - 1
                    }
                    return 0
                }

                Mn.prototype.parse = function (t, e, i, r, n) {
                    return void 0 === n && (n = {}), e ? this.concat(e, i, r)._parse(t, n) : this._parse(t, n)
                }, Mn.prototype._parse = function (t, e) {
                    function i(t, e, i) {
                        return "assert" === i ? new Xr(e, [t]) : "coerce" === i ? new Jr(e, [t]) : t
                    }

                    if (null !== t && "string" != typeof t && "boolean" != typeof t && "number" != typeof t || (t = ["literal", t]), Array.isArray(t)) {
                        if (0 === t.length) return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
                        var r = t[0];
                        if ("string" != typeof r) return this.error("Expression name must be a string, but found " + typeof r + ' instead. If you wanted a literal array, use ["literal", [...]].', 0), null;
                        var n = this.registry[r];
                        if (n) {
                            var a = n.parse(t, this);
                            if (!a) return null;
                            if (this.expectedType) {
                                var o = this.expectedType, s = a.type;
                                if ("string" !== o.kind && "number" !== o.kind && "boolean" !== o.kind && "object" !== o.kind && "array" !== o.kind || "value" !== s.kind) if ("color" !== o.kind && "formatted" !== o.kind && "resolvedImage" !== o.kind || "value" !== s.kind && "string" !== s.kind) {
                                    if (this.checkSubtype(o, s)) return null
                                } else a = i(a, o, e.typeAnnotation || "coerce"); else a = i(a, o, e.typeAnnotation || "assert")
                            }
                            if (!(a instanceof Gr) && "resolvedImage" !== a.type.kind && function e(t) {
                                if (t instanceof wn) return e(t.boundExpression);
                                if (t instanceof tn && "error" === t.name) return !1;
                                if (t instanceof en) return !1;
                                if (t instanceof _n) return !1;
                                var i = t instanceof Jr || t instanceof Xr, r = !0;
                                return t.eachChild(function (t) {
                                    r = i ? r && e(t) : r && t instanceof Gr
                                }), !!r && vn(t) && bn(t, ["zoom", "heatmap-density", "line-progress", "accumulated", "is-supported-script"])
                            }(a)) {
                                var l = new $r;
                                try {
                                    a = new Gr(a.type, a.evaluate(l))
                                } catch (t) {
                                    return this.error(t.message), null
                                }
                            }
                            return a
                        }
                        return this.error('Unknown expression "' + r + '". If you wanted a literal array, use ["literal", [...]].', 0)
                    }
                    return this.error(void 0 === t ? "'undefined' value invalid. Use null instead." : "object" == typeof t ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found " + typeof t + " instead.")
                }, Mn.prototype.concat = function (t, e, i) {
                    var r = "number" == typeof t ? this.path.concat(t) : this.path,
                        n = i ? this.scope.concat(i) : this.scope;
                    return new Mn(this.registry, r, e || null, n, this.errors)
                }, Mn.prototype.error = function (t) {
                    for (var e = [], i = arguments.length - 1; i-- > 0;) e[i] = arguments[i + 1];
                    var r = "" + this.key + e.map(function (t) {
                        return "[" + t + "]"
                    }).join("");
                    this.errors.push(new Sr(r, t))
                }, Mn.prototype.checkSubtype = function (t, e) {
                    var i = Dr(t, e);
                    return i && this.error(i), i
                };
                var En = function (t, e, i) {
                    this.type = t, this.input = e, this.labels = [], this.outputs = [];
                    for (var r = 0, n = i; r < n.length; r += 1) {
                        var a = n[r], o = a[1];
                        this.labels.push(a[0]), this.outputs.push(o)
                    }
                };

                function E(t, e, i) {
                    return t * (1 - i) + e * i
                }

                En.parse = function (t, e) {
                    if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
                    if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
                    var i = e.parse(t[1], 1, y);
                    if (!i) return null;
                    var r = [], n = null;
                    e.expectedType && "value" !== e.expectedType.kind && (n = e.expectedType);
                    for (var a = 1; a < t.length; a += 2) {
                        var o = 1 === a ? -1 / 0 : t[a], s = t[a + 1], l = a, u = a + 1;
                        if ("number" != typeof o) return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', l);
                        if (r.length && r[r.length - 1][0] >= o) return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', l);
                        var h = e.parse(s, u, n);
                        if (!h) return null;
                        n = n || h.type, r.push([o, h])
                    }
                    return new En(n, i, r)
                }, En.prototype.evaluate = function (t) {
                    var e = this.labels, i = this.outputs;
                    if (1 === e.length) return i[0].evaluate(t);
                    var r = this.input.evaluate(t);
                    if (r <= e[0]) return i[0].evaluate(t);
                    var n = e.length;
                    return r >= e[n - 1] ? i[n - 1].evaluate(t) : i[Sn(e, r)].evaluate(t)
                }, En.prototype.eachChild = function (t) {
                    t(this.input);
                    for (var e = 0, i = this.outputs; e < i.length; e += 1) t(i[e])
                }, En.prototype.outputDefined = function () {
                    return this.outputs.every(function (t) {
                        return t.outputDefined()
                    })
                }, En.prototype.serialize = function () {
                    for (var t = ["step", this.input.serialize()], e = 0; e < this.labels.length; e++) e > 0 && t.push(this.labels[e]), t.push(this.outputs[e].serialize());
                    return t
                };
                var In = Object.freeze({
                    __proto__: null, number: E, color: function (t, e, i) {
                        return new S(E(t.r, e.r, i), E(t.g, e.g, i), E(t.b, e.b, i), E(t.a, e.a, i))
                    }, array: function (t, i, r) {
                        return t.map(function (t, e) {
                            return E(t, i[e], r)
                        })
                    }
                }), Tn = 6 / 29 * 3 * (6 / 29), Cn = Math.PI / 180, Pn = 180 / Math.PI;

                function An(t) {
                    return t > .008856451679035631 ? Math.pow(t, 1 / 3) : t / Tn + 4 / 29
                }

                function zn(t) {
                    return t > 6 / 29 ? t * t * t : Tn * (t - 4 / 29)
                }

                function kn(t) {
                    return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055)
                }

                function Ln(t) {
                    return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4)
                }

                function Dn(t) {
                    var e = Ln(t.r), i = Ln(t.g), r = Ln(t.b),
                        n = An((.4124564 * e + .3575761 * i + .1804375 * r) / .95047),
                        a = An((.2126729 * e + .7151522 * i + .072175 * r) / 1);
                    return {
                        l: 116 * a - 16,
                        a: 500 * (n - a),
                        b: 200 * (a - An((.0193339 * e + .119192 * i + .9503041 * r) / 1.08883)),
                        alpha: t.a
                    }
                }

                function Rn(t) {
                    var e = (t.l + 16) / 116, i = isNaN(t.a) ? e : e + t.a / 500, r = isNaN(t.b) ? e : e - t.b / 200;
                    return e = 1 * zn(e), i = .95047 * zn(i), r = 1.08883 * zn(r), new S(kn(3.2404542 * i - 1.5371385 * e - .4985314 * r), kn(-.969266 * i + 1.8760108 * e + .041556 * r), kn(.0556434 * i - .2040259 * e + 1.0572252 * r), t.alpha)
                }

                function Bn(t, e, i) {
                    var r = e - t;
                    return t + i * (r > 180 || r < -180 ? r - 360 * Math.round(r / 360) : r)
                }

                var On = {
                    forward: Dn, reverse: Rn, interpolate: function (t, e, i) {
                        return {l: E(t.l, e.l, i), a: E(t.a, e.a, i), b: E(t.b, e.b, i), alpha: E(t.alpha, e.alpha, i)}
                    }
                }, Fn = {
                    forward: function (t) {
                        var e = Dn(t), i = e.l, r = e.a, n = e.b, a = Math.atan2(n, r) * Pn;
                        return {h: a < 0 ? a + 360 : a, c: Math.sqrt(r * r + n * n), l: i, alpha: t.a}
                    }, reverse: function (t) {
                        var e = t.h * Cn, i = t.c;
                        return Rn({l: t.l, a: Math.cos(e) * i, b: Math.sin(e) * i, alpha: t.alpha})
                    }, interpolate: function (t, e, i) {
                        return {h: Bn(t.h, e.h, i), c: E(t.c, e.c, i), l: E(t.l, e.l, i), alpha: E(t.alpha, e.alpha, i)}
                    }
                }, Un = Object.freeze({__proto__: null, lab: On, hcl: Fn}), Nn = function (t, e, i, r, n) {
                    this.type = t, this.operator = e, this.interpolation = i, this.input = r, this.labels = [], this.outputs = [];
                    for (var a = 0, o = n; a < o.length; a += 1) {
                        var s = o[a], l = s[1];
                        this.labels.push(s[0]), this.outputs.push(l)
                    }
                };

                function Vn(t, e, i, r) {
                    var n = r - i, a = t - i;
                    return 0 === n ? 0 : 1 === e ? a / n : (Math.pow(e, a) - 1) / (Math.pow(e, n) - 1)
                }

                Nn.interpolationFactor = function (t, e, i, r) {
                    var n = 0;
                    if ("exponential" === t.name) n = Vn(e, t.base, i, r); else if ("linear" === t.name) n = Vn(e, 1, i, r); else if ("cubic-bezier" === t.name) {
                        var a = t.controlPoints;
                        n = new k(a[0], a[1], a[2], a[3]).solve(Vn(e, 1, i, r))
                    }
                    return n
                }, Nn.parse = function (t, e) {
                    var i = t[0], r = t[1], n = t[2], a = t.slice(3);
                    if (!Array.isArray(r) || 0 === r.length) return e.error("Expected an interpolation type expression.", 1);
                    if ("linear" === r[0]) r = {name: "linear"}; else if ("exponential" === r[0]) {
                        var o = r[1];
                        if ("number" != typeof o) return e.error("Exponential interpolation requires a numeric base.", 1, 1);
                        r = {name: "exponential", base: o}
                    } else {
                        if ("cubic-bezier" !== r[0]) return e.error("Unknown interpolation type " + String(r[0]), 1, 0);
                        var s = r.slice(1);
                        if (4 !== s.length || s.some(function (t) {
                            return "number" != typeof t || t < 0 || t > 1
                        })) return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
                        r = {name: "cubic-bezier", controlPoints: s}
                    }
                    if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
                    if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
                    if (!(n = e.parse(n, 2, y))) return null;
                    var l = [], u = null;
                    "interpolate-hcl" === i || "interpolate-lab" === i ? u = Tr : e.expectedType && "value" !== e.expectedType.kind && (u = e.expectedType);
                    for (var h = 0; h < a.length; h += 2) {
                        var c = a[h], p = a[h + 1], f = h + 3, d = h + 4;
                        if ("number" != typeof c) return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', f);
                        if (l.length && l[l.length - 1][0] >= c) return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', f);
                        var m = e.parse(p, d, u);
                        if (!m) return null;
                        u = u || m.type, l.push([c, m])
                    }
                    return "number" === u.kind || "color" === u.kind || "array" === u.kind && "number" === u.itemType.kind && "number" == typeof u.N ? new Nn(u, i, r, n, l) : e.error("Type " + T(u) + " is not interpolatable.")
                }, Nn.prototype.evaluate = function (t) {
                    var e = this.labels, i = this.outputs;
                    if (1 === e.length) return i[0].evaluate(t);
                    var r = this.input.evaluate(t);
                    if (r <= e[0]) return i[0].evaluate(t);
                    var n = e.length;
                    if (r >= e[n - 1]) return i[n - 1].evaluate(t);
                    var a = Sn(e, r), o = Nn.interpolationFactor(this.interpolation, r, e[a], e[a + 1]),
                        s = i[a].evaluate(t), l = i[a + 1].evaluate(t);
                    return "interpolate" === this.operator ? In[this.type.kind.toLowerCase()](s, l, o) : "interpolate-hcl" === this.operator ? Fn.reverse(Fn.interpolate(Fn.forward(s), Fn.forward(l), o)) : On.reverse(On.interpolate(On.forward(s), On.forward(l), o))
                }, Nn.prototype.eachChild = function (t) {
                    t(this.input);
                    for (var e = 0, i = this.outputs; e < i.length; e += 1) t(i[e])
                }, Nn.prototype.outputDefined = function () {
                    return this.outputs.every(function (t) {
                        return t.outputDefined()
                    })
                }, Nn.prototype.serialize = function () {
                    var t;
                    t = "linear" === this.interpolation.name ? ["linear"] : "exponential" === this.interpolation.name ? 1 === this.interpolation.base ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
                    for (var e = [this.operator, t, this.input.serialize()], i = 0; i < this.labels.length; i++) e.push(this.labels[i], this.outputs[i].serialize());
                    return e
                };
                var jn = function (t, e) {
                    this.type = t, this.args = e
                };
                jn.parse = function (t, e) {
                    if (t.length < 2) return e.error("Expectected at least one argument.");
                    var i = null, r = e.expectedType;
                    r && "value" !== r.kind && (i = r);
                    for (var n = [], a = 0, o = t.slice(1); a < o.length; a += 1) {
                        var s = e.parse(o[a], 1 + n.length, i, void 0, {typeAnnotation: "omit"});
                        if (!s) return null;
                        i = i || s.type, n.push(s)
                    }
                    var l = r && n.some(function (t) {
                        return Dr(r, t.type)
                    });
                    return new jn(l ? g : i, n)
                }, jn.prototype.evaluate = function (t) {
                    for (var e, i = null, r = 0, n = 0, a = this.args; n < a.length && (r++, (i = a[n].evaluate(t)) && i instanceof Nr && !i.available && (e || (e = i.name), i = null, r === this.args.length && (i = e)), null === i); n += 1) ;
                    return i
                }, jn.prototype.eachChild = function (t) {
                    this.args.forEach(t)
                }, jn.prototype.outputDefined = function () {
                    return this.args.every(function (t) {
                        return t.outputDefined()
                    })
                }, jn.prototype.serialize = function () {
                    var e = ["coalesce"];
                    return this.eachChild(function (t) {
                        e.push(t.serialize())
                    }), e
                };
                var qn = function (t, e) {
                    this.type = e.type, this.bindings = [].concat(t), this.result = e
                };
                qn.prototype.evaluate = function (t) {
                    return this.result.evaluate(t)
                }, qn.prototype.eachChild = function (t) {
                    for (var e = 0, i = this.bindings; e < i.length; e += 1) t(i[e][1]);
                    t(this.result)
                }, qn.parse = function (t, e) {
                    if (t.length < 4) return e.error("Expected at least 3 arguments, but found " + (t.length - 1) + " instead.");
                    for (var i = [], r = 1; r < t.length - 1; r += 2) {
                        var n = t[r];
                        if ("string" != typeof n) return e.error("Expected string, but found " + typeof n + " instead.", r);
                        if (/[^a-zA-Z0-9_]/.test(n)) return e.error("Variable names must contain only alphanumeric characters or '_'.", r);
                        var a = e.parse(t[r + 1], r + 1);
                        if (!a) return null;
                        i.push([n, a])
                    }
                    var o = e.parse(t[t.length - 1], t.length - 1, e.expectedType, i);
                    return o ? new qn(i, o) : null
                }, qn.prototype.outputDefined = function () {
                    return this.result.outputDefined()
                }, qn.prototype.serialize = function () {
                    for (var t = ["let"], e = 0, i = this.bindings; e < i.length; e += 1) {
                        var r = i[e];
                        t.push(r[0], r[1].serialize())
                    }
                    return t.push(this.result.serialize()), t
                };
                var Gn = function (t, e, i) {
                    this.type = t, this.index = e, this.input = i
                };
                Gn.parse = function (t, e) {
                    if (3 !== t.length) return e.error("Expected 2 arguments, but found " + (t.length - 1) + " instead.");
                    var i = e.parse(t[1], 1, y), r = e.parse(t[2], 2, kr(e.expectedType || g));
                    return i && r ? new Gn(r.type.itemType, i, r) : null
                }, Gn.prototype.evaluate = function (t) {
                    var e = this.index.evaluate(t), i = this.input.evaluate(t);
                    if (e < 0) throw new Zr("Array index out of bounds: " + e + " < 0.");
                    if (e >= i.length) throw new Zr("Array index out of bounds: " + e + " > " + (i.length - 1) + ".");
                    if (e !== Math.floor(e)) throw new Zr("Array index must be an integer, but found " + e + " instead.");
                    return i[e]
                }, Gn.prototype.eachChild = function (t) {
                    t(this.index), t(this.input)
                }, Gn.prototype.outputDefined = function () {
                    return !1
                }, Gn.prototype.serialize = function () {
                    return ["at", this.index.serialize(), this.input.serialize()]
                };
                var Zn = function (t, e) {
                    this.type = p, this.needle = t, this.haystack = e
                };
                Zn.parse = function (t, e) {
                    if (3 !== t.length) return e.error("Expected 2 arguments, but found " + (t.length - 1) + " instead.");
                    var i = e.parse(t[1], 1, g), r = e.parse(t[2], 2, g);
                    return i && r ? Rr(i.type, [p, f, y, Ir, g]) ? new Zn(i, r) : e.error("Expected first argument to be of type boolean, string, number or null, but found " + T(i.type) + " instead") : null
                }, Zn.prototype.evaluate = function (t) {
                    var e = this.needle.evaluate(t), i = this.haystack.evaluate(t);
                    if (!i) return !1;
                    if (!Br(e, ["boolean", "string", "number", "null"])) throw new Zr("Expected first argument to be of type boolean, string, number or null, but found " + T(v(e)) + " instead.");
                    if (!Br(i, ["string", "array"])) throw new Zr("Expected second argument to be of type array or string, but found " + T(v(i)) + " instead.");
                    return i.indexOf(e) >= 0
                }, Zn.prototype.eachChild = function (t) {
                    t(this.needle), t(this.haystack)
                }, Zn.prototype.outputDefined = function () {
                    return !0
                }, Zn.prototype.serialize = function () {
                    return ["in", this.needle.serialize(), this.haystack.serialize()]
                };
                var Wn = function (t, e, i) {
                    this.type = y, this.needle = t, this.haystack = e, this.fromIndex = i
                };
                Wn.parse = function (t, e) {
                    if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found " + (t.length - 1) + " instead.");
                    var i = e.parse(t[1], 1, g), r = e.parse(t[2], 2, g);
                    if (!i || !r) return null;
                    if (!Rr(i.type, [p, f, y, Ir, g])) return e.error("Expected first argument to be of type boolean, string, number or null, but found " + T(i.type) + " instead");
                    if (4 === t.length) {
                        var n = e.parse(t[3], 3, y);
                        return n ? new Wn(i, r, n) : null
                    }
                    return new Wn(i, r)
                }, Wn.prototype.evaluate = function (t) {
                    var e = this.needle.evaluate(t), i = this.haystack.evaluate(t);
                    if (!Br(e, ["boolean", "string", "number", "null"])) throw new Zr("Expected first argument to be of type boolean, string, number or null, but found " + T(v(e)) + " instead.");
                    if (!Br(i, ["string", "array"])) throw new Zr("Expected second argument to be of type array or string, but found " + T(v(i)) + " instead.");
                    if (this.fromIndex) {
                        var r = this.fromIndex.evaluate(t);
                        return i.indexOf(e, r)
                    }
                    return i.indexOf(e)
                }, Wn.prototype.eachChild = function (t) {
                    t(this.needle), t(this.haystack), this.fromIndex && t(this.fromIndex)
                }, Wn.prototype.outputDefined = function () {
                    return !1
                }, Wn.prototype.serialize = function () {
                    if (null != this.fromIndex && void 0 !== this.fromIndex) {
                        var t = this.fromIndex.serialize();
                        return ["index-of", this.needle.serialize(), this.haystack.serialize(), t]
                    }
                    return ["index-of", this.needle.serialize(), this.haystack.serialize()]
                };
                var Xn = function (t, e, i, r, n, a) {
                    this.inputType = t, this.type = e, this.input = i, this.cases = r, this.outputs = n, this.otherwise = a
                };
                Xn.parse = function (t, e) {
                    if (t.length < 5) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
                    if (t.length % 2 != 1) return e.error("Expected an even number of arguments.");
                    var i, r;
                    e.expectedType && "value" !== e.expectedType.kind && (r = e.expectedType);
                    for (var n = {}, a = [], o = 2; o < t.length - 1; o += 2) {
                        var s = t[o], l = t[o + 1];
                        Array.isArray(s) || (s = [s]);
                        var u = e.concat(o);
                        if (0 === s.length) return u.error("Expected at least one branch label.");
                        for (var h = 0, c = s; h < c.length; h += 1) {
                            var p = c[h];
                            if ("number" != typeof p && "string" != typeof p) return u.error("Branch labels must be numbers or strings.");
                            if ("number" == typeof p && Math.abs(p) > Number.MAX_SAFE_INTEGER) return u.error("Branch labels must be integers no larger than " + Number.MAX_SAFE_INTEGER + ".");
                            if ("number" == typeof p && Math.floor(p) !== p) return u.error("Numeric branch labels must be integer values.");
                            if (i) {
                                if (u.checkSubtype(i, v(p))) return null
                            } else i = v(p);
                            if (void 0 !== n[String(p)]) return u.error("Branch labels must be unique.");
                            n[String(p)] = a.length
                        }
                        var f = e.parse(l, o, r);
                        if (!f) return null;
                        r = r || f.type, a.push(f)
                    }
                    var d = e.parse(t[1], 1, g);
                    if (!d) return null;
                    var m = e.parse(t[t.length - 1], t.length - 1, r);
                    return m ? "value" !== d.type.kind && e.concat(1).checkSubtype(i, d.type) ? null : new Xn(i, r, d, n, a, m) : null
                }, Xn.prototype.evaluate = function (t) {
                    var e = this.input.evaluate(t);
                    return (v(e) === this.inputType && this.outputs[this.cases[e]] || this.otherwise).evaluate(t)
                }, Xn.prototype.eachChild = function (t) {
                    t(this.input), this.outputs.forEach(t), t(this.otherwise)
                }, Xn.prototype.outputDefined = function () {
                    return this.outputs.every(function (t) {
                        return t.outputDefined()
                    }) && this.otherwise.outputDefined()
                }, Xn.prototype.serialize = function () {
                    for (var e = this, t = ["match", this.input.serialize()], i = [], r = {}, n = 0, a = Object.keys(this.cases).sort(); n < a.length; n += 1) {
                        var o = a[n];
                        void 0 === (c = r[this.cases[o]]) ? (r[this.cases[o]] = i.length, i.push([this.cases[o], [o]])) : i[c][1].push(o)
                    }
                    for (var s = function (t) {
                        return "number" === e.inputType.kind ? Number(t) : t
                    }, l = 0, u = i; l < u.length; l += 1) {
                        var h = u[l], c = h[0], p = h[1];
                        t.push(1 === p.length ? s(p[0]) : p.map(s)), t.push(this.outputs[outputIndex$1].serialize())
                    }
                    return t.push(this.otherwise.serialize()), t
                };
                var Hn = function (t, e, i) {
                    this.type = t, this.branches = e, this.otherwise = i
                };
                Hn.parse = function (t, e) {
                    if (t.length < 4) return e.error("Expected at least 3 arguments, but found only " + (t.length - 1) + ".");
                    if (t.length % 2 != 0) return e.error("Expected an odd number of arguments.");
                    var i;
                    e.expectedType && "value" !== e.expectedType.kind && (i = e.expectedType);
                    for (var r = [], n = 1; n < t.length - 1; n += 2) {
                        var a = e.parse(t[n], n, p);
                        if (!a) return null;
                        var o = e.parse(t[n + 1], n + 1, i);
                        if (!o) return null;
                        r.push([a, o]), i = i || o.type
                    }
                    var s = e.parse(t[t.length - 1], t.length - 1, i);
                    return s ? new Hn(i, r, s) : null
                }, Hn.prototype.evaluate = function (t) {
                    for (var e = 0, i = this.branches; e < i.length; e += 1) {
                        var r = i[e], n = r[1];
                        if (r[0].evaluate(t)) return n.evaluate(t)
                    }
                    return this.otherwise.evaluate(t)
                }, Hn.prototype.eachChild = function (t) {
                    for (var e = 0, i = this.branches; e < i.length; e += 1) {
                        var r = i[e], n = r[1];
                        t(r[0]), t(n)
                    }
                    t(this.otherwise)
                }, Hn.prototype.outputDefined = function () {
                    return this.branches.every(function (t) {
                        return t[1].outputDefined()
                    }) && this.otherwise.outputDefined()
                }, Hn.prototype.serialize = function () {
                    var e = ["case"];
                    return this.eachChild(function (t) {
                        e.push(t.serialize())
                    }), e
                };
                var Kn = function (t, e, i, r) {
                    this.type = t, this.input = e, this.beginIndex = i, this.endIndex = r
                };

                function Yn(t, e) {
                    return "==" === t || "!=" === t ? "boolean" === e.kind || "string" === e.kind || "number" === e.kind || "null" === e.kind || "value" === e.kind : "string" === e.kind || "number" === e.kind || "value" === e.kind
                }

                function Jn(t, e, i, r) {
                    return 0 === r.compare(e, i)
                }

                function Qn(s, l, u) {
                    var h = "==" !== s && "!=" !== s;
                    return function () {
                        function o(t, e, i) {
                            this.type = p, this.lhs = t, this.rhs = e, this.collator = i, this.hasUntypedArgument = "value" === t.type.kind || "value" === e.type.kind
                        }

                        return o.parse = function (t, e) {
                            if (3 !== t.length && 4 !== t.length) return e.error("Expected two or three arguments.");
                            var i = t[0], r = e.parse(t[1], 1, g);
                            if (!r) return null;
                            if (!Yn(i, r.type)) return e.concat(1).error('"' + i + "\" comparisons are not supported for type '" + T(r.type) + "'.");
                            var n = e.parse(t[2], 2, g);
                            if (!n) return null;
                            if (!Yn(i, n.type)) return e.concat(2).error('"' + i + "\" comparisons are not supported for type '" + T(n.type) + "'.");
                            if (r.type.kind !== n.type.kind && "value" !== r.type.kind && "value" !== n.type.kind) return e.error("Cannot compare types '" + T(r.type) + "' and '" + T(n.type) + "'.");
                            h && ("value" === r.type.kind && "value" !== n.type.kind ? r = new Xr(n.type, [r]) : "value" !== r.type.kind && "value" === n.type.kind && (n = new Xr(r.type, [n])));
                            var a = null;
                            if (4 === t.length) {
                                if ("string" !== r.type.kind && "string" !== n.type.kind && "value" !== r.type.kind && "value" !== n.type.kind) return e.error("Cannot use collator to compare non-string types.");
                                if (!(a = e.parse(t[3], 3, Pr))) return null
                            }
                            return new o(r, n, a)
                        }, o.prototype.evaluate = function (t) {
                            var e = this.lhs.evaluate(t), i = this.rhs.evaluate(t);
                            if (h && this.hasUntypedArgument) {
                                var r = v(e), n = v(i);
                                if (r.kind !== n.kind || "string" !== r.kind && "number" !== r.kind) throw new Zr('Expected arguments for "' + s + '" to be (string, string) or (number, number), but found (' + r.kind + ", " + n.kind + ") instead.")
                            }
                            if (this.collator && !h && this.hasUntypedArgument) {
                                var a = v(e), o = v(i);
                                if ("string" !== a.kind || "string" !== o.kind) return l(t, e, i)
                            }
                            return this.collator ? u(t, e, i, this.collator.evaluate(t)) : l(t, e, i)
                        }, o.prototype.eachChild = function (t) {
                            t(this.lhs), t(this.rhs), this.collator && t(this.collator)
                        }, o.prototype.outputDefined = function () {
                            return !0
                        }, o.prototype.serialize = function () {
                            var e = [s];
                            return this.eachChild(function (t) {
                                e.push(t.serialize())
                            }), e
                        }, o
                    }()
                }

                Kn.parse = function (t, e) {
                    if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found " + (t.length - 1) + " instead.");
                    var i = e.parse(t[1], 1, g), r = e.parse(t[2], 2, y);
                    if (!i || !r) return null;
                    if (!Rr(i.type, [kr(g), f, g])) return e.error("Expected first argument to be of type array or string, but found " + T(i.type) + " instead");
                    if (4 === t.length) {
                        var n = e.parse(t[3], 3, y);
                        return n ? new Kn(i.type, i, r, n) : null
                    }
                    return new Kn(i.type, i, r)
                }, Kn.prototype.evaluate = function (t) {
                    var e = this.input.evaluate(t), i = this.beginIndex.evaluate(t);
                    if (!Br(e, ["string", "array"])) throw new Zr("Expected first argument to be of type array or string, but found " + T(v(e)) + " instead.");
                    if (this.endIndex) {
                        var r = this.endIndex.evaluate(t);
                        return e.slice(i, r)
                    }
                    return e.slice(i)
                }, Kn.prototype.eachChild = function (t) {
                    t(this.input), t(this.beginIndex), this.endIndex && t(this.endIndex)
                }, Kn.prototype.outputDefined = function () {
                    return !1
                }, Kn.prototype.serialize = function () {
                    if (null != this.endIndex && void 0 !== this.endIndex) {
                        var t = this.endIndex.serialize();
                        return ["slice", this.input.serialize(), this.beginIndex.serialize(), t]
                    }
                    return ["slice", this.input.serialize(), this.beginIndex.serialize()]
                };
                var $n = Qn("==", function (t, e, i) {
                    return e === i
                }, Jn), ta = Qn("!=", function (t, e, i) {
                    return e !== i
                }, function (t, e, i, r) {
                    return !Jn(0, e, i, r)
                }), ea = Qn("<", function (t, e, i) {
                    return e < i
                }, function (t, e, i, r) {
                    return r.compare(e, i) < 0
                }), ia = Qn(">", function (t, e, i) {
                    return e > i
                }, function (t, e, i, r) {
                    return r.compare(e, i) > 0
                }), ra = Qn("<=", function (t, e, i) {
                    return e <= i
                }, function (t, e, i, r) {
                    return r.compare(e, i) <= 0
                }), na = Qn(">=", function (t, e, i) {
                    return e >= i
                }, function (t, e, i, r) {
                    return r.compare(e, i) >= 0
                }), aa = function (t, e, i, r, n) {
                    this.type = f, this.number = t, this.locale = e, this.currency = i, this.minFractionDigits = r, this.maxFractionDigits = n
                };
                aa.parse = function (t, e) {
                    if (3 !== t.length) return e.error("Expected two arguments.");
                    var i = e.parse(t[1], 1, y);
                    if (!i) return null;
                    var r = t[2];
                    if ("object" != typeof r || Array.isArray(r)) return e.error("NumberFormat options argument must be an object.");
                    var n = null;
                    if (r.locale && !(n = e.parse(r.locale, 1, f))) return null;
                    var a = null;
                    if (r.currency && !(a = e.parse(r.currency, 1, f))) return null;
                    var o = null;
                    if (r["min-fraction-digits"] && !(o = e.parse(r["min-fraction-digits"], 1, y))) return null;
                    var s = null;
                    return r["max-fraction-digits"] && !(s = e.parse(r["max-fraction-digits"], 1, y)) ? null : new aa(i, n, a, o, s)
                }, aa.prototype.evaluate = function (t) {
                    return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t) : [], {
                        style: this.currency ? "currency" : "decimal",
                        currency: this.currency ? this.currency.evaluate(t) : void 0,
                        minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t) : void 0,
                        maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t) : void 0
                    }).format(this.number.evaluate(t))
                }, aa.prototype.eachChild = function (t) {
                    t(this.number), this.locale && t(this.locale), this.currency && t(this.currency), this.minFractionDigits && t(this.minFractionDigits), this.maxFractionDigits && t(this.maxFractionDigits)
                }, aa.prototype.outputDefined = function () {
                    return !1
                }, aa.prototype.serialize = function () {
                    var t = {};
                    return this.locale && (t.locale = this.locale.serialize()), this.currency && (t.currency = this.currency.serialize()), this.minFractionDigits && (t["min-fraction-digits"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t["max-fraction-digits"] = this.maxFractionDigits.serialize()), ["number-format", this.number.serialize(), t]
                };
                var oa = function (t) {
                    this.type = y, this.input = t
                };
                oa.parse = function (t, e) {
                    if (2 !== t.length) return e.error("Expected 1 argument, but found " + (t.length - 1) + " instead.");
                    var i = e.parse(t[1], 1);
                    return i ? "array" !== i.type.kind && "string" !== i.type.kind && "value" !== i.type.kind ? e.error("Expected argument of type string or array, but found " + T(i.type) + " instead.") : new oa(i) : null
                }, oa.prototype.evaluate = function (t) {
                    var e = this.input.evaluate(t);
                    if ("string" == typeof e) return e.length;
                    if (Array.isArray(e)) return e.length;
                    throw new Zr("Expected value to be of type string or array, but found " + T(v(e)) + " instead.")
                }, oa.prototype.eachChild = function (t) {
                    t(this.input)
                }, oa.prototype.outputDefined = function () {
                    return !1
                }, oa.prototype.serialize = function () {
                    var e = ["length"];
                    return this.eachChild(function (t) {
                        e.push(t.serialize())
                    }), e
                };
                var sa = {
                    "==": $n,
                    "!=": ta,
                    ">": ia,
                    "<": ea,
                    ">=": na,
                    "<=": ra,
                    array: Xr,
                    at: Gn,
                    boolean: Xr,
                    case: Hn,
                    coalesce: jn,
                    collator: en,
                    format: Hr,
                    image: Kr,
                    in: Zn,
                    "index-of": Wn,
                    interpolate: Nn,
                    "interpolate-hcl": Nn,
                    "interpolate-lab": Nn,
                    length: oa,
                    let: qn,
                    literal: Gr,
                    match: Xn,
                    number: Xr,
                    "number-format": aa,
                    object: Xr,
                    slice: Kn,
                    step: En,
                    string: Xr,
                    "to-boolean": Jr,
                    "to-color": Jr,
                    "to-number": Jr,
                    "to-string": Jr,
                    var: wn,
                    within: _n
                };

                function la(t, e) {
                    var i = e[0], r = e[1], n = e[2], a = e[3];
                    i = i.evaluate(t), r = r.evaluate(t), n = n.evaluate(t);
                    var o = a ? a.evaluate(t) : 1, s = Vr(i, r, n, o);
                    if (s) throw new Zr(s);
                    return new S(i / 255 * o, r / 255 * o, n / 255 * o, o)
                }

                function ua(t, e) {
                    return t in e
                }

                function ha(t, e) {
                    var i = e[t];
                    return void 0 === i ? null : i
                }

                function ca(t) {
                    return {type: t}
                }

                function pa(t) {
                    return {result: "success", value: t}
                }

                function fa(t) {
                    return {result: "error", value: t}
                }

                function da(t) {
                    return "data-driven" === t["property-type"] || "cross-faded-data-driven" === t["property-type"]
                }

                function ma(t) {
                    return !!t.expression && t.expression.parameters.indexOf("zoom") > -1
                }

                function ya(t) {
                    return !!t.expression && t.expression.interpolated
                }

                function d(t) {
                    return t instanceof Number ? "number" : t instanceof String ? "string" : t instanceof Boolean ? "boolean" : Array.isArray(t) ? "array" : null === t ? "null" : typeof t
                }

                function ga(t) {
                    return "object" == typeof t && null !== t && !Array.isArray(t)
                }

                function _a(t) {
                    return t
                }

                function va(t, e, i) {
                    return void 0 !== t ? t : void 0 !== e ? e : void 0 !== i ? i : void 0
                }

                function xa(t, e, i, r, n) {
                    return va(typeof i === n ? r[i] : void 0, t.default, e.default)
                }

                function ba(t, e, i) {
                    if ("number" !== d(i)) return va(t.default, e.default);
                    var r = t.stops.length;
                    if (1 === r) return t.stops[0][1];
                    if (i <= t.stops[0][0]) return t.stops[0][1];
                    if (i >= t.stops[r - 1][0]) return t.stops[r - 1][1];
                    var n = Sn(t.stops.map(function (t) {
                        return t[0]
                    }), i);
                    return t.stops[n][1]
                }

                function wa(t, e, i) {
                    var r = void 0 !== t.base ? t.base : 1;
                    if ("number" !== d(i)) return va(t.default, e.default);
                    var n = t.stops.length;
                    if (1 === n) return t.stops[0][1];
                    if (i <= t.stops[0][0]) return t.stops[0][1];
                    if (i >= t.stops[n - 1][0]) return t.stops[n - 1][1];
                    var a = Sn(t.stops.map(function (t) {
                            return t[0]
                        }), i), o = function (t, e, i, r) {
                            var n = r - i, a = t - i;
                            return 0 === n ? 0 : 1 === e ? a / n : (Math.pow(e, a) - 1) / (Math.pow(e, n) - 1)
                        }(i, r, t.stops[a][0], t.stops[a + 1][0]), s = t.stops[a][1], l = t.stops[a + 1][1],
                        u = In[e.type] || _a;
                    if (t.colorSpace && "rgb" !== t.colorSpace) {
                        var h = Un[t.colorSpace];
                        u = function (t, e) {
                            return h.reverse(h.interpolate(h.forward(t), h.forward(e), o))
                        }
                    }
                    return "function" == typeof s.evaluate ? {
                        evaluate: function () {
                            for (var t = [], e = arguments.length; e--;) t[e] = arguments[e];
                            var i = s.evaluate.apply(void 0, t), r = l.evaluate.apply(void 0, t);
                            if (void 0 !== i && void 0 !== r) return u(i, r, o)
                        }
                    } : u(s, l, o)
                }

                function Ma(t, e, i) {
                    return "color" === e.type ? i = S.parse(i) : "formatted" === e.type ? i = Ur.fromString(i.toString()) : "resolvedImage" === e.type ? i = Nr.fromString(i.toString()) : d(i) === e.type || "enum" === e.type && e.values[i] || (i = void 0), va(i, t.default, e.default)
                }

                tn.register(sa, {
                    error: [{kind: "error"}, [f], function (t, e) {
                        throw new Zr(e[0].evaluate(t))
                    }],
                    typeof: [f, [g], function (t, e) {
                        return T(v(e[0].evaluate(t)))
                    }],
                    "to-rgba": [kr(y, 4), [Tr], function (t, e) {
                        return e[0].evaluate(t).toArray()
                    }],
                    rgb: [Tr, [y, y, y], la],
                    rgba: [Tr, [y, y, y, y], la],
                    has: {
                        type: p, overloads: [[[f], function (t, e) {
                            return ua(e[0].evaluate(t), t.properties())
                        }], [[f, Cr], function (t, e) {
                            var i = e[1];
                            return ua(e[0].evaluate(t), i.evaluate(t))
                        }]]
                    },
                    get: {
                        type: g, overloads: [[[f], function (t, e) {
                            return ha(e[0].evaluate(t), t.properties())
                        }], [[f, Cr], function (t, e) {
                            var i = e[1];
                            return ha(e[0].evaluate(t), i.evaluate(t))
                        }]]
                    },
                    "feature-state": [g, [f], function (t, e) {
                        return ha(e[0].evaluate(t), t.featureState || {})
                    }],
                    properties: [Cr, [], function (t) {
                        return t.properties()
                    }],
                    "geometry-type": [f, [], function (t) {
                        return t.geometryType()
                    }],
                    id: [g, [], function (t) {
                        return t.id()
                    }],
                    zoom: [y, [], function (t) {
                        return t.globals.zoom
                    }],
                    "heatmap-density": [y, [], function (t) {
                        return t.globals.heatmapDensity || 0
                    }],
                    "line-progress": [y, [], function (t) {
                        return t.globals.lineProgress || 0
                    }],
                    accumulated: [g, [], function (t) {
                        return void 0 === t.globals.accumulated ? null : t.globals.accumulated
                    }],
                    "+": [y, ca(y), function (t, e) {
                        for (var i = 0, r = 0, n = e; r < n.length; r += 1) i += n[r].evaluate(t);
                        return i
                    }],
                    "*": [y, ca(y), function (t, e) {
                        for (var i = 1, r = 0, n = e; r < n.length; r += 1) i *= n[r].evaluate(t);
                        return i
                    }],
                    "-": {
                        type: y, overloads: [[[y, y], function (t, e) {
                            var i = e[1];
                            return e[0].evaluate(t) - i.evaluate(t)
                        }], [[y], function (t, e) {
                            return -e[0].evaluate(t)
                        }]]
                    },
                    "/": [y, [y, y], function (t, e) {
                        var i = e[1];
                        return e[0].evaluate(t) / i.evaluate(t)
                    }],
                    "%": [y, [y, y], function (t, e) {
                        var i = e[1];
                        return e[0].evaluate(t) % i.evaluate(t)
                    }],
                    ln2: [y, [], function () {
                        return Math.LN2
                    }],
                    pi: [y, [], function () {
                        return Math.PI
                    }],
                    e: [y, [], function () {
                        return Math.E
                    }],
                    "^": [y, [y, y], function (t, e) {
                        var i = e[1];
                        return Math.pow(e[0].evaluate(t), i.evaluate(t))
                    }],
                    sqrt: [y, [y], function (t, e) {
                        return Math.sqrt(e[0].evaluate(t))
                    }],
                    log10: [y, [y], function (t, e) {
                        return Math.log(e[0].evaluate(t)) / Math.LN10
                    }],
                    ln: [y, [y], function (t, e) {
                        return Math.log(e[0].evaluate(t))
                    }],
                    log2: [y, [y], function (t, e) {
                        return Math.log(e[0].evaluate(t)) / Math.LN2
                    }],
                    sin: [y, [y], function (t, e) {
                        return Math.sin(e[0].evaluate(t))
                    }],
                    cos: [y, [y], function (t, e) {
                        return Math.cos(e[0].evaluate(t))
                    }],
                    tan: [y, [y], function (t, e) {
                        return Math.tan(e[0].evaluate(t))
                    }],
                    asin: [y, [y], function (t, e) {
                        return Math.asin(e[0].evaluate(t))
                    }],
                    acos: [y, [y], function (t, e) {
                        return Math.acos(e[0].evaluate(t))
                    }],
                    atan: [y, [y], function (t, e) {
                        return Math.atan(e[0].evaluate(t))
                    }],
                    min: [y, ca(y), function (e, t) {
                        return Math.min.apply(Math, t.map(function (t) {
                            return t.evaluate(e)
                        }))
                    }],
                    max: [y, ca(y), function (e, t) {
                        return Math.max.apply(Math, t.map(function (t) {
                            return t.evaluate(e)
                        }))
                    }],
                    abs: [y, [y], function (t, e) {
                        return Math.abs(e[0].evaluate(t))
                    }],
                    round: [y, [y], function (t, e) {
                        var i = e[0].evaluate(t);
                        return i < 0 ? -Math.round(-i) : Math.round(i)
                    }],
                    floor: [y, [y], function (t, e) {
                        return Math.floor(e[0].evaluate(t))
                    }],
                    ceil: [y, [y], function (t, e) {
                        return Math.ceil(e[0].evaluate(t))
                    }],
                    "filter-==": [p, [f, g], function (t, e) {
                        var i = e[0], r = e[1];
                        return t.properties()[i.value] === r.value
                    }],
                    "filter-id-==": [p, [g], function (t, e) {
                        var i = e[0];
                        return t.id() === i.value
                    }],
                    "filter-type-==": [p, [f], function (t, e) {
                        var i = e[0];
                        return t.geometryType() === i.value
                    }],
                    "filter-<": [p, [f, g], function (t, e) {
                        var i = e[0], r = e[1], n = t.properties()[i.value], a = r.value;
                        return typeof n == typeof a && n < a
                    }],
                    "filter-id-<": [p, [g], function (t, e) {
                        var i = e[0], r = t.id(), n = i.value;
                        return typeof r == typeof n && r < n
                    }],
                    "filter->": [p, [f, g], function (t, e) {
                        var i = e[0], r = e[1], n = t.properties()[i.value], a = r.value;
                        return typeof n == typeof a && n > a
                    }],
                    "filter-id->": [p, [g], function (t, e) {
                        var i = e[0], r = t.id(), n = i.value;
                        return typeof r == typeof n && r > n
                    }],
                    "filter-<=": [p, [f, g], function (t, e) {
                        var i = e[0], r = e[1], n = t.properties()[i.value], a = r.value;
                        return typeof n == typeof a && n <= a
                    }],
                    "filter-id-<=": [p, [g], function (t, e) {
                        var i = e[0], r = t.id(), n = i.value;
                        return typeof r == typeof n && r <= n
                    }],
                    "filter->=": [p, [f, g], function (t, e) {
                        var i = e[0], r = e[1], n = t.properties()[i.value], a = r.value;
                        return typeof n == typeof a && n >= a
                    }],
                    "filter-id->=": [p, [g], function (t, e) {
                        var i = e[0], r = t.id(), n = i.value;
                        return typeof r == typeof n && r >= n
                    }],
                    "filter-has": [p, [g], function (t, e) {
                        return e[0].value in t.properties()
                    }],
                    "filter-has-id": [p, [], function (t) {
                        return null !== t.id() && void 0 !== t.id()
                    }],
                    "filter-type-in": [p, [kr(f)], function (t, e) {
                        return e[0].value.indexOf(t.geometryType()) >= 0
                    }],
                    "filter-id-in": [p, [kr(g)], function (t, e) {
                        return e[0].value.indexOf(t.id()) >= 0
                    }],
                    "filter-in-small": [p, [f, kr(g)], function (t, e) {
                        var i = e[0];
                        return e[1].value.indexOf(t.properties()[i.value]) >= 0
                    }],
                    "filter-in-large": [p, [f, kr(g)], function (t, e) {
                        var i = e[0], r = e[1];
                        return function (t, e, i, r) {
                            for (; i <= r;) {
                                var n = i + r >> 1;
                                if (e[n] === t) return !0;
                                e[n] > t ? r = n - 1 : i = n + 1
                            }
                            return !1
                        }(t.properties()[i.value], r.value, 0, r.value.length - 1)
                    }],
                    all: {
                        type: p, overloads: [[[p, p], function (t, e) {
                            var i = e[1];
                            return e[0].evaluate(t) && i.evaluate(t)
                        }], [ca(p), function (t, e) {
                            for (var i = 0, r = e; i < r.length; i += 1) if (!r[i].evaluate(t)) return !1;
                            return !0
                        }]]
                    },
                    any: {
                        type: p, overloads: [[[p, p], function (t, e) {
                            var i = e[1];
                            return e[0].evaluate(t) || i.evaluate(t)
                        }], [ca(p), function (t, e) {
                            for (var i = 0, r = e; i < r.length; i += 1) if (r[i].evaluate(t)) return !0;
                            return !1
                        }]]
                    },
                    "!": [p, [p], function (t, e) {
                        return !e[0].evaluate(t)
                    }],
                    "is-supported-script": [p, [f], function (t, e) {
                        var i = t.globals && t.globals.isSupportedScript;
                        return !i || i(e[0].evaluate(t))
                    }],
                    upcase: [f, [f], function (t, e) {
                        return e[0].evaluate(t).toUpperCase()
                    }],
                    downcase: [f, [f], function (t, e) {
                        return e[0].evaluate(t).toLowerCase()
                    }],
                    concat: [f, ca(g), function (e, t) {
                        return t.map(function (t) {
                            return qr(t.evaluate(e))
                        }).join("")
                    }],
                    "resolved-locale": [f, [Pr], function (t, e) {
                        return e[0].evaluate(t).resolvedLocale()
                    }]
                });
                var Sa = function (t, e) {
                    this.expression = t, this._warningHistory = {}, this._evaluator = new $r, this._defaultValue = e ? function (t) {
                        return "color" === t.type && ga(t.default) ? new S(0, 0, 0, 0) : "color" === t.type ? S.parse(t.default) || null : void 0 === t.default ? null : t.default
                    }(e) : null, this._enumValues = e && "enum" === e.type ? e.values : null
                };

                function Ea(t) {
                    return Array.isArray(t) && t.length > 0 && "string" == typeof t[0] && t[0] in sa
                }

                function Ia(t, e) {
                    var i = new Mn(sa, [], e ? function (t) {
                            var e = {
                                color: Tr,
                                string: f,
                                number: y,
                                enum: f,
                                boolean: p,
                                formatted: Ar,
                                resolvedImage: zr
                            };
                            return "array" === t.type ? kr(e[t.value] || g, t.length) : e[t.type]
                        }(e) : void 0),
                        r = i.parse(t, void 0, void 0, void 0, e && "string" === e.type ? {typeAnnotation: "coerce"} : void 0);
                    return r ? pa(new Sa(r, e)) : fa(i.errors)
                }

                Sa.prototype.evaluateWithoutErrorHandling = function (t, e, i, r, n, a) {
                    return this._evaluator.globals = t, this._evaluator.feature = e, this._evaluator.featureState = i, this._evaluator.canonical = r, this._evaluator.availableImages = n || null, this._evaluator.formattedSection = a, this.expression.evaluate(this._evaluator)
                }, Sa.prototype.evaluate = function (t, e, i, r, n, a) {
                    this._evaluator.globals = t, this._evaluator.feature = e || null, this._evaluator.featureState = i || null, this._evaluator.canonical = r, this._evaluator.availableImages = n || null, this._evaluator.formattedSection = a || null;
                    try {
                        var o = this.expression.evaluate(this._evaluator);
                        if (null == o || "number" == typeof o && o != o) return this._defaultValue;
                        if (this._enumValues && !(o in this._enumValues)) throw new Zr("Expected value to be one of " + Object.keys(this._enumValues).map(function (t) {
                            return JSON.stringify(t)
                        }).join(", ") + ", but found " + JSON.stringify(o) + " instead.");
                        return o
                    } catch (t) {
                        return this._warningHistory[t.message] || (this._warningHistory[t.message] = !0, "undefined" != typeof console && console.warn(t.message)), this._defaultValue
                    }
                };
                var Ta = function (t, e) {
                    this.kind = t, this._styleExpression = e, this.isStateDependent = "constant" !== t && !xn(e.expression)
                };
                Ta.prototype.evaluateWithoutErrorHandling = function (t, e, i, r, n, a) {
                    return this._styleExpression.evaluateWithoutErrorHandling(t, e, i, r, n, a)
                }, Ta.prototype.evaluate = function (t, e, i, r, n, a) {
                    return this._styleExpression.evaluate(t, e, i, r, n, a)
                };
                var Ca = function (t, e, i, r) {
                    this.kind = t, this.zoomStops = i, this._styleExpression = e, this.isStateDependent = "camera" !== t && !xn(e.expression), this.interpolationType = r
                };

                function Pa(t, e) {
                    if ("error" === (t = Ia(t, e)).result) return t;
                    var i = t.value.expression, r = vn(i);
                    if (!r && !da(e)) return fa([new Sr("", "data expressions not supported")]);
                    var n = bn(i, ["zoom"]);
                    if (!n && !ma(e)) return fa([new Sr("", "zoom expressions not supported")]);
                    var a = function i(t) {
                        var r = null;
                        if (t instanceof qn) r = i(t.result); else if (t instanceof jn) for (var e = 0, n = t.args; e < n.length && !(r = i(n[e])); e += 1) ; else (t instanceof En || t instanceof Nn) && t.input instanceof tn && "zoom" === t.input.name && (r = t);
                        return r instanceof Sr || t.eachChild(function (t) {
                            var e = i(t);
                            e instanceof Sr ? r = e : !r && e ? r = new Sr("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : r && e && r !== e && (r = new Sr("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))
                        }), r
                    }(i);
                    return a || n ? a instanceof Sr ? fa([a]) : a instanceof Nn && !ya(e) ? fa([new Sr("", '"interpolate" expressions cannot be used with this property')]) : pa(a ? new Ca(r ? "camera" : "composite", t.value, a.labels, a instanceof Nn ? a.interpolation : void 0) : new Ta(r ? "constant" : "source", t.value)) : fa([new Sr("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])
                }

                Ca.prototype.evaluateWithoutErrorHandling = function (t, e, i, r, n, a) {
                    return this._styleExpression.evaluateWithoutErrorHandling(t, e, i, r, n, a)
                }, Ca.prototype.evaluate = function (t, e, i, r, n, a) {
                    return this._styleExpression.evaluate(t, e, i, r, n, a)
                }, Ca.prototype.interpolationFactor = function (t, e, i) {
                    return this.interpolationType ? Nn.interpolationFactor(this.interpolationType, t, e, i) : 0
                };
                var Aa = function (t, e) {
                    this._parameters = t, this._specification = e, Mr(this, function t(r, n) {
                        var a, o, s, e = "color" === n.type, i = r.stops && "object" == typeof r.stops[0][0],
                            l = i || !(i || void 0 !== r.property), u = r.type || (ya(n) ? "exponential" : "interval");
                        if (e && ((r = Mr({}, r)).stops && (r.stops = r.stops.map(function (t) {
                            return [t[0], S.parse(t[1])]
                        })), r.default = S.parse(r.default ? r.default : n.default)), r.colorSpace && "rgb" !== r.colorSpace && !Un[r.colorSpace]) throw new Error("Unknown color space: " + r.colorSpace);
                        if ("exponential" === u) a = wa; else if ("interval" === u) a = ba; else if ("categorical" === u) {
                            a = xa, o = Object.create(null);
                            for (var h = 0, c = r.stops; h < c.length; h += 1) {
                                var p = c[h];
                                o[p[0]] = p[1]
                            }
                            s = typeof r.stops[0][0]
                        } else {
                            if ("identity" !== u) throw new Error('Unknown function type "' + u + '"');
                            a = Ma
                        }
                        if (i) {
                            for (var f = {}, d = [], m = 0; m < r.stops.length; m++) {
                                var y = r.stops[m], g = y[0].zoom;
                                void 0 === f[g] && (f[g] = {
                                    zoom: g,
                                    type: r.type,
                                    property: r.property,
                                    default: r.default,
                                    stops: []
                                }, d.push(g)), f[g].stops.push([y[0].value, y[1]])
                            }
                            for (var _ = [], v = 0, x = d; v < x.length; v += 1) {
                                var b = x[v];
                                _.push([f[b].zoom, t(f[b], n)])
                            }
                            var w = {name: "linear"};
                            return {
                                kind: "composite",
                                interpolationType: w,
                                interpolationFactor: Nn.interpolationFactor.bind(void 0, w),
                                zoomStops: _.map(function (t) {
                                    return t[0]
                                }),
                                evaluate: function (t, e) {
                                    var i = t.zoom;
                                    return wa({stops: _, base: r.base}, n, i).evaluate(i, e)
                                }
                            }
                        }
                        if (l) {
                            var M = "exponential" === u ? {
                                name: "exponential",
                                base: void 0 !== r.base ? r.base : 1
                            } : null;
                            return {
                                kind: "camera",
                                interpolationType: M,
                                interpolationFactor: Nn.interpolationFactor.bind(void 0, M),
                                zoomStops: r.stops.map(function (t) {
                                    return t[0]
                                }),
                                evaluate: function (t) {
                                    return a(r, n, t.zoom, o, s)
                                }
                            }
                        }
                        return {
                            kind: "source", evaluate: function (t, e) {
                                var i = e && e.properties ? e.properties[r.property] : void 0;
                                return void 0 === i ? va(r.default, n.default) : a(r, n, i, o, s)
                            }
                        }
                    }(this._parameters, this._specification))
                };
                Aa.deserialize = function (t) {
                    return new Aa(t._parameters, t._specification)
                }, Aa.serialize = function (t) {
                    return {_parameters: t._parameters, _specification: t._specification}
                };
                var za = c.ImageData, ka = c.ImageBitmap, La = {};

                function e(t, e, i) {
                    void 0 === i && (i = {}), Object.defineProperty(e, "_classRegistryKey", {
                        value: t,
                        writeable: !1
                    }), La[t] = {klass: e, omit: i.omit || [], shallow: i.shallow || []}
                }

                for (var Da in e("Object", Object), xr.serialize = function (t, e) {
                    var i = t.toArrayBuffer();
                    return e && e.push(i), {buffer: i}
                }, xr.deserialize = function (t) {
                    return new xr(t.buffer)
                }, e("Grid", xr), e("Color", S), e("Error", Error), e("ResolvedImage", Nr), e("StylePropertyFunction", Aa), e("StyleExpression", Sa, {omit: ["_evaluator"]}), e("ZoomDependentExpression", Ca), e("ZoomConstantExpression", Ta), e("CompoundExpression", tn, {omit: ["_evaluate"]}), sa) sa[Da]._classRegistryKey || e("Expression_" + Da, sa[Da]);

                function Ra(t) {
                    return t && "undefined" != typeof ArrayBuffer && (t instanceof ArrayBuffer || t.constructor && "ArrayBuffer" === t.constructor.name)
                }

                function Ba(t) {
                    return ka && t instanceof ka
                }

                function Oa(t, e) {
                    if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp) return t;
                    if (Ra(t) || Ba(t)) return e && e.push(t), t;
                    if (ArrayBuffer.isView(t)) {
                        var i = t;
                        return e && e.push(i.buffer), i
                    }
                    if (t instanceof za) return e && e.push(t.data.buffer), t;
                    if (Array.isArray(t)) {
                        for (var r = [], n = 0, a = t; n < a.length; n += 1) r.push(Oa(a[n], e));
                        return r
                    }
                    if ("object" == typeof t) {
                        var o = t.constructor, s = o._classRegistryKey;
                        if (!s) throw new Error("can't serialize object of unregistered class");
                        var l = o.serialize ? o.serialize(t, e) : {};
                        if (!o.serialize) {
                            for (var u in t) if (t.hasOwnProperty(u) && !(La[s].omit.indexOf(u) >= 0)) {
                                var h = t[u];
                                l[u] = La[s].shallow.indexOf(u) >= 0 ? h : Oa(h, e)
                            }
                            t instanceof Error && (l.message = t.message)
                        }
                        if (l.$name) throw new Error("$name property is reserved for worker serialization logic.");
                        return "Object" !== s && (l.$name = s), l
                    }
                    throw new Error("can't serialize object of type " + typeof t)
                }

                function Fa(t) {
                    if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp || Ra(t) || Ba(t) || ArrayBuffer.isView(t) || t instanceof za) return t;
                    if (Array.isArray(t)) return t.map(Fa);
                    if ("object" == typeof t) {
                        var e = t.$name || "Object", i = La[e].klass;
                        if (!i) throw new Error("can't deserialize unregistered class " + e);
                        if (i.deserialize) return i.deserialize(t);
                        for (var r = Object.create(i.prototype), n = 0, a = Object.keys(t); n < a.length; n += 1) {
                            var o = a[n];
                            if ("$name" !== o) {
                                var s = t[o];
                                r[o] = La[e].shallow.indexOf(o) >= 0 ? s : Fa(s)
                            }
                        }
                        return r
                    }
                    throw new Error("can't deserialize object of type " + typeof t)
                }

                function Ua(t, e, i, r) {
                    var n = e.width, a = e.height;
                    if (r) {
                        if (r instanceof Uint8ClampedArray) r = new Uint8Array(r.buffer); else if (r.length !== n * a * i) throw new RangeError("mismatched image size")
                    } else r = new Uint8Array(n * a * i);
                    return t.width = n, t.height = a, t.data = r, t
                }

                function Na(t, e, i) {
                    var r = e.width, n = e.height;
                    if (r !== t.width || n !== t.height) {
                        var a = Ua({}, {width: r, height: n}, i);
                        Va(t, a, {x: 0, y: 0}, {x: 0, y: 0}, {
                            width: Math.min(t.width, r),
                            height: Math.min(t.height, n)
                        }, i), t.width = r, t.height = n, t.data = a.data
                    }
                }

                function Va(t, e, i, r, n, a) {
                    if (0 === n.width || 0 === n.height) return e;
                    if (n.width > t.width || n.height > t.height || i.x > t.width - n.width || i.y > t.height - n.height) throw new RangeError("out of range source coordinates for image copy");
                    if (n.width > e.width || n.height > e.height || r.x > e.width - n.width || r.y > e.height - n.height) throw new RangeError("out of range destination coordinates for image copy");
                    for (var o = t.data, s = e.data, l = 0; l < n.height; l++) for (var u = ((i.y + l) * t.width + i.x) * a, h = ((r.y + l) * e.width + r.x) * a, c = 0; c < n.width * a; c++) s[h + c] = o[u + c];
                    return e
                }

                var ja = function (t, e) {
                    Ua(this, t, 1, e)
                };
                ja.prototype.resize = function (t) {
                    Na(this, t, 1)
                }, ja.prototype.clone = function () {
                    return new ja({width: this.width, height: this.height}, new Uint8Array(this.data))
                }, ja.copy = function (t, e, i, r, n) {
                    Va(t, e, i, r, n, 1)
                };
                var x = function (t, e) {
                    Ua(this, t, 4, e)
                };

                function qa(t, e, i) {
                    i[t] && -1 !== i[t].indexOf(e) || (i[t] = i[t] || [], i[t].push(e))
                }

                function Ga(t, e, i) {
                    if (i && i[t]) {
                        var r = i[t].indexOf(e);
                        -1 !== r && i[t].splice(r, 1)
                    }
                }

                x.prototype.resize = function (t) {
                    Na(this, t, 4)
                }, x.prototype.replace = function (t, e) {
                    e ? this.data.set(t) : this.data = t instanceof Uint8ClampedArray ? new Uint8Array(t.buffer) : t
                }, x.prototype.clone = function () {
                    return new x({width: this.width, height: this.height}, new Uint8Array(this.data))
                }, x.copy = function (t, e, i, r, n) {
                    Va(t, e, i, r, n, 4)
                }, e("AlphaImage", ja), e("RGBAImage", x);
                var Za = function (t, e) {
                    void 0 === e && (e = {}), V(this, e), this.type = t
                }, Wa = function (i) {
                    function t(t, e) {
                        void 0 === e && (e = {}), i.call(this, "error", V({error: t}, e))
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t
                }(Za), Xa = function () {
                };
                Xa.prototype.on = function (t, e) {
                    return this._listeners = this._listeners || {}, qa(t, e, this._listeners), this
                }, Xa.prototype.off = function (t, e) {
                    return Ga(t, e, this._listeners), Ga(t, e, this._oneTimeListeners), this
                }, Xa.prototype.once = function (t, e) {
                    return this._oneTimeListeners = this._oneTimeListeners || {}, qa(t, e, this._oneTimeListeners), this
                }, Xa.prototype.fire = function (t, e) {
                    "string" == typeof t && (t = new Za(t, e || {}));
                    var i = t.type;
                    if (this.listens(i)) {
                        t.target = this;
                        for (var r = 0, n = this._listeners && this._listeners[i] ? this._listeners[i].slice() : []; r < n.length; r += 1) n[r].call(this, t);
                        for (var a = 0, o = this._oneTimeListeners && this._oneTimeListeners[i] ? this._oneTimeListeners[i].slice() : []; a < o.length; a += 1) {
                            var s = o[a];
                            Ga(i, s, this._oneTimeListeners), s.call(this, t)
                        }
                        var l = this._eventedParent;
                        l && (V(t, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), l.fire(t))
                    } else t instanceof Wa && console.error(t.error);
                    return this
                }, Xa.prototype.listens = function (t) {
                    return this._listeners && this._listeners[t] && this._listeners[t].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t] && this._oneTimeListeners[t].length > 0 || this._eventedParent && this._eventedParent.listens(t)
                }, Xa.prototype.setEventedParent = function (t, e) {
                    return this._eventedParent = t, this._eventedParentData = e, this
                };
                var a = {
                    $version: 8,
                    $root: {
                        version: {required: !0, type: "enum", values: [8]},
                        name: {type: "string"},
                        metadata: {type: "*"},
                        center: {type: "array", value: "number"},
                        zoom: {type: "number"},
                        bearing: {type: "number", default: 0, period: 360, units: "degrees"},
                        pitch: {type: "number", default: 0, units: "degrees"},
                        light: {type: "light"},
                        sources: {required: !0, type: "sources"},
                        sprite: {type: "stringobject"},
                        glyphs: {type: "stringobject"},
                        transition: {type: "transition"},
                        layers: {required: !0, type: "array", value: "layer"}
                    },
                    sources: {"*": {type: "source"}},
                    source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"],
                    source_vector: {
                        type: {required: !0, type: "enum", values: {vector: {}}},
                        url: {type: "string"},
                        tiles: {type: "array", value: "string"},
                        bounds: {
                            type: "array",
                            value: "number",
                            length: 4,
                            default: [-180, -85.051129, 180, 85.051129]
                        },
                        scheme: {type: "enum", values: {xyz: {}, tms: {}}, default: "xyz"},
                        minzoom: {type: "number", default: 0},
                        maxzoom: {type: "number", default: 22},
                        attribution: {type: "string"},
                        promoteId: {type: "promoteId"},
                        volatile: {type: "boolean", default: !1},
                        "*": {type: "*"}
                    },
                    source_raster: {
                        type: {required: !0, type: "enum", values: {raster: {}}},
                        url: {type: "string"},
                        tiles: {type: "array", value: "string"},
                        bounds: {
                            type: "array",
                            value: "number",
                            length: 4,
                            default: [-180, -85.051129, 180, 85.051129]
                        },
                        minzoom: {type: "number", default: 0},
                        maxzoom: {type: "number", default: 22},
                        tileSize: {type: "number", default: 512, units: "pixels"},
                        scheme: {type: "enum", values: {xyz: {}, tms: {}}, default: "xyz"},
                        attribution: {type: "string"},
                        volatile: {type: "boolean", default: !1},
                        "*": {type: "*"}
                    },
                    source_raster_dem: {
                        type: {required: !0, type: "enum", values: {"raster-dem": {}}},
                        url: {type: "string"},
                        tiles: {type: "array", value: "string"},
                        bounds: {
                            type: "array",
                            value: "number",
                            length: 4,
                            default: [-180, -85.051129, 180, 85.051129]
                        },
                        minzoom: {type: "number", default: 0},
                        maxzoom: {type: "number", default: 22},
                        tileSize: {type: "number", default: 512, units: "pixels"},
                        attribution: {type: "string"},
                        encoding: {type: "enum", values: {terrarium: {}, mapbox: {}}, default: "mapbox"},
                        volatile: {type: "boolean", default: !1},
                        "*": {type: "*"}
                    },
                    source_geojson: {
                        type: {required: !0, type: "enum", values: {geojson: {}}},
                        data: {type: "*"},
                        maxzoom: {type: "number", default: 18},
                        attribution: {type: "string"},
                        customprj: {type: "*"},
                        buffer: {type: "number", default: 128, maximum: 512, minimum: 0},
                        filter: {type: "*"},
                        tolerance: {type: "number", default: .375},
                        cluster: {type: "boolean", default: !1},
                        clusterRadius: {type: "number", default: 50, minimum: 0},
                        clusterMaxZoom: {type: "number"},
                        clusterMinPoints: {type: "number"},
                        clusterProperties: {type: "*"},
                        lineMetrics: {type: "boolean", default: !1},
                        generateId: {type: "boolean", default: !1},
                        promoteId: {type: "promoteId"}
                    },
                    source_video: {
                        type: {required: !0, type: "enum", values: {video: {}}},
                        urls: {required: !0, type: "array", value: "string"},
                        coordinates: {
                            required: !0,
                            type: "array",
                            length: 4,
                            value: {type: "array", length: 2, value: "number"}
                        }
                    },
                    source_image: {
                        type: {required: !0, type: "enum", values: {image: {}}},
                        url: {required: !0, type: "string"},
                        coordinates: {
                            required: !0,
                            type: "array",
                            length: 4,
                            value: {type: "array", length: 2, value: "number"}
                        }
                    },
                    layer: {
                        id: {type: "string", required: !0},
                        type: {
                            type: "enum",
                            values: {
                                fill: {},
                                line: {},
                                symbol: {},
                                circle: {},
                                heatmap: {},
                                "fill-extrusion": {},
                                raster: {},
                                hillshade: {},
                                background: {}
                            },
                            required: !0
                        },
                        metadata: {type: "*"},
                        source: {type: "string"},
                        "source-layer": {type: "string"},
                        minzoom: {type: "number", minimum: 0, maximum: 24},
                        maxzoom: {type: "number", minimum: 0, maximum: 24},
                        filter: {type: "filter"},
                        layout: {type: "layout"},
                        paint: {type: "paint"}
                    },
                    layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_fill-extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background"],
                    layout_background: {
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_fill: {
                        "fill-sort-key": {
                            type: "number",
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_circle: {
                        "circle-sort-key": {
                            type: "number",
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_heatmap: {
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    "layout_fill-extrusion": {
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_line: {
                        "line-cap": {
                            type: "enum",
                            values: {butt: {}, round: {}, square: {}},
                            default: "butt",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "line-join": {
                            type: "enum",
                            values: {bevel: {}, round: {}, miter: {}},
                            default: "miter",
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "line-miter-limit": {
                            type: "number",
                            default: 2,
                            requires: [{"line-join": "miter"}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "line-round-limit": {
                            type: "number",
                            default: 1.05,
                            requires: [{"line-join": "round"}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "line-sort-key": {
                            type: "number",
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_symbol: {
                        "symbol-placement": {
                            type: "enum",
                            values: {point: {}, line: {}, "line-center": {}},
                            default: "point",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "symbol-spacing": {
                            type: "number",
                            default: 250,
                            minimum: 1,
                            units: "pixels",
                            requires: [{"symbol-placement": "line"}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "symbol-avoid-edges": {
                            type: "boolean",
                            default: !1,
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "symbol-sort-key": {
                            type: "number",
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "symbol-z-order": {
                            type: "enum",
                            values: {auto: {}, "viewport-y": {}, source: {}},
                            default: "auto",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-allow-overlap": {
                            type: "boolean",
                            default: !1,
                            requires: ["icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-ignore-placement": {
                            type: "boolean",
                            default: !1,
                            requires: ["icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-optional": {
                            type: "boolean",
                            default: !1,
                            requires: ["icon-image", "text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-rotation-alignment": {
                            type: "enum",
                            values: {map: {}, viewport: {}, auto: {}},
                            default: "auto",
                            requires: ["icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-size": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            units: "factor of the original icon size",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "icon-text-fit": {
                            type: "enum",
                            values: {none: {}, width: {}, height: {}, both: {}},
                            default: "none",
                            requires: ["icon-image", "text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-text-fit-padding": {
                            type: "array",
                            value: "number",
                            length: 4,
                            default: [0, 0, 0, 0],
                            units: "pixels",
                            requires: ["icon-image", "text-field", {"icon-text-fit": ["both", "width", "height"]}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-image": {
                            type: "resolvedImage",
                            tokens: !0,
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "icon-rotate": {
                            type: "number",
                            default: 0,
                            period: 360,
                            units: "degrees",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "icon-padding": {
                            type: "number",
                            default: 2,
                            minimum: 0,
                            units: "pixels",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-keep-upright": {
                            type: "boolean",
                            default: !1,
                            requires: ["icon-image", {"icon-rotation-alignment": "map"}, {"symbol-placement": ["line", "line-center"]}],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-offset": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "icon-anchor": {
                            type: "enum",
                            values: {
                                center: {},
                                left: {},
                                right: {},
                                top: {},
                                bottom: {},
                                "top-left": {},
                                "top-right": {},
                                "bottom-left": {},
                                "bottom-right": {}
                            },
                            default: "center",
                            requires: ["icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "icon-pitch-alignment": {
                            type: "enum",
                            values: {map: {}, viewport: {}, auto: {}},
                            default: "auto",
                            requires: ["icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-pitch-alignment": {
                            type: "enum",
                            values: {map: {}, viewport: {}, auto: {}},
                            default: "auto",
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-rotation-alignment": {
                            type: "enum",
                            values: {map: {}, viewport: {}, auto: {}},
                            default: "auto",
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-field": {
                            type: "formatted",
                            default: "",
                            tokens: !0,
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-font": {
                            type: "array",
                            value: "string",
                            default: ["Open Sans Regular", "Arial Unicode MS Regular"],
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-size": {
                            type: "number",
                            default: 16,
                            minimum: 0,
                            units: "pixels",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-max-width": {
                            type: "number",
                            default: 10,
                            minimum: 0,
                            units: "ems",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-line-height": {
                            type: "number",
                            default: 1.2,
                            units: "ems",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-letter-spacing": {
                            type: "number",
                            default: 0,
                            units: "ems",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-justify": {
                            type: "enum",
                            values: {auto: {}, left: {}, center: {}, right: {}},
                            default: "center",
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-radial-offset": {
                            type: "number",
                            units: "ems",
                            default: 0,
                            requires: ["text-field"],
                            "property-type": "data-driven",
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]}
                        },
                        "text-variable-anchor": {
                            type: "array",
                            value: "enum",
                            values: {
                                center: {},
                                left: {},
                                right: {},
                                top: {},
                                bottom: {},
                                "top-left": {},
                                "top-right": {},
                                "bottom-left": {},
                                "bottom-right": {}
                            },
                            requires: ["text-field", {"symbol-placement": ["point"]}],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-anchor": {
                            type: "enum",
                            values: {
                                center: {},
                                left: {},
                                right: {},
                                top: {},
                                bottom: {},
                                "top-left": {},
                                "top-right": {},
                                "bottom-left": {},
                                "bottom-right": {}
                            },
                            default: "center",
                            requires: ["text-field", {"!": "text-variable-anchor"}],
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-max-angle": {
                            type: "number",
                            default: 45,
                            units: "degrees",
                            requires: ["text-field", {"symbol-placement": ["line", "line-center"]}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-writing-mode": {
                            type: "array",
                            value: "enum",
                            values: {horizontal: {}, vertical: {}},
                            requires: ["text-field", {"symbol-placement": ["point"]}],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-rotate": {
                            type: "number",
                            default: 0,
                            period: 360,
                            units: "degrees",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-padding": {
                            type: "number",
                            default: 2,
                            minimum: 0,
                            units: "pixels",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-keep-upright": {
                            type: "boolean",
                            default: !0,
                            requires: ["text-field", {"text-rotation-alignment": "map"}, {"symbol-placement": ["line", "line-center"]}],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-transform": {
                            type: "enum",
                            values: {none: {}, uppercase: {}, lowercase: {}},
                            default: "none",
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-offset": {
                            type: "array",
                            value: "number",
                            units: "ems",
                            length: 2,
                            default: [0, 0],
                            requires: ["text-field", {"!": "text-radial-offset"}],
                            expression: {interpolated: !0, parameters: ["zoom", "feature"]},
                            "property-type": "data-driven"
                        },
                        "text-allow-overlap": {
                            type: "boolean",
                            default: !1,
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-ignore-placement": {
                            type: "boolean",
                            default: !1,
                            requires: ["text-field"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-optional": {
                            type: "boolean",
                            default: !1,
                            requires: ["text-field", "icon-image"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_raster: {
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    layout_hillshade: {
                        visibility: {
                            type: "enum",
                            values: {visible: {}, none: {}},
                            default: "visible",
                            "property-type": "constant"
                        }
                    },
                    filter: {type: "array", value: "*"},
                    filter_operator: {
                        type: "enum",
                        values: {
                            "==": {},
                            "!=": {},
                            ">": {},
                            ">=": {},
                            "<": {},
                            "<=": {},
                            in: {},
                            "!in": {},
                            all: {},
                            any: {},
                            none: {},
                            has: {},
                            "!has": {},
                            within: {}
                        }
                    },
                    geometry_type: {type: "enum", values: {Point: {}, LineString: {}, Polygon: {}}},
                    function: {
                        expression: {type: "expression"},
                        stops: {type: "array", value: "function_stop"},
                        base: {type: "number", default: 1, minimum: 0},
                        property: {type: "string", default: "$zoom"},
                        type: {
                            type: "enum",
                            values: {identity: {}, exponential: {}, interval: {}, categorical: {}},
                            default: "exponential"
                        },
                        colorSpace: {type: "enum", values: {rgb: {}, lab: {}, hcl: {}}, default: "rgb"},
                        default: {type: "*", required: !1}
                    },
                    function_stop: {type: "array", minimum: 0, maximum: 24, value: ["number", "color"], length: 2},
                    expression: {type: "array", value: "*", minimum: 1},
                    light: {
                        anchor: {
                            type: "enum",
                            default: "viewport",
                            values: {map: {}, viewport: {}},
                            "property-type": "data-constant",
                            transition: !1,
                            expression: {interpolated: !1, parameters: ["zoom"]}
                        },
                        position: {
                            type: "array",
                            default: [1.15, 210, 30],
                            length: 3,
                            value: "number",
                            "property-type": "data-constant",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]}
                        },
                        color: {
                            type: "color",
                            "property-type": "data-constant",
                            default: "#ffffff",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            transition: !0
                        },
                        intensity: {
                            type: "number",
                            "property-type": "data-constant",
                            default: .5,
                            minimum: 0,
                            maximum: 1,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            transition: !0
                        }
                    },
                    paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_fill-extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background"],
                    paint_fill: {
                        "fill-antialias": {
                            type: "boolean",
                            default: !0,
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            requires: [{"!": "fill-pattern"}],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-outline-color": {
                            type: "color",
                            transition: !0,
                            requires: [{"!": "fill-pattern"}, {"fill-antialias": !0}],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["fill-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-pattern": {
                            type: "resolvedImage",
                            transition: !0,
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "cross-faded-data-driven"
                        }
                    },
                    "paint_fill-extrusion": {
                        "fill-extrusion-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-extrusion-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            requires: [{"!": "fill-extrusion-pattern"}],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-extrusion-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-extrusion-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["fill-extrusion-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "fill-extrusion-pattern": {
                            type: "resolvedImage",
                            transition: !0,
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "cross-faded-data-driven"
                        },
                        "fill-extrusion-height": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            units: "meters",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-extrusion-base": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            units: "meters",
                            transition: !0,
                            requires: ["fill-extrusion-height"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "fill-extrusion-vertical-gradient": {
                            type: "boolean",
                            default: !0,
                            transition: !1,
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    paint_line: {
                        "line-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            requires: [{"!": "line-pattern"}],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "line-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["line-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "line-width": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-gap-width": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-offset": {
                            type: "number",
                            default: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-blur": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "line-dasharray": {
                            type: "array",
                            value: "number",
                            minimum: 0,
                            transition: !0,
                            units: "line widths",
                            requires: [{"!": "line-pattern"}],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "cross-faded"
                        },
                        "line-pattern": {
                            type: "resolvedImage",
                            transition: !0,
                            expression: {interpolated: !1, parameters: ["zoom", "feature"]},
                            "property-type": "cross-faded-data-driven"
                        },
                        "line-gradient": {
                            type: "color",
                            transition: !1,
                            requires: [{"!": "line-dasharray"}, {"!": "line-pattern"}, {
                                source: "geojson",
                                has: {lineMetrics: !0}
                            }],
                            expression: {interpolated: !0, parameters: ["line-progress"]},
                            "property-type": "color-ramp"
                        }
                    },
                    paint_circle: {
                        "circle-radius": {
                            type: "number",
                            default: 5,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-blur": {
                            type: "number",
                            default: 0,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "circle-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["circle-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "circle-pitch-scale": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "circle-pitch-alignment": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "viewport",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "circle-stroke-width": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-stroke-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "circle-stroke-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        }
                    },
                    paint_heatmap: {
                        "heatmap-radius": {
                            type: "number",
                            default: 30,
                            minimum: 1,
                            transition: !0,
                            units: "pixels",
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "heatmap-weight": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            transition: !1,
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "heatmap-intensity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "heatmap-color": {
                            type: "color",
                            default: ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", .1, "royalblue", .3, "cyan", .5, "lime", .7, "yellow", 1, "red"],
                            transition: !1,
                            expression: {interpolated: !0, parameters: ["heatmap-density"]},
                            "property-type": "color-ramp"
                        },
                        "heatmap-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    paint_symbol: {
                        "icon-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "icon-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "icon-halo-color": {
                            type: "color",
                            default: "rgba(0, 0, 0, 0)",
                            transition: !0,
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "icon-halo-width": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "icon-halo-blur": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "icon-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            requires: ["icon-image"],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "icon-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["icon-image", "icon-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "text-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            overridable: !0,
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "text-halo-color": {
                            type: "color",
                            default: "rgba(0, 0, 0, 0)",
                            transition: !0,
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "text-halo-width": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "text-halo-blur": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            transition: !0,
                            units: "pixels",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom", "feature", "feature-state"]},
                            "property-type": "data-driven"
                        },
                        "text-translate": {
                            type: "array",
                            value: "number",
                            length: 2,
                            default: [0, 0],
                            transition: !0,
                            units: "pixels",
                            requires: ["text-field"],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "text-translate-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "map",
                            requires: ["text-field", "text-translate"],
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    paint_raster: {
                        "raster-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-hue-rotate": {
                            type: "number",
                            default: 0,
                            period: 360,
                            transition: !0,
                            units: "degrees",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-brightness-min": {
                            type: "number",
                            default: 0,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-brightness-max": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-saturation": {
                            type: "number",
                            default: 0,
                            minimum: -1,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-contrast": {
                            type: "number",
                            default: 0,
                            minimum: -1,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-resampling": {
                            type: "enum",
                            values: {linear: {}, nearest: {}},
                            default: "linear",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "raster-fade-duration": {
                            type: "number",
                            default: 300,
                            minimum: 0,
                            transition: !1,
                            units: "milliseconds",
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    paint_hillshade: {
                        "hillshade-illumination-direction": {
                            type: "number",
                            default: 335,
                            minimum: 0,
                            maximum: 359,
                            transition: !1,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "hillshade-illumination-anchor": {
                            type: "enum",
                            values: {map: {}, viewport: {}},
                            default: "viewport",
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "hillshade-exaggeration": {
                            type: "number",
                            default: .5,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "hillshade-shadow-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "hillshade-highlight-color": {
                            type: "color",
                            default: "#FFFFFF",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "hillshade-accent-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    paint_background: {
                        "background-color": {
                            type: "color",
                            default: "#000000",
                            transition: !0,
                            requires: [{"!": "background-pattern"}],
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        },
                        "background-pattern": {
                            type: "resolvedImage",
                            transition: !0,
                            expression: {interpolated: !1, parameters: ["zoom"]},
                            "property-type": "cross-faded"
                        },
                        "background-opacity": {
                            type: "number",
                            default: 1,
                            minimum: 0,
                            maximum: 1,
                            transition: !0,
                            expression: {interpolated: !0, parameters: ["zoom"]},
                            "property-type": "data-constant"
                        }
                    },
                    transition: {
                        duration: {type: "number", default: 300, minimum: 0, units: "milliseconds"},
                        delay: {type: "number", default: 0, minimum: 0, units: "milliseconds"}
                    },
                    "property-type": {
                        "data-driven": {type: "property-type"},
                        "cross-faded": {type: "property-type"},
                        "cross-faded-data-driven": {type: "property-type"},
                        "color-ramp": {type: "property-type"},
                        "data-constant": {type: "property-type"},
                        constant: {type: "property-type"}
                    },
                    promoteId: {"*": {type: "string"}}
                }, m = function (t, e, i, r) {
                    this.message = (t ? t + ": " : "") + i, r && (this.identifier = r), null != e && e.__line__ && (this.line = e.__line__)
                };

                function Ha(t) {
                    var e = t.value;
                    return e ? [new m(t.key, e, "constants have been deprecated as of v8")] : []
                }

                function b(t) {
                    return t instanceof Number || t instanceof String || t instanceof Boolean ? t.valueOf() : t
                }

                function Ka(t) {
                    if (Array.isArray(t)) return t.map(Ka);
                    if (t instanceof Object && !(t instanceof Number || t instanceof String || t instanceof Boolean)) {
                        var e = {};
                        for (var i in t) e[i] = Ka(t[i]);
                        return e
                    }
                    return b(t)
                }

                function Ya(t) {
                    var e = t.key, i = t.value, r = t.valueSpec || {}, n = t.objectElementValidators || {}, a = t.style,
                        o = t.styleSpec, s = [], l = d(i);
                    if ("object" !== l) return [new m(e, i, "object expected, " + l + " found")];
                    for (var u in i) {
                        var h = u.split(".")[0], c = r[h] || r["*"], p = void 0;
                        if (n[h]) p = n[h]; else if (r[h]) p = wo; else if (n["*"]) p = n["*"]; else {
                            if (!r["*"]) {
                                s.push(new m(e, i[u], 'unknown property "' + u + '"'));
                                continue
                            }
                            p = wo
                        }
                        s = s.concat(p({
                            key: (e ? e + "." : e) + u,
                            value: i[u],
                            valueSpec: c,
                            style: a,
                            styleSpec: o,
                            object: i,
                            objectKey: u
                        }, i))
                    }
                    for (var f in r) n[f] || r[f].required && void 0 === r[f].default && void 0 === i[f] && s.push(new m(e, i, 'missing required property "' + f + '"'));
                    return s
                }

                function Ja(t) {
                    var e = t.value, i = t.valueSpec, r = t.style, n = t.styleSpec, a = t.key,
                        o = t.arrayElementValidator || wo;
                    if ("array" !== d(e)) return [new m(a, e, "array expected, " + d(e) + " found")];
                    if (i.length && e.length !== i.length) return [new m(a, e, "array length " + i.length + " expected, length " + e.length + " found")];
                    if (i["min-length"] && e.length < i["min-length"]) return [new m(a, e, "array length at least " + i["min-length"] + " expected, length " + e.length + " found")];
                    var s = {type: i.value, values: i.values};
                    n.$version < 7 && (s.function = i.function), "object" === d(i.value) && (s = i.value);
                    for (var l = [], u = 0; u < e.length; u++) l = l.concat(o({
                        array: e,
                        arrayIndex: u,
                        value: e[u],
                        valueSpec: s,
                        style: r,
                        styleSpec: n,
                        key: a + "[" + u + "]"
                    }));
                    return l
                }

                function Qa(t) {
                    var e = t.key, i = t.value, r = t.valueSpec, n = d(i);
                    return "number" === n && i != i && (n = "NaN"), "number" !== n ? [new m(e, i, "number expected, " + n + " found")] : "minimum" in r && i < r.minimum ? [new m(e, i, i + " is less than the minimum value " + r.minimum)] : "maximum" in r && i > r.maximum ? [new m(e, i, i + " is greater than the maximum value " + r.maximum)] : []
                }

                function $a(t) {
                    var o, s, n, l = t.valueSpec, u = b(t.value.type), h = {},
                        e = "categorical" !== u && void 0 === t.value.property, i = !e,
                        a = "array" === d(t.value.stops) && "array" === d(t.value.stops[0]) && "object" === d(t.value.stops[0][0]),
                        r = Ya({
                            key: t.key,
                            value: t.value,
                            valueSpec: t.styleSpec.function,
                            style: t.style,
                            styleSpec: t.styleSpec,
                            objectElementValidators: {
                                stops: function (t) {
                                    if ("identity" === u) return [new m(t.key, t.value, 'identity function may not have a "stops" property')];
                                    var e = [], i = t.value;
                                    return e = e.concat(Ja({
                                        key: t.key,
                                        value: i,
                                        valueSpec: t.valueSpec,
                                        style: t.style,
                                        styleSpec: t.styleSpec,
                                        arrayElementValidator: c
                                    })), "array" === d(i) && 0 === i.length && e.push(new m(t.key, i, "array must have at least one stop")), e
                                }, default: function (t) {
                                    return wo({
                                        key: t.key,
                                        value: t.value,
                                        valueSpec: l,
                                        style: t.style,
                                        styleSpec: t.styleSpec
                                    })
                                }
                            }
                        });
                    return "identity" === u && e && r.push(new m(t.key, t.value, 'missing required property "property"')), "identity" === u || t.value.stops || r.push(new m(t.key, t.value, 'missing required property "stops"')), "exponential" === u && t.valueSpec.expression && !ya(t.valueSpec) && r.push(new m(t.key, t.value, "exponential functions not supported")), t.styleSpec.$version >= 8 && (i && !da(t.valueSpec) ? r.push(new m(t.key, t.value, "property functions not supported")) : e && !ma(t.valueSpec) && r.push(new m(t.key, t.value, "zoom functions not supported"))), "categorical" !== u && !a || void 0 !== t.value.property || r.push(new m(t.key, t.value, '"property" property is required')), r;

                    function c(t) {
                        var e = [], i = t.value, r = t.key;
                        if ("array" !== d(i)) return [new m(r, i, "array expected, " + d(i) + " found")];
                        if (2 !== i.length) return [new m(r, i, "array length 2 expected, length " + i.length + " found")];
                        if (a) {
                            if ("object" !== d(i[0])) return [new m(r, i, "object expected, " + d(i[0]) + " found")];
                            if (void 0 === i[0].zoom) return [new m(r, i, "object stop key must have zoom")];
                            if (void 0 === i[0].value) return [new m(r, i, "object stop key must have value")];
                            if (n && n > b(i[0].zoom)) return [new m(r, i[0].zoom, "stop zoom values must appear in ascending order")];
                            b(i[0].zoom) !== n && (n = b(i[0].zoom), s = void 0, h = {}), e = e.concat(Ya({
                                key: r + "[0]",
                                value: i[0],
                                valueSpec: {zoom: {}},
                                style: t.style,
                                styleSpec: t.styleSpec,
                                objectElementValidators: {zoom: Qa, value: p}
                            }))
                        } else e = e.concat(p({
                            key: r + "[0]",
                            value: i[0],
                            valueSpec: {},
                            style: t.style,
                            styleSpec: t.styleSpec
                        }, i));
                        return Ea(Ka(i[1])) ? e.concat([new m(r + "[1]", i[1], "expressions are not allowed in function stops.")]) : e.concat(wo({
                            key: r + "[1]",
                            value: i[1],
                            valueSpec: l,
                            style: t.style,
                            styleSpec: t.styleSpec
                        }))
                    }

                    function p(t, e) {
                        var i = d(t.value), r = b(t.value), n = null !== t.value ? t.value : e;
                        if (o) {
                            if (i !== o) return [new m(t.key, n, i + " stop domain type must match previous stop domain type " + o)]
                        } else o = i;
                        if ("number" !== i && "string" !== i && "boolean" !== i) return [new m(t.key, n, "stop domain value must be a number, string, or boolean")];
                        if ("number" !== i && "categorical" !== u) {
                            var a = "number expected, " + i + " found";
                            return da(l) && void 0 === u && (a += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new m(t.key, n, a)]
                        }
                        return "categorical" !== u || "number" !== i || isFinite(r) && Math.floor(r) === r ? "categorical" !== u && "number" === i && void 0 !== s && r < s ? [new m(t.key, n, "stop domain values must appear in ascending order")] : (s = r, "categorical" === u && r in h ? [new m(t.key, n, "stop domain values must be unique")] : (h[r] = !0, [])) : [new m(t.key, n, "integer expected, found " + r)]
                    }
                }

                function to(e) {
                    var t = ("property" === e.expressionContext ? Pa : Ia)(Ka(e.value), e.valueSpec);
                    if ("error" === t.result) return t.value.map(function (t) {
                        return new m("" + e.key + t.key, e.value, t.message)
                    });
                    var i = t.value.expression || t.value._styleExpression.expression;
                    if ("property" === e.expressionContext && "text-font" === e.propertyKey && !i.outputDefined()) return [new m(e.key, e.value, 'Invalid data expression for "' + e.propertyKey + '". Output values must be contained as literals within the expression.')];
                    if ("property" === e.expressionContext && "layout" === e.propertyType && !xn(i)) return [new m(e.key, e.value, '"feature-state" data expressions are not supported with layout properties.')];
                    if ("filter" === e.expressionContext && !xn(i)) return [new m(e.key, e.value, '"feature-state" data expressions are not supported with filters.')];
                    if (e.expressionContext && 0 === e.expressionContext.indexOf("cluster")) {
                        if (!bn(i, ["zoom", "feature-state"])) return [new m(e.key, e.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
                        if ("cluster-initial" === e.expressionContext && !vn(i)) return [new m(e.key, e.value, "Feature data expressions are not supported with initial expression part of cluster properties.")]
                    }
                    return []
                }

                function eo(t) {
                    var e = t.key, i = t.value, r = t.valueSpec, n = [];
                    return Array.isArray(r.values) ? -1 === r.values.indexOf(b(i)) && n.push(new m(e, i, "expected one of [" + r.values.join(", ") + "], " + JSON.stringify(i) + " found")) : -1 === Object.keys(r.values).indexOf(b(i)) && n.push(new m(e, i, "expected one of [" + Object.keys(r.values).join(", ") + "], " + JSON.stringify(i) + " found")), n
                }

                function io(t) {
                    if (!0 === t || !1 === t) return !0;
                    if (!Array.isArray(t) || 0 === t.length) return !1;
                    switch (t[0]) {
                        case"has":
                            return t.length >= 2 && "$id" !== t[1] && "$type" !== t[1];
                        case"in":
                            return t.length >= 3 && ("string" != typeof t[1] || Array.isArray(t[2]));
                        case"!in":
                        case"!has":
                        case"none":
                            return !1;
                        case"==":
                        case"!=":
                        case">":
                        case">=":
                        case"<":
                        case"<=":
                            return 3 !== t.length || Array.isArray(t[1]) || Array.isArray(t[2]);
                        case"any":
                        case"all":
                            for (var e = 0, i = t.slice(1); e < i.length; e += 1) {
                                var r = i[e];
                                if (!io(r) && "boolean" != typeof r) return !1
                            }
                            return !0;
                        default:
                            return !0
                    }
                }

                var ro = {
                    type: "boolean",
                    default: !1,
                    transition: !1,
                    "property-type": "data-driven",
                    expression: {interpolated: !1, parameters: ["zoom", "feature"]}
                };

                function no(t) {
                    if (null == t) return {
                        filter: function () {
                            return !0
                        }, needGeometry: !1
                    };
                    io(t) || (t = oo(t));
                    var r = Ia(t, ro);
                    if ("error" === r.result) throw new Error(r.value.map(function (t) {
                        return t.key + ": " + t.message
                    }).join(", "));
                    return {
                        filter: function (t, e, i) {
                            return r.value.evaluate(t, e, {}, i)
                        }, needGeometry: function t(e) {
                            if (!Array.isArray(e)) return !1;
                            if ("within" === e[0]) return !0;
                            for (var i = 1; i < e.length; i++) if (t(e[i])) return !0;
                            return !1
                        }(t)
                    }
                }

                function ao(t, e) {
                    return t < e ? -1 : t > e ? 1 : 0
                }

                function oo(t) {
                    if (!t) return !0;
                    var e, i = t[0];
                    return t.length <= 1 ? "any" !== i : "==" === i ? so(t[1], t[2], "==") : "!=" === i ? ho(so(t[1], t[2], "==")) : "<" === i || ">" === i || "<=" === i || ">=" === i ? so(t[1], t[2], i) : "any" === i ? (e = t.slice(1), ["any"].concat(e.map(oo))) : "all" === i ? ["all"].concat(t.slice(1).map(oo)) : "none" === i ? ["all"].concat(t.slice(1).map(oo).map(ho)) : "in" === i ? lo(t[1], t.slice(2)) : "!in" === i ? ho(lo(t[1], t.slice(2))) : "has" === i ? uo(t[1]) : "!has" === i ? ho(uo(t[1])) : "within" !== i || t
                }

                function so(t, e, i) {
                    switch (t) {
                        case"$type":
                            return ["filter-type-" + i, e];
                        case"$id":
                            return ["filter-id-" + i, e];
                        default:
                            return ["filter-" + i, t, e]
                    }
                }

                function lo(t, e) {
                    if (0 === e.length) return !1;
                    switch (t) {
                        case"$type":
                            return ["filter-type-in", ["literal", e]];
                        case"$id":
                            return ["filter-id-in", ["literal", e]];
                        default:
                            return e.length > 200 && !e.some(function (t) {
                                return typeof t != typeof e[0]
                            }) ? ["filter-in-large", t, ["literal", e.sort(ao)]] : ["filter-in-small", t, ["literal", e]]
                    }
                }

                function uo(t) {
                    switch (t) {
                        case"$type":
                            return !0;
                        case"$id":
                            return ["filter-has-id"];
                        default:
                            return ["filter-has", t]
                    }
                }

                function ho(t) {
                    return ["!", t]
                }

                function co(t) {
                    return io(Ka(t.value)) ? to(Mr({}, t, {
                        expressionContext: "filter",
                        valueSpec: {value: "boolean"}
                    })) : function t(e) {
                        var i = e.value, r = e.key;
                        if ("array" !== d(i)) return [new m(r, i, "array expected, " + d(i) + " found")];
                        var n, a = e.styleSpec, o = [];
                        if (i.length < 1) return [new m(r, i, "filter array must have at least 1 element")];
                        switch (o = o.concat(eo({
                            key: r + "[0]",
                            value: i[0],
                            valueSpec: a.filter_operator,
                            style: e.style,
                            styleSpec: e.styleSpec
                        })), b(i[0])) {
                            case"<":
                            case"<=":
                            case">":
                            case">=":
                                i.length >= 2 && "$type" === b(i[1]) && o.push(new m(r, i, '"$type" cannot be use with operator "' + i[0] + '"'));
                            case"==":
                            case"!=":
                                3 !== i.length && o.push(new m(r, i, 'filter array for operator "' + i[0] + '" must have 3 elements'));
                            case"in":
                            case"!in":
                                i.length >= 2 && "string" !== (n = d(i[1])) && o.push(new m(r + "[1]", i[1], "string expected, " + n + " found"));
                                for (var s = 2; s < i.length; s++) n = d(i[s]), "$type" === b(i[1]) ? o = o.concat(eo({
                                    key: r + "[" + s + "]",
                                    value: i[s],
                                    valueSpec: a.geometry_type,
                                    style: e.style,
                                    styleSpec: e.styleSpec
                                })) : "string" !== n && "number" !== n && "boolean" !== n && o.push(new m(r + "[" + s + "]", i[s], "string, number, or boolean expected, " + n + " found"));
                                break;
                            case"any":
                            case"all":
                            case"none":
                                for (var l = 1; l < i.length; l++) o = o.concat(t({
                                    key: r + "[" + l + "]",
                                    value: i[l],
                                    style: e.style,
                                    styleSpec: e.styleSpec
                                }));
                                break;
                            case"has":
                            case"!has":
                                n = d(i[1]), 2 !== i.length ? o.push(new m(r, i, 'filter array for "' + i[0] + '" operator must have 2 elements')) : "string" !== n && o.push(new m(r + "[1]", i[1], "string expected, " + n + " found"));
                                break;
                            case"within":
                                n = d(i[1]), 2 !== i.length ? o.push(new m(r, i, 'filter array for "' + i[0] + '" operator must have 2 elements')) : "object" !== n && o.push(new m(r + "[1]", i[1], "object expected, " + n + " found"))
                        }
                        return o
                    }(t)
                }

                function po(t, e) {
                    var i = t.key, r = t.style, n = t.styleSpec, a = t.value, o = t.objectKey,
                        s = n[e + "_" + t.layerType];
                    if (!s) return [];
                    var l = o.match(/^(.*)-transition$/);
                    if ("paint" === e && l && s[l[1]] && s[l[1]].transition) return wo({
                        key: i,
                        value: a,
                        valueSpec: n.transition,
                        style: r,
                        styleSpec: n
                    });
                    var u, h = t.valueSpec || s[o];
                    return h ? "string" === d(a) && da(h) && !h.tokens && (u = /^{([^}]+)}$/.exec(a)) ? [new m(i, a, '"' + o + '" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ' + JSON.stringify(u[1]) + " }`.")] : [].concat(wo({
                        key: t.key,
                        value: a,
                        valueSpec: h,
                        style: r,
                        styleSpec: n,
                        expressionContext: "property",
                        propertyType: e,
                        propertyKey: o
                    })) : [new m(i, a, 'unknown property "' + o + '"')]
                }

                function fo(t) {
                    return po(t, "paint")
                }

                function mo(t) {
                    return po(t, "layout")
                }

                function yo(t) {
                    var e = [], i = t.value, r = t.key, n = t.style, a = t.styleSpec;
                    i.type || i.ref || e.push(new m(r, i, 'either "type" or "ref" is required'));
                    var o, s = b(i.type), l = b(i.ref);
                    if (i.id) for (var u = b(i.id), h = 0; h < t.arrayIndex; h++) {
                        var c = n.layers[h];
                        b(c.id) === u && e.push(new m(r, i.id, 'duplicate layer id "' + i.id + '", previously used at line ' + c.id.__line__))
                    }
                    if ("ref" in i) ["type", "source", "source-layer", "filter", "layout"].forEach(function (t) {
                        t in i && e.push(new m(r, i[t], '"' + t + '" is prohibited for ref layers'))
                    }), n.layers.forEach(function (t) {
                        b(t.id) === l && (o = t)
                    }), o ? o.ref ? e.push(new m(r, i.ref, "ref cannot reference another ref layer")) : s = b(o.type) : e.push(new m(r, i.ref, 'ref layer "' + l + '" not found')); else if ("background" !== s) if (i.source) {
                        var p = n.sources && n.sources[i.source], f = p && b(p.type);
                        p ? "vector" === f && "raster" === s ? e.push(new m(r, i.source, 'layer "' + i.id + '" requires a raster source')) : "raster" === f && "raster" !== s ? e.push(new m(r, i.source, 'layer "' + i.id + '" requires a vector source')) : "vector" !== f || i["source-layer"] ? "raster-dem" === f && "hillshade" !== s ? e.push(new m(r, i.source, "raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== s || !i.paint || !i.paint["line-gradient"] || "geojson" === f && p.lineMetrics || e.push(new m(r, i, 'layer "' + i.id + '" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')) : e.push(new m(r, i, 'layer "' + i.id + '" must specify a "source-layer"')) : e.push(new m(r, i.source, 'source "' + i.source + '" not found'))
                    } else e.push(new m(r, i, 'missing required property "source"'));
                    return e = e.concat(Ya({
                        key: r,
                        value: i,
                        valueSpec: a.layer,
                        style: t.style,
                        styleSpec: t.styleSpec,
                        objectElementValidators: {
                            "*": function () {
                                return []
                            }, type: function () {
                                return wo({
                                    key: r + ".type",
                                    value: i.type,
                                    valueSpec: a.layer.type,
                                    style: t.style,
                                    styleSpec: t.styleSpec,
                                    object: i,
                                    objectKey: "type"
                                })
                            }, filter: co, layout: function (t) {
                                return Ya({
                                    layer: i,
                                    key: t.key,
                                    value: t.value,
                                    style: t.style,
                                    styleSpec: t.styleSpec,
                                    objectElementValidators: {
                                        "*": function (t) {
                                            return mo(Mr({layerType: s}, t))
                                        }
                                    }
                                })
                            }, paint: function (t) {
                                return Ya({
                                    layer: i,
                                    key: t.key,
                                    value: t.value,
                                    style: t.style,
                                    styleSpec: t.styleSpec,
                                    objectElementValidators: {
                                        "*": function (t) {
                                            return fo(Mr({layerType: s}, t))
                                        }
                                    }
                                })
                            }
                        }
                    }))
                }

                function go(t) {
                    var e = t.value, i = t.key, r = d(e);
                    return "string" !== r ? [new m(i, e, "string expected, " + r + " found")] : []
                }

                var _o = {
                    promoteId: function (t) {
                        var e = t.key, i = t.value;
                        if ("string" === d(i)) return go({key: e, value: i});
                        var r = [];
                        for (var n in i) r.push.apply(r, go({key: e + "." + n, value: i[n]}));
                        return r
                    }
                };

                function vo(t) {
                    var e = t.value, i = t.key, r = t.styleSpec, n = t.style;
                    if (!e.type) return [new m(i, e, '"type" is required')];
                    var a, o = b(e.type);
                    switch (o) {
                        case"vector":
                        case"raster":
                        case"raster-dem":
                            return Ya({
                                key: i,
                                value: e,
                                valueSpec: r["source_" + o.replace("-", "_")],
                                style: t.style,
                                styleSpec: r,
                                objectElementValidators: _o
                            });
                        case"geojson":
                            if (a = Ya({
                                key: i,
                                value: e,
                                valueSpec: r.source_geojson,
                                style: n,
                                styleSpec: r,
                                objectElementValidators: _o
                            }), e.cluster) for (var s in e.clusterProperties) {
                                var l = e.clusterProperties[s], u = l[0],
                                    h = "string" == typeof u ? [u, ["accumulated"], ["get", s]] : u;
                                a.push.apply(a, to({
                                    key: i + "." + s + ".map",
                                    value: l[1],
                                    expressionContext: "cluster-map"
                                })), a.push.apply(a, to({
                                    key: i + "." + s + ".reduce",
                                    value: h,
                                    expressionContext: "cluster-reduce"
                                }))
                            }
                            return a;
                        case"video":
                            return Ya({key: i, value: e, valueSpec: r.source_video, style: n, styleSpec: r});
                        case"image":
                            return Ya({key: i, value: e, valueSpec: r.source_image, style: n, styleSpec: r});
                        case"canvas":
                            return [new m(i, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];
                        default:
                            return eo({
                                key: i + ".type",
                                value: e.type,
                                valueSpec: {values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]},
                                style: n,
                                styleSpec: r
                            })
                    }
                }

                function xo(t) {
                    var e = t.value, i = t.styleSpec, r = i.light, n = t.style, a = [], o = d(e);
                    if (void 0 === e) return a;
                    if ("object" !== o) return a.concat([new m("light", e, "object expected, " + o + " found")]);
                    for (var s in e) {
                        var l = s.match(/^(.*)-transition$/);
                        a = a.concat(l && r[l[1]] && r[l[1]].transition ? wo({
                            key: s,
                            value: e[s],
                            valueSpec: i.transition,
                            style: n,
                            styleSpec: i
                        }) : r[s] ? wo({
                            key: s,
                            value: e[s],
                            valueSpec: r[s],
                            style: n,
                            styleSpec: i
                        }) : [new m(s, e[s], 'unknown property "' + s + '"')])
                    }
                    return a
                }

                var bo = {
                    "*": function () {
                        return []
                    },
                    array: Ja,
                    boolean: function (t) {
                        var e = t.value, i = t.key, r = d(e);
                        return "boolean" !== r ? [new m(i, e, "boolean expected, " + r + " found")] : []
                    },
                    number: Qa,
                    color: function (t) {
                        var e = t.key, i = t.value, r = d(i);
                        return "string" !== r ? [new m(e, i, "color expected, " + r + " found")] : null === wr(i) ? [new m(e, i, 'color expected, "' + i + '" found')] : []
                    },
                    constants: Ha,
                    enum: eo,
                    filter: co,
                    function: $a,
                    layer: yo,
                    object: Ya,
                    source: vo,
                    light: xo,
                    string: go,
                    formatted: function (t) {
                        return 0 === go(t).length ? [] : to(t)
                    },
                    resolvedImage: function (t) {
                        return 0 === go(t).length ? [] : to(t)
                    },
                    stringobject: function (t) {
                        var e = t.value, i = t.key, r = d(e);
                        if ("string" == r) return [];
                        if ("object" == r) {
                            var n = [];
                            for (var a in e) {
                                var o = d(e[a]);
                                "string" !== o && n.push(new m(a, e[a], "string expected, " + o + " found"))
                            }
                            return n
                        }
                        return [new m(i, e, "string expected, " + r + " found")]
                    }
                };

                function wo(t) {
                    var e = t.value, i = t.valueSpec, r = t.styleSpec;
                    return i.expression && ga(b(e)) ? $a(t) : i.expression && Ea(Ka(e)) ? to(t) : i.type && bo[i.type] ? bo[i.type](t) : Ya(Mr({}, t, {valueSpec: i.type ? r[i.type] : i}))
                }

                function Mo(t, e) {
                    void 0 === e && (e = a);
                    var i = [];
                    return i = i.concat(wo({
                        key: "",
                        value: t,
                        valueSpec: e.$root,
                        styleSpec: e,
                        style: t,
                        objectElementValidators: {
                            "*": function () {
                                return []
                            }
                        }
                    })), t.constants && (i = i.concat(Ha({
                        key: "constants",
                        value: t.constants,
                        style: t,
                        styleSpec: e
                    }))), So(i)
                }

                function So(t) {
                    return [].concat(t).sort(function (t, e) {
                        return t.line - e.line
                    })
                }

                function Eo(i) {
                    return function () {
                        for (var t = [], e = arguments.length; e--;) t[e] = arguments[e];
                        return So(i.apply(this, t))
                    }
                }

                Mo.source = Eo(vo), Mo.light = Eo(xo), Mo.layer = Eo(yo), Mo.filter = Eo(co), Mo.paintProperty = Eo(fo), Mo.layoutProperty = Eo(mo);
                var Io = Mo, To = Io.light, Co = Io.paintProperty, Po = Io.layoutProperty;

                function Ao(t, e) {
                    var i = !1;
                    if (e && e.length) for (var r = 0, n = e; r < n.length; r += 1) t.fire(new Wa(new Error(n[r].message))), i = !0;
                    return i
                }

                var zo = function () {
                    this.first = !0
                };
                zo.prototype.update = function (t, e) {
                    var i = Math.floor(t);
                    return this.first ? (this.first = !1, this.lastIntegerZoom = i, this.lastIntegerZoomTime = 0, this.lastZoom = t, this.lastFloorZoom = i, !0) : (this.lastFloorZoom > i ? (this.lastIntegerZoom = i + 1, this.lastIntegerZoomTime = e) : this.lastFloorZoom < i && (this.lastIntegerZoom = i, this.lastIntegerZoomTime = e), t !== this.lastZoom && (this.lastZoom = t, this.lastFloorZoom = i, !0))
                };
                var K = {
                    "Latin-1 Supplement": function (t) {
                        return t >= 128 && t <= 255
                    }, Arabic: function (t) {
                        return t >= 1536 && t <= 1791
                    }, "Arabic Supplement": function (t) {
                        return t >= 1872 && t <= 1919
                    }, "Arabic Extended-A": function (t) {
                        return t >= 2208 && t <= 2303
                    }, "Hangul Jamo": function (t) {
                        return t >= 4352 && t <= 4607
                    }, "Unified Canadian Aboriginal Syllabics": function (t) {
                        return t >= 5120 && t <= 5759
                    }, Khmer: function (t) {
                        return t >= 6016 && t <= 6143
                    }, "Unified Canadian Aboriginal Syllabics Extended": function (t) {
                        return t >= 6320 && t <= 6399
                    }, "General Punctuation": function (t) {
                        return t >= 8192 && t <= 8303
                    }, "Letterlike Symbols": function (t) {
                        return t >= 8448 && t <= 8527
                    }, "Number Forms": function (t) {
                        return t >= 8528 && t <= 8591
                    }, "Miscellaneous Technical": function (t) {
                        return t >= 8960 && t <= 9215
                    }, "Control Pictures": function (t) {
                        return t >= 9216 && t <= 9279
                    }, "Optical Character Recognition": function (t) {
                        return t >= 9280 && t <= 9311
                    }, "Enclosed Alphanumerics": function (t) {
                        return t >= 9312 && t <= 9471
                    }, "Geometric Shapes": function (t) {
                        return t >= 9632 && t <= 9727
                    }, "Miscellaneous Symbols": function (t) {
                        return t >= 9728 && t <= 9983
                    }, "Miscellaneous Symbols and Arrows": function (t) {
                        return t >= 11008 && t <= 11263
                    }, "CJK Radicals Supplement": function (t) {
                        return t >= 11904 && t <= 12031
                    }, "Kangxi Radicals": function (t) {
                        return t >= 12032 && t <= 12255
                    }, "Ideographic Description Characters": function (t) {
                        return t >= 12272 && t <= 12287
                    }, "CJK Symbols and Punctuation": function (t) {
                        return t >= 12288 && t <= 12351
                    }, Hiragana: function (t) {
                        return t >= 12352 && t <= 12447
                    }, Katakana: function (t) {
                        return t >= 12448 && t <= 12543
                    }, Bopomofo: function (t) {
                        return t >= 12544 && t <= 12591
                    }, "Hangul Compatibility Jamo": function (t) {
                        return t >= 12592 && t <= 12687
                    }, Kanbun: function (t) {
                        return t >= 12688 && t <= 12703
                    }, "Bopomofo Extended": function (t) {
                        return t >= 12704 && t <= 12735
                    }, "CJK Strokes": function (t) {
                        return t >= 12736 && t <= 12783
                    }, "Katakana Phonetic Extensions": function (t) {
                        return t >= 12784 && t <= 12799
                    }, "Enclosed CJK Letters and Months": function (t) {
                        return t >= 12800 && t <= 13055
                    }, "CJK Compatibility": function (t) {
                        return t >= 13056 && t <= 13311
                    }, "CJK Unified Ideographs Extension A": function (t) {
                        return t >= 13312 && t <= 19903
                    }, "Yijing Hexagram Symbols": function (t) {
                        return t >= 19904 && t <= 19967
                    }, "CJK Unified Ideographs": function (t) {
                        return t >= 19968 && t <= 40959
                    }, "Yi Syllables": function (t) {
                        return t >= 40960 && t <= 42127
                    }, "Yi Radicals": function (t) {
                        return t >= 42128 && t <= 42191
                    }, "Hangul Jamo Extended-A": function (t) {
                        return t >= 43360 && t <= 43391
                    }, "Hangul Syllables": function (t) {
                        return t >= 44032 && t <= 55215
                    }, "Hangul Jamo Extended-B": function (t) {
                        return t >= 55216 && t <= 55295
                    }, "Private Use Area": function (t) {
                        return t >= 57344 && t <= 63743
                    }, "CJK Compatibility Ideographs": function (t) {
                        return t >= 63744 && t <= 64255
                    }, "Arabic Presentation Forms-A": function (t) {
                        return t >= 64336 && t <= 65023
                    }, "Vertical Forms": function (t) {
                        return t >= 65040 && t <= 65055
                    }, "CJK Compatibility Forms": function (t) {
                        return t >= 65072 && t <= 65103
                    }, "Small Form Variants": function (t) {
                        return t >= 65104 && t <= 65135
                    }, "Arabic Presentation Forms-B": function (t) {
                        return t >= 65136 && t <= 65279
                    }, "Halfwidth and Fullwidth Forms": function (t) {
                        return t >= 65280 && t <= 65519
                    }
                };

                function ko(t) {
                    for (var e = 0, i = t; e < i.length; e += 1) if (Lo(i[e].charCodeAt(0))) return !0;
                    return !1
                }

                function Lo(t) {
                    return !(746 !== t && 747 !== t && (t < 4352 || !(K["Bopomofo Extended"](t) || K.Bopomofo(t) || K["CJK Compatibility Forms"](t) && !(t >= 65097 && t <= 65103) || K["CJK Compatibility Ideographs"](t) || K["CJK Compatibility"](t) || K["CJK Radicals Supplement"](t) || K["CJK Strokes"](t) || !(!K["CJK Symbols and Punctuation"](t) || t >= 12296 && t <= 12305 || t >= 12308 && t <= 12319 || 12336 === t) || K["CJK Unified Ideographs Extension A"](t) || K["CJK Unified Ideographs"](t) || K["Enclosed CJK Letters and Months"](t) || K["Hangul Compatibility Jamo"](t) || K["Hangul Jamo Extended-A"](t) || K["Hangul Jamo Extended-B"](t) || K["Hangul Jamo"](t) || K["Hangul Syllables"](t) || K.Hiragana(t) || K["Ideographic Description Characters"](t) || K.Kanbun(t) || K["Kangxi Radicals"](t) || K["Katakana Phonetic Extensions"](t) || K.Katakana(t) && 12540 !== t || !(!K["Halfwidth and Fullwidth Forms"](t) || 65288 === t || 65289 === t || 65293 === t || t >= 65306 && t <= 65310 || 65339 === t || 65341 === t || 65343 === t || t >= 65371 && t <= 65503 || 65507 === t || t >= 65512 && t <= 65519) || !(!K["Small Form Variants"](t) || t >= 65112 && t <= 65118 || t >= 65123 && t <= 65126) || K["Unified Canadian Aboriginal Syllabics"](t) || K["Unified Canadian Aboriginal Syllabics Extended"](t) || K["Vertical Forms"](t) || K["Yijing Hexagram Symbols"](t) || K["Yi Syllables"](t) || K["Yi Radicals"](t))))
                }

                function Do(t) {
                    return !(Lo(t) || function (t) {
                        return !!(K["Latin-1 Supplement"](t) && (167 === t || 169 === t || 174 === t || 177 === t || 188 === t || 189 === t || 190 === t || 215 === t || 247 === t) || K["General Punctuation"](t) && (8214 === t || 8224 === t || 8225 === t || 8240 === t || 8241 === t || 8251 === t || 8252 === t || 8258 === t || 8263 === t || 8264 === t || 8265 === t || 8273 === t) || K["Letterlike Symbols"](t) || K["Number Forms"](t) || K["Miscellaneous Technical"](t) && (t >= 8960 && t <= 8967 || t >= 8972 && t <= 8991 || t >= 8996 && t <= 9e3 || 9003 === t || t >= 9085 && t <= 9114 || t >= 9150 && t <= 9165 || 9167 === t || t >= 9169 && t <= 9179 || t >= 9186 && t <= 9215) || K["Control Pictures"](t) && 9251 !== t || K["Optical Character Recognition"](t) || K["Enclosed Alphanumerics"](t) || K["Geometric Shapes"](t) || K["Miscellaneous Symbols"](t) && !(t >= 9754 && t <= 9759) || K["Miscellaneous Symbols and Arrows"](t) && (t >= 11026 && t <= 11055 || t >= 11088 && t <= 11097 || t >= 11192 && t <= 11243) || K["CJK Symbols and Punctuation"](t) || K.Katakana(t) || K["Private Use Area"](t) || K["CJK Compatibility Forms"](t) || K["Small Form Variants"](t) || K["Halfwidth and Fullwidth Forms"](t) || 8734 === t || 8756 === t || 8757 === t || t >= 9984 && t <= 10087 || t >= 10102 && t <= 10131 || 65532 === t || 65533 === t)
                    }(t))
                }

                function Ro(t) {
                    return t >= 1424 && t <= 2303 || K["Arabic Presentation Forms-A"](t) || K["Arabic Presentation Forms-B"](t)
                }

                function Bo(t, e) {
                    return !(!e && Ro(t) || t >= 2304 && t <= 3583 || t >= 3840 && t <= 4255 || K.Khmer(t))
                }

                function Oo(t) {
                    for (var e = 0, i = t; e < i.length; e += 1) if (Ro(i[e].charCodeAt(0))) return !0;
                    return !1
                }

                var Fo = null, Uo = "unavailable", No = null, Vo = function (t) {
                    t && "string" == typeof t && t.indexOf("NetworkError") > -1 && (Uo = "error"), Fo && Fo(t)
                };

                function jo() {
                    qo.fire(new Za("pluginStateChange", {pluginStatus: Uo, pluginURL: No}))
                }

                var qo = new Xa, Go = function () {
                    return Uo
                }, Zo = function () {
                    if ("deferred" !== Uo || !No) throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
                    Uo = "loading", jo(), No && gr({url: No}, function (t) {
                        t ? Vo(t) : (Uo = "loaded", jo())
                    })
                }, Wo = {
                    applyArabicShaping: null,
                    processBidirectionalText: null,
                    processStyledBidirectionalText: null,
                    isLoaded: function () {
                        return "loaded" === Uo || null != Wo.applyArabicShaping
                    },
                    isLoading: function () {
                        return "loading" === Uo
                    },
                    setState: function (t) {
                        Uo = t.pluginStatus, No = t.pluginURL
                    },
                    isParsed: function () {
                        return null != Wo.applyArabicShaping && null != Wo.processBidirectionalText && null != Wo.processStyledBidirectionalText
                    },
                    getPluginURL: function () {
                        return No
                    }
                }, j = function (t, e) {
                    this.zoom = t, e ? (this.now = e.now, this.fadeDuration = e.fadeDuration, this.zoomHistory = e.zoomHistory, this.transition = e.transition) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new zo, this.transition = {})
                };
                j.prototype.isSupportedScript = function (t) {
                    return function (t, e) {
                        for (var i = 0, r = t; i < r.length; i += 1) if (!Bo(r[i].charCodeAt(0), e)) return !1;
                        return !0
                    }(t, Wo.isLoaded())
                }, j.prototype.crossFadingFactor = function () {
                    return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1)
                }, j.prototype.getCrossfadeParameters = function () {
                    var t = this.zoom, e = t - Math.floor(t), i = this.crossFadingFactor();
                    return t > this.zoomHistory.lastIntegerZoom ? {
                        fromScale: 2,
                        toScale: 1,
                        t: e + (1 - e) * i
                    } : {fromScale: .5, toScale: 1, t: 1 - (1 - i) * e}
                };
                var Xo = function (t, e) {
                    this.property = t, this.value = e, this.expression = function (t, e) {
                        if (ga(t)) return new Aa(t, e);
                        if (Ea(t)) {
                            var i = Pa(t, e);
                            if ("error" === i.result) throw new Error(i.value.map(function (t) {
                                return t.key + ": " + t.message
                            }).join(", "));
                            return i.value
                        }
                        var r = t;
                        return "string" == typeof t && "color" === e.type && (r = S.parse(t)), {
                            kind: "constant",
                            evaluate: function () {
                                return r
                            }
                        }
                    }(void 0 === e ? t.specification.default : e, t.specification)
                };
                Xo.prototype.isDataDriven = function () {
                    return "source" === this.expression.kind || "composite" === this.expression.kind
                }, Xo.prototype.possiblyEvaluate = function (t, e, i) {
                    return this.property.possiblyEvaluate(this, t, e, i)
                };
                var Ho = function (t) {
                    this.property = t, this.value = new Xo(t, void 0)
                };
                Ho.prototype.transitioned = function (t, e) {
                    return new Yo(this.property, this.value, e, V({}, t.transition, this.transition), t.now)
                }, Ho.prototype.untransitioned = function () {
                    return new Yo(this.property, this.value, null, {}, 0)
                };
                var Ko = function (t) {
                    this._properties = t, this._values = Object.create(t.defaultTransitionablePropertyValues)
                };
                Ko.prototype.getValue = function (t) {
                    return $(this._values[t].value.value)
                }, Ko.prototype.setValue = function (t, e) {
                    this._values.hasOwnProperty(t) || (this._values[t] = new Ho(this._values[t].property)), this._values[t].value = new Xo(this._values[t].property, null === e ? void 0 : $(e))
                }, Ko.prototype.getTransition = function (t) {
                    return $(this._values[t].transition)
                }, Ko.prototype.setTransition = function (t, e) {
                    this._values.hasOwnProperty(t) || (this._values[t] = new Ho(this._values[t].property)), this._values[t].transition = $(e) || void 0
                }, Ko.prototype.serialize = function () {
                    for (var t = {}, e = 0, i = Object.keys(this._values); e < i.length; e += 1) {
                        var r = i[e], n = this.getValue(r);
                        void 0 !== n && (t[r] = n);
                        var a = this.getTransition(r);
                        void 0 !== a && (t[r + "-transition"] = a)
                    }
                    return t
                }, Ko.prototype.transitioned = function (t, e) {
                    for (var i = new Jo(this._properties), r = 0, n = Object.keys(this._values); r < n.length; r += 1) {
                        var a = n[r];
                        i._values[a] = this._values[a].transitioned(t, e._values[a])
                    }
                    return i
                }, Ko.prototype.untransitioned = function () {
                    for (var t = new Jo(this._properties), e = 0, i = Object.keys(this._values); e < i.length; e += 1) {
                        var r = i[e];
                        t._values[r] = this._values[r].untransitioned()
                    }
                    return t
                };
                var Yo = function (t, e, i, r, n) {
                    this.property = t, this.value = e, this.begin = n + r.delay || 0, this.end = this.begin + r.duration || 0, t.specification.transition && (r.delay || r.duration) && (this.prior = i)
                };
                Yo.prototype.possiblyEvaluate = function (t, e, i) {
                    var r = t.now || 0, n = this.value.possiblyEvaluate(t, e, i), a = this.prior;
                    if (a) {
                        if (r > this.end) return this.prior = null, n;
                        if (this.value.isDataDriven()) return this.prior = null, n;
                        if (r < this.begin) return a.possiblyEvaluate(t, e, i);
                        var o = (r - this.begin) / (this.end - this.begin);
                        return this.property.interpolate(a.possiblyEvaluate(t, e, i), n, function (t) {
                            if (t <= 0) return 0;
                            if (t >= 1) return 1;
                            var e = t * t, i = e * t;
                            return 4 * (t < .5 ? i : 3 * (t - e) + i - .75)
                        }(o))
                    }
                    return n
                };
                var Jo = function (t) {
                    this._properties = t, this._values = Object.create(t.defaultTransitioningPropertyValues)
                };
                Jo.prototype.possiblyEvaluate = function (t, e, i) {
                    for (var r = new ts(this._properties), n = 0, a = Object.keys(this._values); n < a.length; n += 1) {
                        var o = a[n];
                        r._values[o] = this._values[o].possiblyEvaluate(t, e, i)
                    }
                    return r
                }, Jo.prototype.hasTransition = function () {
                    for (var t = 0, e = Object.keys(this._values); t < e.length; t += 1) if (this._values[e[t]].prior) return !0;
                    return !1
                };
                var Qo = function (t) {
                    this._properties = t, this._values = Object.create(t.defaultPropertyValues)
                };
                Qo.prototype.getValue = function (t) {
                    return $(this._values[t].value)
                }, Qo.prototype.setValue = function (t, e) {
                    this._values[t] = new Xo(this._values[t].property, null === e ? void 0 : $(e))
                }, Qo.prototype.serialize = function () {
                    for (var t = {}, e = 0, i = Object.keys(this._values); e < i.length; e += 1) {
                        var r = i[e], n = this.getValue(r);
                        void 0 !== n && (t[r] = n)
                    }
                    return t
                }, Qo.prototype.possiblyEvaluate = function (t, e, i) {
                    for (var r = new ts(this._properties), n = 0, a = Object.keys(this._values); n < a.length; n += 1) {
                        var o = a[n];
                        r._values[o] = this._values[o].possiblyEvaluate(t, e, i)
                    }
                    return r
                };
                var $o = function (t, e, i) {
                    this.property = t, this.value = e, this.parameters = i
                };
                $o.prototype.isConstant = function () {
                    return "constant" === this.value.kind
                }, $o.prototype.constantOr = function (t) {
                    return "constant" === this.value.kind ? this.value.value : t
                }, $o.prototype.evaluate = function (t, e, i, r) {
                    return this.property.evaluate(this.value, this.parameters, t, e, i, r)
                };
                var ts = function (t) {
                    this._properties = t, this._values = Object.create(t.defaultPossiblyEvaluatedValues)
                };
                ts.prototype.get = function (t) {
                    return this._values[t]
                };
                var i = function (t) {
                    this.specification = t
                };
                i.prototype.possiblyEvaluate = function (t, e) {
                    return t.expression.evaluate(e)
                }, i.prototype.interpolate = function (t, e, i) {
                    var r = In[this.specification.type];
                    return r ? r(t, e, i) : t
                };
                var r = function (t, e) {
                    this.specification = t, this.overrides = e
                };
                r.prototype.possiblyEvaluate = function (t, e, i, r) {
                    return new $o(this, "constant" === t.expression.kind || "camera" === t.expression.kind ? {
                        kind: "constant",
                        value: t.expression.evaluate(e, null, {}, i, r)
                    } : t.expression, e)
                }, r.prototype.interpolate = function (t, e, i) {
                    if ("constant" !== t.value.kind || "constant" !== e.value.kind) return t;
                    if (void 0 === t.value.value || void 0 === e.value.value) return new $o(this, {
                        kind: "constant",
                        value: void 0
                    }, t.parameters);
                    var r = In[this.specification.type];
                    return r ? new $o(this, {
                        kind: "constant",
                        value: r(t.value.value, e.value.value, i)
                    }, t.parameters) : t
                }, r.prototype.evaluate = function (t, e, i, r, n, a) {
                    return "constant" === t.kind ? t.value : t.evaluate(e, i, r, n, a)
                };
                var es = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.possiblyEvaluate = function (t, e, i, r) {
                        if (void 0 === t.value) return new $o(this, {kind: "constant", value: void 0}, e);
                        if ("constant" === t.expression.kind) {
                            var n = t.expression.evaluate(e, null, {}, i, r),
                                a = "resolvedImage" === t.property.specification.type && "string" != typeof n ? n.name : n,
                                o = this._calculate(a, a, a, e);
                            return new $o(this, {kind: "constant", value: o}, e)
                        }
                        if ("camera" === t.expression.kind) {
                            var s = this._calculate(t.expression.evaluate({zoom: e.zoom - 1}), t.expression.evaluate({zoom: e.zoom}), t.expression.evaluate({zoom: e.zoom + 1}), e);
                            return new $o(this, {kind: "constant", value: s}, e)
                        }
                        return new $o(this, t.expression, e)
                    }, e.prototype.evaluate = function (t, e, i, r, n, a) {
                        if ("source" === t.kind) {
                            var o = t.evaluate(e, i, r, n, a);
                            return this._calculate(o, o, o, e)
                        }
                        return "composite" === t.kind ? this._calculate(t.evaluate({zoom: Math.floor(e.zoom) - 1}, i, r), t.evaluate({zoom: Math.floor(e.zoom)}, i, r), t.evaluate({zoom: Math.floor(e.zoom) + 1}, i, r), e) : t.value
                    }, e.prototype._calculate = function (t, e, i, r) {
                        return r.zoom > r.zoomHistory.lastIntegerZoom ? {from: t, to: e} : {from: i, to: e}
                    }, e.prototype.interpolate = function (t) {
                        return t
                    }, e
                }(r), is = function (t) {
                    this.specification = t
                };
                is.prototype.possiblyEvaluate = function (t, e, i, r) {
                    if (void 0 !== t.value) {
                        if ("constant" === t.expression.kind) {
                            var n = t.expression.evaluate(e, null, {}, i, r);
                            return this._calculate(n, n, n, e)
                        }
                        return this._calculate(t.expression.evaluate(new j(Math.floor(e.zoom - 1), e)), t.expression.evaluate(new j(Math.floor(e.zoom), e)), t.expression.evaluate(new j(Math.floor(e.zoom + 1), e)), e)
                    }
                }, is.prototype._calculate = function (t, e, i, r) {
                    return r.zoom > r.zoomHistory.lastIntegerZoom ? {from: t, to: e} : {from: i, to: e}
                }, is.prototype.interpolate = function (t) {
                    return t
                };
                var rs = function (t) {
                    this.specification = t
                };
                rs.prototype.possiblyEvaluate = function (t, e, i, r) {
                    return !!t.expression.evaluate(e, null, {}, i, r)
                }, rs.prototype.interpolate = function () {
                    return !1
                };
                var ns = function (t) {
                    for (var e in this.properties = t, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [], t) {
                        var i = t[e];
                        i.specification.overridable && this.overridableProperties.push(e);
                        var r = this.defaultPropertyValues[e] = new Xo(i, void 0),
                            n = this.defaultTransitionablePropertyValues[e] = new Ho(i);
                        this.defaultTransitioningPropertyValues[e] = n.untransitioned(), this.defaultPossiblyEvaluatedValues[e] = r.possiblyEvaluate({})
                    }
                };
                e("DataDrivenProperty", r), e("DataConstantProperty", i), e("CrossFadedDataDrivenProperty", es), e("CrossFadedProperty", is), e("ColorRampProperty", rs);
                var as = function (n) {
                    function t(t, e) {
                        if (n.call(this), this.id = t.id, this.type = t.type, this._featureFilter = {
                            filter: function () {
                                return !0
                            }, needGeometry: !1
                        }, "custom" !== t.type && (this.metadata = (t = t).metadata, this.minzoom = t.minzoom, this.maxzoom = t.maxzoom, "background" !== t.type && (this.source = t.source, this.sourceLayer = t["source-layer"], this.filter = t.filter), e.layout && (this._unevaluatedLayout = new Qo(e.layout)), e.paint)) {
                            for (var i in this._transitionablePaint = new Ko(e.paint), t.paint) this.setPaintProperty(i, t.paint[i], {validate: !1});
                            for (var r in t.layout) this.setLayoutProperty(r, t.layout[r], {validate: !1});
                            this._transitioningPaint = this._transitionablePaint.untransitioned(), this.paint = new ts(e.paint)
                        }
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.getCrossfadeParameters = function () {
                        return this._crossfadeParameters
                    }, t.prototype.getLayoutProperty = function (t) {
                        return "visibility" === t ? this.visibility : this._unevaluatedLayout.getValue(t)
                    }, t.prototype.setLayoutProperty = function (t, e, i) {
                        void 0 === i && (i = {}), null != e && this._validate(Po, "layers." + this.id + ".layout." + t, t, e, i) || ("visibility" !== t ? this._unevaluatedLayout.setValue(t, e) : this.visibility = e)
                    }, t.prototype.getPaintProperty = function (t) {
                        return Y(t, "-transition") ? this._transitionablePaint.getTransition(t.slice(0, -"-transition".length)) : this._transitionablePaint.getValue(t)
                    }, t.prototype.setPaintProperty = function (t, e, i) {
                        if (void 0 === i && (i = {}), null != e && this._validate(Co, "layers." + this.id + ".paint." + t, t, e, i)) return !1;
                        if (Y(t, "-transition")) return this._transitionablePaint.setTransition(t.slice(0, -"-transition".length), e || void 0), !1;
                        var r = this._transitionablePaint._values[t],
                            n = "cross-faded-data-driven" === r.property.specification["property-type"],
                            a = r.value.isDataDriven(), o = r.value;
                        this._transitionablePaint.setValue(t, e), this._handleSpecialPaintPropertyUpdate(t);
                        var s = this._transitionablePaint._values[t].value;
                        return s.isDataDriven() || a || n || this._handleOverridablePaintPropertyUpdate(t, o, s)
                    }, t.prototype._handleSpecialPaintPropertyUpdate = function (t) {
                    }, t.prototype._handleOverridablePaintPropertyUpdate = function (t, e, i) {
                        return !1
                    }, t.prototype.isHidden = function (t) {
                        return !!(this.minzoom && t < this.minzoom) || !!(this.maxzoom && t >= this.maxzoom) || "none" === this.visibility
                    }, t.prototype.updateTransitions = function (t) {
                        this._transitioningPaint = this._transitionablePaint.transitioned(t, this._transitioningPaint)
                    }, t.prototype.hasTransition = function () {
                        return this._transitioningPaint.hasTransition()
                    }, t.prototype.recalculate = function (t, e) {
                        t.getCrossfadeParameters && (this._crossfadeParameters = t.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t, void 0, e)), this.paint = this._transitioningPaint.possiblyEvaluate(t, void 0, e)
                    }, t.prototype.serialize = function () {
                        var t = {
                            id: this.id,
                            type: this.type,
                            source: this.source,
                            "source-layer": this.sourceLayer,
                            metadata: this.metadata,
                            minzoom: this.minzoom,
                            maxzoom: this.maxzoom,
                            filter: this.filter,
                            layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),
                            paint: this._transitionablePaint && this._transitionablePaint.serialize()
                        };
                        return this.visibility && (t.layout = t.layout || {}, t.layout.visibility = this.visibility), Q(t, function (t, e) {
                            return !(void 0 === t || "layout" === e && !Object.keys(t).length || "paint" === e && !Object.keys(t).length)
                        })
                    }, t.prototype._validate = function (t, e, i, r, n) {
                        return void 0 === n && (n = {}), (!n || !1 !== n.validate) && Ao(this, t.call(Io, {
                            key: e,
                            layerType: this.type,
                            objectKey: i,
                            value: r,
                            styleSpec: a,
                            style: {glyphs: !0, sprite: !0}
                        }))
                    }, t.prototype.is3D = function () {
                        return !1
                    }, t.prototype.isTileClipped = function () {
                        return !1
                    }, t.prototype.hasOffscreenPass = function () {
                        return !1
                    }, t.prototype.resize = function () {
                    }, t.prototype.isStateDependent = function () {
                        for (var t in this.paint._values) {
                            var e = this.paint.get(t);
                            if (e instanceof $o && da(e.property.specification) && ("source" === e.value.kind || "composite" === e.value.kind) && e.value.isStateDependent) return !0
                        }
                        return !1
                    }, t
                }(Xa), os = {
                    Int8: Int8Array,
                    Uint8: Uint8Array,
                    Int16: Int16Array,
                    Uint16: Uint16Array,
                    Int32: Int32Array,
                    Uint32: Uint32Array,
                    Float32: Float32Array
                }, ss = function (t, e) {
                    this._structArray = t, this._pos1 = e * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8
                }, n = function () {
                    this.isTransferred = !1, this.capacity = -1, this.resize(0)
                };

                function o(t, n) {
                    void 0 === n && (n = 1);
                    var a = 0, o = 0;
                    return {
                        members: t.map(function (t) {
                            var e = os[t.type].BYTES_PER_ELEMENT, i = a = ls(a, Math.max(n, e)), r = t.components || 1;
                            return o = Math.max(o, e), a += e * r, {
                                name: t.name,
                                type: t.type,
                                components: r,
                                offset: i
                            }
                        }), size: ls(a, Math.max(o, n)), alignment: n
                    }
                }

                function ls(t, e) {
                    return Math.ceil(t / e) * e
                }

                n.serialize = function (t, e) {
                    return t._trim(), e && (t.isTransferred = !0, e.push(t.arrayBuffer)), {
                        length: t.length,
                        arrayBuffer: t.arrayBuffer
                    }
                }, n.deserialize = function (t) {
                    var e = Object.create(this.prototype);
                    return e.arrayBuffer = t.arrayBuffer, e.length = t.length, e.capacity = t.arrayBuffer.byteLength / e.bytesPerElement, e._refreshViews(), e
                }, n.prototype._trim = function () {
                    this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews())
                }, n.prototype.clear = function () {
                    this.length = 0
                }, n.prototype.resize = function (t) {
                    this.reserve(t), this.length = t
                }, n.prototype.reserve = function (t) {
                    if (t > this.capacity) {
                        this.capacity = Math.max(t, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
                        var e = this.uint8;
                        this._refreshViews(), e && this.uint8.set(e)
                    }
                }, n.prototype._refreshViews = function () {
                    throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")
                };
                var us = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e) {
                        var i = this.length;
                        return this.resize(i + 1), this.emplace(i, t, e)
                    }, e.prototype.emplace = function (t, e, i) {
                        var r = 2 * t;
                        return this.int16[r + 0] = e, this.int16[r + 1] = i, t
                    }, e
                }(n);
                us.prototype.bytesPerElement = 4, e("StructArrayLayout2i4", us);
                var hs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r) {
                        var n = this.length;
                        return this.resize(n + 1), this.emplace(n, t, e, i, r)
                    }, e.prototype.emplace = function (t, e, i, r, n) {
                        var a = 4 * t;
                        return this.int16[a + 0] = e, this.int16[a + 1] = i, this.int16[a + 2] = r, this.int16[a + 3] = n, t
                    }, e
                }(n);
                hs.prototype.bytesPerElement = 8, e("StructArrayLayout4i8", hs);
                var cs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a) {
                        var o = this.length;
                        return this.resize(o + 1), this.emplace(o, t, e, i, r, n, a)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o) {
                        var s = 6 * t;
                        return this.int16[s + 0] = e, this.int16[s + 1] = i, this.int16[s + 2] = r, this.int16[s + 3] = n, this.int16[s + 4] = a, this.int16[s + 5] = o, t
                    }, e
                }(n);
                cs.prototype.bytesPerElement = 12, e("StructArrayLayout2i4i12", cs);
                var ps = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a) {
                        var o = this.length;
                        return this.resize(o + 1), this.emplace(o, t, e, i, r, n, a)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o) {
                        var s = 4 * t, l = 8 * t;
                        return this.int16[s + 0] = e, this.int16[s + 1] = i, this.uint8[l + 4] = r, this.uint8[l + 5] = n, this.uint8[l + 6] = a, this.uint8[l + 7] = o, t
                    }, e
                }(n);
                ps.prototype.bytesPerElement = 8, e("StructArrayLayout2i4ub8", ps);
                var fs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e) {
                        var i = this.length;
                        return this.resize(i + 1), this.emplace(i, t, e)
                    }, e.prototype.emplace = function (t, e, i) {
                        var r = 2 * t;
                        return this.float32[r + 0] = e, this.float32[r + 1] = i, t
                    }, e
                }(n);
                fs.prototype.bytesPerElement = 8, e("StructArrayLayout2f8", fs);
                var ds = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a, o, s, l, u) {
                        var h = this.length;
                        return this.resize(h + 1), this.emplace(h, t, e, i, r, n, a, o, s, l, u)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o, s, l, u, h) {
                        var c = 10 * t;
                        return this.uint16[c + 0] = e, this.uint16[c + 1] = i, this.uint16[c + 2] = r, this.uint16[c + 3] = n, this.uint16[c + 4] = a, this.uint16[c + 5] = o, this.uint16[c + 6] = s, this.uint16[c + 7] = l, this.uint16[c + 8] = u, this.uint16[c + 9] = h, t
                    }, e
                }(n);
                ds.prototype.bytesPerElement = 20, e("StructArrayLayout10ui20", ds);
                var ms = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a, o, s, l, u, h, c) {
                        var p = this.length;
                        return this.resize(p + 1), this.emplace(p, t, e, i, r, n, a, o, s, l, u, h, c)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o, s, l, u, h, c, p) {
                        var f = 12 * t;
                        return this.int16[f + 0] = e, this.int16[f + 1] = i, this.int16[f + 2] = r, this.int16[f + 3] = n, this.uint16[f + 4] = a, this.uint16[f + 5] = o, this.uint16[f + 6] = s, this.uint16[f + 7] = l, this.int16[f + 8] = u, this.int16[f + 9] = h, this.int16[f + 10] = c, this.int16[f + 11] = p, t
                    }, e
                }(n);
                ms.prototype.bytesPerElement = 24, e("StructArrayLayout4i4ui4i24", ms);
                var ys = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i) {
                        var r = this.length;
                        return this.resize(r + 1), this.emplace(r, t, e, i)
                    }, e.prototype.emplace = function (t, e, i, r) {
                        var n = 3 * t;
                        return this.float32[n + 0] = e, this.float32[n + 1] = i, this.float32[n + 2] = r, t
                    }, e
                }(n);
                ys.prototype.bytesPerElement = 12, e("StructArrayLayout3f12", ys);
                var gs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t) {
                        var e = this.length;
                        return this.resize(e + 1), this.emplace(e, t)
                    }, e.prototype.emplace = function (t, e) {
                        return this.uint32[1 * t + 0] = e, t
                    }, e
                }(n);
                gs.prototype.bytesPerElement = 4, e("StructArrayLayout1ul4", gs);
                var _s = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a, o, s, l) {
                        var u = this.length;
                        return this.resize(u + 1), this.emplace(u, t, e, i, r, n, a, o, s, l)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o, s, l, u) {
                        var h = 10 * t, c = 5 * t;
                        return this.int16[h + 0] = e, this.int16[h + 1] = i, this.int16[h + 2] = r, this.int16[h + 3] = n, this.int16[h + 4] = a, this.int16[h + 5] = o, this.uint32[c + 3] = s, this.uint16[h + 8] = l, this.uint16[h + 9] = u, t
                    }, e
                }(n);
                _s.prototype.bytesPerElement = 20, e("StructArrayLayout6i1ul2ui20", _s);
                var vs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a) {
                        var o = this.length;
                        return this.resize(o + 1), this.emplace(o, t, e, i, r, n, a)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o) {
                        var s = 6 * t;
                        return this.int16[s + 0] = e, this.int16[s + 1] = i, this.int16[s + 2] = r, this.int16[s + 3] = n, this.int16[s + 4] = a, this.int16[s + 5] = o, t
                    }, e
                }(n);
                vs.prototype.bytesPerElement = 12, e("StructArrayLayout2i2i2i12", vs);
                var xs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n) {
                        var a = this.length;
                        return this.resize(a + 1), this.emplace(a, t, e, i, r, n)
                    }, e.prototype.emplace = function (t, e, i, r, n, a) {
                        var o = 4 * t, s = 8 * t;
                        return this.float32[o + 0] = e, this.float32[o + 1] = i, this.float32[o + 2] = r, this.int16[s + 6] = n, this.int16[s + 7] = a, t
                    }, e
                }(n);
                xs.prototype.bytesPerElement = 16, e("StructArrayLayout2f1f2i16", xs);
                var bs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r) {
                        var n = this.length;
                        return this.resize(n + 1), this.emplace(n, t, e, i, r)
                    }, e.prototype.emplace = function (t, e, i, r, n) {
                        var a = 12 * t, o = 3 * t;
                        return this.uint8[a + 0] = e, this.uint8[a + 1] = i, this.float32[o + 1] = r, this.float32[o + 2] = n, t
                    }, e
                }(n);
                bs.prototype.bytesPerElement = 12, e("StructArrayLayout2ub2f12", bs);
                var ws = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i) {
                        var r = this.length;
                        return this.resize(r + 1), this.emplace(r, t, e, i)
                    }, e.prototype.emplace = function (t, e, i, r) {
                        var n = 3 * t;
                        return this.uint16[n + 0] = e, this.uint16[n + 1] = i, this.uint16[n + 2] = r, t
                    }, e
                }(n);
                ws.prototype.bytesPerElement = 6, e("StructArrayLayout3ui6", ws);
                var Ms = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y) {
                        var g = this.length;
                        return this.resize(g + 1), this.emplace(g, t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g) {
                        var _ = 24 * t, v = 12 * t, x = 48 * t;
                        return this.int16[_ + 0] = e, this.int16[_ + 1] = i, this.uint16[_ + 2] = r, this.uint16[_ + 3] = n, this.uint32[v + 2] = a, this.uint32[v + 3] = o, this.uint32[v + 4] = s, this.uint16[_ + 10] = l, this.uint16[_ + 11] = u, this.uint16[_ + 12] = h, this.float32[v + 7] = c, this.float32[v + 8] = p, this.uint8[x + 36] = f, this.uint8[x + 37] = d, this.uint8[x + 38] = m, this.uint32[v + 10] = y, this.int16[_ + 22] = g, t
                    }, e
                }(n);
                Ms.prototype.bytesPerElement = 48, e("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", Ms);
                var Ss = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v, x, b, w, M, S, E, I, T) {
                        var C = this.length;
                        return this.resize(C + 1), this.emplace(C, t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v, x, b, w, M, S, E, I, T)
                    }, e.prototype.emplace = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, g, _, v, x, b, w, M, S, E, I, T, C) {
                        var P = 34 * t, A = 17 * t;
                        return this.int16[P + 0] = e, this.int16[P + 1] = i, this.int16[P + 2] = r, this.int16[P + 3] = n, this.int16[P + 4] = a, this.int16[P + 5] = o, this.int16[P + 6] = s, this.int16[P + 7] = l, this.uint16[P + 8] = u, this.uint16[P + 9] = h, this.uint16[P + 10] = c, this.uint16[P + 11] = p, this.uint16[P + 12] = f, this.uint16[P + 13] = d, this.uint16[P + 14] = m, this.uint16[P + 15] = y, this.uint16[P + 16] = g, this.uint16[P + 17] = _, this.uint16[P + 18] = v, this.uint16[P + 19] = x, this.uint16[P + 20] = b, this.uint16[P + 21] = w, this.uint16[P + 22] = M, this.uint32[A + 12] = S, this.float32[A + 13] = E, this.float32[A + 14] = I, this.float32[A + 15] = T, this.float32[A + 16] = C, t
                    }, e
                }(n);
                Ss.prototype.bytesPerElement = 68, e("StructArrayLayout8i15ui1ul4f68", Ss);
                var Es = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t) {
                        var e = this.length;
                        return this.resize(e + 1), this.emplace(e, t)
                    }, e.prototype.emplace = function (t, e) {
                        return this.float32[1 * t + 0] = e, t
                    }, e
                }(n);
                Es.prototype.bytesPerElement = 4, e("StructArrayLayout1f4", Es);
                var Is = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i) {
                        var r = this.length;
                        return this.resize(r + 1), this.emplace(r, t, e, i)
                    }, e.prototype.emplace = function (t, e, i, r) {
                        var n = 3 * t;
                        return this.int16[n + 0] = e, this.int16[n + 1] = i, this.int16[n + 2] = r, t
                    }, e
                }(n);
                Is.prototype.bytesPerElement = 6, e("StructArrayLayout3i6", Is);
                var Ts = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i) {
                        var r = this.length;
                        return this.resize(r + 1), this.emplace(r, t, e, i)
                    }, e.prototype.emplace = function (t, e, i, r) {
                        var n = 4 * t;
                        return this.uint32[2 * t + 0] = e, this.uint16[n + 2] = i, this.uint16[n + 3] = r, t
                    }, e
                }(n);
                Ts.prototype.bytesPerElement = 8, e("StructArrayLayout1ul2ui8", Ts);
                var Cs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e) {
                        var i = this.length;
                        return this.resize(i + 1), this.emplace(i, t, e)
                    }, e.prototype.emplace = function (t, e, i) {
                        var r = 2 * t;
                        return this.uint16[r + 0] = e, this.uint16[r + 1] = i, t
                    }, e
                }(n);
                Cs.prototype.bytesPerElement = 4, e("StructArrayLayout2ui4", Cs);
                var Ps = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t) {
                        var e = this.length;
                        return this.resize(e + 1), this.emplace(e, t)
                    }, e.prototype.emplace = function (t, e) {
                        return this.uint16[1 * t + 0] = e, t
                    }, e
                }(n);
                Ps.prototype.bytesPerElement = 2, e("StructArrayLayout1ui2", Ps);
                var As = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                        this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer)
                    }, e.prototype.emplaceBack = function (t, e, i, r) {
                        var n = this.length;
                        return this.resize(n + 1), this.emplace(n, t, e, i, r)
                    }, e.prototype.emplace = function (t, e, i, r, n) {
                        var a = 4 * t;
                        return this.float32[a + 0] = e, this.float32[a + 1] = i, this.float32[a + 2] = r, this.float32[a + 3] = n, t
                    }, e
                }(n);
                As.prototype.bytesPerElement = 16, e("StructArrayLayout4f16", As);
                var zs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
                    var i = {
                        anchorPointX: {configurable: !0},
                        anchorPointY: {configurable: !0},
                        x1: {configurable: !0},
                        y1: {configurable: !0},
                        x2: {configurable: !0},
                        y2: {configurable: !0},
                        featureIndex: {configurable: !0},
                        sourceLayerIndex: {configurable: !0},
                        bucketIndex: {configurable: !0},
                        anchorPoint: {configurable: !0}
                    };
                    return i.anchorPointX.get = function () {
                        return this._structArray.int16[this._pos2 + 0]
                    }, i.anchorPointY.get = function () {
                        return this._structArray.int16[this._pos2 + 1]
                    }, i.x1.get = function () {
                        return this._structArray.int16[this._pos2 + 2]
                    }, i.y1.get = function () {
                        return this._structArray.int16[this._pos2 + 3]
                    }, i.x2.get = function () {
                        return this._structArray.int16[this._pos2 + 4]
                    }, i.y2.get = function () {
                        return this._structArray.int16[this._pos2 + 5]
                    }, i.featureIndex.get = function () {
                        return this._structArray.uint32[this._pos4 + 3]
                    }, i.sourceLayerIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 8]
                    }, i.bucketIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 9]
                    }, i.anchorPoint.get = function () {
                        return new W(this.anchorPointX, this.anchorPointY)
                    }, Object.defineProperties(e.prototype, i), e
                }(ss);
                zs.prototype.size = 20;
                var ks = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                        return new zs(this, t)
                    }, e
                }(_s);
                e("CollisionBoxArray", ks);
                var Ls = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
                    var i = {
                        anchorX: {configurable: !0},
                        anchorY: {configurable: !0},
                        glyphStartIndex: {configurable: !0},
                        numGlyphs: {configurable: !0},
                        vertexStartIndex: {configurable: !0},
                        lineStartIndex: {configurable: !0},
                        lineLength: {configurable: !0},
                        segment: {configurable: !0},
                        lowerSize: {configurable: !0},
                        upperSize: {configurable: !0},
                        lineOffsetX: {configurable: !0},
                        lineOffsetY: {configurable: !0},
                        writingMode: {configurable: !0},
                        placedOrientation: {configurable: !0},
                        hidden: {configurable: !0},
                        crossTileID: {configurable: !0},
                        associatedIconIndex: {configurable: !0}
                    };
                    return i.anchorX.get = function () {
                        return this._structArray.int16[this._pos2 + 0]
                    }, i.anchorY.get = function () {
                        return this._structArray.int16[this._pos2 + 1]
                    }, i.glyphStartIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 2]
                    }, i.numGlyphs.get = function () {
                        return this._structArray.uint16[this._pos2 + 3]
                    }, i.vertexStartIndex.get = function () {
                        return this._structArray.uint32[this._pos4 + 2]
                    }, i.lineStartIndex.get = function () {
                        return this._structArray.uint32[this._pos4 + 3]
                    }, i.lineLength.get = function () {
                        return this._structArray.uint32[this._pos4 + 4]
                    }, i.segment.get = function () {
                        return this._structArray.uint16[this._pos2 + 10]
                    }, i.lowerSize.get = function () {
                        return this._structArray.uint16[this._pos2 + 11]
                    }, i.upperSize.get = function () {
                        return this._structArray.uint16[this._pos2 + 12]
                    }, i.lineOffsetX.get = function () {
                        return this._structArray.float32[this._pos4 + 7]
                    }, i.lineOffsetY.get = function () {
                        return this._structArray.float32[this._pos4 + 8]
                    }, i.writingMode.get = function () {
                        return this._structArray.uint8[this._pos1 + 36]
                    }, i.placedOrientation.get = function () {
                        return this._structArray.uint8[this._pos1 + 37]
                    }, i.placedOrientation.set = function (t) {
                        this._structArray.uint8[this._pos1 + 37] = t
                    }, i.hidden.get = function () {
                        return this._structArray.uint8[this._pos1 + 38]
                    }, i.hidden.set = function (t) {
                        this._structArray.uint8[this._pos1 + 38] = t
                    }, i.crossTileID.get = function () {
                        return this._structArray.uint32[this._pos4 + 10]
                    }, i.crossTileID.set = function (t) {
                        this._structArray.uint32[this._pos4 + 10] = t
                    }, i.associatedIconIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 22]
                    }, Object.defineProperties(e.prototype, i), e
                }(ss);
                Ls.prototype.size = 48;
                var Ds = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                        return new Ls(this, t)
                    }, e
                }(Ms);
                e("PlacedSymbolArray", Ds);
                var Rs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
                    var i = {
                        anchorX: {configurable: !0},
                        anchorY: {configurable: !0},
                        rightJustifiedTextSymbolIndex: {configurable: !0},
                        centerJustifiedTextSymbolIndex: {configurable: !0},
                        leftJustifiedTextSymbolIndex: {configurable: !0},
                        verticalPlacedTextSymbolIndex: {configurable: !0},
                        placedIconSymbolIndex: {configurable: !0},
                        verticalPlacedIconSymbolIndex: {configurable: !0},
                        key: {configurable: !0},
                        textBoxStartIndex: {configurable: !0},
                        textBoxEndIndex: {configurable: !0},
                        verticalTextBoxStartIndex: {configurable: !0},
                        verticalTextBoxEndIndex: {configurable: !0},
                        iconBoxStartIndex: {configurable: !0},
                        iconBoxEndIndex: {configurable: !0},
                        verticalIconBoxStartIndex: {configurable: !0},
                        verticalIconBoxEndIndex: {configurable: !0},
                        featureIndex: {configurable: !0},
                        numHorizontalGlyphVertices: {configurable: !0},
                        numVerticalGlyphVertices: {configurable: !0},
                        numIconVertices: {configurable: !0},
                        numVerticalIconVertices: {configurable: !0},
                        useRuntimeCollisionCircles: {configurable: !0},
                        crossTileID: {configurable: !0},
                        textBoxScale: {configurable: !0},
                        textOffset0: {configurable: !0},
                        textOffset1: {configurable: !0},
                        collisionCircleDiameter: {configurable: !0}
                    };
                    return i.anchorX.get = function () {
                        return this._structArray.int16[this._pos2 + 0]
                    }, i.anchorY.get = function () {
                        return this._structArray.int16[this._pos2 + 1]
                    }, i.rightJustifiedTextSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 2]
                    }, i.centerJustifiedTextSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 3]
                    }, i.leftJustifiedTextSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 4]
                    }, i.verticalPlacedTextSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 5]
                    }, i.placedIconSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 6]
                    }, i.verticalPlacedIconSymbolIndex.get = function () {
                        return this._structArray.int16[this._pos2 + 7]
                    }, i.key.get = function () {
                        return this._structArray.uint16[this._pos2 + 8]
                    }, i.textBoxStartIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 9]
                    }, i.textBoxEndIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 10]
                    }, i.verticalTextBoxStartIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 11]
                    }, i.verticalTextBoxEndIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 12]
                    }, i.iconBoxStartIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 13]
                    }, i.iconBoxEndIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 14]
                    }, i.verticalIconBoxStartIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 15]
                    }, i.verticalIconBoxEndIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 16]
                    }, i.featureIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 17]
                    }, i.numHorizontalGlyphVertices.get = function () {
                        return this._structArray.uint16[this._pos2 + 18]
                    }, i.numVerticalGlyphVertices.get = function () {
                        return this._structArray.uint16[this._pos2 + 19]
                    }, i.numIconVertices.get = function () {
                        return this._structArray.uint16[this._pos2 + 20]
                    }, i.numVerticalIconVertices.get = function () {
                        return this._structArray.uint16[this._pos2 + 21]
                    }, i.useRuntimeCollisionCircles.get = function () {
                        return this._structArray.uint16[this._pos2 + 22]
                    }, i.crossTileID.get = function () {
                        return this._structArray.uint32[this._pos4 + 12]
                    }, i.crossTileID.set = function (t) {
                        this._structArray.uint32[this._pos4 + 12] = t
                    }, i.textBoxScale.get = function () {
                        return this._structArray.float32[this._pos4 + 13]
                    }, i.textOffset0.get = function () {
                        return this._structArray.float32[this._pos4 + 14]
                    }, i.textOffset1.get = function () {
                        return this._structArray.float32[this._pos4 + 15]
                    }, i.collisionCircleDiameter.get = function () {
                        return this._structArray.float32[this._pos4 + 16]
                    }, Object.defineProperties(e.prototype, i), e
                }(ss);
                Rs.prototype.size = 68;
                var Bs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                        return new Rs(this, t)
                    }, e
                }(Ss);
                e("SymbolInstanceArray", Bs);
                var Os = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getoffsetX = function (t) {
                        return this.float32[1 * t + 0]
                    }, e
                }(Es);
                e("GlyphOffsetArray", Os);
                var Fs = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getx = function (t) {
                        return this.int16[3 * t + 0]
                    }, e.prototype.gety = function (t) {
                        return this.int16[3 * t + 1]
                    }, e.prototype.gettileUnitDistanceFromAnchor = function (t) {
                        return this.int16[3 * t + 2]
                    }, e
                }(Is);
                e("SymbolLineVertexArray", Fs);
                var Us = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
                    var i = {
                        featureIndex: {configurable: !0},
                        sourceLayerIndex: {configurable: !0},
                        bucketIndex: {configurable: !0}
                    };
                    return i.featureIndex.get = function () {
                        return this._structArray.uint32[this._pos4 + 0]
                    }, i.sourceLayerIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 2]
                    }, i.bucketIndex.get = function () {
                        return this._structArray.uint16[this._pos2 + 3]
                    }, Object.defineProperties(e.prototype, i), e
                }(ss);
                Us.prototype.size = 8;
                var Ns = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                        return new Us(this, t)
                    }, e
                }(Ts);
                e("FeatureIndexArray", Ns);
                var Vs = o([{name: "a_pos", components: 2, type: "Int16"}], 4).members, L = function (t) {
                    void 0 === t && (t = []), this.segments = t
                };

                function js(t, e) {
                    return 256 * (t = U(Math.floor(t), 0, 255)) + U(Math.floor(e), 0, 255)
                }

                L.prototype.prepareSegment = function (t, e, i, r) {
                    var n = this.segments[this.segments.length - 1];
                    return t > L.MAX_VERTEX_ARRAY_LENGTH && ht("Max vertices per segment is " + L.MAX_VERTEX_ARRAY_LENGTH + ": bucket requested " + t), (!n || n.vertexLength + t > L.MAX_VERTEX_ARRAY_LENGTH || n.sortKey !== r) && (n = {
                        vertexOffset: e.length,
                        primitiveOffset: i.length,
                        vertexLength: 0,
                        primitiveLength: 0
                    }, void 0 !== r && (n.sortKey = r), this.segments.push(n)), n
                }, L.prototype.get = function () {
                    return this.segments
                }, L.prototype.destroy = function () {
                    for (var t = 0, e = this.segments; t < e.length; t += 1) {
                        var i = e[t];
                        for (var r in i.vaos) i.vaos[r].destroy()
                    }
                }, L.simpleSegment = function (t, e, i, r) {
                    return new L([{
                        vertexOffset: t,
                        primitiveOffset: e,
                        vertexLength: i,
                        primitiveLength: r,
                        vaos: {},
                        sortKey: 0
                    }])
                }, L.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, e("SegmentVector", L);
                var qs = o([{name: "a_pattern_from", components: 4, type: "Uint16"}, {
                    name: "a_pattern_to",
                    components: 4,
                    type: "Uint16"
                }, {name: "a_pixel_ratio_from", components: 1, type: "Uint16"}, {
                    name: "a_pixel_ratio_to",
                    components: 1,
                    type: "Uint16"
                }]), Gs = z(function (t) {
                    t.exports = function (t, e) {
                        var i, r, n, a, o, s, l, u;
                        for (r = t.length - (i = 3 & t.length), n = e, o = 3432918353, s = 461845907, u = 0; u < r;) l = 255 & t.charCodeAt(u) | (255 & t.charCodeAt(++u)) << 8 | (255 & t.charCodeAt(++u)) << 16 | (255 & t.charCodeAt(++u)) << 24, ++u, n = 27492 + (65535 & (a = 5 * (65535 & (n = (n ^= l = (65535 & (l = (l = (65535 & l) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * s + (((l >>> 16) * s & 65535) << 16) & 4294967295) << 13 | n >>> 19)) + ((5 * (n >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (a >>> 16) & 65535) << 16);
                        switch (l = 0, i) {
                            case 3:
                                l ^= (255 & t.charCodeAt(u + 2)) << 16;
                            case 2:
                                l ^= (255 & t.charCodeAt(u + 1)) << 8;
                            case 1:
                                n ^= l = (65535 & (l = (l = (65535 & (l ^= 255 & t.charCodeAt(u))) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * s + (((l >>> 16) * s & 65535) << 16) & 4294967295
                        }
                        return n ^= t.length, n = 2246822507 * (65535 & (n ^= n >>> 16)) + ((2246822507 * (n >>> 16) & 65535) << 16) & 4294967295, n = 3266489909 * (65535 & (n ^= n >>> 13)) + ((3266489909 * (n >>> 16) & 65535) << 16) & 4294967295, (n ^= n >>> 16) >>> 0
                    }
                }), Zs = z(function (t) {
                    t.exports = function (t, e) {
                        for (var i, r = t.length, n = e ^ r, a = 0; r >= 4;) i = 1540483477 * (65535 & (i = 255 & t.charCodeAt(a) | (255 & t.charCodeAt(++a)) << 8 | (255 & t.charCodeAt(++a)) << 16 | (255 & t.charCodeAt(++a)) << 24)) + ((1540483477 * (i >>> 16) & 65535) << 16), n = 1540483477 * (65535 & n) + ((1540483477 * (n >>> 16) & 65535) << 16) ^ (i = 1540483477 * (65535 & (i ^= i >>> 24)) + ((1540483477 * (i >>> 16) & 65535) << 16)), r -= 4, ++a;
                        switch (r) {
                            case 3:
                                n ^= (255 & t.charCodeAt(a + 2)) << 16;
                            case 2:
                                n ^= (255 & t.charCodeAt(a + 1)) << 8;
                            case 1:
                                n = 1540483477 * (65535 & (n ^= 255 & t.charCodeAt(a))) + ((1540483477 * (n >>> 16) & 65535) << 16)
                        }
                        return n = 1540483477 * (65535 & (n ^= n >>> 13)) + ((1540483477 * (n >>> 16) & 65535) << 16), (n ^= n >>> 15) >>> 0
                    }
                }), Ws = Gs, Xs = Zs;
                Ws.murmur3 = Gs, Ws.murmur2 = Xs;
                var Hs = function () {
                    this.ids = [], this.positions = [], this.indexed = !1
                };
                Hs.prototype.add = function (t, e, i, r) {
                    this.ids.push(Ys(t)), this.positions.push(e, i, r)
                }, Hs.prototype.getPositions = function (t) {
                    for (var e = Ys(t), i = 0, r = this.ids.length - 1; i < r;) {
                        var n = i + r >> 1;
                        this.ids[n] >= e ? r = n : i = n + 1
                    }
                    for (var a = []; this.ids[i] === e;) a.push({
                        index: this.positions[3 * i],
                        start: this.positions[3 * i + 1],
                        end: this.positions[3 * i + 2]
                    }), i++;
                    return a
                }, Hs.serialize = function (t, e) {
                    var i = new Float64Array(t.ids), r = new Uint32Array(t.positions);
                    return function t(e, i, r, n) {
                        for (; r < n;) {
                            for (var a = e[r + n >> 1], o = r - 1, s = n + 1; ;) {
                                do {
                                    o++
                                } while (e[o] < a);
                                do {
                                    s--
                                } while (e[s] > a);
                                if (o >= s) break;
                                Js(e, o, s), Js(i, 3 * o, 3 * s), Js(i, 3 * o + 1, 3 * s + 1), Js(i, 3 * o + 2, 3 * s + 2)
                            }
                            s - r < n - s ? (t(e, i, r, s), r = s + 1) : (t(e, i, s + 1, n), n = s)
                        }
                    }(i, r, 0, i.length - 1), e && e.push(i.buffer, r.buffer), {ids: i, positions: r}
                }, Hs.deserialize = function (t) {
                    var e = new Hs;
                    return e.ids = t.ids, e.positions = t.positions, e.indexed = !0, e
                };
                var Ks = Math.pow(2, 53) - 1;

                function Ys(t) {
                    var e = +t;
                    return !isNaN(e) && e <= Ks ? e : Ws(String(t))
                }

                function Js(t, e, i) {
                    var r = t[e];
                    t[e] = t[i], t[i] = r
                }

                e("FeaturePositionMap", Hs);
                var Qs = function (t, e) {
                    this.gl = t.gl, this.location = e
                }, $s = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = 0
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        this.current !== t && (this.current = t, this.gl.uniform1i(this.location, t))
                    }, t
                }(Qs), tl = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = 0
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        this.current !== t && (this.current = t, this.gl.uniform1f(this.location, t))
                    }, t
                }(Qs), el = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = [0, 0]
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        t[0] === this.current[0] && t[1] === this.current[1] || (this.current = t, this.gl.uniform2f(this.location, t[0], t[1]))
                    }, t
                }(Qs), il = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = [0, 0, 0]
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] || (this.current = t, this.gl.uniform3f(this.location, t[0], t[1], t[2]))
                    }, t
                }(Qs), rl = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = [0, 0, 0, 0]
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] && t[3] === this.current[3] || (this.current = t, this.gl.uniform4f(this.location, t[0], t[1], t[2], t[3]))
                    }, t
                }(Qs), nl = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = S.transparent
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        t.r === this.current.r && t.g === this.current.g && t.b === this.current.b && t.a === this.current.a || (this.current = t, this.gl.uniform4f(this.location, t.r, t.g, t.b, t.a))
                    }, t
                }(Qs), al = new Float32Array(16), ol = function (i) {
                    function t(t, e) {
                        i.call(this, t, e), this.current = al
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.set = function (t) {
                        if (t[12] !== this.current[12] || t[0] !== this.current[0]) return this.current = t, void this.gl.uniformMatrix4fv(this.location, !1, t);
                        for (var e = 1; e < 16; e++) if (t[e] !== this.current[e]) {
                            this.current = t, this.gl.uniformMatrix4fv(this.location, !1, t);
                            break
                        }
                    }, t
                }(Qs);

                function sl(t) {
                    return [js(255 * t.r, 255 * t.g), js(255 * t.b, 255 * t.a)]
                }

                var ll = function (t, e, i) {
                    this.value = t, this.uniformNames = e.map(function (t) {
                        return "u_" + t
                    }), this.type = i
                };
                ll.prototype.setUniform = function (t, e, i) {
                    t.set(i.constantOr(this.value))
                }, ll.prototype.getBinding = function (t, e, i) {
                    return "color" === this.type ? new nl(t, e) : new tl(t, e)
                };
                var ul = function (t, e) {
                    this.uniformNames = e.map(function (t) {
                        return "u_" + t
                    }), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1
                };
                ul.prototype.setConstantPatternPositions = function (t, e) {
                    this.pixelRatioFrom = e.pixelRatio, this.pixelRatioTo = t.pixelRatio, this.patternFrom = e.tlbr, this.patternTo = t.tlbr
                }, ul.prototype.setUniform = function (t, e, i, r) {
                    var n = "u_pattern_to" === r ? this.patternTo : "u_pattern_from" === r ? this.patternFrom : "u_pixel_ratio_to" === r ? this.pixelRatioTo : "u_pixel_ratio_from" === r ? this.pixelRatioFrom : null;
                    n && t.set(n)
                }, ul.prototype.getBinding = function (t, e, i) {
                    return "u_pattern" === i.substr(0, 9) ? new rl(t, e) : new tl(t, e)
                };
                var hl = function (t, e, i, r) {
                    this.expression = t, this.type = i, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
                        return {name: "a_" + t, type: "Float32", components: "color" === i ? 2 : 1, offset: 0}
                    }), this.paintVertexArray = new r
                };
                hl.prototype.populatePaintArray = function (t, e, i, r, n) {
                    var a = this.paintVertexArray.length, o = this.expression.evaluate(new j(0), e, {}, r, [], n);
                    this.paintVertexArray.resize(t), this._setPaintValue(a, t, o)
                }, hl.prototype.updatePaintArray = function (t, e, i, r) {
                    var n = this.expression.evaluate({zoom: 0}, i, r);
                    this._setPaintValue(t, e, n)
                }, hl.prototype._setPaintValue = function (t, e, i) {
                    if ("color" === this.type) for (var r = sl(i), n = t; n < e; n++) this.paintVertexArray.emplace(n, r[0], r[1]); else {
                        for (var a = t; a < e; a++) this.paintVertexArray.emplace(a, i);
                        this.maxValue = Math.max(this.maxValue, Math.abs(i))
                    }
                }, hl.prototype.upload = function (t) {
                    this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent))
                }, hl.prototype.destroy = function () {
                    this.paintVertexBuffer && this.paintVertexBuffer.destroy()
                };
                var cl = function (t, e, i, r, n, a) {
                    this.expression = t, this.uniformNames = e.map(function (t) {
                        return "u_" + t + "_t"
                    }), this.type = i, this.useIntegerZoom = r, this.zoom = n, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
                        return {name: "a_" + t, type: "Float32", components: "color" === i ? 4 : 2, offset: 0}
                    }), this.paintVertexArray = new a
                };
                cl.prototype.populatePaintArray = function (t, e, i, r, n) {
                    var a = this.expression.evaluate(new j(this.zoom), e, {}, r, [], n),
                        o = this.expression.evaluate(new j(this.zoom + 1), e, {}, r, [], n),
                        s = this.paintVertexArray.length;
                    this.paintVertexArray.resize(t), this._setPaintValue(s, t, a, o)
                }, cl.prototype.updatePaintArray = function (t, e, i, r) {
                    var n = this.expression.evaluate({zoom: this.zoom}, i, r),
                        a = this.expression.evaluate({zoom: this.zoom + 1}, i, r);
                    this._setPaintValue(t, e, n, a)
                }, cl.prototype._setPaintValue = function (t, e, i, r) {
                    if ("color" === this.type) for (var n = sl(i), a = sl(r), o = t; o < e; o++) this.paintVertexArray.emplace(o, n[0], n[1], a[0], a[1]); else {
                        for (var s = t; s < e; s++) this.paintVertexArray.emplace(s, i, r);
                        this.maxValue = Math.max(this.maxValue, Math.abs(i), Math.abs(r))
                    }
                }, cl.prototype.upload = function (t) {
                    this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent))
                }, cl.prototype.destroy = function () {
                    this.paintVertexBuffer && this.paintVertexBuffer.destroy()
                }, cl.prototype.setUniform = function (t, e) {
                    var i = this.useIntegerZoom ? Math.floor(e.zoom) : e.zoom,
                        r = U(this.expression.interpolationFactor(i, this.zoom, this.zoom + 1), 0, 1);
                    t.set(r)
                }, cl.prototype.getBinding = function (t, e, i) {
                    return new tl(t, e)
                };
                var pl = function (t, e, i, r, n, a) {
                    this.expression = t, this.type = e, this.useIntegerZoom = i, this.zoom = r, this.layerId = a, this.zoomInPaintVertexArray = new n, this.zoomOutPaintVertexArray = new n
                };
                pl.prototype.populatePaintArray = function (t, e, i) {
                    var r = this.zoomInPaintVertexArray.length;
                    this.zoomInPaintVertexArray.resize(t), this.zoomOutPaintVertexArray.resize(t), this._setPaintValues(r, t, e.patterns && e.patterns[this.layerId], i)
                }, pl.prototype.updatePaintArray = function (t, e, i, r, n) {
                    this._setPaintValues(t, e, i.patterns && i.patterns[this.layerId], n)
                }, pl.prototype._setPaintValues = function (t, e, i, r) {
                    if (r && i) {
                        var n = r[i.min], a = r[i.mid], o = r[i.max];
                        if (n && a && o) for (var s = t; s < e; s++) this.zoomInPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], n.tl[0], n.tl[1], n.br[0], n.br[1], a.pixelRatio, n.pixelRatio), this.zoomOutPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], o.tl[0], o.tl[1], o.br[0], o.br[1], a.pixelRatio, o.pixelRatio)
                    }
                }, pl.prototype.upload = function (t) {
                    this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t.createVertexBuffer(this.zoomInPaintVertexArray, qs.members, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t.createVertexBuffer(this.zoomOutPaintVertexArray, qs.members, this.expression.isStateDependent))
                }, pl.prototype.destroy = function () {
                    this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy()
                };
                var fl = function (t, e, i) {
                    this.binders = {}, this._buffers = [];
                    var r = [];
                    for (var n in t.paint._values) if (i(n)) {
                        var a = t.paint.get(n);
                        if (a instanceof $o && da(a.property.specification)) {
                            var o = ml(n, t.type), s = a.value, l = a.property.specification.type,
                                u = a.property.useIntegerZoom, h = a.property.specification["property-type"],
                                c = "cross-faded" === h || "cross-faded-data-driven" === h;
                            if ("constant" === s.kind) this.binders[n] = c ? new ul(s.value, o) : new ll(s.value, o, l), r.push("/u_" + n); else if ("source" === s.kind || c) {
                                var p = yl(n, l, "source");
                                this.binders[n] = c ? new pl(s, l, u, e, p, t.id) : new hl(s, o, l, p), r.push("/a_" + n)
                            } else {
                                var f = yl(n, l, "composite");
                                this.binders[n] = new cl(s, o, l, u, e, f), r.push("/z_" + n)
                            }
                        }
                    }
                    this.cacheKey = r.sort().join("")
                };
                fl.prototype.getMaxValue = function (t) {
                    var e = this.binders[t];
                    return e instanceof hl || e instanceof cl ? e.maxValue : 0
                }, fl.prototype.populatePaintArrays = function (t, e, i, r, n) {
                    for (var a in this.binders) {
                        var o = this.binders[a];
                        (o instanceof hl || o instanceof cl || o instanceof pl) && o.populatePaintArray(t, e, i, r, n)
                    }
                }, fl.prototype.setConstantPatternPositions = function (t, e) {
                    for (var i in this.binders) {
                        var r = this.binders[i];
                        r instanceof ul && r.setConstantPatternPositions(t, e)
                    }
                }, fl.prototype.updatePaintArrays = function (t, e, i, r, n) {
                    var a = !1;
                    for (var o in t) for (var s = 0, l = e.getPositions(o); s < l.length; s += 1) {
                        var u = l[s], h = i.feature(u.index);
                        for (var c in this.binders) {
                            var p = this.binders[c];
                            if ((p instanceof hl || p instanceof cl || p instanceof pl) && !0 === p.expression.isStateDependent) {
                                var f = r.paint.get(c);
                                p.expression = f.value, p.updatePaintArray(u.start, u.end, h, t[o], n), a = !0
                            }
                        }
                    }
                    return a
                }, fl.prototype.defines = function () {
                    var t = [];
                    for (var e in this.binders) {
                        var i = this.binders[e];
                        (i instanceof ll || i instanceof ul) && t.push.apply(t, i.uniformNames.map(function (t) {
                            return "#define HAS_UNIFORM_" + t
                        }))
                    }
                    return t
                }, fl.prototype.getBinderAttributes = function () {
                    var t = [];
                    for (var e in this.binders) {
                        var i = this.binders[e];
                        if (i instanceof hl || i instanceof cl) for (var r = 0; r < i.paintVertexAttributes.length; r++) t.push(i.paintVertexAttributes[r].name); else if (i instanceof pl) for (var n = 0; n < qs.members.length; n++) t.push(qs.members[n].name)
                    }
                    return t
                }, fl.prototype.getBinderUniforms = function () {
                    var t = [];
                    for (var e in this.binders) {
                        var i = this.binders[e];
                        if (i instanceof ll || i instanceof ul || i instanceof cl) for (var r = 0, n = i.uniformNames; r < n.length; r += 1) t.push(n[r])
                    }
                    return t
                }, fl.prototype.getPaintVertexBuffers = function () {
                    return this._buffers
                }, fl.prototype.getUniforms = function (t, e) {
                    var i = [];
                    for (var r in this.binders) {
                        var n = this.binders[r];
                        if (n instanceof ll || n instanceof ul || n instanceof cl) for (var a = 0, o = n.uniformNames; a < o.length; a += 1) {
                            var s = o[a];
                            if (e[s]) {
                                var l = n.getBinding(t, e[s], s);
                                i.push({name: s, property: r, binding: l})
                            }
                        }
                    }
                    return i
                }, fl.prototype.setUniforms = function (t, e, i, r) {
                    for (var n = 0, a = e; n < a.length; n += 1) {
                        var o = a[n], s = o.name, l = o.property;
                        this.binders[l].setUniform(o.binding, r, i.get(l), s)
                    }
                }, fl.prototype.updatePaintBuffers = function (t) {
                    for (var e in this._buffers = [], this.binders) {
                        var i = this.binders[e];
                        if (t && i instanceof pl) {
                            var r = 2 === t.fromScale ? i.zoomInPaintVertexBuffer : i.zoomOutPaintVertexBuffer;
                            r && this._buffers.push(r)
                        } else (i instanceof hl || i instanceof cl) && i.paintVertexBuffer && this._buffers.push(i.paintVertexBuffer)
                    }
                }, fl.prototype.upload = function (t) {
                    for (var e in this.binders) {
                        var i = this.binders[e];
                        (i instanceof hl || i instanceof cl || i instanceof pl) && i.upload(t)
                    }
                    this.updatePaintBuffers()
                }, fl.prototype.destroy = function () {
                    for (var t in this.binders) {
                        var e = this.binders[t];
                        (e instanceof hl || e instanceof cl || e instanceof pl) && e.destroy()
                    }
                };
                var dl = function (t, e, i) {
                    void 0 === i && (i = function () {
                        return !0
                    }), this.programConfigurations = {};
                    for (var r = 0, n = t; r < n.length; r += 1) {
                        var a = n[r];
                        this.programConfigurations[a.id] = new fl(a, e, i)
                    }
                    this.needsUpload = !1, this._featureMap = new Hs, this._bufferOffset = 0
                };

                function ml(t, e) {
                    return {
                        "text-opacity": ["opacity"],
                        "icon-opacity": ["opacity"],
                        "text-color": ["fill_color"],
                        "icon-color": ["fill_color"],
                        "text-halo-color": ["halo_color"],
                        "icon-halo-color": ["halo_color"],
                        "text-halo-blur": ["halo_blur"],
                        "icon-halo-blur": ["halo_blur"],
                        "text-halo-width": ["halo_width"],
                        "icon-halo-width": ["halo_width"],
                        "line-gap-width": ["gapwidth"],
                        "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                        "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                        "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"]
                    }[t] || [t.replace(e + "-", "").replace(/-/g, "_")]
                }

                function yl(t, e, i) {
                    var r = {color: {source: fs, composite: As}, number: {source: Es, composite: fs}},
                        n = function (t) {
                            return {
                                "line-pattern": {source: ds, composite: ds},
                                "fill-pattern": {source: ds, composite: ds},
                                "fill-extrusion-pattern": {source: ds, composite: ds}
                            }[t]
                        }(t);
                    return n && n[i] || r[e][i]
                }

                dl.prototype.populatePaintArrays = function (t, e, i, r, n, a) {
                    for (var o in this.programConfigurations) this.programConfigurations[o].populatePaintArrays(t, e, r, n, a);
                    void 0 !== e.id && this._featureMap.add(e.id, i, this._bufferOffset, t), this._bufferOffset = t, this.needsUpload = !0
                }, dl.prototype.updatePaintArrays = function (t, e, i, r) {
                    for (var n = 0, a = i; n < a.length; n += 1) {
                        var o = a[n];
                        this.needsUpload = this.programConfigurations[o.id].updatePaintArrays(t, this._featureMap, e, o, r) || this.needsUpload
                    }
                }, dl.prototype.get = function (t) {
                    return this.programConfigurations[t]
                }, dl.prototype.upload = function (t) {
                    if (this.needsUpload) {
                        for (var e in this.programConfigurations) this.programConfigurations[e].upload(t);
                        this.needsUpload = !1
                    }
                }, dl.prototype.destroy = function () {
                    for (var t in this.programConfigurations) this.programConfigurations[t].destroy()
                }, e("ConstantBinder", ll), e("CrossFadedConstantBinder", ul), e("SourceExpressionBinder", hl), e("CrossFadedCompositeBinder", pl), e("CompositeExpressionBinder", cl), e("ProgramConfiguration", fl, {omit: ["_buffers"]}), e("ProgramConfigurationSet", dl);
                var gl = Math.pow(2, 14) - 1, _l = -gl - 1;

                function vl(t) {
                    for (var e = 8192 / t.extent, i = t.loadGeometry(), r = 0; r < i.length; r++) for (var n = i[r], a = 0; a < n.length; a++) {
                        var o = n[a], s = Math.round(o.x * e), l = Math.round(o.y * e);
                        o.x = U(s, _l, gl), o.y = U(l, _l, gl), (s < o.x || s > o.x + 1 || l < o.y || l > o.y + 1) && ht("Geometry exceeds allowed extent, reduce your vector tile buffer size")
                    }
                    return i
                }

                function xl(t, e, i, r, n) {
                    t.emplaceBack(2 * e + (r + 1) / 2, 2 * i + (n + 1) / 2)
                }

                var bl = function (t) {
                    this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
                        return t.id
                    }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new us, this.indexArray = new ws, this.segments = new L, this.programConfigurations = new dl(t.layers, t.zoom), this.stateDependentLayerIds = this.layers.filter(function (t) {
                        return t.isStateDependent()
                    }).map(function (t) {
                        return t.id
                    })
                };

                function wl(t, e) {
                    for (var i = 0; i < t.length; i++) if (zl(e, t[i])) return !0;
                    for (var r = 0; r < e.length; r++) if (zl(t, e[r])) return !0;
                    return !!Il(t, e)
                }

                function Ml(t, e, i) {
                    return !!zl(t, e) || !!Cl(e, t, i)
                }

                function Sl(t, e) {
                    if (1 === t.length) return Al(e, t[0]);
                    for (var i = 0; i < e.length; i++) for (var r = e[i], n = 0; n < r.length; n++) if (zl(t, r[n])) return !0;
                    for (var a = 0; a < t.length; a++) if (Al(e, t[a])) return !0;
                    for (var o = 0; o < e.length; o++) if (Il(t, e[o])) return !0;
                    return !1
                }

                function El(t, e, i) {
                    if (t.length > 1) {
                        if (Il(t, e)) return !0;
                        for (var r = 0; r < e.length; r++) if (Cl(e[r], t, i)) return !0
                    }
                    for (var n = 0; n < t.length; n++) if (Cl(t[n], e, i)) return !0;
                    return !1
                }

                function Il(t, e) {
                    if (0 === t.length || 0 === e.length) return !1;
                    for (var i = 0; i < t.length - 1; i++) for (var r = t[i], n = t[i + 1], a = 0; a < e.length - 1; a++) if (Tl(r, n, e[a], e[a + 1])) return !0;
                    return !1
                }

                function Tl(t, e, i, r) {
                    return et(t, i, r) !== et(e, i, r) && et(t, e, i) !== et(t, e, r)
                }

                function Cl(t, e, i) {
                    var r = i * i;
                    if (1 === e.length) return t.distSqr(e[0]) < r;
                    for (var n = 1; n < e.length; n++) if (Pl(t, e[n - 1], e[n]) < r) return !0;
                    return !1
                }

                function Pl(t, e, i) {
                    var r = e.distSqr(i);
                    if (0 === r) return t.distSqr(e);
                    var n = ((t.x - e.x) * (i.x - e.x) + (t.y - e.y) * (i.y - e.y)) / r;
                    return t.distSqr(n < 0 ? e : n > 1 ? i : i.sub(e)._mult(n)._add(e))
                }

                function Al(t, e) {
                    for (var i, r, n, a = !1, o = 0; o < t.length; o++) for (var s = 0, l = (i = t[o]).length - 1; s < i.length; l = s++) (r = i[s]).y > e.y != (n = i[l]).y > e.y && e.x < (n.x - r.x) * (e.y - r.y) / (n.y - r.y) + r.x && (a = !a);
                    return a
                }

                function zl(t, e) {
                    for (var i = !1, r = 0, n = t.length - 1; r < t.length; n = r++) {
                        var a = t[r], o = t[n];
                        a.y > e.y != o.y > e.y && e.x < (o.x - a.x) * (e.y - a.y) / (o.y - a.y) + a.x && (i = !i)
                    }
                    return i
                }

                function kl(t, e, i) {
                    var r = i[0], n = i[2];
                    if (t.x < r.x && e.x < r.x || t.x > n.x && e.x > n.x || t.y < r.y && e.y < r.y || t.y > n.y && e.y > n.y) return !1;
                    var a = et(t, e, i[0]);
                    return a !== et(t, e, i[1]) || a !== et(t, e, i[2]) || a !== et(t, e, i[3])
                }

                function Ll(t, e, i) {
                    var r = e.paint.get(t).value;
                    return "constant" === r.kind ? r.value : i.programConfigurations.get(e.id).getMaxValue(t)
                }

                function Dl(t) {
                    return Math.sqrt(t[0] * t[0] + t[1] * t[1])
                }

                function Rl(t, e, i, r, n) {
                    if (!e[0] && !e[1]) return t;
                    var a = W.convert(e)._mult(n);
                    "viewport" === i && a._rotate(-r);
                    for (var o = [], s = 0; s < t.length; s++) o.push(t[s].sub(a));
                    return o
                }

                bl.prototype.populate = function (t, e, i) {
                    var r = this.layers[0], n = [], a = null;
                    "circle" === r.type && (a = r.layout.get("circle-sort-key"));
                    for (var o = 0, s = t; o < s.length; o += 1) {
                        var l = s[o], u = l.feature, h = l.id, c = l.index, p = l.sourceLayerIndex,
                            f = this.layers[0]._featureFilter.needGeometry,
                            d = {type: u.type, id: h, properties: u.properties, geometry: f ? vl(u) : []};
                        if (this.layers[0]._featureFilter.filter(new j(this.zoom), d, i)) {
                            f || (d.geometry = vl(u));
                            var m = a ? a.evaluate(d, {}, i) : void 0;
                            n.push({
                                id: h,
                                properties: u.properties,
                                type: u.type,
                                sourceLayerIndex: p,
                                index: c,
                                geometry: d.geometry,
                                patterns: {},
                                sortKey: m
                            })
                        }
                    }
                    a && n.sort(function (t, e) {
                        return t.sortKey - e.sortKey
                    });
                    for (var y = 0, g = n; y < g.length; y += 1) {
                        var _ = g[y], v = _.geometry, x = _.index, b = _.sourceLayerIndex, w = t[x].feature;
                        this.addFeature(_, v, x, i), e.featureIndex.insert(w, v, x, b, this.index)
                    }
                }, bl.prototype.update = function (t, e, i) {
                    this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, i)
                }, bl.prototype.isEmpty = function () {
                    return 0 === this.layoutVertexArray.length
                }, bl.prototype.uploadPending = function () {
                    return !this.uploaded || this.programConfigurations.needsUpload
                }, bl.prototype.upload = function (t) {
                    this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Vs), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0
                }, bl.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy())
                }, bl.prototype.addFeature = function (t, e, i, r) {
                    for (var n = 0, a = e; n < a.length; n += 1) for (var o = 0, s = a[n]; o < s.length; o += 1) {
                        var l = s[o], u = l.x, h = l.y;
                        if (!(u < 0 || u >= 8192 || h < 0 || h >= 8192)) {
                            var c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t.sortKey),
                                p = c.vertexLength;
                            xl(this.layoutVertexArray, u, h, -1, -1), xl(this.layoutVertexArray, u, h, 1, -1), xl(this.layoutVertexArray, u, h, 1, 1), xl(this.layoutVertexArray, u, h, -1, 1), this.indexArray.emplaceBack(p, p + 1, p + 2), this.indexArray.emplaceBack(p, p + 3, p + 2), c.vertexLength += 4, c.primitiveLength += 2
                        }
                    }
                    this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, i, {}, r)
                }, e("CircleBucket", bl, {omit: ["layers"]});
                var Bl = new ns({"circle-sort-key": new r(a.layout_circle["circle-sort-key"])}), Ol = {
                    paint: new ns({
                        "circle-radius": new r(a.paint_circle["circle-radius"]),
                        "circle-color": new r(a.paint_circle["circle-color"]),
                        "circle-blur": new r(a.paint_circle["circle-blur"]),
                        "circle-opacity": new r(a.paint_circle["circle-opacity"]),
                        "circle-translate": new i(a.paint_circle["circle-translate"]),
                        "circle-translate-anchor": new i(a.paint_circle["circle-translate-anchor"]),
                        "circle-pitch-scale": new i(a.paint_circle["circle-pitch-scale"]),
                        "circle-pitch-alignment": new i(a.paint_circle["circle-pitch-alignment"]),
                        "circle-stroke-width": new r(a.paint_circle["circle-stroke-width"]),
                        "circle-stroke-color": new r(a.paint_circle["circle-stroke-color"]),
                        "circle-stroke-opacity": new r(a.paint_circle["circle-stroke-opacity"])
                    }), layout: Bl
                }, Fl = "undefined" != typeof Float32Array ? Float32Array : Array;

                function Ul(t) {
                    return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t
                }

                function Nl(t, e, i) {
                    var r = e[0], n = e[1], a = e[2], o = e[3], s = e[4], l = e[5], u = e[6], h = e[7], c = e[8],
                        p = e[9], f = e[10], d = e[11], m = e[12], y = e[13], g = e[14], _ = e[15], v = i[0], x = i[1],
                        b = i[2], w = i[3];
                    return t[0] = v * r + x * s + b * c + w * m, t[1] = v * n + x * l + b * p + w * y, t[2] = v * a + x * u + b * f + w * g, t[3] = v * o + x * h + b * d + w * _, t[4] = (v = i[4]) * r + (x = i[5]) * s + (b = i[6]) * c + (w = i[7]) * m, t[5] = v * n + x * l + b * p + w * y, t[6] = v * a + x * u + b * f + w * g, t[7] = v * o + x * h + b * d + w * _, t[8] = (v = i[8]) * r + (x = i[9]) * s + (b = i[10]) * c + (w = i[11]) * m, t[9] = v * n + x * l + b * p + w * y, t[10] = v * a + x * u + b * f + w * g, t[11] = v * o + x * h + b * d + w * _, t[12] = (v = i[12]) * r + (x = i[13]) * s + (b = i[14]) * c + (w = i[15]) * m, t[13] = v * n + x * l + b * p + w * y, t[14] = v * a + x * u + b * f + w * g, t[15] = v * o + x * h + b * d + w * _, t
                }

                Math.hypot || (Math.hypot = function () {
                    for (var t = arguments, e = 0, i = arguments.length; i--;) e += t[i] * t[i];
                    return Math.sqrt(e)
                });
                var Vl, jl = Nl;

                function ql(t, e, i) {
                    var r = e[0], n = e[1], a = e[2], o = e[3];
                    return t[0] = i[0] * r + i[4] * n + i[8] * a + i[12] * o, t[1] = i[1] * r + i[5] * n + i[9] * a + i[13] * o, t[2] = i[2] * r + i[6] * n + i[10] * a + i[14] * o, t[3] = i[3] * r + i[7] * n + i[11] * a + i[15] * o, t
                }

                Vl = new Fl(3), Fl != Float32Array && (Vl[0] = 0, Vl[1] = 0, Vl[2] = 0), function () {
                    var t = new Fl(4);
                    Fl != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 0)
                }();
                var Gl = (function () {
                    var t = new Fl(2);
                    Fl != Float32Array && (t[0] = 0, t[1] = 0)
                }(), function (e) {
                    function t(t) {
                        e.call(this, t, Ol)
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.createBucket = function (t) {
                        return new bl(t)
                    }, t.prototype.queryRadius = function (t) {
                        var e = t;
                        return Ll("circle-radius", this, e) + Ll("circle-stroke-width", this, e) + Dl(this.paint.get("circle-translate"))
                    }, t.prototype.queryIntersectsFeature = function (t, e, i, r, n, a, o, s) {
                        for (var l = Rl(t, this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), a.angle, o), u = this.paint.get("circle-radius").evaluate(e, i) + this.paint.get("circle-stroke-width").evaluate(e, i), h = "map" === this.paint.get("circle-pitch-alignment"), c = h ? l : function (t, e) {
                            return t.map(function (t) {
                                return Zl(t, e)
                            })
                        }(l, s), p = h ? u * o : u, f = 0, d = r; f < d.length; f += 1) for (var m = 0, y = d[f]; m < y.length; m += 1) {
                            var g = y[m], _ = h ? g : Zl(g, s), v = p, x = ql([], [g.x, g.y, 0, 1], s);
                            if ("viewport" === this.paint.get("circle-pitch-scale") && "map" === this.paint.get("circle-pitch-alignment") ? v *= x[3] / a.cameraToCenterDistance : "map" === this.paint.get("circle-pitch-scale") && "viewport" === this.paint.get("circle-pitch-alignment") && (v *= a.cameraToCenterDistance / x[3]), Ml(c, _, v)) return !0
                        }
                        return !1
                    }, t
                }(as));

                function Zl(t, e) {
                    var i = ql([], [t.x, t.y, 0, 1], e);
                    return new W(i[0] / i[3], i[1] / i[3])
                }

                var Wl = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
                }(bl);
                e("HeatmapBucket", Wl, {omit: ["layers"]});
                var Xl = {
                    paint: new ns({
                        "heatmap-radius": new r(a.paint_heatmap["heatmap-radius"]),
                        "heatmap-weight": new r(a.paint_heatmap["heatmap-weight"]),
                        "heatmap-intensity": new i(a.paint_heatmap["heatmap-intensity"]),
                        "heatmap-color": new rs(a.paint_heatmap["heatmap-color"]),
                        "heatmap-opacity": new i(a.paint_heatmap["heatmap-opacity"])
                    })
                };

                function Hl(n) {
                    var a = {}, t = n.resolution || 256, e = n.clips ? n.clips.length : 1,
                        o = n.image || new x({width: t, height: e}), i = function (t, e, i) {
                            a[n.evaluationKey] = i;
                            var r = n.expression.evaluate(a);
                            o.data[t + e + 0] = Math.floor(255 * r.r / r.a), o.data[t + e + 1] = Math.floor(255 * r.g / r.a), o.data[t + e + 2] = Math.floor(255 * r.b / r.a), o.data[t + e + 3] = Math.floor(255 * r.a)
                        };
                    if (n.clips) for (var r = 0, s = 0; r < e; ++r, s += 4 * t) for (var l = 0, u = 0; l < t; l++, u += 4) {
                        var h = l / (t - 1), c = n.clips[r];
                        i(s, u, c.start * (1 - h) + c.end * h)
                    } else for (var p = 0, f = 0; p < t; p++, f += 4) i(0, f, p / (t - 1));
                    return o
                }

                var Kl = function (e) {
                    function t(t) {
                        e.call(this, t, Xl), this._updateColorRamp()
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.createBucket = function (t) {
                        return new Wl(t)
                    }, t.prototype._handleSpecialPaintPropertyUpdate = function (t) {
                        "heatmap-color" === t && this._updateColorRamp()
                    }, t.prototype._updateColorRamp = function () {
                        this.colorRamp = Hl({
                            expression: this._transitionablePaint._values["heatmap-color"].value.expression,
                            evaluationKey: "heatmapDensity",
                            image: this.colorRamp
                        }), this.colorRampTexture = null
                    }, t.prototype.resize = function () {
                        this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null)
                    }, t.prototype.queryRadius = function () {
                        return 0
                    }, t.prototype.queryIntersectsFeature = function () {
                        return !1
                    }, t.prototype.hasOffscreenPass = function () {
                        return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility
                    }, t
                }(as), Yl = {
                    paint: new ns({
                        "hillshade-illumination-direction": new i(a.paint_hillshade["hillshade-illumination-direction"]),
                        "hillshade-illumination-anchor": new i(a.paint_hillshade["hillshade-illumination-anchor"]),
                        "hillshade-exaggeration": new i(a.paint_hillshade["hillshade-exaggeration"]),
                        "hillshade-shadow-color": new i(a.paint_hillshade["hillshade-shadow-color"]),
                        "hillshade-highlight-color": new i(a.paint_hillshade["hillshade-highlight-color"]),
                        "hillshade-accent-color": new i(a.paint_hillshade["hillshade-accent-color"])
                    })
                }, Jl = function (e) {
                    function t(t) {
                        e.call(this, t, Yl)
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.hasOffscreenPass = function () {
                        return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility
                    }, t
                }(as), Ql = o([{name: "a_pos", components: 2, type: "Int16"}], 4).members, $l = eu, tu = eu;

                function eu(t, e, i) {
                    i = i || 2;
                    var r, n, a, o, s, l, u, h = e && e.length, c = h ? e[0] * i : t.length, p = iu(t, 0, c, i, !0),
                        f = [];
                    if (!p || p.next === p.prev) return f;
                    if (h && (p = function (t, e, i, r) {
                        var n, a, o, s = [];
                        for (n = 0, a = e.length; n < a; n++) (o = iu(t, e[n] * r, n < a - 1 ? e[n + 1] * r : t.length, r, !1)) === o.next && (o.steiner = !0), s.push(fu(o));
                        for (s.sort(uu), n = 0; n < s.length; n++) hu(s[n], i), i = ru(i, i.next);
                        return i
                    }(t, e, p, i)), t.length > 80 * i) {
                        r = a = t[0], n = o = t[1];
                        for (var d = i; d < c; d += i) (s = t[d]) < r && (r = s), (l = t[d + 1]) < n && (n = l), s > a && (a = s), l > o && (o = l);
                        u = 0 !== (u = Math.max(a - r, o - n)) ? 1 / u : 0
                    }
                    return nu(p, f, i, r, n, u), f
                }

                function iu(t, e, i, r, n) {
                    var a, o;
                    if (n === Eu(t, e, i, r) > 0) for (a = e; a < i; a += r) o = wu(a, t[a], t[a + 1], o); else for (a = i - r; a >= e; a -= r) o = wu(a, t[a], t[a + 1], o);
                    return o && yu(o, o.next) && (Mu(o), o = o.next), o
                }

                function ru(t, e) {
                    if (!t) return t;
                    e || (e = t);
                    var i, r = t;
                    do {
                        if (i = !1, r.steiner || !yu(r, r.next) && 0 !== w(r.prev, r, r.next)) r = r.next; else {
                            if (Mu(r), (r = e = r.prev) === r.next) break;
                            i = !0
                        }
                    } while (i || r !== e);
                    return e
                }

                function nu(t, e, i, r, n, a, o) {
                    if (t) {
                        !o && a && function (t, e, i, r) {
                            var n = t;
                            do {
                                null === n.z && (n.z = pu(n.x, n.y, e, i, r)), n.prevZ = n.prev, n.nextZ = n.next, n = n.next
                            } while (n !== t);
                            n.prevZ.nextZ = null, n.prevZ = null, function (t) {
                                var e, i, r, n, a, o, s, l, u = 1;
                                do {
                                    for (i = t, t = null, a = null, o = 0; i;) {
                                        for (o++, r = i, s = 0, e = 0; e < u && (s++, r = r.nextZ); e++) ;
                                        for (l = u; s > 0 || l > 0 && r;) 0 !== s && (0 === l || !r || i.z <= r.z) ? (n = i, i = i.nextZ, s--) : (n = r, r = r.nextZ, l--), a ? a.nextZ = n : t = n, n.prevZ = a, a = n;
                                        i = r
                                    }
                                    a.nextZ = null, u *= 2
                                } while (o > 1)
                            }(n)
                        }(t, r, n, a);
                        for (var s, l, u = t; t.prev !== t.next;) if (s = t.prev, l = t.next, a ? ou(t, r, n, a) : au(t)) e.push(s.i / i), e.push(t.i / i), e.push(l.i / i), Mu(t), t = l.next, u = l.next; else if ((t = l) === u) {
                            o ? 1 === o ? nu(t = su(ru(t), e, i), e, i, r, n, a, 2) : 2 === o && lu(t, e, i, r, n, a) : nu(ru(t), e, i, r, n, a, 1);
                            break
                        }
                    }
                }

                function au(t) {
                    var e = t.prev, i = t, r = t.next;
                    if (w(e, i, r) >= 0) return !1;
                    for (var n = t.next.next; n !== t.prev;) {
                        if (du(e.x, e.y, i.x, i.y, r.x, r.y, n.x, n.y) && w(n.prev, n, n.next) >= 0) return !1;
                        n = n.next
                    }
                    return !0
                }

                function ou(t, e, i, r) {
                    var n = t.prev, a = t, o = t.next;
                    if (w(n, a, o) >= 0) return !1;
                    for (var s = n.x > a.x ? n.x > o.x ? n.x : o.x : a.x > o.x ? a.x : o.x, l = n.y > a.y ? n.y > o.y ? n.y : o.y : a.y > o.y ? a.y : o.y, u = pu(n.x < a.x ? n.x < o.x ? n.x : o.x : a.x < o.x ? a.x : o.x, n.y < a.y ? n.y < o.y ? n.y : o.y : a.y < o.y ? a.y : o.y, e, i, r), h = pu(s, l, e, i, r), c = t.prevZ, p = t.nextZ; c && c.z >= u && p && p.z <= h;) {
                        if (c !== t.prev && c !== t.next && du(n.x, n.y, a.x, a.y, o.x, o.y, c.x, c.y) && w(c.prev, c, c.next) >= 0) return !1;
                        if (c = c.prevZ, p !== t.prev && p !== t.next && du(n.x, n.y, a.x, a.y, o.x, o.y, p.x, p.y) && w(p.prev, p, p.next) >= 0) return !1;
                        p = p.nextZ
                    }
                    for (; c && c.z >= u;) {
                        if (c !== t.prev && c !== t.next && du(n.x, n.y, a.x, a.y, o.x, o.y, c.x, c.y) && w(c.prev, c, c.next) >= 0) return !1;
                        c = c.prevZ
                    }
                    for (; p && p.z <= h;) {
                        if (p !== t.prev && p !== t.next && du(n.x, n.y, a.x, a.y, o.x, o.y, p.x, p.y) && w(p.prev, p, p.next) >= 0) return !1;
                        p = p.nextZ
                    }
                    return !0
                }

                function su(t, e, i) {
                    var r = t;
                    do {
                        var n = r.prev, a = r.next.next;
                        !yu(n, a) && gu(n, r, r.next, a) && xu(n, a) && xu(a, n) && (e.push(n.i / i), e.push(r.i / i), e.push(a.i / i), Mu(r), Mu(r.next), r = t = a), r = r.next
                    } while (r !== t);
                    return ru(r)
                }

                function lu(t, e, i, r, n, a) {
                    var o = t;
                    do {
                        for (var s = o.next.next; s !== o.prev;) {
                            if (o.i !== s.i && mu(o, s)) {
                                var l = bu(o, s);
                                return o = ru(o, o.next), l = ru(l, l.next), nu(o, e, i, r, n, a), void nu(l, e, i, r, n, a)
                            }
                            s = s.next
                        }
                        o = o.next
                    } while (o !== t)
                }

                function uu(t, e) {
                    return t.x - e.x
                }

                function hu(t, e) {
                    if (e = function (t, e) {
                        var i, r = e, n = t.x, a = t.y, o = -1 / 0;
                        do {
                            if (a <= r.y && a >= r.next.y && r.next.y !== r.y) {
                                var s = r.x + (a - r.y) * (r.next.x - r.x) / (r.next.y - r.y);
                                if (s <= n && s > o) {
                                    if (o = s, s === n) {
                                        if (a === r.y) return r;
                                        if (a === r.next.y) return r.next
                                    }
                                    i = r.x < r.next.x ? r : r.next
                                }
                            }
                            r = r.next
                        } while (r !== e);
                        if (!i) return null;
                        if (n === o) return i;
                        var l, u = i, h = i.x, c = i.y, p = 1 / 0;
                        r = i;
                        do {
                            n >= r.x && r.x >= h && n !== r.x && du(a < c ? n : o, a, h, c, a < c ? o : n, a, r.x, r.y) && (l = Math.abs(a - r.y) / (n - r.x), xu(r, t) && (l < p || l === p && (r.x > i.x || r.x === i.x && cu(i, r))) && (i = r, p = l)), r = r.next
                        } while (r !== u);
                        return i
                    }(t, e)) {
                        var i = bu(e, t);
                        ru(e, e.next), ru(i, i.next)
                    }
                }

                function cu(t, e) {
                    return w(t.prev, t, e.prev) < 0 && w(e.next, t, t.next) < 0
                }

                function pu(t, e, i, r, n) {
                    return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) * n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - r) * n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1
                }

                function fu(t) {
                    var e = t, i = t;
                    do {
                        (e.x < i.x || e.x === i.x && e.y < i.y) && (i = e), e = e.next
                    } while (e !== t);
                    return i
                }

                function du(t, e, i, r, n, a, o, s) {
                    return (n - o) * (e - s) - (t - o) * (a - s) >= 0 && (t - o) * (r - s) - (i - o) * (e - s) >= 0 && (i - o) * (a - s) - (n - o) * (r - s) >= 0
                }

                function mu(t, e) {
                    return t.next.i !== e.i && t.prev.i !== e.i && !function (t, e) {
                        var i = t;
                        do {
                            if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && gu(i, i.next, t, e)) return !0;
                            i = i.next
                        } while (i !== t);
                        return !1
                    }(t, e) && (xu(t, e) && xu(e, t) && function (t, e) {
                        var i = t, r = !1, n = (t.x + e.x) / 2, a = (t.y + e.y) / 2;
                        do {
                            i.y > a != i.next.y > a && i.next.y !== i.y && n < (i.next.x - i.x) * (a - i.y) / (i.next.y - i.y) + i.x && (r = !r), i = i.next
                        } while (i !== t);
                        return r
                    }(t, e) && (w(t.prev, t, e.prev) || w(t, e.prev, e)) || yu(t, e) && w(t.prev, t, t.next) > 0 && w(e.prev, e, e.next) > 0)
                }

                function w(t, e, i) {
                    return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y)
                }

                function yu(t, e) {
                    return t.x === e.x && t.y === e.y
                }

                function gu(t, e, i, r) {
                    var n = vu(w(t, e, i)), a = vu(w(t, e, r)), o = vu(w(i, r, t)), s = vu(w(i, r, e));
                    return n !== a && o !== s || !(0 !== n || !_u(t, i, e)) || !(0 !== a || !_u(t, r, e)) || !(0 !== o || !_u(i, t, r)) || !(0 !== s || !_u(i, e, r))
                }

                function _u(t, e, i) {
                    return e.x <= Math.max(t.x, i.x) && e.x >= Math.min(t.x, i.x) && e.y <= Math.max(t.y, i.y) && e.y >= Math.min(t.y, i.y)
                }

                function vu(t) {
                    return t > 0 ? 1 : t < 0 ? -1 : 0
                }

                function xu(t, e) {
                    return w(t.prev, t, t.next) < 0 ? w(t, e, t.next) >= 0 && w(t, t.prev, e) >= 0 : w(t, e, t.prev) < 0 || w(t, t.next, e) < 0
                }

                function bu(t, e) {
                    var i = new Su(t.i, t.x, t.y), r = new Su(e.i, e.x, e.y), n = t.next, a = e.prev;
                    return t.next = e, e.prev = t, i.next = n, n.prev = i, r.next = i, i.prev = r, a.next = r, r.prev = a, r
                }

                function wu(t, e, i, r) {
                    var n = new Su(t, e, i);
                    return r ? (n.next = r.next, n.prev = r, r.next.prev = n, r.next = n) : (n.prev = n, n.next = n), n
                }

                function Mu(t) {
                    t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ)
                }

                function Su(t, e, i) {
                    this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1
                }

                function Eu(t, e, i, r) {
                    for (var n = 0, a = e, o = i - r; a < i; a += r) n += (t[o] - t[a]) * (t[a + 1] + t[o + 1]), o = a;
                    return n
                }

                function Iu(t, e, i, r, n) {
                    !function t(e, i, r, n, a) {
                        for (; n > r;) {
                            if (n - r > 600) {
                                var o = n - r + 1, s = i - r + 1, l = Math.log(o), u = .5 * Math.exp(2 * l / 3),
                                    h = .5 * Math.sqrt(l * u * (o - u) / o) * (s - o / 2 < 0 ? -1 : 1);
                                t(e, i, Math.max(r, Math.floor(i - s * u / o + h)), Math.min(n, Math.floor(i + (o - s) * u / o + h)), a)
                            }
                            var c = e[i], p = r, f = n;
                            for (Tu(e, r, i), a(e[n], c) > 0 && Tu(e, r, n); p < f;) {
                                for (Tu(e, p, f), p++, f--; a(e[p], c) < 0;) p++;
                                for (; a(e[f], c) > 0;) f--
                            }
                            0 === a(e[r], c) ? Tu(e, r, f) : Tu(e, ++f, n), f <= i && (r = f + 1), i <= f && (n = f - 1)
                        }
                    }(t, e, i || 0, r || t.length - 1, n || Cu)
                }

                function Tu(t, e, i) {
                    var r = t[e];
                    t[e] = t[i], t[i] = r
                }

                function Cu(t, e) {
                    return t < e ? -1 : t > e ? 1 : 0
                }

                function Pu(t, e) {
                    var i = t.length;
                    if (i <= 1) return [t];
                    for (var r, n, a = [], o = 0; o < i; o++) {
                        var s = it(t[o]);
                        0 !== s && (t[o].area = Math.abs(s), void 0 === n && (n = s < 0), n === s < 0 ? (r && a.push(r), r = [t[o]]) : r.push(t[o]))
                    }
                    if (r && a.push(r), e > 1) for (var l = 0; l < a.length; l++) a[l].length <= e || (Iu(a[l], e, 1, a[l].length - 1, Au), a[l] = a[l].slice(0, e));
                    return a
                }

                function Au(t, e) {
                    return e.area - t.area
                }

                function zu(t, e, i) {
                    for (var r = i.patternDependencies, n = !1, a = 0, o = e; a < o.length; a += 1) {
                        var s = o[a].paint.get(t + "-pattern");
                        s.isConstant() || (n = !0);
                        var l = s.constantOr(null);
                        l && (n = !0, r[l.to] = !0, r[l.from] = !0)
                    }
                    return n
                }

                function ku(t, e, i, r, n) {
                    for (var a = n.patternDependencies, o = 0, s = e; o < s.length; o += 1) {
                        var l = s[o], u = l.paint.get(t + "-pattern").value;
                        if ("constant" !== u.kind) {
                            var h = u.evaluate({zoom: r - 1}, i, {}, n.availableImages),
                                c = u.evaluate({zoom: r}, i, {}, n.availableImages),
                                p = u.evaluate({zoom: r + 1}, i, {}, n.availableImages);
                            c = c && c.name ? c.name : c, p = p && p.name ? p.name : p, a[h = h && h.name ? h.name : h] = !0, a[c] = !0, a[p] = !0, i.patterns[l.id] = {
                                min: h,
                                mid: c,
                                max: p
                            }
                        }
                    }
                    return i
                }

                eu.deviation = function (t, e, i, r) {
                    var n = e && e.length, a = Math.abs(Eu(t, 0, n ? e[0] * i : t.length, i));
                    if (n) for (var o = 0, s = e.length; o < s; o++) a -= Math.abs(Eu(t, e[o] * i, o < s - 1 ? e[o + 1] * i : t.length, i));
                    var l = 0;
                    for (o = 0; o < r.length; o += 3) {
                        var u = r[o] * i, h = r[o + 1] * i, c = r[o + 2] * i;
                        l += Math.abs((t[u] - t[c]) * (t[h + 1] - t[u + 1]) - (t[u] - t[h]) * (t[c + 1] - t[u + 1]))
                    }
                    return 0 === a && 0 === l ? 0 : Math.abs((l - a) / a)
                }, eu.flatten = function (t) {
                    for (var e = t[0][0].length, i = {
                        vertices: [],
                        holes: [],
                        dimensions: e
                    }, r = 0, n = 0; n < t.length; n++) {
                        for (var a = 0; a < t[n].length; a++) for (var o = 0; o < e; o++) i.vertices.push(t[n][a][o]);
                        n > 0 && i.holes.push(r += t[n - 1].length)
                    }
                    return i
                }, $l.default = tu;
                var Lu = function (t) {
                    this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
                        return t.id
                    }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new us, this.indexArray = new ws, this.indexArray2 = new Cs, this.programConfigurations = new dl(t.layers, t.zoom), this.segments = new L, this.segments2 = new L, this.stateDependentLayerIds = this.layers.filter(function (t) {
                        return t.isStateDependent()
                    }).map(function (t) {
                        return t.id
                    })
                };
                Lu.prototype.populate = function (t, e, i) {
                    this.hasPattern = zu("fill", this.layers, e);
                    for (var r = this.layers[0].layout.get("fill-sort-key"), n = [], a = 0, o = t; a < o.length; a += 1) {
                        var s = o[a], l = s.feature, u = s.id, h = s.index, c = s.sourceLayerIndex,
                            p = this.layers[0]._featureFilter.needGeometry,
                            f = {type: l.type, id: u, properties: l.properties, geometry: p ? vl(l) : []};
                        if (this.layers[0]._featureFilter.filter(new j(this.zoom), f, i)) {
                            p || (f.geometry = vl(l));
                            var d = r ? r.evaluate(f, {}, i, e.availableImages) : void 0;
                            n.push({
                                id: u,
                                properties: l.properties,
                                type: l.type,
                                sourceLayerIndex: c,
                                index: h,
                                geometry: f.geometry,
                                patterns: {},
                                sortKey: d
                            })
                        }
                    }
                    r && n.sort(function (t, e) {
                        return t.sortKey - e.sortKey
                    });
                    for (var m = 0, y = n; m < y.length; m += 1) {
                        var g = y[m], _ = g.geometry, v = g.index, x = g.sourceLayerIndex;
                        if (this.hasPattern) {
                            var b = ku("fill", this.layers, g, this.zoom, e);
                            this.patternFeatures.push(b)
                        } else this.addFeature(g, _, v, i, {});
                        e.featureIndex.insert(t[v].feature, _, v, x, this.index)
                    }
                }, Lu.prototype.update = function (t, e, i) {
                    this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, i)
                }, Lu.prototype.addFeatures = function (t, e, i) {
                    for (var r = 0, n = this.patternFeatures; r < n.length; r += 1) {
                        var a = n[r];
                        this.addFeature(a, a.geometry, a.index, e, i)
                    }
                }, Lu.prototype.isEmpty = function () {
                    return 0 === this.layoutVertexArray.length
                }, Lu.prototype.uploadPending = function () {
                    return !this.uploaded || this.programConfigurations.needsUpload
                }, Lu.prototype.upload = function (t) {
                    this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Ql), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.indexBuffer2 = t.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t), this.uploaded = !0
                }, Lu.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy())
                }, Lu.prototype.addFeature = function (t, e, i, r, n) {
                    for (var a = 0, o = Pu(e, 500); a < o.length; a += 1) {
                        for (var s = o[a], l = 0, u = 0, h = s; u < h.length; u += 1) l += h[u].length;
                        for (var c = this.segments.prepareSegment(l, this.layoutVertexArray, this.indexArray), p = c.vertexLength, f = [], d = [], m = 0, y = s; m < y.length; m += 1) {
                            var g = y[m];
                            if (0 !== g.length) {
                                g !== s[0] && d.push(f.length / 2);
                                var _ = this.segments2.prepareSegment(g.length, this.layoutVertexArray, this.indexArray2),
                                    v = _.vertexLength;
                                this.layoutVertexArray.emplaceBack(g[0].x, g[0].y), this.indexArray2.emplaceBack(v + g.length - 1, v), f.push(g[0].x), f.push(g[0].y);
                                for (var x = 1; x < g.length; x++) this.layoutVertexArray.emplaceBack(g[x].x, g[x].y), this.indexArray2.emplaceBack(v + x - 1, v + x), f.push(g[x].x), f.push(g[x].y);
                                _.vertexLength += g.length, _.primitiveLength += g.length
                            }
                        }
                        for (var b = $l(f, d), w = 0; w < b.length; w += 3) this.indexArray.emplaceBack(p + b[w], p + b[w + 1], p + b[w + 2]);
                        c.vertexLength += l, c.primitiveLength += b.length / 3
                    }
                    this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, i, n, r)
                }, e("FillBucket", Lu, {omit: ["layers", "patternFeatures"]});
                var Du = new ns({"fill-sort-key": new r(a.layout_fill["fill-sort-key"])}), Ru = {
                    paint: new ns({
                        "fill-antialias": new i(a.paint_fill["fill-antialias"]),
                        "fill-opacity": new r(a.paint_fill["fill-opacity"]),
                        "fill-color": new r(a.paint_fill["fill-color"]),
                        "fill-outline-color": new r(a.paint_fill["fill-outline-color"]),
                        "fill-translate": new i(a.paint_fill["fill-translate"]),
                        "fill-translate-anchor": new i(a.paint_fill["fill-translate-anchor"]),
                        "fill-pattern": new es(a.paint_fill["fill-pattern"])
                    }), layout: Du
                }, Bu = function (r) {
                    function t(t) {
                        r.call(this, t, Ru)
                    }

                    return r && (t.__proto__ = r), (t.prototype = Object.create(r && r.prototype)).constructor = t, t.prototype.recalculate = function (t, e) {
                        r.prototype.recalculate.call(this, t, e);
                        var i = this.paint._values["fill-outline-color"];
                        "constant" === i.value.kind && void 0 === i.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"])
                    }, t.prototype.createBucket = function (t) {
                        return new Lu(t)
                    }, t.prototype.queryRadius = function () {
                        return Dl(this.paint.get("fill-translate"))
                    }, t.prototype.queryIntersectsFeature = function (t, e, i, r, n, a, o) {
                        return Sl(Rl(t, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), a.angle, o), r)
                    }, t.prototype.isTileClipped = function () {
                        return !0
                    }, t
                }(as), Ou = o([{name: "a_pos", components: 2, type: "Int16"}, {
                    name: "a_normal_ed",
                    components: 4,
                    type: "Int16"
                }], 4).members, Fu = Uu;

                function Uu(t, e, i, r, n) {
                    this.properties = {}, this.extent = i, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = r, this._values = n, t.readFields(Nu, this, e)
                }

                function Nu(t, e, i) {
                    1 == t ? e.id = i.readVarint() : 2 == t ? function (t, e) {
                        for (var i = t.readVarint() + t.pos; t.pos < i;) {
                            var r = e._keys[t.readVarint()], n = e._values[t.readVarint()];
                            e.properties[r] = n
                        }
                    }(i, e) : 3 == t ? e.type = i.readVarint() : 4 == t && (e._geometry = i.pos)
                }

                function Vu(t) {
                    for (var e, i, r = 0, n = 0, a = t.length, o = a - 1; n < a; o = n++) r += ((i = t[o]).x - (e = t[n]).x) * (e.y + i.y);
                    return r
                }

                Uu.types = ["Unknown", "Point", "LineString", "Polygon"], Uu.prototype.loadGeometry = function () {
                    var t = this._pbf;
                    t.pos = this._geometry;
                    for (var e, i = t.readVarint() + t.pos, r = 1, n = 0, a = 0, o = 0, s = []; t.pos < i;) {
                        if (n <= 0) {
                            var l = t.readVarint();
                            r = 7 & l, n = l >> 3
                        }
                        if (n--, 1 === r || 2 === r) a += t.readSVarint(), o += t.readSVarint(), 1 === r && (e && s.push(e), e = []), e.push(new W(a, o)); else {
                            if (7 !== r) throw new Error("unknown command " + r);
                            e && e.push(e[0].clone())
                        }
                    }
                    return e && s.push(e), s
                }, Uu.prototype.bbox = function () {
                    var t = this._pbf;
                    t.pos = this._geometry;
                    for (var e = t.readVarint() + t.pos, i = 1, r = 0, n = 0, a = 0, o = 1 / 0, s = -1 / 0, l = 1 / 0, u = -1 / 0; t.pos < e;) {
                        if (r <= 0) {
                            var h = t.readVarint();
                            i = 7 & h, r = h >> 3
                        }
                        if (r--, 1 === i || 2 === i) (n += t.readSVarint()) < o && (o = n), n > s && (s = n), (a += t.readSVarint()) < l && (l = a), a > u && (u = a); else if (7 !== i) throw new Error("unknown command " + i)
                    }
                    return [o, l, s, u]
                }, Uu.prototype.toGeoJSON = function (t, e, i, r) {
                    var n, a, o = this.extent * Math.pow(2, i), s = this.extent * t, l = this.extent * e,
                        u = this.loadGeometry(), h = Uu.types[this.type];

                    function c(t) {
                        for (var e = 0; e < t.length; e++) {
                            var i = t[e];
                            t[e] = r((i.x + s) / o, (i.y + l) / o)
                        }
                    }

                    switch (this.type) {
                        case 1:
                            var p = [];
                            for (n = 0; n < u.length; n++) p[n] = u[n][0];
                            c(u = p);
                            break;
                        case 2:
                            for (n = 0; n < u.length; n++) c(u[n]);
                            break;
                        case 3:
                            for (u = function (t) {
                                var e = t.length;
                                if (e <= 1) return [t];
                                for (var i, r, n = [], a = 0; a < e; a++) {
                                    var o = Vu(t[a]);
                                    0 !== o && (void 0 === r && (r = o < 0), r === o < 0 ? (i && n.push(i), i = [t[a]]) : i.push(t[a]))
                                }
                                return i && n.push(i), n
                            }(u), n = 0; n < u.length; n++) for (a = 0; a < u[n].length; a++) c(u[n][a])
                    }
                    1 === u.length ? u = u[0] : h = "Multi" + h;
                    var f = {type: "Feature", geometry: {type: h, coordinates: u}, properties: this.properties};
                    return "id" in this && (f.id = this.id), f
                };
                var ju = qu;

                function qu(t, e) {
                    this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(Gu, this, e), this.length = this._features.length
                }

                function Gu(t, e, i) {
                    15 === t ? e.version = i.readVarint() : 1 === t ? e.name = i.readString() : 5 === t ? e.extent = i.readVarint() : 2 === t ? e._features.push(i.pos) : 3 === t ? e._keys.push(i.readString()) : 4 === t && e._values.push(function (t) {
                        for (var e = null, i = t.readVarint() + t.pos; t.pos < i;) {
                            var r = t.readVarint() >> 3;
                            e = 1 === r ? t.readString() : 2 === r ? t.readFloat() : 3 === r ? t.readDouble() : 4 === r ? t.readVarint64() : 5 === r ? t.readVarint() : 6 === r ? t.readSVarint() : 7 === r ? t.readBoolean() : null
                        }
                        return e
                    }(i))
                }

                function Zu(t, e, i) {
                    if (3 === t) {
                        var r = new ju(i, i.readVarint() + i.pos);
                        r.length && (e[r.name] = r)
                    }
                }

                qu.prototype.feature = function (t) {
                    if (t < 0 || t >= this._features.length) throw new Error("feature index out of bounds");
                    this._pbf.pos = this._features[t];
                    var e = this._pbf.readVarint() + this._pbf.pos;
                    return new Fu(this._pbf, e, this.extent, this._keys, this._values)
                };
                var Wu = {
                    VectorTile: function (t, e) {
                        this.layers = t.readFields(Zu, {}, e)
                    }, VectorTileFeature: Fu, VectorTileLayer: ju
                }, Xu = Wu.VectorTileFeature.types, Hu = Math.pow(2, 13);

                function Ku(t, e, i, r, n, a, o, s) {
                    t.emplaceBack(e, i, 2 * Math.floor(r * Hu) + o, n * Hu * 2, a * Hu * 2, Math.round(s))
                }

                var Yu = function (t) {
                    this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
                        return t.id
                    }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new cs, this.indexArray = new ws, this.programConfigurations = new dl(t.layers, t.zoom), this.segments = new L, this.stateDependentLayerIds = this.layers.filter(function (t) {
                        return t.isStateDependent()
                    }).map(function (t) {
                        return t.id
                    })
                };

                function Ju(t, e) {
                    return t.x === e.x && (t.x < 0 || t.x > 8192) || t.y === e.y && (t.y < 0 || t.y > 8192)
                }

                Yu.prototype.populate = function (t, e, i) {
                    this.features = [], this.hasPattern = zu("fill-extrusion", this.layers, e);
                    for (var r = 0, n = t; r < n.length; r += 1) {
                        var a = n[r], o = a.feature, s = a.id, l = a.index, u = a.sourceLayerIndex,
                            h = this.layers[0]._featureFilter.needGeometry,
                            c = {type: o.type, id: s, properties: o.properties, geometry: h ? vl(o) : []};
                        if (this.layers[0]._featureFilter.filter(new j(this.zoom), c, i)) {
                            var p = {
                                id: s,
                                sourceLayerIndex: u,
                                index: l,
                                geometry: h ? c.geometry : vl(o),
                                properties: o.properties,
                                type: o.type,
                                patterns: {}
                            };
                            this.hasPattern ? this.features.push(ku("fill-extrusion", this.layers, p, this.zoom, e)) : this.addFeature(p, p.geometry, l, i, {}), e.featureIndex.insert(o, p.geometry, l, u, this.index, !0)
                        }
                    }
                }, Yu.prototype.addFeatures = function (t, e, i) {
                    for (var r = 0, n = this.features; r < n.length; r += 1) {
                        var a = n[r];
                        this.addFeature(a, a.geometry, a.index, e, i)
                    }
                }, Yu.prototype.update = function (t, e, i) {
                    this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, i)
                }, Yu.prototype.isEmpty = function () {
                    return 0 === this.layoutVertexArray.length
                }, Yu.prototype.uploadPending = function () {
                    return !this.uploaded || this.programConfigurations.needsUpload
                }, Yu.prototype.upload = function (t) {
                    this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Ou), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0
                }, Yu.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy())
                }, Yu.prototype.addFeature = function (t, e, i, r, n) {
                    for (var a = 0, o = Pu(e, 500); a < o.length; a += 1) {
                        for (var s = o[a], l = 0, u = 0, h = s; u < h.length; u += 1) l += h[u].length;
                        for (var c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray), p = 0, f = s; p < f.length; p += 1) {
                            var d = f[p];
                            if (0 !== d.length && !((k = d).every(function (t) {
                                return t.x < 0
                            }) || k.every(function (t) {
                                return t.x > 8192
                            }) || k.every(function (t) {
                                return t.y < 0
                            }) || k.every(function (t) {
                                return t.y > 8192
                            }))) for (var m = 0, y = 0; y < d.length; y++) {
                                var g = d[y];
                                if (y >= 1) {
                                    var _ = d[y - 1];
                                    if (!Ju(g, _)) {
                                        c.vertexLength + 4 > L.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                                        var v = g.sub(_)._perp()._unit(), x = _.dist(g);
                                        m + x > 32768 && (m = 0), Ku(this.layoutVertexArray, g.x, g.y, v.x, v.y, 0, 0, m), Ku(this.layoutVertexArray, g.x, g.y, v.x, v.y, 0, 1, m), Ku(this.layoutVertexArray, _.x, _.y, v.x, v.y, 0, 0, m += x), Ku(this.layoutVertexArray, _.x, _.y, v.x, v.y, 0, 1, m);
                                        var b = c.vertexLength;
                                        this.indexArray.emplaceBack(b, b + 2, b + 1), this.indexArray.emplaceBack(b + 1, b + 2, b + 3), c.vertexLength += 4, c.primitiveLength += 2
                                    }
                                }
                            }
                        }
                        if (c.vertexLength + l > L.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(l, this.layoutVertexArray, this.indexArray)), "Polygon" === Xu[t.type]) {
                            for (var w = [], M = [], S = c.vertexLength, E = 0, I = s; E < I.length; E += 1) {
                                var T = I[E];
                                if (0 !== T.length) {
                                    T !== s[0] && M.push(w.length / 2);
                                    for (var C = 0; C < T.length; C++) {
                                        var P = T[C];
                                        Ku(this.layoutVertexArray, P.x, P.y, 0, 0, 1, 1, 0), w.push(P.x), w.push(P.y)
                                    }
                                }
                            }
                            for (var A = $l(w, M), z = 0; z < A.length; z += 3) this.indexArray.emplaceBack(S + A[z], S + A[z + 2], S + A[z + 1]);
                            c.primitiveLength += A.length / 3, c.vertexLength += l
                        }
                    }
                    var k;
                    this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, i, n, r)
                }, e("FillExtrusionBucket", Yu, {omit: ["layers", "features"]});
                var Qu = {
                    paint: new ns({
                        "fill-extrusion-opacity": new i(a["paint_fill-extrusion"]["fill-extrusion-opacity"]),
                        "fill-extrusion-color": new r(a["paint_fill-extrusion"]["fill-extrusion-color"]),
                        "fill-extrusion-translate": new i(a["paint_fill-extrusion"]["fill-extrusion-translate"]),
                        "fill-extrusion-translate-anchor": new i(a["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),
                        "fill-extrusion-pattern": new es(a["paint_fill-extrusion"]["fill-extrusion-pattern"]),
                        "fill-extrusion-height": new r(a["paint_fill-extrusion"]["fill-extrusion-height"]),
                        "fill-extrusion-base": new r(a["paint_fill-extrusion"]["fill-extrusion-base"]),
                        "fill-extrusion-vertical-gradient": new i(a["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])
                    })
                }, $u = function (e) {
                    function t(t) {
                        e.call(this, t, Qu)
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.createBucket = function (t) {
                        return new Yu(t)
                    }, t.prototype.queryRadius = function () {
                        return Dl(this.paint.get("fill-extrusion-translate"))
                    }, t.prototype.is3D = function () {
                        return !0
                    }, t.prototype.queryIntersectsFeature = function (t, e, i, r, n, a, o, s) {
                        var l = Rl(t, this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), a.angle, o),
                            u = this.paint.get("fill-extrusion-height").evaluate(e, i),
                            h = this.paint.get("fill-extrusion-base").evaluate(e, i), c = function (t, e, i, r) {
                                for (var n = [], a = 0, o = t; a < o.length; a += 1) {
                                    var s = o[a], l = [s.x, s.y, 0, 1];
                                    ql(l, l, e), n.push(new W(l[0] / l[3], l[1] / l[3]))
                                }
                                return n
                            }(l, s), p = function (t, e, i, r) {
                                for (var n = [], a = [], o = r[8] * e, s = r[9] * e, l = r[10] * e, u = r[11] * e, h = r[8] * i, c = r[9] * i, p = r[10] * i, f = r[11] * i, d = 0, m = t; d < m.length; d += 1) {
                                    for (var y = [], g = [], _ = 0, v = m[d]; _ < v.length; _ += 1) {
                                        var x = v[_], b = x.x, w = x.y, M = r[0] * b + r[4] * w + r[12],
                                            S = r[1] * b + r[5] * w + r[13], E = r[2] * b + r[6] * w + r[14],
                                            I = r[3] * b + r[7] * w + r[15], T = E + l, C = I + u, P = M + h, A = S + c,
                                            z = E + p, k = I + f, L = new W((M + o) / C, (S + s) / C);
                                        L.z = T / C, y.push(L);
                                        var D = new W(P / k, A / k);
                                        D.z = z / k, g.push(D)
                                    }
                                    n.push(y), a.push(g)
                                }
                                return [n, a]
                            }(r, h, u, s);
                        return function (t, e, i) {
                            var r = 1 / 0;
                            Sl(i, e) && (r = eh(i, e[0]));
                            for (var n = 0; n < e.length; n++) for (var a = e[n], o = t[n], s = 0; s < a.length - 1; s++) {
                                var l = a[s], u = [l, a[s + 1], o[s + 1], o[s], l];
                                wl(i, u) && (r = Math.min(r, eh(i, u)))
                            }
                            return r !== 1 / 0 && r
                        }(p[0], p[1], c)
                    }, t
                }(as);

                function th(t, e) {
                    return t.x * e.x + t.y * e.y
                }

                function eh(t, e) {
                    if (1 === t.length) {
                        for (var i, r = 0, n = e[r++]; !i || n.equals(i);) if (!(i = e[r++])) return 1 / 0;
                        for (; r < e.length; r++) {
                            var a = e[r], o = t[0], s = i.sub(n), l = a.sub(n), u = o.sub(n), h = th(s, s),
                                c = th(s, l), p = th(l, l), f = th(u, s), d = th(u, l), m = h * p - c * c,
                                y = (p * f - c * d) / m, g = (h * d - c * f) / m,
                                _ = n.z * (1 - y - g) + i.z * y + a.z * g;
                            if (isFinite(_)) return _
                        }
                        return 1 / 0
                    }
                    for (var v = 1 / 0, x = 0, b = e; x < b.length; x += 1) v = Math.min(v, b[x].z);
                    return v
                }

                var ih = o([{name: "a_pos_normal", components: 2, type: "Int16"}, {
                        name: "a_data",
                        components: 4,
                        type: "Uint8"
                    }], 4).members, rh = o([{name: "a_uv_x", components: 1, type: "Float32"}, {
                        name: "a_split_index",
                        components: 1,
                        type: "Float32"
                    }]).members, nh = Wu.VectorTileFeature.types, ah = Math.cos(Math.PI / 180 * 37.5),
                    oh = Math.pow(2, 14) / .5, sh = function (t) {
                        var e = this;
                        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
                            return t.id
                        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach(function (t) {
                            e.gradients[t.id] = {}
                        }), this.layoutVertexArray = new ps, this.layoutVertexArray2 = new fs, this.indexArray = new ws, this.programConfigurations = new dl(t.layers, t.zoom), this.segments = new L, this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter(function (t) {
                            return t.isStateDependent()
                        }).map(function (t) {
                            return t.id
                        })
                    };
                sh.prototype.populate = function (t, e, i) {
                    this.hasPattern = zu("line", this.layers, e);
                    for (var r = this.layers[0].layout.get("line-sort-key"), n = [], a = 0, o = t; a < o.length; a += 1) {
                        var s = o[a], l = s.feature, u = s.id, h = s.index, c = s.sourceLayerIndex,
                            p = this.layers[0]._featureFilter.needGeometry,
                            f = {type: l.type, id: u, properties: l.properties, geometry: p ? vl(l) : []};
                        if (this.layers[0]._featureFilter.filter(new j(this.zoom), f, i)) {
                            p || (f.geometry = vl(l));
                            var d = r ? r.evaluate(f, {}, i) : void 0;
                            n.push({
                                id: u,
                                properties: l.properties,
                                type: l.type,
                                sourceLayerIndex: c,
                                index: h,
                                geometry: f.geometry,
                                patterns: {},
                                sortKey: d
                            })
                        }
                    }
                    r && n.sort(function (t, e) {
                        return t.sortKey - e.sortKey
                    });
                    for (var m = 0, y = n; m < y.length; m += 1) {
                        var g = y[m], _ = g.geometry, v = g.index, x = g.sourceLayerIndex;
                        if (this.hasPattern) {
                            var b = ku("line", this.layers, g, this.zoom, e);
                            this.patternFeatures.push(b)
                        } else this.addFeature(g, _, v, i, {});
                        e.featureIndex.insert(t[v].feature, _, v, x, this.index)
                    }
                }, sh.prototype.update = function (t, e, i) {
                    this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, i)
                }, sh.prototype.addFeatures = function (t, e, i) {
                    for (var r = 0, n = this.patternFeatures; r < n.length; r += 1) {
                        var a = n[r];
                        this.addFeature(a, a.geometry, a.index, e, i)
                    }
                }, sh.prototype.isEmpty = function () {
                    return 0 === this.layoutVertexArray.length
                }, sh.prototype.uploadPending = function () {
                    return !this.uploaded || this.programConfigurations.needsUpload
                }, sh.prototype.upload = function (t) {
                    this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = t.createVertexBuffer(this.layoutVertexArray2, rh)), this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, ih), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0
                }, sh.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy())
                }, sh.prototype.lineFeatureClips = function (t) {
                    if (t.properties && t.properties.hasOwnProperty("mapbox_clip_start") && t.properties.hasOwnProperty("mapbox_clip_end")) return {
                        start: +t.properties.mapbox_clip_start,
                        end: +t.properties.mapbox_clip_end
                    }
                }, sh.prototype.addFeature = function (t, e, i, r, n) {
                    var a = this.layers[0].layout, o = a.get("line-join").evaluate(t, {}), s = a.get("line-cap"),
                        l = a.get("line-miter-limit"), u = a.get("line-round-limit");
                    this.lineClips = this.lineFeatureClips(t);
                    for (var h = 0, c = e; h < c.length; h += 1) this.addLine(c[h], t, o, s, l, u);
                    this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, i, n, r)
                }, sh.prototype.addLine = function (t, B, e, O, i, F) {
                    if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineClips) {
                        this.lineClipsArray.push(this.lineClips);
                        for (var r = 0; r < t.length - 1; r++) this.totalDistance += t[r].dist(t[r + 1]);
                        this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance)
                    }
                    for (var n = "Polygon" === nh[B.type], a = t.length; a >= 2 && t[a - 1].equals(t[a - 2]);) a--;
                    for (var o = 0; o < a - 1 && t[o].equals(t[o + 1]);) o++;
                    if (!(a < (n ? 3 : 2))) {
                        "bevel" === e && (i = 1.05);
                        var s, l = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                            u = this.segments.prepareSegment(10 * a, this.layoutVertexArray, this.indexArray),
                            h = void 0, c = void 0, p = void 0, f = void 0;
                        this.e1 = this.e2 = -1, n && (f = t[o].sub(s = t[a - 2])._unit()._perp());
                        for (var d = o; d < a; d++) if (!(c = d === a - 1 ? n ? t[o + 1] : void 0 : t[d + 1]) || !t[d].equals(c)) {
                            f && (p = f), s && (h = s), s = t[d], f = c ? c.sub(s)._unit()._perp() : p;
                            var m = (p = p || f).add(f);
                            0 === m.x && 0 === m.y || m._unit();
                            var y = p.x * f.x + p.y * f.y, g = m.x * f.x + m.y * f.y, _ = 0 !== g ? 1 / g : 1 / 0,
                                U = 2 * Math.sqrt(2 - 2 * g), v = g < ah && h && c, x = p.x * f.y - p.y * f.x > 0;
                            if (v && d > o) {
                                var b = s.dist(h);
                                if (b > 2 * l) {
                                    var w = s.sub(s.sub(h)._mult(l / b)._round());
                                    this.updateDistance(h, w), this.addCurrentVertex(w, p, 0, 0, u), h = w
                                }
                            }
                            var M = h && c, S = M ? e : n ? "butt" : O;
                            if (M && "round" === S && (_ < F ? S = "miter" : _ <= 2 && (S = "fakeround")), "miter" === S && _ > i && (S = "bevel"), "bevel" === S && (_ > 2 && (S = "flipbevel"), _ < i && (S = "miter")), h && this.updateDistance(h, s), "miter" === S) m._mult(_), this.addCurrentVertex(s, m, 0, 0, u); else if ("flipbevel" === S) {
                                if (_ > 100) m = f.mult(-1); else {
                                    var N = _ * p.add(f).mag() / p.sub(f).mag();
                                    m._perp()._mult(N * (x ? -1 : 1))
                                }
                                this.addCurrentVertex(s, m, 0, 0, u), this.addCurrentVertex(s, m.mult(-1), 0, 0, u)
                            } else if ("bevel" === S || "fakeround" === S) {
                                var E = -Math.sqrt(_ * _ - 1), I = x ? E : 0, T = x ? 0 : E;
                                if (h && this.addCurrentVertex(s, p, I, T, u), "fakeround" === S) for (var C = Math.round(180 * U / Math.PI / 20), P = 1; P < C; P++) {
                                    var A = P / C;
                                    if (.5 !== A) {
                                        var z = A - .5;
                                        A += A * z * (A - 1) * ((1.0904 + y * (y * (3.55645 - 1.43519 * y) - 3.2452)) * z * z + (.848013 + y * (.215638 * y - 1.06021)))
                                    }
                                    var k = f.sub(p)._mult(A)._add(p)._unit()._mult(x ? -1 : 1);
                                    this.addHalfVertex(s, k.x, k.y, !1, x, 0, u)
                                }
                                c && this.addCurrentVertex(s, f, -I, -T, u)
                            } else if ("butt" === S) this.addCurrentVertex(s, m, 0, 0, u); else if ("square" === S) {
                                var L = h ? 1 : -1;
                                this.addCurrentVertex(s, m, L, L, u)
                            } else "round" === S && (h && (this.addCurrentVertex(s, p, 0, 0, u), this.addCurrentVertex(s, p, 1, 1, u, !0)), c && (this.addCurrentVertex(s, f, -1, -1, u, !0), this.addCurrentVertex(s, f, 0, 0, u)));
                            if (v && d < a - 1) {
                                var D = s.dist(c);
                                if (D > 2 * l) {
                                    var R = s.add(c.sub(s)._mult(l / D)._round());
                                    this.updateDistance(s, R), this.addCurrentVertex(R, f, 0, 0, u), s = R
                                }
                            }
                        }
                    }
                }, sh.prototype.addCurrentVertex = function (t, e, i, r, n, a) {
                    void 0 === a && (a = !1);
                    var o = e.y * r - e.x, s = -e.y - e.x * r;
                    this.addHalfVertex(t, e.x + e.y * i, e.y - e.x * i, a, !1, i, n), this.addHalfVertex(t, o, s, a, !0, -r, n), this.distance > oh / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, i, r, n, a))
                }, sh.prototype.addHalfVertex = function (t, e, i, r, n, a, o) {
                    var s = .5 * (this.lineClips ? this.scaledDistance * (oh - 1) : this.scaledDistance);
                    this.layoutVertexArray.emplaceBack((t.x << 1) + (r ? 1 : 0), (t.y << 1) + (n ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * i) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6), this.lineClips && this.layoutVertexArray2.emplaceBack((this.scaledDistance - this.lineClips.start) / (this.lineClips.end - this.lineClips.start), this.lineClipsArray.length);
                    var l = o.vertexLength++;
                    this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l), o.primitiveLength++), n ? this.e2 = l : this.e1 = l
                }, sh.prototype.updateScaledDistance = function () {
                    this.scaledDistance = this.lineClips ? this.lineClips.start + (this.lineClips.end - this.lineClips.start) * this.distance / this.totalDistance : this.distance
                }, sh.prototype.updateDistance = function (t, e) {
                    this.distance += t.dist(e), this.updateScaledDistance()
                }, e("LineBucket", sh, {omit: ["layers", "patternFeatures"]});
                var lh = new ns({
                    "line-cap": new i(a.layout_line["line-cap"]),
                    "line-join": new r(a.layout_line["line-join"]),
                    "line-miter-limit": new i(a.layout_line["line-miter-limit"]),
                    "line-round-limit": new i(a.layout_line["line-round-limit"]),
                    "line-sort-key": new r(a.layout_line["line-sort-key"])
                }), uh = {
                    paint: new ns({
                        "line-opacity": new r(a.paint_line["line-opacity"]),
                        "line-color": new r(a.paint_line["line-color"]),
                        "line-translate": new i(a.paint_line["line-translate"]),
                        "line-translate-anchor": new i(a.paint_line["line-translate-anchor"]),
                        "line-width": new r(a.paint_line["line-width"]),
                        "line-gap-width": new r(a.paint_line["line-gap-width"]),
                        "line-offset": new r(a.paint_line["line-offset"]),
                        "line-blur": new r(a.paint_line["line-blur"]),
                        "line-dasharray": new is(a.paint_line["line-dasharray"]),
                        "line-pattern": new es(a.paint_line["line-pattern"]),
                        "line-gradient": new rs(a.paint_line["line-gradient"])
                    }), layout: lh
                }, hh = new (function (n) {
                    function t() {
                        n.apply(this, arguments)
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.possiblyEvaluate = function (t, e) {
                        return e = new j(Math.floor(e.zoom), {
                            now: e.now,
                            fadeDuration: e.fadeDuration,
                            zoomHistory: e.zoomHistory,
                            transition: e.transition
                        }), n.prototype.possiblyEvaluate.call(this, t, e)
                    }, t.prototype.evaluate = function (t, e, i, r) {
                        return e = V({}, e, {zoom: Math.floor(e.zoom)}), n.prototype.evaluate.call(this, t, e, i, r)
                    }, t
                }(r))(uh.paint.properties["line-width"].specification);
                hh.useIntegerZoom = !0;
                var ch = function (i) {
                    function t(t) {
                        i.call(this, t, uh), this.gradientVersion = 0
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype._handleSpecialPaintPropertyUpdate = function (t) {
                        "line-gradient" === t && (this.stepInterpolant = this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof En, this.gradientVersion = (this.gradientVersion + 1) % B)
                    }, t.prototype.gradientExpression = function () {
                        return this._transitionablePaint._values["line-gradient"].value.expression
                    }, t.prototype.recalculate = function (t, e) {
                        i.prototype.recalculate.call(this, t, e), this.paint._values["line-floorwidth"] = hh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, t)
                    }, t.prototype.createBucket = function (t) {
                        return new sh(t)
                    }, t.prototype.queryRadius = function (t) {
                        var e = t, i = ph(Ll("line-width", this, e), Ll("line-gap-width", this, e)),
                            r = Ll("line-offset", this, e);
                        return i / 2 + Math.abs(r) + Dl(this.paint.get("line-translate"))
                    }, t.prototype.queryIntersectsFeature = function (t, e, i, r, n, a, o) {
                        var s = Rl(t, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), a.angle, o),
                            l = o / 2 * ph(this.paint.get("line-width").evaluate(e, i), this.paint.get("line-gap-width").evaluate(e, i)),
                            u = this.paint.get("line-offset").evaluate(e, i);
                        return u && (r = function (t, e) {
                            for (var i = [], r = new W(0, 0), n = 0; n < t.length; n++) {
                                for (var a = t[n], o = [], s = 0; s < a.length; s++) {
                                    var l = a[s], u = a[s + 1], h = 0 === s ? r : l.sub(a[s - 1])._unit()._perp(),
                                        c = s === a.length - 1 ? r : u.sub(l)._unit()._perp(), p = h._add(c)._unit();
                                    p._mult(1 / (p.x * c.x + p.y * c.y)), o.push(p._mult(e)._add(l))
                                }
                                i.push(o)
                            }
                            return i
                        }(r, u * o)), function (t, e, i) {
                            for (var r = 0; r < e.length; r++) {
                                var n = e[r];
                                if (t.length >= 3) for (var a = 0; a < n.length; a++) if (zl(t, n[a])) return !0;
                                if (El(t, n, i)) return !0
                            }
                            return !1
                        }(s, r, l)
                    }, t.prototype.isTileClipped = function () {
                        return !0
                    }, t
                }(as);

                function ph(t, e) {
                    return e > 0 ? e + 2 * t : t
                }

                var fh = o([{name: "a_pos_offset", components: 4, type: "Int16"}, {
                        name: "a_data",
                        components: 4,
                        type: "Uint16"
                    }, {name: "a_pixeloffset", components: 4, type: "Int16"}], 4),
                    dh = o([{name: "a_projected_pos", components: 3, type: "Float32"}], 4),
                    mh = (o([{name: "a_fade_opacity", components: 1, type: "Uint32"}], 4), o([{
                        name: "a_placed",
                        components: 2,
                        type: "Uint8"
                    }, {name: "a_shift", components: 2, type: "Float32"}])),
                    yh = (o([{type: "Int16", name: "anchorPointX"}, {
                        type: "Int16",
                        name: "anchorPointY"
                    }, {type: "Int16", name: "x1"}, {type: "Int16", name: "y1"}, {
                        type: "Int16",
                        name: "x2"
                    }, {type: "Int16", name: "y2"}, {type: "Uint32", name: "featureIndex"}, {
                        type: "Uint16",
                        name: "sourceLayerIndex"
                    }, {type: "Uint16", name: "bucketIndex"}]), o([{
                        name: "a_pos",
                        components: 2,
                        type: "Int16"
                    }, {name: "a_anchor_pos", components: 2, type: "Int16"}, {
                        name: "a_extrude",
                        components: 2,
                        type: "Int16"
                    }], 4)), gh = o([{name: "a_pos", components: 2, type: "Float32"}, {
                        name: "a_radius",
                        components: 1,
                        type: "Float32"
                    }, {name: "a_flags", components: 2, type: "Int16"}], 4);

                function _h(t, e, i) {
                    return t.sections.forEach(function (t) {
                        t.text = function (t, e, i) {
                            var r = e.layout.get("text-transform").evaluate(i, {});
                            return "uppercase" === r ? t = t.toLocaleUpperCase() : "lowercase" === r && (t = t.toLocaleLowerCase()), Wo.applyArabicShaping && (t = Wo.applyArabicShaping(t)), t
                        }(t.text, e, i)
                    }), t
                }

                o([{name: "triangle", components: 3, type: "Uint16"}]), o([{
                    type: "Int16",
                    name: "anchorX"
                }, {type: "Int16", name: "anchorY"}, {type: "Uint16", name: "glyphStartIndex"}, {
                    type: "Uint16",
                    name: "numGlyphs"
                }, {type: "Uint32", name: "vertexStartIndex"}, {
                    type: "Uint32",
                    name: "lineStartIndex"
                }, {type: "Uint32", name: "lineLength"}, {type: "Uint16", name: "segment"}, {
                    type: "Uint16",
                    name: "lowerSize"
                }, {type: "Uint16", name: "upperSize"}, {type: "Float32", name: "lineOffsetX"}, {
                    type: "Float32",
                    name: "lineOffsetY"
                }, {type: "Uint8", name: "writingMode"}, {type: "Uint8", name: "placedOrientation"}, {
                    type: "Uint8",
                    name: "hidden"
                }, {type: "Uint32", name: "crossTileID"}, {
                    type: "Int16",
                    name: "associatedIconIndex"
                }]), o([{type: "Int16", name: "anchorX"}, {type: "Int16", name: "anchorY"}, {
                    type: "Int16",
                    name: "rightJustifiedTextSymbolIndex"
                }, {type: "Int16", name: "centerJustifiedTextSymbolIndex"}, {
                    type: "Int16",
                    name: "leftJustifiedTextSymbolIndex"
                }, {type: "Int16", name: "verticalPlacedTextSymbolIndex"}, {
                    type: "Int16",
                    name: "placedIconSymbolIndex"
                }, {type: "Int16", name: "verticalPlacedIconSymbolIndex"}, {
                    type: "Uint16",
                    name: "key"
                }, {type: "Uint16", name: "textBoxStartIndex"}, {
                    type: "Uint16",
                    name: "textBoxEndIndex"
                }, {type: "Uint16", name: "verticalTextBoxStartIndex"}, {
                    type: "Uint16",
                    name: "verticalTextBoxEndIndex"
                }, {type: "Uint16", name: "iconBoxStartIndex"}, {
                    type: "Uint16",
                    name: "iconBoxEndIndex"
                }, {type: "Uint16", name: "verticalIconBoxStartIndex"}, {
                    type: "Uint16",
                    name: "verticalIconBoxEndIndex"
                }, {type: "Uint16", name: "featureIndex"}, {
                    type: "Uint16",
                    name: "numHorizontalGlyphVertices"
                }, {type: "Uint16", name: "numVerticalGlyphVertices"}, {
                    type: "Uint16",
                    name: "numIconVertices"
                }, {type: "Uint16", name: "numVerticalIconVertices"}, {
                    type: "Uint16",
                    name: "useRuntimeCollisionCircles"
                }, {type: "Uint32", name: "crossTileID"}, {type: "Float32", name: "textBoxScale"}, {
                    type: "Float32",
                    components: 2,
                    name: "textOffset"
                }, {type: "Float32", name: "collisionCircleDiameter"}]), o([{
                    type: "Float32",
                    name: "offsetX"
                }]), o([{type: "Int16", name: "x"}, {type: "Int16", name: "y"}, {
                    type: "Int16",
                    name: "tileUnitDistanceFromAnchor"
                }]);
                var vh = {
                    "!": "",
                    "#": "",
                    $: "",
                    "%": "",
                    "&": "",
                    "(": "",
                    ")": "",
                    "*": "",
                    "+": "",
                    ",": "",
                    "-": "",
                    ".": "",
                    "/": "",
                    ":": "",
                    ";": "",
                    "<": "",
                    "=": "",
                    ">": "",
                    "?": "",
                    "@": "",
                    "[": "",
                    "\\": "",
                    "]": "",
                    "^": "",
                    _: "",
                    "`": "",
                    "{": "",
                    "|": "",
                    "}": "",
                    "~": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": "",
                    "": ""
                }, xh = function (t, e, i, r, n) {
                    var a, o, s = 8 * n - r - 1, l = (1 << s) - 1, u = l >> 1, h = -7, c = i ? n - 1 : 0,
                        p = i ? -1 : 1, f = t[e + c];
                    for (c += p, a = f & (1 << -h) - 1, f >>= -h, h += s; h > 0; a = 256 * a + t[e + c], c += p, h -= 8) ;
                    for (o = a & (1 << -h) - 1, a >>= -h, h += r; h > 0; o = 256 * o + t[e + c], c += p, h -= 8) ;
                    if (0 === a) a = 1 - u; else {
                        if (a === l) return o ? NaN : 1 / 0 * (f ? -1 : 1);
                        o += Math.pow(2, r), a -= u
                    }
                    return (f ? -1 : 1) * o * Math.pow(2, a - r)
                }, bh = function (t, e, i, r, n, a) {
                    var o, s, l, u = 8 * a - n - 1, h = (1 << u) - 1, c = h >> 1,
                        p = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f = r ? 0 : a - 1, d = r ? 1 : -1,
                        m = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;
                    for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (s = isNaN(e) ? 1 : 0, o = h) : (o = Math.floor(Math.log(e) / Math.LN2), e * (l = Math.pow(2, -o)) < 1 && (o--, l *= 2), (e += o + c >= 1 ? p / l : p * Math.pow(2, 1 - c)) * l >= 2 && (o++, l /= 2), o + c >= h ? (s = 0, o = h) : o + c >= 1 ? (s = (e * l - 1) * Math.pow(2, n), o += c) : (s = e * Math.pow(2, c - 1) * Math.pow(2, n), o = 0)); n >= 8; t[i + f] = 255 & s, f += d, s /= 256, n -= 8) ;
                    for (o = o << n | s, u += n; u > 0; t[i + f] = 255 & o, f += d, o /= 256, u -= 8) ;
                    t[i + f - d] |= 128 * m
                }, wh = s;

                function s(t) {
                    this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t) ? t : new Uint8Array(t || 0), this.pos = 0, this.type = 0, this.length = this.buf.length
                }

                s.Varint = 0, s.Fixed64 = 1, s.Bytes = 2, s.Fixed32 = 5;
                var Mh = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");

                function Sh(t) {
                    return t.type === s.Bytes ? t.readVarint() + t.pos : t.pos + 1
                }

                function Eh(t, e, i) {
                    return i ? 4294967296 * e + (t >>> 0) : 4294967296 * (e >>> 0) + (t >>> 0)
                }

                function Ih(t, e, i) {
                    var r = e <= 16383 ? 1 : e <= 2097151 ? 2 : e <= 268435455 ? 3 : Math.floor(Math.log(e) / (7 * Math.LN2));
                    i.realloc(r);
                    for (var n = i.pos - 1; n >= t; n--) i.buf[n + r] = i.buf[n]
                }

                function Th(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeVarint(t[i])
                }

                function Ch(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeSVarint(t[i])
                }

                function Ph(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeFloat(t[i])
                }

                function Ah(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeDouble(t[i])
                }

                function zh(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeBoolean(t[i])
                }

                function kh(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeFixed32(t[i])
                }

                function Lh(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeSFixed32(t[i])
                }

                function Dh(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeFixed64(t[i])
                }

                function Rh(t, e) {
                    for (var i = 0; i < t.length; i++) e.writeSFixed64(t[i])
                }

                function Bh(t, e) {
                    return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + 16777216 * t[e + 3]
                }

                function Oh(t, e, i) {
                    t[i] = e, t[i + 1] = e >>> 8, t[i + 2] = e >>> 16, t[i + 3] = e >>> 24
                }

                function Fh(t, e) {
                    return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + (t[e + 3] << 24)
                }

                function Uh(t, e, i) {
                    1 === t && i.readMessage(Nh, e)
                }

                function Nh(t, e, i) {
                    if (3 === t) {
                        var r = i.readMessage(Vh, {}), n = r.width, a = r.height, o = r.left, s = r.top, l = r.advance;
                        e.push({
                            id: r.id,
                            bitmap: new ja({width: n + 6, height: a + 6}, r.bitmap),
                            metrics: {width: n, height: a, left: o, top: s, advance: l}
                        })
                    }
                }

                function Vh(t, e, i) {
                    1 === t ? e.id = i.readVarint() : 2 === t ? e.bitmap = i.readBytes() : 3 === t ? e.width = i.readVarint() : 4 === t ? e.height = i.readVarint() : 5 === t ? e.left = i.readSVarint() : 6 === t ? e.top = i.readSVarint() : 7 === t && (e.advance = i.readVarint())
                }

                function jh(t) {
                    for (var e = 0, i = 0, r = 0, n = t; r < n.length; r += 1) {
                        var a = n[r];
                        e += a.w * a.h, i = Math.max(i, a.w)
                    }
                    t.sort(function (t, e) {
                        return e.h - t.h
                    });
                    for (var o = [{
                        x: 0,
                        y: 0,
                        w: Math.max(Math.ceil(Math.sqrt(e / .95)), i),
                        h: 1 / 0
                    }], s = 0, l = 0, u = 0, h = t; u < h.length; u += 1) for (var c = h[u], p = o.length - 1; p >= 0; p--) {
                        var f = o[p];
                        if (!(c.w > f.w || c.h > f.h)) {
                            if (c.x = f.x, c.y = f.y, l = Math.max(l, c.y + c.h), s = Math.max(s, c.x + c.w), c.w === f.w && c.h === f.h) {
                                var d = o.pop();
                                p < o.length && (o[p] = d)
                            } else c.h === f.h ? (f.x += c.w, f.w -= c.w) : c.w === f.w ? (f.y += c.h, f.h -= c.h) : (o.push({
                                x: f.x + c.w,
                                y: f.y,
                                w: f.w - c.w,
                                h: c.h
                            }), f.y += c.h, f.h -= c.h);
                            break
                        }
                    }
                    return {w: s, h: l, fill: e / (s * l) || 0}
                }

                s.prototype = {
                    destroy: function () {
                        this.buf = null
                    }, readFields: function (t, e, i) {
                        for (i = i || this.length; this.pos < i;) {
                            var r = this.readVarint(), n = r >> 3, a = this.pos;
                            this.type = 7 & r, t(n, e, this), this.pos === a && this.skip(r)
                        }
                        return e
                    }, readMessage: function (t, e) {
                        return this.readFields(t, e, this.readVarint() + this.pos)
                    }, readFixed32: function () {
                        var t = Bh(this.buf, this.pos);
                        return this.pos += 4, t
                    }, readSFixed32: function () {
                        var t = Fh(this.buf, this.pos);
                        return this.pos += 4, t
                    }, readFixed64: function () {
                        var t = Bh(this.buf, this.pos) + 4294967296 * Bh(this.buf, this.pos + 4);
                        return this.pos += 8, t
                    }, readSFixed64: function () {
                        var t = Bh(this.buf, this.pos) + 4294967296 * Fh(this.buf, this.pos + 4);
                        return this.pos += 8, t
                    }, readFloat: function () {
                        var t = xh(this.buf, this.pos, !0, 23, 4);
                        return this.pos += 4, t
                    }, readDouble: function () {
                        var t = xh(this.buf, this.pos, !0, 52, 8);
                        return this.pos += 8, t
                    }, readVarint: function (t) {
                        var e, i, r = this.buf;
                        return e = 127 & (i = r[this.pos++]), i < 128 ? e : (e |= (127 & (i = r[this.pos++])) << 7, i < 128 ? e : (e |= (127 & (i = r[this.pos++])) << 14, i < 128 ? e : (e |= (127 & (i = r[this.pos++])) << 21, i < 128 ? e : function (t, e, i) {
                            var r, n, a = i.buf;
                            if (r = (112 & (n = a[i.pos++])) >> 4, n < 128) return Eh(t, r, e);
                            if (r |= (127 & (n = a[i.pos++])) << 3, n < 128) return Eh(t, r, e);
                            if (r |= (127 & (n = a[i.pos++])) << 10, n < 128) return Eh(t, r, e);
                            if (r |= (127 & (n = a[i.pos++])) << 17, n < 128) return Eh(t, r, e);
                            if (r |= (127 & (n = a[i.pos++])) << 24, n < 128) return Eh(t, r, e);
                            if (r |= (1 & (n = a[i.pos++])) << 31, n < 128) return Eh(t, r, e);
                            throw new Error("Expected varint not more than 10 bytes")
                        }(e |= (15 & (i = r[this.pos])) << 28, t, this))))
                    }, readVarint64: function () {
                        return this.readVarint(!0)
                    }, readSVarint: function () {
                        var t = this.readVarint();
                        return t % 2 == 1 ? (t + 1) / -2 : t / 2
                    }, readBoolean: function () {
                        return Boolean(this.readVarint())
                    }, readString: function () {
                        var t = this.readVarint() + this.pos, e = this.pos;
                        return this.pos = t, t - e >= 12 && Mh ? function (t, e, i) {
                            return Mh.decode(t.subarray(e, i))
                        }(this.buf, e, t) : function (t, e, i) {
                            for (var r = "", n = e; n < i;) {
                                var a, o, s, l = t[n], u = null, h = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1;
                                if (n + h > i) break;
                                1 === h ? l < 128 && (u = l) : 2 === h ? 128 == (192 & (a = t[n + 1])) && (u = (31 & l) << 6 | 63 & a) <= 127 && (u = null) : 3 === h ? (o = t[n + 2], 128 == (192 & (a = t[n + 1])) && 128 == (192 & o) && ((u = (15 & l) << 12 | (63 & a) << 6 | 63 & o) <= 2047 || u >= 55296 && u <= 57343) && (u = null)) : 4 === h && (o = t[n + 2], s = t[n + 3], 128 == (192 & (a = t[n + 1])) && 128 == (192 & o) && 128 == (192 & s) && ((u = (15 & l) << 18 | (63 & a) << 12 | (63 & o) << 6 | 63 & s) <= 65535 || u >= 1114112) && (u = null)), null === u ? (u = 65533, h = 1) : u > 65535 && (u -= 65536, r += String.fromCharCode(u >>> 10 & 1023 | 55296), u = 56320 | 1023 & u), r += String.fromCharCode(u), n += h
                            }
                            return r
                        }(this.buf, e, t)
                    }, readBytes: function () {
                        var t = this.readVarint() + this.pos, e = this.buf.subarray(this.pos, t);
                        return this.pos = t, e
                    }, readPackedVarint: function (t, e) {
                        if (this.type !== s.Bytes) return t.push(this.readVarint(e));
                        var i = Sh(this);
                        for (t = t || []; this.pos < i;) t.push(this.readVarint(e));
                        return t
                    }, readPackedSVarint: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readSVarint());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readSVarint());
                        return t
                    }, readPackedBoolean: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readBoolean());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readBoolean());
                        return t
                    }, readPackedFloat: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readFloat());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readFloat());
                        return t
                    }, readPackedDouble: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readDouble());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readDouble());
                        return t
                    }, readPackedFixed32: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readFixed32());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readFixed32());
                        return t
                    }, readPackedSFixed32: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readSFixed32());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readSFixed32());
                        return t
                    }, readPackedFixed64: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readFixed64());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readFixed64());
                        return t
                    }, readPackedSFixed64: function (t) {
                        if (this.type !== s.Bytes) return t.push(this.readSFixed64());
                        var e = Sh(this);
                        for (t = t || []; this.pos < e;) t.push(this.readSFixed64());
                        return t
                    }, skip: function (t) {
                        var e = 7 & t;
                        if (e === s.Varint) for (; this.buf[this.pos++] > 127;) ; else if (e === s.Bytes) this.pos = this.readVarint() + this.pos; else if (e === s.Fixed32) this.pos += 4; else {
                            if (e !== s.Fixed64) throw new Error("Unimplemented type: " + e);
                            this.pos += 8
                        }
                    }, writeTag: function (t, e) {
                        this.writeVarint(t << 3 | e)
                    }, realloc: function (t) {
                        for (var e = this.length || 16; e < this.pos + t;) e *= 2;
                        if (e !== this.length) {
                            var i = new Uint8Array(e);
                            i.set(this.buf), this.buf = i, this.length = e
                        }
                    }, finish: function () {
                        return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length)
                    }, writeFixed32: function (t) {
                        this.realloc(4), Oh(this.buf, t, this.pos), this.pos += 4
                    }, writeSFixed32: function (t) {
                        this.realloc(4), Oh(this.buf, t, this.pos), this.pos += 4
                    }, writeFixed64: function (t) {
                        this.realloc(8), Oh(this.buf, -1 & t, this.pos), Oh(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8
                    }, writeSFixed64: function (t) {
                        this.realloc(8), Oh(this.buf, -1 & t, this.pos), Oh(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8
                    }, writeVarint: function (t) {
                        (t = +t || 0) > 268435455 || t < 0 ? function (t, e) {
                            var i, r;
                            if (t >= 0 ? (i = t % 4294967296 | 0, r = t / 4294967296 | 0) : (r = ~(-t / 4294967296), 4294967295 ^ (i = ~(-t % 4294967296)) ? i = i + 1 | 0 : (i = 0, r = r + 1 | 0)), t >= 0x10000000000000000 || t < -0x10000000000000000) throw new Error("Given varint doesn't fit into 10 bytes");
                            e.realloc(10), function (t, e, i) {
                                i.buf[i.pos++] = 127 & t | 128, t >>>= 7, i.buf[i.pos++] = 127 & t | 128, t >>>= 7, i.buf[i.pos++] = 127 & t | 128, t >>>= 7, i.buf[i.pos++] = 127 & t | 128, i.buf[i.pos] = 127 & (t >>>= 7)
                            }(i, 0, e), function (t, e) {
                                var i = (7 & t) << 4;
                                e.buf[e.pos++] |= i | ((t >>>= 3) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t)))))
                            }(r, e)
                        }(t, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = t >>> 7 & 127))))
                    }, writeSVarint: function (t) {
                        this.writeVarint(t < 0 ? 2 * -t - 1 : 2 * t)
                    }, writeBoolean: function (t) {
                        this.writeVarint(Boolean(t))
                    }, writeString: function (t) {
                        t = String(t), this.realloc(4 * t.length), this.pos++;
                        var e = this.pos;
                        this.pos = function (t, e, i) {
                            for (var r, n, a = 0; a < e.length; a++) {
                                if ((r = e.charCodeAt(a)) > 55295 && r < 57344) {
                                    if (!n) {
                                        r > 56319 || a + 1 === e.length ? (t[i++] = 239, t[i++] = 191, t[i++] = 189) : n = r;
                                        continue
                                    }
                                    if (r < 56320) {
                                        t[i++] = 239, t[i++] = 191, t[i++] = 189, n = r;
                                        continue
                                    }
                                    r = n - 55296 << 10 | r - 56320 | 65536, n = null
                                } else n && (t[i++] = 239, t[i++] = 191, t[i++] = 189, n = null);
                                r < 128 ? t[i++] = r : (r < 2048 ? t[i++] = r >> 6 | 192 : (r < 65536 ? t[i++] = r >> 12 | 224 : (t[i++] = r >> 18 | 240, t[i++] = r >> 12 & 63 | 128), t[i++] = r >> 6 & 63 | 128), t[i++] = 63 & r | 128)
                            }
                            return i
                        }(this.buf, t, this.pos);
                        var i = this.pos - e;
                        i >= 128 && Ih(e, i, this), this.pos = e - 1, this.writeVarint(i), this.pos += i
                    }, writeFloat: function (t) {
                        this.realloc(4), bh(this.buf, t, this.pos, !0, 23, 4), this.pos += 4
                    }, writeDouble: function (t) {
                        this.realloc(8), bh(this.buf, t, this.pos, !0, 52, 8), this.pos += 8
                    }, writeBytes: function (t) {
                        var e = t.length;
                        this.writeVarint(e), this.realloc(e);
                        for (var i = 0; i < e; i++) this.buf[this.pos++] = t[i]
                    }, writeRawMessage: function (t, e) {
                        this.pos++;
                        var i = this.pos;
                        t(e, this);
                        var r = this.pos - i;
                        r >= 128 && Ih(i, r, this), this.pos = i - 1, this.writeVarint(r), this.pos += r
                    }, writeMessage: function (t, e, i) {
                        this.writeTag(t, s.Bytes), this.writeRawMessage(e, i)
                    }, writePackedVarint: function (t, e) {
                        e.length && this.writeMessage(t, Th, e)
                    }, writePackedSVarint: function (t, e) {
                        e.length && this.writeMessage(t, Ch, e)
                    }, writePackedBoolean: function (t, e) {
                        e.length && this.writeMessage(t, zh, e)
                    }, writePackedFloat: function (t, e) {
                        e.length && this.writeMessage(t, Ph, e)
                    }, writePackedDouble: function (t, e) {
                        e.length && this.writeMessage(t, Ah, e)
                    }, writePackedFixed32: function (t, e) {
                        e.length && this.writeMessage(t, kh, e)
                    }, writePackedSFixed32: function (t, e) {
                        e.length && this.writeMessage(t, Lh, e)
                    }, writePackedFixed64: function (t, e) {
                        e.length && this.writeMessage(t, Dh, e)
                    }, writePackedSFixed64: function (t, e) {
                        e.length && this.writeMessage(t, Rh, e)
                    }, writeBytesField: function (t, e) {
                        this.writeTag(t, s.Bytes), this.writeBytes(e)
                    }, writeFixed32Field: function (t, e) {
                        this.writeTag(t, s.Fixed32), this.writeFixed32(e)
                    }, writeSFixed32Field: function (t, e) {
                        this.writeTag(t, s.Fixed32), this.writeSFixed32(e)
                    }, writeFixed64Field: function (t, e) {
                        this.writeTag(t, s.Fixed64), this.writeFixed64(e)
                    }, writeSFixed64Field: function (t, e) {
                        this.writeTag(t, s.Fixed64), this.writeSFixed64(e)
                    }, writeVarintField: function (t, e) {
                        this.writeTag(t, s.Varint), this.writeVarint(e)
                    }, writeSVarintField: function (t, e) {
                        this.writeTag(t, s.Varint), this.writeSVarint(e)
                    }, writeStringField: function (t, e) {
                        this.writeTag(t, s.Bytes), this.writeString(e)
                    }, writeFloatField: function (t, e) {
                        this.writeTag(t, s.Fixed32), this.writeFloat(e)
                    }, writeDoubleField: function (t, e) {
                        this.writeTag(t, s.Fixed64), this.writeDouble(e)
                    }, writeBooleanField: function (t, e) {
                        this.writeVarintField(t, Boolean(e))
                    }
                };
                var qh = function (t, e) {
                    var i = e.pixelRatio, r = e.version, n = e.stretchX, a = e.stretchY, o = e.content;
                    this.paddedRect = t, this.pixelRatio = i, this.stretchX = n, this.stretchY = a, this.content = o, this.version = r
                }, Gh = {
                    tl: {configurable: !0},
                    br: {configurable: !0},
                    tlbr: {configurable: !0},
                    displaySize: {configurable: !0}
                };
                Gh.tl.get = function () {
                    return [this.paddedRect.x + 1, this.paddedRect.y + 1]
                }, Gh.br.get = function () {
                    return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1]
                }, Gh.tlbr.get = function () {
                    return this.tl.concat(this.br)
                }, Gh.displaySize.get = function () {
                    return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio]
                }, Object.defineProperties(qh.prototype, Gh);
                var Zh = function (t, e) {
                    var i = {}, r = {};
                    this.haveRenderCallbacks = [];
                    var n = [];
                    this.addImages(t, i, n), this.addImages(e, r, n);
                    var a = jh(n), o = new x({width: a.w || 1, height: a.h || 1});
                    for (var s in t) {
                        var l = t[s], u = i[s].paddedRect;
                        x.copy(l.data, o, {x: 0, y: 0}, {x: u.x + 1, y: u.y + 1}, l.data)
                    }
                    for (var h in e) {
                        var c = e[h], p = r[h].paddedRect, f = p.x + 1, d = p.y + 1, m = c.data.width,
                            y = c.data.height;
                        x.copy(c.data, o, {x: 0, y: 0}, {x: f, y: d}, c.data), x.copy(c.data, o, {
                            x: 0,
                            y: y - 1
                        }, {x: f, y: d + y}, {width: m, height: 1}), x.copy(c.data, o, {x: 0, y: 0}, {
                            x: f,
                            y: d - 1
                        }, {width: m, height: 1}), x.copy(c.data, o, {x: m - 1, y: 0}, {x: f + m, y: d}, {
                            width: 1,
                            height: y
                        }), x.copy(c.data, o, {x: 0, y: 0}, {x: f - 1, y: d}, {
                            width: 1,
                            height: y
                        }), x.copy(c.data, o, {x: 0, y: 0}, {x: 0, y: d - 1}, {
                            width: 1,
                            height: 1
                        }), x.copy(c.data, o, {x: m - 1, y: 0}, {x: f + m, y: d - 1}, {
                            width: 1,
                            height: 1
                        }), x.copy(c.data, o, {x: m - 1, y: y - 1}, {x: f + m, y: d + y}, {
                            width: 1,
                            height: 1
                        }), x.copy(c.data, o, {x: 0, y: y - 1}, {x: 0, y: d + y}, {width: 1, height: 1})
                    }
                    this.image = o, this.iconPositions = i, this.patternPositions = r
                };
                Zh.prototype.addImages = function (t, e, i) {
                    for (var r in t) {
                        var n = t[r], a = {x: 0, y: 0, w: n.data.width + 2, h: n.data.height + 2};
                        i.push(a), e[r] = new qh(a, n), n.hasRenderCallback && this.haveRenderCallbacks.push(r)
                    }
                }, Zh.prototype.patchUpdatedImages = function (t, e) {
                    for (var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks), t.updatedImages) this.patchUpdatedImage(this.iconPositions[i], t.getImage(i), e), this.patchUpdatedImage(this.patternPositions[i], t.getImage(i), e)
                }, Zh.prototype.patchUpdatedImage = function (t, e, i) {
                    if (t && e && t.version !== e.version) {
                        t.version = e.version;
                        var r = t.tl;
                        i.update(e.data, void 0, {x: r[0], y: r[1]})
                    }
                }, e("ImagePosition", qh), e("ImageAtlas", Zh);
                var Wh = {horizontal: 1, vertical: 2, horizontalOnly: 3}, Xh = function () {
                    this.scale = 1, this.fontStack = "", this.imageName = null
                };
                Xh.forText = function (t, e) {
                    var i = new Xh;
                    return i.scale = t || 1, i.fontStack = e, i
                }, Xh.forImage = function (t) {
                    var e = new Xh;
                    return e.imageName = t, e
                };
                var Hh = function () {
                    this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null
                };

                function Kh(t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m) {
                    var y, g = Hh.fromFeature(t, n);
                    c === Wh.vertical && g.verticalizePunctuation();
                    var _ = Wo.processBidirectionalText, v = Wo.processStyledBidirectionalText;
                    if (_ && 1 === g.sections.length) {
                        y = [];
                        for (var x = 0, b = _(g.toString(), ic(g, u, a, e, r, f, d)); x < b.length; x += 1) {
                            var w = b[x], M = new Hh;
                            M.text = w, M.sections = g.sections;
                            for (var S = 0; S < w.length; S++) M.sectionIndex.push(0);
                            y.push(M)
                        }
                    } else if (v) {
                        y = [];
                        for (var E = 0, I = v(g.text, g.sectionIndex, ic(g, u, a, e, r, f, d)); E < I.length; E += 1) {
                            var T = I[E], C = new Hh;
                            C.text = T[0], C.sectionIndex = T[1], C.sections = g.sections, y.push(C)
                        }
                    } else y = function (t, e) {
                        for (var i = [], r = t.text, n = 0, a = 0, o = e; a < o.length; a += 1) {
                            var s = o[a];
                            i.push(t.substring(n, s)), n = s
                        }
                        return n < r.length && i.push(t.substring(n, r.length)), i
                    }(g, ic(g, u, a, e, r, f, d));
                    var P = [], A = {
                        positionedLines: P,
                        text: g.toString(),
                        top: h[1],
                        bottom: h[1],
                        left: h[0],
                        right: h[0],
                        writingMode: c,
                        iconsInText: !1,
                        verticalizable: !1
                    };
                    return function (t, B, O, F, e, i, U, r, N, n, a, V) {
                        for (var o = 0, s = -17, l = 0, u = 0, h = "right" === r ? 1 : "left" === r ? 0 : .5, c = 0, p = 0, f = e; p < f.length; p += 1) {
                            var d = f[p];
                            d.trim();
                            var m = d.getMaxScale(), y = 24 * (m - 1), g = {positionedGlyphs: [], lineOffset: 0};
                            t.positionedLines[c] = g;
                            var _ = g.positionedGlyphs, v = 0;
                            if (d.length()) {
                                for (var x = 0; x < d.length(); x++) {
                                    var b = d.getSection(x), w = d.getSectionIndex(x), M = d.getCharCode(x), S = 0,
                                        E = null, I = null, T = null, C = 24,
                                        P = !(N === Wh.horizontal || !a && !Lo(M) || a && (Yh[M] || (D = M, K.Arabic(D) || K["Arabic Supplement"](D) || K["Arabic Extended-A"](D) || K["Arabic Presentation Forms-A"](D) || K["Arabic Presentation Forms-B"](D))));
                                    if (b.imageName) {
                                        var A = F[b.imageName];
                                        if (!A) continue;
                                        T = b.imageName, t.iconsInText = t.iconsInText || !0, I = A.paddedRect;
                                        var z = A.displaySize;
                                        b.scale = 24 * b.scale / V, S = y + (24 - z[1] * b.scale), C = (E = {
                                            width: z[0],
                                            height: z[1],
                                            left: 1,
                                            top: -3,
                                            advance: P ? z[1] : z[0]
                                        }).advance;
                                        var k = P ? z[0] * b.scale - 24 * m : z[1] * b.scale - 24 * m;
                                        k > 0 && k > v && (v = k)
                                    } else {
                                        var j = O[b.fontStack], L = j && j[M];
                                        if (L && L.rect) I = L.rect, E = L.metrics; else {
                                            var q = B[b.fontStack], G = q && q[M];
                                            if (!G) continue;
                                            E = G.metrics
                                        }
                                        S = 24 * (m - b.scale)
                                    }
                                    P ? (t.verticalizable = !0, _.push({
                                        glyph: M,
                                        imageName: T,
                                        x: o,
                                        y: s + S,
                                        vertical: P,
                                        scale: b.scale,
                                        fontStack: b.fontStack,
                                        sectionIndex: w,
                                        metrics: E,
                                        rect: I
                                    }), o += C * b.scale + n) : (_.push({
                                        glyph: M,
                                        imageName: T,
                                        x: o,
                                        y: s + S,
                                        vertical: P,
                                        scale: b.scale,
                                        fontStack: b.fontStack,
                                        sectionIndex: w,
                                        metrics: E,
                                        rect: I
                                    }), o += E.advance * b.scale + n)
                                }
                                0 !== _.length && (l = Math.max(o - n, l), nc(_, 0, _.length - 1, h, v)), o = 0;
                                var Z = i * m + v;
                                g.lineOffset = Math.max(v, y), s += Z, u = Math.max(Z, u), ++c
                            } else s += i, ++c
                        }
                        var D, R = s - -17, W = rc(U), X = W.horizontalAlign, H = W.verticalAlign;
                        (function (t, e, i, r, n, a, o, s, l) {
                            var u, h = (e - i) * n;
                            u = a !== o ? -s * r - -17 : (-r * l + .5) * o;
                            for (var c = 0, p = t; c < p.length; c += 1) for (var f = 0, d = p[c].positionedGlyphs; f < d.length; f += 1) {
                                var m = d[f];
                                m.x += h, m.y += u
                            }
                        })(t.positionedLines, h, X, H, l, u, i, R, e.length), t.top += -H * R, t.bottom = t.top + R, t.left += -X * l, t.right = t.left + l
                    }(A, e, i, r, y, o, s, l, c, u, p, m), !function (t) {
                        for (var e = 0, i = t; e < i.length; e += 1) if (0 !== i[e].positionedGlyphs.length) return !1;
                        return !0
                    }(P) && A
                }

                Hh.fromFeature = function (t, e) {
                    for (var i = new Hh, r = 0; r < t.sections.length; r++) {
                        var n = t.sections[r];
                        n.image ? i.addImageSection(n) : i.addTextSection(n, e)
                    }
                    return i
                }, Hh.prototype.length = function () {
                    return this.text.length
                }, Hh.prototype.getSection = function (t) {
                    return this.sections[this.sectionIndex[t]]
                }, Hh.prototype.getSectionIndex = function (t) {
                    return this.sectionIndex[t]
                }, Hh.prototype.getCharCode = function (t) {
                    return this.text.charCodeAt(t)
                }, Hh.prototype.verticalizePunctuation = function () {
                    this.text = function (t) {
                        for (var e = "", i = 0; i < t.length; i++) {
                            var r = t.charCodeAt(i + 1) || null, n = t.charCodeAt(i - 1) || null;
                            e += r && Do(r) && !vh[t[i + 1]] || n && Do(n) && !vh[t[i - 1]] || !vh[t[i]] ? t[i] : vh[t[i]]
                        }
                        return e
                    }(this.text)
                }, Hh.prototype.trim = function () {
                    for (var t = 0, e = 0; e < this.text.length && Yh[this.text.charCodeAt(e)]; e++) t++;
                    for (var i = this.text.length, r = this.text.length - 1; r >= 0 && r >= t && Yh[this.text.charCodeAt(r)]; r--) i--;
                    this.text = this.text.substring(t, i), this.sectionIndex = this.sectionIndex.slice(t, i)
                }, Hh.prototype.substring = function (t, e) {
                    var i = new Hh;
                    return i.text = this.text.substring(t, e), i.sectionIndex = this.sectionIndex.slice(t, e), i.sections = this.sections, i
                }, Hh.prototype.toString = function () {
                    return this.text
                }, Hh.prototype.getMaxScale = function () {
                    var i = this;
                    return this.sectionIndex.reduce(function (t, e) {
                        return Math.max(t, i.sections[e].scale)
                    }, 0)
                }, Hh.prototype.addTextSection = function (t, e) {
                    this.text += t.text, this.sections.push(Xh.forText(t.scale, t.fontStack || e));
                    for (var i = this.sections.length - 1, r = 0; r < t.text.length; ++r) this.sectionIndex.push(i)
                }, Hh.prototype.addImageSection = function (t) {
                    var e = t.image ? t.image.name : "";
                    if (0 !== e.length) {
                        var i = this.getNextImageSectionCharCode();
                        i ? (this.text += String.fromCharCode(i), this.sections.push(Xh.forImage(e)), this.sectionIndex.push(this.sections.length - 1)) : ht("Reached maximum number of images 6401")
                    } else ht("Can't add FormattedSection with an empty image.")
                }, Hh.prototype.getNextImageSectionCharCode = function () {
                    return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID)
                };
                var Yh = {9: !0, 10: !0, 11: !0, 12: !0, 13: !0, 32: !0}, Jh = {};

                function Qh(t, e, i, r, n, a) {
                    if (e.imageName) {
                        var o = r[e.imageName];
                        return o ? o.displaySize[0] * e.scale * 24 / a + n : 0
                    }
                    var s = i[e.fontStack], l = s && s[t];
                    return l ? l.metrics.advance * e.scale + n : 0
                }

                function $h(t, e, i, r) {
                    var n = Math.pow(t - e, 2);
                    return r ? t < e ? n / 2 : 2 * n : n + Math.abs(i) * i
                }

                function tc(t, e, i) {
                    var r = 0;
                    return 10 === t && (r -= 1e4), i && (r += 150), 40 !== t && 65288 !== t || (r += 50), 41 !== e && 65289 !== e || (r += 50), r
                }

                function ec(t, e, i, r, n, a) {
                    for (var o = null, s = $h(e, i, n, a), l = 0, u = r; l < u.length; l += 1) {
                        var h = u[l], c = $h(e - h.x, i, n, a) + h.badness;
                        c <= s && (o = h, s = c)
                    }
                    return {index: t, x: e, priorBreak: o, badness: s}
                }

                function ic(t, e, i, r, n, a, o) {
                    if ("point" !== a) return [];
                    if (!t) return [];
                    for (var s, l = [], u = function (t, e, i, r, n, a) {
                        for (var o = 0, s = 0; s < t.length(); s++) {
                            var l = t.getSection(s);
                            o += Qh(t.getCharCode(s), l, r, n, e, a)
                        }
                        return o / Math.max(1, Math.ceil(o / i))
                    }(t, e, i, r, n, o), h = t.text.indexOf("") >= 0, c = 0, p = 0; p < t.length(); p++) {
                        var f = t.getSection(p), d = t.getCharCode(p);
                        if (Yh[d] || (c += Qh(d, f, r, n, e, o)), p < t.length() - 1) {
                            var m = !((s = d) < 11904 || !(K["Bopomofo Extended"](s) || K.Bopomofo(s) || K["CJK Compatibility Forms"](s) || K["CJK Compatibility Ideographs"](s) || K["CJK Compatibility"](s) || K["CJK Radicals Supplement"](s) || K["CJK Strokes"](s) || K["CJK Symbols and Punctuation"](s) || K["CJK Unified Ideographs Extension A"](s) || K["CJK Unified Ideographs"](s) || K["Enclosed CJK Letters and Months"](s) || K["Halfwidth and Fullwidth Forms"](s) || K.Hiragana(s) || K["Ideographic Description Characters"](s) || K["Kangxi Radicals"](s) || K["Katakana Phonetic Extensions"](s) || K.Katakana(s) || K["Vertical Forms"](s) || K["Yi Radicals"](s) || K["Yi Syllables"](s)));
                            (Jh[d] || m || f.imageName) && l.push(ec(p + 1, c, u, l, tc(d, t.getCharCode(p + 1), m && h), !1))
                        }
                    }
                    return function t(e) {
                        return e ? t(e.priorBreak).concat(e.index) : []
                    }(ec(t.length(), c, u, l, 0, !0))
                }

                function rc(t) {
                    var e = .5, i = .5;
                    switch (t) {
                        case"right":
                        case"top-right":
                        case"bottom-right":
                            e = 1;
                            break;
                        case"left":
                        case"top-left":
                        case"bottom-left":
                            e = 0
                    }
                    switch (t) {
                        case"bottom":
                        case"bottom-right":
                        case"bottom-left":
                            i = 1;
                            break;
                        case"top":
                        case"top-right":
                        case"top-left":
                            i = 0
                    }
                    return {horizontalAlign: e, verticalAlign: i}
                }

                function nc(t, e, i, r, n) {
                    if (r || n) for (var a = t[i], o = (t[i].x + a.metrics.advance * a.scale) * r, s = e; s <= i; s++) t[s].x -= o, t[s].y += n
                }

                function ac(t, e, i, r, n, a) {
                    var o, s = t.image;
                    if (s.content) {
                        var l = s.content, u = s.pixelRatio || 1;
                        o = [l[0] / u, l[1] / u, s.displaySize[0] - l[2] / u, s.displaySize[1] - l[3] / u]
                    }
                    var h, c, p, f, d = e.left * a, m = e.right * a;
                    "width" === i || "both" === i ? (f = n[0] + d - r[3], c = n[0] + m + r[1]) : c = (f = n[0] + (d + m - s.displaySize[0]) / 2) + s.displaySize[0];
                    var y = e.top * a, g = e.bottom * a;
                    return "height" === i || "both" === i ? (h = n[1] + y - r[0], p = n[1] + g + r[2]) : p = (h = n[1] + (y + g - s.displaySize[1]) / 2) + s.displaySize[1], {
                        image: s,
                        top: h,
                        right: c,
                        bottom: p,
                        left: f,
                        collisionPadding: o
                    }
                }

                Jh[10] = !0, Jh[32] = !0, Jh[38] = !0, Jh[40] = !0, Jh[41] = !0, Jh[43] = !0, Jh[45] = !0, Jh[47] = !0, Jh[173] = !0, Jh[183] = !0, Jh[8203] = !0, Jh[8208] = !0, Jh[8211] = !0, Jh[8231] = !0;
                var oc = function (n) {
                    function t(t, e, i, r) {
                        n.call(this, t, e), this.angle = i, void 0 !== r && (this.segment = r)
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.clone = function () {
                        return new t(this.x, this.y, this.angle, this.segment)
                    }, t
                }(W);

                function sc(t, e) {
                    var i = e.expression;
                    if ("constant" === i.kind) return {kind: "constant", layoutSize: i.evaluate(new j(t + 1))};
                    if ("source" === i.kind) return {kind: "source"};
                    for (var r = i.zoomStops, n = i.interpolationType, a = 0; a < r.length && r[a] <= t;) a++;
                    for (var o = a = Math.max(0, a - 1); o < r.length && r[o] < t + 1;) o++;
                    o = Math.min(r.length - 1, o);
                    var s = r[a], l = r[o];
                    return "composite" === i.kind ? {
                        kind: "composite",
                        minZoom: s,
                        maxZoom: l,
                        interpolationType: n
                    } : {
                        kind: "camera",
                        minZoom: s,
                        maxZoom: l,
                        minSize: i.evaluate(new j(s)),
                        maxSize: i.evaluate(new j(l)),
                        interpolationType: n
                    }
                }

                function lc(t, e, i) {
                    var r = e.uSize, n = i.lowerSize;
                    return "source" === t.kind ? n / 128 : "composite" === t.kind ? E(n / 128, i.upperSize / 128, e.uSizeT) : r
                }

                function uc(t, e) {
                    var i = 0, r = 0;
                    if ("constant" === t.kind) r = t.layoutSize; else if ("source" !== t.kind) {
                        var n = t.interpolationType,
                            a = n ? U(Nn.interpolationFactor(n, e, t.minZoom, t.maxZoom), 0, 1) : 0;
                        "camera" === t.kind ? r = E(t.minSize, t.maxSize, a) : i = a
                    }
                    return {uSizeT: i, uSize: r}
                }

                e("Anchor", oc);
                var hc = Object.freeze({
                    __proto__: null,
                    getSizeData: sc,
                    evaluateSizeForFeature: lc,
                    evaluateSizeForZoom: uc,
                    SIZE_PACK_FACTOR: 128
                });

                function cc(t, e, i, r, n) {
                    if (void 0 === e.segment) return !0;
                    for (var a = e, o = e.segment + 1, s = 0; s > -i / 2;) {
                        if (--o < 0) return !1;
                        s -= t[o].dist(a), a = t[o]
                    }
                    s += t[o].dist(t[o + 1]), o++;
                    for (var l = [], u = 0; s < i / 2;) {
                        var h = t[o], c = t[o + 1];
                        if (!c) return !1;
                        var p = t[o - 1].angleTo(h) - h.angleTo(c);
                        for (p = Math.abs((p + 3 * Math.PI) % (2 * Math.PI) - Math.PI), l.push({
                            distance: s,
                            angleDelta: p
                        }), u += p; s - l[0].distance > r;) u -= l.shift().angleDelta;
                        if (u > n) return !1;
                        o++, s += h.dist(c)
                    }
                    return !0
                }

                function pc(t) {
                    for (var e = 0, i = 0; i < t.length - 1; i++) e += t[i].dist(t[i + 1]);
                    return e
                }

                function fc(t, e, i) {
                    return t ? .6 * e * i : 0
                }

                function dc(t, e) {
                    return Math.max(t ? t.right - t.left : 0, e ? e.right - e.left : 0)
                }

                function mc(t, e, i, r, n, a) {
                    for (var o = fc(i, n, a), s = dc(i, r) * a, l = 0, u = pc(t) / 2, h = 0; h < t.length - 1; h++) {
                        var c = t[h], p = t[h + 1], f = c.dist(p);
                        if (l + f > u) {
                            var d = (u - l) / f, m = E(c.x, p.x, d), y = E(c.y, p.y, d),
                                g = new oc(m, y, p.angleTo(c), h);
                            return g._round(), !o || cc(t, g, s, o, e) ? g : void 0
                        }
                        l += f
                    }
                }

                function yc(t, e, i, r, n, a, o, s, l) {
                    var u = fc(r, a, o), h = dc(r, n), c = h * o,
                        p = 0 === t[0].x || t[0].x === l || 0 === t[0].y || t[0].y === l;
                    return e - c < e / 4 && (e = c + e / 4), function t(e, i, r, n, a, o, s, l, u) {
                        for (var h = o / 2, c = pc(e), p = 0, f = i - r, d = [], m = 0; m < e.length - 1; m++) {
                            for (var y = e[m], g = e[m + 1], _ = y.dist(g), v = g.angleTo(y); f + r < p + _;) {
                                var x = ((f += r) - p) / _, b = E(y.x, g.x, x), w = E(y.y, g.y, x);
                                if (b >= 0 && b < u && w >= 0 && w < u && f - h >= 0 && f + h <= c) {
                                    var M = new oc(b, w, v, m);
                                    M._round(), n && !cc(e, M, o, n, a) || d.push(M)
                                }
                            }
                            p += _
                        }
                        return l || d.length || s || (d = t(e, p / 2, r, n, a, o, s, !0, u)), d
                    }(t, p ? e / 2 * s % e : (h / 2 + 2 * a) * o * s % e, e, u, i, c, p, !1, l)
                }

                function gc(t, e, i, r, n) {
                    for (var a = [], o = 0; o < t.length; o++) for (var s = t[o], l = void 0, u = 0; u < s.length - 1; u++) {
                        var h = s[u], c = s[u + 1];
                        h.x < e && c.x < e || (h.x < e ? h = new W(e, h.y + (e - h.x) / (c.x - h.x) * (c.y - h.y))._round() : c.x < e && (c = new W(e, h.y + (e - h.x) / (c.x - h.x) * (c.y - h.y))._round()), h.y < i && c.y < i || (h.y < i ? h = new W(h.x + (i - h.y) / (c.y - h.y) * (c.x - h.x), i)._round() : c.y < i && (c = new W(h.x + (i - h.y) / (c.y - h.y) * (c.x - h.x), i)._round()), h.x >= r && c.x >= r || (h.x >= r ? h = new W(r, h.y + (r - h.x) / (c.x - h.x) * (c.y - h.y))._round() : c.x >= r && (c = new W(r, h.y + (r - h.x) / (c.x - h.x) * (c.y - h.y))._round()), h.y >= n && c.y >= n || (h.y >= n ? h = new W(h.x + (n - h.y) / (c.y - h.y) * (c.x - h.x), n)._round() : c.y >= n && (c = new W(h.x + (n - h.y) / (c.y - h.y) * (c.x - h.x), n)._round()), l && h.equals(l[l.length - 1]) || a.push(l = [h]), l.push(c)))))
                    }
                    return a
                }

                function _c(S, E, I, t) {
                    var e = [], T = S.image, C = T.pixelRatio, i = T.paddedRect.w - 2, r = T.paddedRect.h - 2,
                        P = S.right - S.left, A = S.bottom - S.top, n = T.stretchX || [[0, i]],
                        a = T.stretchY || [[0, r]], o = function (t, e) {
                            return t + e[1] - e[0]
                        }, z = n.reduce(o, 0), k = a.reduce(o, 0), s = i - z, l = r - k, L = 0, D = z, R = 0, B = k, O = 0,
                        F = s, U = 0, N = l;
                    if (T.content && t) {
                        var u = T.content;
                        L = vc(n, 0, u[0]), R = vc(a, 0, u[1]), D = vc(n, u[0], u[2]), B = vc(a, u[1], u[3]), O = u[0] - L, U = u[1] - R, F = u[2] - u[0] - D, N = u[3] - u[1] - B
                    }
                    var h = function (t, e, i, r) {
                        var n = bc(t.stretch - L, D, P, S.left), a = wc(t.fixed - O, F, t.stretch, z),
                            o = bc(e.stretch - R, B, A, S.top), s = wc(e.fixed - U, N, e.stretch, k),
                            l = bc(i.stretch - L, D, P, S.left), u = wc(i.fixed - O, F, i.stretch, z),
                            h = bc(r.stretch - R, B, A, S.top), c = wc(r.fixed - U, N, r.stretch, k), p = new W(n, o),
                            f = new W(l, o), d = new W(l, h), m = new W(n, h), y = new W(a / C, s / C),
                            g = new W(u / C, c / C), _ = E * Math.PI / 180;
                        if (_) {
                            var v = Math.sin(_), x = Math.cos(_), b = [x, -v, v, x];
                            p._matMult(b), f._matMult(b), m._matMult(b), d._matMult(b)
                        }
                        var w = t.stretch + t.fixed, M = e.stretch + e.fixed;
                        return {
                            tl: p,
                            tr: f,
                            bl: m,
                            br: d,
                            tex: {
                                x: T.paddedRect.x + 1 + w,
                                y: T.paddedRect.y + 1 + M,
                                w: i.stretch + i.fixed - w,
                                h: r.stretch + r.fixed - M
                            },
                            writingMode: void 0,
                            glyphOffset: [0, 0],
                            sectionIndex: 0,
                            pixelOffsetTL: y,
                            pixelOffsetBR: g,
                            minFontScaleX: F / C / P,
                            minFontScaleY: N / C / A,
                            isSDF: I
                        }
                    };
                    if (t && (T.stretchX || T.stretchY)) for (var c = xc(n, s, z), p = xc(a, l, k), f = 0; f < c.length - 1; f++) for (var d = c[f], m = c[f + 1], y = 0; y < p.length - 1; y++) e.push(h(d, p[y], m, p[y + 1])); else e.push(h({
                        fixed: 0,
                        stretch: -1
                    }, {fixed: 0, stretch: -1}, {fixed: 0, stretch: i + 1}, {fixed: 0, stretch: r + 1}));
                    return e
                }

                function vc(t, e, i) {
                    for (var r = 0, n = 0, a = t; n < a.length; n += 1) {
                        var o = a[n];
                        r += Math.max(e, Math.min(i, o[1])) - Math.max(e, Math.min(i, o[0]))
                    }
                    return r
                }

                function xc(t, e, i) {
                    for (var r = [{fixed: -1, stretch: 0}], n = 0, a = t; n < a.length; n += 1) {
                        var o = a[n], s = o[0], l = o[1], u = r[r.length - 1];
                        r.push({fixed: s - u.stretch, stretch: u.stretch}), r.push({
                            fixed: s - u.stretch,
                            stretch: u.stretch + (l - s)
                        })
                    }
                    return r.push({fixed: e + 1, stretch: i}), r
                }

                function bc(t, e, i, r) {
                    return t / e * i + r
                }

                function wc(t, e, i, r) {
                    return t - e * i / r
                }

                var Mc = function (t, e, i, r, n, a, o, s, l, u) {
                    if (this.boxStartIndex = t.length, l) {
                        var h = a.top, c = a.bottom, p = a.collisionPadding;
                        p && (h -= p[1], c += p[3]);
                        var f = c - h;
                        f > 0 && (f = Math.max(10, f), this.circleDiameter = f)
                    } else {
                        var d = a.top * o - s, m = a.bottom * o + s, y = a.left * o - s, g = a.right * o + s,
                            _ = a.collisionPadding;
                        if (_ && (y -= _[0] * o, d -= _[1] * o, g += _[2] * o, m += _[3] * o), u) {
                            var v = new W(y, d), x = new W(g, d), b = new W(y, m), w = new W(g, m),
                                M = u * Math.PI / 180;
                            v._rotate(M), x._rotate(M), b._rotate(M), w._rotate(M), y = Math.min(v.x, x.x, b.x, w.x), g = Math.max(v.x, x.x, b.x, w.x), d = Math.min(v.y, x.y, b.y, w.y), m = Math.max(v.y, x.y, b.y, w.y)
                        }
                        t.emplaceBack(e.x, e.y, y, d, g, m, i, r, n)
                    }
                    this.boxEndIndex = t.length
                }, Sc = function (t, e) {
                    if (void 0 === t && (t = []), void 0 === e && (e = Ec), this.data = t, this.length = this.data.length, this.compare = e, this.length > 0) for (var i = (this.length >> 1) - 1; i >= 0; i--) this._down(i)
                };

                function Ec(t, e) {
                    return t < e ? -1 : t > e ? 1 : 0
                }

                function Ic(t, e, i) {
                    void 0 === e && (e = 1), void 0 === i && (i = !1);
                    for (var r = 1 / 0, n = 1 / 0, a = -1 / 0, o = -1 / 0, s = t[0], l = 0; l < s.length; l++) {
                        var u = s[l];
                        (!l || u.x < r) && (r = u.x), (!l || u.y < n) && (n = u.y), (!l || u.x > a) && (a = u.x), (!l || u.y > o) && (o = u.y)
                    }
                    var h = Math.min(a - r, o - n), c = h / 2, p = new Sc([], Tc);
                    if (0 === h) return new W(r, n);
                    for (var f = r; f < a; f += h) for (var d = n; d < o; d += h) p.push(new Cc(f + c, d + c, c, t));
                    for (var m = function (t) {
                        for (var e = 0, i = 0, r = 0, n = t[0], a = 0, o = n.length, s = o - 1; a < o; s = a++) {
                            var l = n[a], u = n[s], h = l.x * u.y - u.x * l.y;
                            i += (l.x + u.x) * h, r += (l.y + u.y) * h, e += 3 * h
                        }
                        return new Cc(i / e, r / e, 0, t)
                    }(t), y = p.length; p.length;) {
                        var g = p.pop();
                        (g.d > m.d || !m.d) && (m = g, i && console.log("found best %d after %d probes", Math.round(1e4 * g.d) / 1e4, y)), g.max - m.d <= e || (p.push(new Cc(g.p.x - (c = g.h / 2), g.p.y - c, c, t)), p.push(new Cc(g.p.x + c, g.p.y - c, c, t)), p.push(new Cc(g.p.x - c, g.p.y + c, c, t)), p.push(new Cc(g.p.x + c, g.p.y + c, c, t)), y += 4)
                    }
                    return i && (console.log("num probes: " + y), console.log("best distance: " + m.d)), m.p
                }

                function Tc(t, e) {
                    return e.max - t.max
                }

                function Cc(t, e, i, r) {
                    this.p = new W(t, e), this.h = i, this.d = function (t, e) {
                        for (var i = !1, r = 1 / 0, n = 0; n < e.length; n++) for (var a = e[n], o = 0, s = a.length, l = s - 1; o < s; l = o++) {
                            var u = a[o], h = a[l];
                            u.y > t.y != h.y > t.y && t.x < (h.x - u.x) * (t.y - u.y) / (h.y - u.y) + u.x && (i = !i), r = Math.min(r, Pl(t, u, h))
                        }
                        return (i ? 1 : -1) * Math.sqrt(r)
                    }(this.p, r), this.max = this.d + this.h * Math.SQRT2
                }

                Sc.prototype.push = function (t) {
                    this.data.push(t), this.length++, this._up(this.length - 1)
                }, Sc.prototype.pop = function () {
                    if (0 !== this.length) {
                        var t = this.data[0], e = this.data.pop();
                        return this.length--, this.length > 0 && (this.data[0] = e, this._down(0)), t
                    }
                }, Sc.prototype.peek = function () {
                    return this.data[0]
                }, Sc.prototype._up = function (t) {
                    for (var e = this.data, i = this.compare, r = e[t]; t > 0;) {
                        var n = t - 1 >> 1, a = e[n];
                        if (i(r, a) >= 0) break;
                        e[t] = a, t = n
                    }
                    e[t] = r
                }, Sc.prototype._down = function (t) {
                    for (var e = this.data, i = this.compare, r = this.length >> 1, n = e[t]; t < r;) {
                        var a = 1 + (t << 1), o = e[a], s = a + 1;
                        if (s < this.length && i(e[s], o) < 0 && (a = s, o = e[s]), i(o, n) >= 0) break;
                        e[t] = o, t = a
                    }
                    e[t] = n
                };
                var Pc = Number.POSITIVE_INFINITY;

                function Ac(t, e) {
                    return e[1] !== Pc ? function (t, e, i) {
                        var r = 0, n = 0;
                        switch (e = Math.abs(e), i = Math.abs(i), t) {
                            case"top-right":
                            case"top-left":
                            case"top":
                                n = i - 7;
                                break;
                            case"bottom-right":
                            case"bottom-left":
                            case"bottom":
                                n = 7 - i
                        }
                        switch (t) {
                            case"top-right":
                            case"bottom-right":
                            case"right":
                                r = -e;
                                break;
                            case"top-left":
                            case"bottom-left":
                            case"left":
                                r = e
                        }
                        return [r, n]
                    }(t, e[0], e[1]) : function (t, e) {
                        var i = 0, r = 0;
                        e < 0 && (e = 0);
                        var n = e / Math.sqrt(2);
                        switch (t) {
                            case"top-right":
                            case"top-left":
                                r = n - 7;
                                break;
                            case"bottom-right":
                            case"bottom-left":
                                r = 7 - n;
                                break;
                            case"bottom":
                                r = 7 - e;
                                break;
                            case"top":
                                r = e - 7
                        }
                        switch (t) {
                            case"top-right":
                            case"bottom-right":
                                i = -n;
                                break;
                            case"top-left":
                            case"bottom-left":
                                i = n;
                                break;
                            case"left":
                                i = e;
                                break;
                            case"right":
                                i = -e
                        }
                        return [i, r]
                    }(t, e[0])
                }

                function zc(t) {
                    switch (t) {
                        case"right":
                        case"top-right":
                        case"bottom-right":
                            return "right";
                        case"left":
                        case"top-left":
                        case"bottom-left":
                            return "left"
                    }
                    return "center"
                }

                function kc(t, e, i, r, n, a, o, s, l, u, h, c, p, f, d) {
                    var m = function (B, t, e, O, i, F, U, r) {
                        for (var n = O.layout.get("text-rotate").evaluate(F, {}) * Math.PI / 180, a = [], o = 0, s = t.positionedLines; o < s.length; o += 1) for (var l = s[o], u = 0, h = l.positionedGlyphs; u < h.length; u += 1) {
                            var c = h[u];
                            if (c.rect) {
                                var p = c.rect || {}, f = 4, d = !0, m = 1, y = 0, g = (i || r) && c.vertical,
                                    _ = c.metrics.advance * c.scale / 2;
                                if (r && t.verticalizable && (y = l.lineOffset / 2 - (c.imageName ? -(24 - c.metrics.width * c.scale) / 2 : 24 * (c.scale - 1))), c.imageName) {
                                    var v = U[c.imageName];
                                    d = v.sdf, f = 1 / (m = v.pixelRatio)
                                }
                                var N = i ? [c.x + _, c.y] : [0, 0], x = i ? [0, 0] : [c.x + _ + e[0], c.y + e[1] - y],
                                    b = [0, 0];
                                g && (b = x, x = [0, 0]);
                                var w = c.metrics.isDoubleResolution ? 2 : 1,
                                    M = (c.metrics.left - f) * c.scale - _ + x[0],
                                    S = (-c.metrics.top - f) * c.scale + x[1], E = M + p.w / w * c.scale / m,
                                    I = S + p.h / w * c.scale / m, T = new W(M, S), C = new W(E, S), P = new W(M, I),
                                    A = new W(E, I);
                                if (g) {
                                    var z = new W(-_, _ - -17), k = -Math.PI / 2, V = 12 - _,
                                        L = new W(22 - V, -(c.imageName ? V : 0)),
                                        D = new (Function.prototype.bind.apply(W, [null].concat(b)));
                                    T._rotateAround(k, z)._add(L)._add(D), C._rotateAround(k, z)._add(L)._add(D), P._rotateAround(k, z)._add(L)._add(D), A._rotateAround(k, z)._add(L)._add(D)
                                }
                                if (n) {
                                    var j = Math.sin(n), q = Math.cos(n), R = [q, -j, j, q];
                                    T._matMult(R), C._matMult(R), P._matMult(R), A._matMult(R)
                                }
                                var G = new W(0, 0), Z = new W(0, 0);
                                a.push({
                                    tl: T,
                                    tr: C,
                                    bl: P,
                                    br: A,
                                    tex: p,
                                    writingMode: t.writingMode,
                                    glyphOffset: N,
                                    sectionIndex: c.sectionIndex,
                                    isSDF: d,
                                    pixelOffsetTL: G,
                                    pixelOffsetBR: Z,
                                    minFontScaleX: 0,
                                    minFontScaleY: 0
                                })
                            }
                        }
                        return a
                    }(0, i, s, n, a, o, r, t.allowVerticalPlacement), y = t.textSizeData, g = null;
                    "source" === y.kind ? (g = [128 * n.layout.get("text-size").evaluate(o, {})])[0] > 32640 && ht(t.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".') : "composite" === y.kind && ((g = [128 * f.compositeTextSizes[0].evaluate(o, {}, d), 128 * f.compositeTextSizes[1].evaluate(o, {}, d)])[0] > 32640 || g[1] > 32640) && ht(t.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".'), t.addSymbols(t.text, m, g, s, a, o, u, e, l.lineStartIndex, l.lineLength, p, d);
                    for (var _ = 0, v = h; _ < v.length; _ += 1) c[v[_]] = t.text.placedSymbolArray.length - 1;
                    return 4 * m.length
                }

                function Lc(t) {
                    for (var e in t) return t[e];
                    return null
                }

                function Dc(t, e, i, r) {
                    var n = t.compareText;
                    if (e in n) {
                        for (var a = n[e], o = a.length - 1; o >= 0; o--) if (r.dist(a[o]) < i) return !0
                    } else n[e] = [];
                    return n[e].push(r), !1
                }

                var Rc = Wu.VectorTileFeature.types,
                    Bc = [{name: "a_fade_opacity", components: 1, type: "Uint8", offset: 0}];

                function Oc(t, e, i, r, n, a, o, s, l, u, h, c, p) {
                    var f = s ? Math.min(32640, Math.round(s[0])) : 0, d = s ? Math.min(32640, Math.round(s[1])) : 0;
                    t.emplaceBack(e, i, Math.round(32 * r), Math.round(32 * n), a, o, (f << 1) + (l ? 1 : 0), d, 16 * u, 16 * h, 256 * c, 256 * p)
                }

                function Fc(t, e, i) {
                    t.emplaceBack(e.x, e.y, i), t.emplaceBack(e.x, e.y, i), t.emplaceBack(e.x, e.y, i), t.emplaceBack(e.x, e.y, i)
                }

                function Uc(t) {
                    for (var e = 0, i = t.sections; e < i.length; e += 1) if (Oo(i[e].text)) return !0;
                    return !1
                }

                var Nc = function (t) {
                    this.layoutVertexArray = new ms, this.indexArray = new ws, this.programConfigurations = t, this.segments = new L, this.dynamicLayoutVertexArray = new ys, this.opacityVertexArray = new gs, this.placedSymbolArray = new Ds
                };
                Nc.prototype.isEmpty = function () {
                    return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length
                }, Nc.prototype.upload = function (t, e, i, r) {
                    this.isEmpty() || (i && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, fh.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, dh.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, Bc, !0), this.opacityVertexBuffer.itemSize = 1), (i || r) && this.programConfigurations.upload(t))
                }, Nc.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy())
                }, e("SymbolBuffers", Nc);
                var Vc = function (t, e, i) {
                    this.layoutVertexArray = new t, this.layoutAttributes = e, this.indexArray = new i, this.segments = new L, this.collisionVertexArray = new bs
                };
                Vc.prototype.upload = function (t) {
                    this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, mh.members, !0)
                }, Vc.prototype.destroy = function () {
                    this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy())
                }, e("CollisionBuffers", Vc);
                var ut = function (t) {
                    this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
                        return t.id
                    }), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = Ul([]), this.placementViewportMatrix = Ul([]);
                    var e = this.layers[0]._unevaluatedLayout._values;
                    this.textSizeData = sc(this.zoom, e["text-size"]), this.iconSizeData = sc(this.zoom, e["icon-size"]);
                    var i = this.layers[0].layout, r = i.get("symbol-sort-key"), n = i.get("symbol-z-order");
                    this.sortFeaturesByKey = "viewport-y" !== n && void 0 !== r.constantOr(1), this.sortFeaturesByY = ("viewport-y" === n || "auto" === n && !this.sortFeaturesByKey) && (i.get("text-allow-overlap") || i.get("icon-allow-overlap") || i.get("text-ignore-placement") || i.get("icon-ignore-placement")), "point" === i.get("symbol-placement") && (this.writingModes = i.get("text-writing-mode").map(function (t) {
                        return Wh[t]
                    })), this.stateDependentLayerIds = this.layers.filter(function (t) {
                        return t.isStateDependent()
                    }).map(function (t) {
                        return t.id
                    }), this.sourceID = t.sourceID
                };
                ut.prototype.createArrays = function () {
                    this.text = new Nc(new dl(this.layers, this.zoom, function (t) {
                        return /^text/.test(t)
                    })), this.icon = new Nc(new dl(this.layers, this.zoom, function (t) {
                        return /^icon/.test(t)
                    })), this.glyphOffsetArray = new Os, this.lineVertexArray = new Fs, this.symbolInstances = new Bs
                }, ut.prototype.calculateGlyphDependencies = function (t, e, i, r, n) {
                    for (var a = 0; a < t.length; a++) if (e[t.charCodeAt(a)] = !0, (i || r) && n) {
                        var o = vh[t.charAt(a)];
                        o && (e[o.charCodeAt(0)] = !0)
                    }
                }, ut.prototype.populate = function (t, e, i) {
                    var r = this.layers[0], n = r.layout, a = n.get("text-font"), o = n.get("text-field"),
                        s = n.get("icon-image"),
                        l = ("constant" !== o.value.kind || o.value.value instanceof Ur && !o.value.value.isEmpty() || o.value.value.toString().length > 0) && ("constant" !== a.value.kind || a.value.value.length > 0),
                        u = "constant" !== s.value.kind || !!s.value.value || Object.keys(s.parameters).length > 0,
                        h = n.get("symbol-sort-key");
                    if (this.features = [], l || u) {
                        for (var c = e.iconDependencies, p = e.glyphDependencies, f = e.availableImages, d = new j(this.zoom), m = 0, y = t; m < y.length; m += 1) {
                            var g = y[m], _ = g.feature, v = g.id, x = g.index, b = g.sourceLayerIndex,
                                w = r._featureFilter.needGeometry,
                                M = {type: _.type, id: v, properties: _.properties, geometry: w ? vl(_) : []};
                            if (r._featureFilter.filter(d, M, i)) {
                                w || (M.geometry = vl(_));
                                var S = void 0;
                                if (l) {
                                    var E = r.getValueAndResolveTokens("text-field", M, i, f), I = Ur.factory(E);
                                    Uc(I) && (this.hasRTLText = !0), (!this.hasRTLText || "unavailable" === Go() || this.hasRTLText && Wo.isParsed()) && (S = _h(I, r, M))
                                }
                                var T = void 0;
                                if (u) {
                                    var C = r.getValueAndResolveTokens("icon-image", M, i, f);
                                    T = C instanceof Nr ? C : Nr.fromString(C)
                                }
                                if (S || T) {
                                    var P = this.sortFeaturesByKey ? h.evaluate(M, {}, i) : void 0, A = {
                                        id: v,
                                        text: S,
                                        icon: T,
                                        index: x,
                                        sourceLayerIndex: b,
                                        geometry: vl(_),
                                        properties: _.properties,
                                        type: Rc[_.type],
                                        sortKey: P
                                    };
                                    if (this.features.push(A), T && (c[T.name] = !0), S) {
                                        var z = a.evaluate(M, {}, i).join(","),
                                            B = "map" === n.get("text-rotation-alignment") && "point" !== n.get("symbol-placement");
                                        this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(Wh.vertical) >= 0;
                                        for (var k = 0, L = S.sections; k < L.length; k += 1) {
                                            var D = L[k];
                                            if (D.image) c[D.image.name] = !0; else {
                                                var O = ko(S.toString()), R = D.fontStack || z, F = p[R] = p[R] || {};
                                                this.calculateGlyphDependencies(D.text, F, B, this.allowVerticalPlacement, O)
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        "line" === n.get("symbol-placement") && (this.features = function (e) {
                            var n = {}, a = {}, o = [], i = 0;

                            function t(t) {
                                o.push(e[t]), i++
                            }

                            function r(t, e, i) {
                                var r = a[t];
                                return delete a[t], a[e] = r, o[r].geometry[0].pop(), o[r].geometry[0] = o[r].geometry[0].concat(i[0]), r
                            }

                            function s(t, e, i) {
                                var r = n[e];
                                return delete n[e], n[t] = r, o[r].geometry[0].shift(), o[r].geometry[0] = i[0].concat(o[r].geometry[0]), r
                            }

                            function l(t, e, i) {
                                var r = i ? e[0][e[0].length - 1] : e[0][0];
                                return t + ":" + r.x + ":" + r.y
                            }

                            for (var u = 0; u < e.length; u++) {
                                var h = e[u], c = h.geometry, p = h.text ? h.text.toString() : null;
                                if (p) {
                                    var f = l(p, c), d = l(p, c, !0);
                                    if (f in a && d in n && a[f] !== n[d]) {
                                        var m = s(f, d, c), y = r(f, d, o[m].geometry);
                                        delete n[f], delete a[d], a[l(p, o[y].geometry, !0)] = y, o[m].geometry = null
                                    } else f in a ? r(f, d, c) : d in n ? s(f, d, c) : (t(u), n[f] = i - 1, a[d] = i - 1)
                                } else t(u)
                            }
                            return o.filter(function (t) {
                                return t.geometry
                            })
                        }(this.features)), this.sortFeaturesByKey && this.features.sort(function (t, e) {
                            return t.sortKey - e.sortKey
                        })
                    }
                }, ut.prototype.update = function (t, e, i) {
                    this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, i), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, i))
                }, ut.prototype.isEmpty = function () {
                    return 0 === this.symbolInstances.length && !this.hasRTLText
                }, ut.prototype.uploadPending = function () {
                    return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload
                }, ut.prototype.upload = function (t) {
                    !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0
                }, ut.prototype.destroyDebugData = function () {
                    this.textCollisionBox.destroy(), this.iconCollisionBox.destroy()
                }, ut.prototype.destroy = function () {
                    this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData()
                }, ut.prototype.addToLineVertexArray = function (t, e) {
                    var i = this.lineVertexArray.length;
                    if (void 0 !== t.segment) {
                        for (var r = t.dist(e[t.segment + 1]), n = t.dist(e[t.segment]), a = {}, o = t.segment + 1; o < e.length; o++) a[o] = {
                            x: e[o].x,
                            y: e[o].y,
                            tileUnitDistanceFromAnchor: r
                        }, o < e.length - 1 && (r += e[o + 1].dist(e[o]));
                        for (var s = t.segment || 0; s >= 0; s--) a[s] = {
                            x: e[s].x,
                            y: e[s].y,
                            tileUnitDistanceFromAnchor: n
                        }, s > 0 && (n += e[s - 1].dist(e[s]));
                        for (var l = 0; l < e.length; l++) {
                            var u = a[l];
                            this.lineVertexArray.emplaceBack(u.x, u.y, u.tileUnitDistanceFromAnchor)
                        }
                    }
                    return {lineStartIndex: i, lineLength: this.lineVertexArray.length - i}
                }, ut.prototype.addSymbols = function (t, e, i, r, n, a, o, s, l, u, h, c) {
                    for (var p = t.indexArray, f = t.layoutVertexArray, d = t.segments.prepareSegment(4 * e.length, f, p, a.sortKey), m = this.glyphOffsetArray.length, y = d.vertexLength, g = this.allowVerticalPlacement && o === Wh.vertical ? Math.PI / 2 : 0, _ = a.text && a.text.sections, v = 0; v < e.length; v++) {
                        var x = e[v], b = x.tl, w = x.tr, M = x.bl, S = x.br, E = x.tex, I = x.pixelOffsetTL,
                            T = x.pixelOffsetBR, C = x.minFontScaleX, P = x.minFontScaleY, A = x.glyphOffset,
                            z = x.isSDF, k = x.sectionIndex, L = d.vertexLength, D = A[1];
                        Oc(f, s.x, s.y, b.x, D + b.y, E.x, E.y, i, z, I.x, I.y, C, P), Oc(f, s.x, s.y, w.x, D + w.y, E.x + E.w, E.y, i, z, T.x, I.y, C, P), Oc(f, s.x, s.y, M.x, D + M.y, E.x, E.y + E.h, i, z, I.x, T.y, C, P), Oc(f, s.x, s.y, S.x, D + S.y, E.x + E.w, E.y + E.h, i, z, T.x, T.y, C, P), Fc(t.dynamicLayoutVertexArray, s, g), p.emplaceBack(L, L + 1, L + 2), p.emplaceBack(L + 1, L + 2, L + 3), d.vertexLength += 4, d.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(A[0]), v !== e.length - 1 && k === e[v + 1].sectionIndex || t.programConfigurations.populatePaintArrays(f.length, a, a.index, {}, c, _ && _[k])
                    }
                    t.placedSymbolArray.emplaceBack(s.x, s.y, m, this.glyphOffsetArray.length - m, y, l, u, s.segment, i ? i[0] : 0, i ? i[1] : 0, r[0], r[1], o, 0, !1, 0, h)
                }, ut.prototype._addCollisionDebugVertex = function (t, e, i, r, n, a) {
                    return e.emplaceBack(0, 0), t.emplaceBack(i.x, i.y, r, n, Math.round(a.x), Math.round(a.y))
                }, ut.prototype.addCollisionDebugVertices = function (t, e, i, r, n, a, o) {
                    var s = n.segments.prepareSegment(4, n.layoutVertexArray, n.indexArray), l = s.vertexLength,
                        u = n.layoutVertexArray, h = n.collisionVertexArray, c = o.anchorX, p = o.anchorY;
                    this._addCollisionDebugVertex(u, h, a, c, p, new W(t, e)), this._addCollisionDebugVertex(u, h, a, c, p, new W(i, e)), this._addCollisionDebugVertex(u, h, a, c, p, new W(i, r)), this._addCollisionDebugVertex(u, h, a, c, p, new W(t, r)), s.vertexLength += 4;
                    var f = n.indexArray;
                    f.emplaceBack(l, l + 1), f.emplaceBack(l + 1, l + 2), f.emplaceBack(l + 2, l + 3), f.emplaceBack(l + 3, l), s.primitiveLength += 4
                }, ut.prototype.addDebugCollisionBoxes = function (t, e, i, r) {
                    for (var n = t; n < e; n++) {
                        var a = this.collisionBoxArray.get(n);
                        this.addCollisionDebugVertices(a.x1, a.y1, a.x2, a.y2, r ? this.textCollisionBox : this.iconCollisionBox, a.anchorPoint, i)
                    }
                }, ut.prototype.generateCollisionDebugBuffers = function () {
                    this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new Vc(vs, yh.members, Cs), this.iconCollisionBox = new Vc(vs, yh.members, Cs);
                    for (var t = 0; t < this.symbolInstances.length; t++) {
                        var e = this.symbolInstances.get(t);
                        this.addDebugCollisionBoxes(e.textBoxStartIndex, e.textBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex, e.verticalTextBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.iconBoxStartIndex, e.iconBoxEndIndex, e, !1), this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex, e.verticalIconBoxEndIndex, e, !1)
                    }
                }, ut.prototype._deserializeCollisionBoxesForSymbol = function (t, e, i, r, n, a, o, s, l) {
                    for (var u = {}, h = e; h < i; h++) {
                        var c = t.get(h);
                        u.textBox = {
                            x1: c.x1,
                            y1: c.y1,
                            x2: c.x2,
                            y2: c.y2,
                            anchorPointX: c.anchorPointX,
                            anchorPointY: c.anchorPointY
                        }, u.textFeatureIndex = c.featureIndex;
                        break
                    }
                    for (var p = r; p < n; p++) {
                        var f = t.get(p);
                        u.verticalTextBox = {
                            x1: f.x1,
                            y1: f.y1,
                            x2: f.x2,
                            y2: f.y2,
                            anchorPointX: f.anchorPointX,
                            anchorPointY: f.anchorPointY
                        }, u.verticalTextFeatureIndex = f.featureIndex;
                        break
                    }
                    for (var d = a; d < o; d++) {
                        var m = t.get(d);
                        u.iconBox = {
                            x1: m.x1,
                            y1: m.y1,
                            x2: m.x2,
                            y2: m.y2,
                            anchorPointX: m.anchorPointX,
                            anchorPointY: m.anchorPointY
                        }, u.iconFeatureIndex = m.featureIndex;
                        break
                    }
                    for (var y = s; y < l; y++) {
                        var g = t.get(y);
                        u.verticalIconBox = {
                            x1: g.x1,
                            y1: g.y1,
                            x2: g.x2,
                            y2: g.y2,
                            anchorPointX: g.anchorPointX,
                            anchorPointY: g.anchorPointY
                        }, u.verticalIconFeatureIndex = g.featureIndex;
                        break
                    }
                    return u
                }, ut.prototype.deserializeCollisionBoxes = function (t) {
                    this.collisionArrays = [];
                    for (var e = 0; e < this.symbolInstances.length; e++) {
                        var i = this.symbolInstances.get(e);
                        this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, i.textBoxStartIndex, i.textBoxEndIndex, i.verticalTextBoxStartIndex, i.verticalTextBoxEndIndex, i.iconBoxStartIndex, i.iconBoxEndIndex, i.verticalIconBoxStartIndex, i.verticalIconBoxEndIndex))
                    }
                }, ut.prototype.hasTextData = function () {
                    return this.text.segments.get().length > 0
                }, ut.prototype.hasIconData = function () {
                    return this.icon.segments.get().length > 0
                }, ut.prototype.hasDebugData = function () {
                    return this.textCollisionBox && this.iconCollisionBox
                }, ut.prototype.hasTextCollisionBoxData = function () {
                    return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0
                }, ut.prototype.hasIconCollisionBoxData = function () {
                    return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0
                }, ut.prototype.addIndicesForPlacedSymbol = function (t, e) {
                    for (var i = t.placedSymbolArray.get(e), r = i.vertexStartIndex + 4 * i.numGlyphs, n = i.vertexStartIndex; n < r; n += 4) t.indexArray.emplaceBack(n, n + 1, n + 2), t.indexArray.emplaceBack(n + 1, n + 2, n + 3)
                }, ut.prototype.getSortedSymbolIndexes = function (t) {
                    if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;
                    for (var e = Math.sin(t), i = Math.cos(t), r = [], n = [], a = [], o = 0; o < this.symbolInstances.length; ++o) {
                        a.push(o);
                        var s = this.symbolInstances.get(o);
                        r.push(0 | Math.round(e * s.anchorX + i * s.anchorY)), n.push(s.featureIndex)
                    }
                    return a.sort(function (t, e) {
                        return r[t] - r[e] || n[e] - n[t]
                    }), a
                }, ut.prototype.addToSortKeyRanges = function (t, e) {
                    var i = this.sortKeyRanges[this.sortKeyRanges.length - 1];
                    i && i.sortKey === e ? i.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({
                        sortKey: e,
                        symbolInstanceStart: t,
                        symbolInstanceEnd: t + 1
                    })
                }, ut.prototype.sortFeatures = function (t) {
                    var r = this;
                    if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
                        this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];
                        for (var e = 0, i = this.symbolInstanceIndexes; e < i.length; e += 1) {
                            var n = this.symbolInstances.get(i[e]);
                            this.featureSortOrder.push(n.featureIndex), [n.rightJustifiedTextSymbolIndex, n.centerJustifiedTextSymbolIndex, n.leftJustifiedTextSymbolIndex].forEach(function (t, e, i) {
                                t >= 0 && i.indexOf(t) === e && r.addIndicesForPlacedSymbol(r.text, t)
                            }), n.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, n.verticalPlacedTextSymbolIndex), n.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, n.placedIconSymbolIndex), n.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, n.verticalPlacedIconSymbolIndex)
                        }
                        this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray)
                    }
                }, e("SymbolBucket", ut, {omit: ["layers", "collisionBoxArray", "features", "compareText"]}), ut.MAX_GLYPHS = 65535, ut.addDynamicAttributes = Fc;
                var jc = new ns({
                    "symbol-placement": new i(a.layout_symbol["symbol-placement"]),
                    "symbol-spacing": new i(a.layout_symbol["symbol-spacing"]),
                    "symbol-avoid-edges": new i(a.layout_symbol["symbol-avoid-edges"]),
                    "symbol-sort-key": new r(a.layout_symbol["symbol-sort-key"]),
                    "symbol-z-order": new i(a.layout_symbol["symbol-z-order"]),
                    "icon-allow-overlap": new i(a.layout_symbol["icon-allow-overlap"]),
                    "icon-ignore-placement": new i(a.layout_symbol["icon-ignore-placement"]),
                    "icon-optional": new i(a.layout_symbol["icon-optional"]),
                    "icon-rotation-alignment": new i(a.layout_symbol["icon-rotation-alignment"]),
                    "icon-size": new r(a.layout_symbol["icon-size"]),
                    "icon-text-fit": new i(a.layout_symbol["icon-text-fit"]),
                    "icon-text-fit-padding": new i(a.layout_symbol["icon-text-fit-padding"]),
                    "icon-image": new r(a.layout_symbol["icon-image"]),
                    "icon-rotate": new r(a.layout_symbol["icon-rotate"]),
                    "icon-padding": new i(a.layout_symbol["icon-padding"]),
                    "icon-keep-upright": new i(a.layout_symbol["icon-keep-upright"]),
                    "icon-offset": new r(a.layout_symbol["icon-offset"]),
                    "icon-anchor": new r(a.layout_symbol["icon-anchor"]),
                    "icon-pitch-alignment": new i(a.layout_symbol["icon-pitch-alignment"]),
                    "text-pitch-alignment": new i(a.layout_symbol["text-pitch-alignment"]),
                    "text-rotation-alignment": new i(a.layout_symbol["text-rotation-alignment"]),
                    "text-field": new r(a.layout_symbol["text-field"]),
                    "text-font": new r(a.layout_symbol["text-font"]),
                    "text-size": new r(a.layout_symbol["text-size"]),
                    "text-max-width": new r(a.layout_symbol["text-max-width"]),
                    "text-line-height": new i(a.layout_symbol["text-line-height"]),
                    "text-letter-spacing": new r(a.layout_symbol["text-letter-spacing"]),
                    "text-justify": new r(a.layout_symbol["text-justify"]),
                    "text-radial-offset": new r(a.layout_symbol["text-radial-offset"]),
                    "text-variable-anchor": new i(a.layout_symbol["text-variable-anchor"]),
                    "text-anchor": new r(a.layout_symbol["text-anchor"]),
                    "text-max-angle": new i(a.layout_symbol["text-max-angle"]),
                    "text-writing-mode": new i(a.layout_symbol["text-writing-mode"]),
                    "text-rotate": new r(a.layout_symbol["text-rotate"]),
                    "text-padding": new i(a.layout_symbol["text-padding"]),
                    "text-keep-upright": new i(a.layout_symbol["text-keep-upright"]),
                    "text-transform": new r(a.layout_symbol["text-transform"]),
                    "text-offset": new r(a.layout_symbol["text-offset"]),
                    "text-allow-overlap": new i(a.layout_symbol["text-allow-overlap"]),
                    "text-ignore-placement": new i(a.layout_symbol["text-ignore-placement"]),
                    "text-optional": new i(a.layout_symbol["text-optional"])
                }), qc = {
                    paint: new ns({
                        "icon-opacity": new r(a.paint_symbol["icon-opacity"]),
                        "icon-color": new r(a.paint_symbol["icon-color"]),
                        "icon-halo-color": new r(a.paint_symbol["icon-halo-color"]),
                        "icon-halo-width": new r(a.paint_symbol["icon-halo-width"]),
                        "icon-halo-blur": new r(a.paint_symbol["icon-halo-blur"]),
                        "icon-translate": new i(a.paint_symbol["icon-translate"]),
                        "icon-translate-anchor": new i(a.paint_symbol["icon-translate-anchor"]),
                        "text-opacity": new r(a.paint_symbol["text-opacity"]),
                        "text-color": new r(a.paint_symbol["text-color"], {
                            runtimeType: Tr, getOverride: function (t) {
                                return t.textColor
                            }, hasOverride: function (t) {
                                return !!t.textColor
                            }
                        }),
                        "text-halo-color": new r(a.paint_symbol["text-halo-color"]),
                        "text-halo-width": new r(a.paint_symbol["text-halo-width"]),
                        "text-halo-blur": new r(a.paint_symbol["text-halo-blur"]),
                        "text-translate": new i(a.paint_symbol["text-translate"]),
                        "text-translate-anchor": new i(a.paint_symbol["text-translate-anchor"])
                    }), layout: jc
                }, Gc = function (t) {
                    this.type = t.property.overrides ? t.property.overrides.runtimeType : Ir, this.defaultValue = t
                };
                Gc.prototype.evaluate = function (t) {
                    if (t.formattedSection) {
                        var e = this.defaultValue.property.overrides;
                        if (e && e.hasOverride(t.formattedSection)) return e.getOverride(t.formattedSection)
                    }
                    return t.feature && t.featureState ? this.defaultValue.evaluate(t.feature, t.featureState) : this.defaultValue.property.specification.default
                }, Gc.prototype.eachChild = function (t) {
                    this.defaultValue.isConstant() || t(this.defaultValue.value._styleExpression.expression)
                }, Gc.prototype.outputDefined = function () {
                    return !1
                }, Gc.prototype.serialize = function () {
                    return null
                }, e("FormatSectionOverride", Gc, {omit: ["defaultValue"]});
                var Zc = function (s) {
                        function l(t) {
                            s.call(this, t, qc)
                        }

                        return s && (l.__proto__ = s), (l.prototype = Object.create(s && s.prototype)).constructor = l, l.prototype.recalculate = function (t, e) {
                            if (s.prototype.recalculate.call(this, t, e), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), "point" === this.layout.get("symbol-placement")) {
                                var i = this.layout.get("text-writing-mode");
                                if (i) {
                                    for (var r = [], n = 0, a = i; n < a.length; n += 1) {
                                        var o = a[n];
                                        r.indexOf(o) < 0 && r.push(o)
                                    }
                                    this.layout._values["text-writing-mode"] = r
                                } else this.layout._values["text-writing-mode"] = ["horizontal"]
                            }
                            this._setPaintOverrides()
                        }, l.prototype.getValueAndResolveTokens = function (t, e, i, r) {
                            var n = this.layout.get(t).evaluate(e, {}, i, r), a = this._unevaluatedLayout._values[t];
                            return a.isDataDriven() || Ea(a.value) || !n ? n : function (i, t) {
                                return t.replace(/{([^{}]+)}/g, function (t, e) {
                                    return e in i ? String(i[e]) : ""
                                })
                            }(e.properties, n)
                        }, l.prototype.createBucket = function (t) {
                            return new ut(t)
                        }, l.prototype.queryRadius = function () {
                            return 0
                        }, l.prototype.queryIntersectsFeature = function () {
                            return !1
                        }, l.prototype._setPaintOverrides = function () {
                            for (var t = 0, e = qc.paint.overridableProperties; t < e.length; t += 1) {
                                var i = e[t];
                                if (l.hasPaintOverride(this.layout, i)) {
                                    var r, n = this.paint.get(i), a = new Gc(n), o = new Sa(a, n.property.specification);
                                    r = "constant" === n.value.kind || "source" === n.value.kind ? new Ta("source", o) : new Ca("composite", o, n.value.zoomStops, n.value._interpolationType), this.paint._values[i] = new $o(n.property, r, n.parameters)
                                }
                            }
                        }, l.prototype._handleOverridablePaintPropertyUpdate = function (t, e, i) {
                            return !(!this.layout || e.isDataDriven() || i.isDataDriven()) && l.hasPaintOverride(this.layout, t)
                        }, l.hasPaintOverride = function (t, e) {
                            var i = t.get("text-field"), r = qc.paint.properties[e], n = !1, a = function (t) {
                                for (var e = 0, i = t; e < i.length; e += 1) if (r.overrides && r.overrides.hasOverride(i[e])) return void (n = !0)
                            };
                            if ("constant" === i.value.kind && i.value.value instanceof Ur) a(i.value.value.sections); else if ("source" === i.value.kind) {
                                var o = function (t) {
                                    n || (t instanceof Gr && v(t.value) === Ar ? a(t.value.sections) : t instanceof Hr ? a(t.sections) : t.eachChild(o))
                                }, s = i.value;
                                s._styleExpression && o(s._styleExpression.expression)
                            }
                            return n
                        }, l
                    }(as), Wc = {
                        paint: new ns({
                            "background-color": new i(a.paint_background["background-color"]),
                            "background-pattern": new is(a.paint_background["background-pattern"]),
                            "background-opacity": new i(a.paint_background["background-opacity"])
                        })
                    }, Xc = function (e) {
                        function t(t) {
                            e.call(this, t, Wc)
                        }

                        return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t
                    }(as), Hc = {
                        paint: new ns({
                            "raster-opacity": new i(a.paint_raster["raster-opacity"]),
                            "raster-hue-rotate": new i(a.paint_raster["raster-hue-rotate"]),
                            "raster-brightness-min": new i(a.paint_raster["raster-brightness-min"]),
                            "raster-brightness-max": new i(a.paint_raster["raster-brightness-max"]),
                            "raster-saturation": new i(a.paint_raster["raster-saturation"]),
                            "raster-contrast": new i(a.paint_raster["raster-contrast"]),
                            "raster-resampling": new i(a.paint_raster["raster-resampling"]),
                            "raster-fade-duration": new i(a.paint_raster["raster-fade-duration"])
                        })
                    }, Kc = function (e) {
                        function t(t) {
                            e.call(this, t, Hc)
                        }

                        return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t
                    }(as), Yc = function (e) {
                        function t(t) {
                            e.call(this, t, {}), this.implementation = t
                        }

                        return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.is3D = function () {
                            return "3d" === this.implementation.renderingMode
                        }, t.prototype.hasOffscreenPass = function () {
                            return void 0 !== this.implementation.prerender
                        }, t.prototype.recalculate = function () {
                        }, t.prototype.updateTransitions = function () {
                        }, t.prototype.hasTransition = function () {
                        }, t.prototype.serialize = function () {
                        }, t.prototype.onAdd = function (t) {
                            this.implementation.onAdd && this.implementation.onAdd(t, t.painter.context.gl)
                        }, t.prototype.onRemove = function (t) {
                            this.implementation.onRemove && this.implementation.onRemove(t, t.painter.context.gl)
                        }, t
                    }(as), Jc = {
                        circle: Gl,
                        heatmap: Kl,
                        hillshade: Jl,
                        fill: Bu,
                        "fill-extrusion": $u,
                        line: ch,
                        symbol: Zc,
                        background: Xc,
                        raster: Kc
                    }, Qc = c.HTMLImageElement, $c = c.HTMLCanvasElement, tp = c.HTMLVideoElement, ep = c.ImageData,
                    ip = c.ImageBitmap, rp = function (t, e, i, r) {
                        this.context = t, this.format = i, this.texture = t.gl.createTexture(), this.update(e, r)
                    };
                rp.prototype.update = function (t, e, i) {
                    var r = t.width, n = t.height, a = !(this.size && this.size[0] === r && this.size[1] === n || i),
                        o = this.context, s = o.gl;
                    if (this.useMipmap = Boolean(e && e.useMipmap), s.bindTexture(s.TEXTURE_2D, this.texture), o.pixelStoreUnpackFlipY.set(!1), o.pixelStoreUnpack.set(1), o.pixelStoreUnpackPremultiplyAlpha.set(this.format === s.RGBA && (!e || !1 !== e.premultiply)), a) this.size = [r, n], t instanceof Qc || t instanceof $c || t instanceof tp || t instanceof ep || ip && t instanceof ip ? s.texImage2D(s.TEXTURE_2D, 0, this.format, this.format, s.UNSIGNED_BYTE, t) : s.texImage2D(s.TEXTURE_2D, 0, this.format, r, n, 0, this.format, s.UNSIGNED_BYTE, t.data); else {
                        var l = i || {x: 0, y: 0}, u = l.x, h = l.y;
                        t instanceof Qc || t instanceof $c || t instanceof tp || t instanceof ep || ip && t instanceof ip ? s.texSubImage2D(s.TEXTURE_2D, 0, u, h, s.RGBA, s.UNSIGNED_BYTE, t) : s.texSubImage2D(s.TEXTURE_2D, 0, u, h, r, n, s.RGBA, s.UNSIGNED_BYTE, t.data)
                    }
                    this.useMipmap && this.isSizePowerOfTwo() && s.generateMipmap(s.TEXTURE_2D)
                }, rp.prototype.bind = function (t, e, i) {
                    var r = this.context.gl;
                    r.bindTexture(r.TEXTURE_2D, this.texture), i !== r.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (i = r.LINEAR), t !== this.filter && (r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, t), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, i || t), this.filter = t), e !== this.wrap && (r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, e), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, e), this.wrap = e)
                }, rp.prototype.isSizePowerOfTwo = function () {
                    return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0
                }, rp.prototype.destroy = function () {
                    this.context.gl.deleteTexture(this.texture), this.texture = null
                };
                var np = function (t) {
                    var e = this;
                    this._callback = t, this._triggered = !1, "undefined" != typeof MessageChannel && (this._channel = new MessageChannel, this._channel.port2.onmessage = function () {
                        e._triggered = !1, e._callback()
                    })
                };
                np.prototype.trigger = function () {
                    var t = this;
                    this._triggered || (this._triggered = !0, this._channel ? this._channel.port1.postMessage(!0) : setTimeout(function () {
                        t._triggered = !1, t._callback()
                    }, 0))
                }, np.prototype.remove = function () {
                    delete this._channel, this._callback = function () {
                    }
                };
                var ap = function (t, e, i) {
                    this.target = t, this.parent = e, this.mapId = i, this.callbacks = {}, this.tasks = {}, this.taskQueue = [], this.cancelCallbacks = {}, H(["receive", "process"], this), this.invoker = new np(this.process), this.target.addEventListener("message", this.receive, !1), this.globalScope = rt() ? t : c
                };
                ap.prototype.send = function (t, e, i, r, n, a) {
                    var o = this;
                    void 0 === n && (n = !1);
                    var s = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
                    i && (this.callbacks[s] = i);
                    var l = ot(this.globalScope) ? void 0 : [];
                    return this.target.postMessage({
                        sourceId: a,
                        id: s,
                        type: t,
                        hasCallback: !!i,
                        targetMapId: r,
                        mustQueue: n,
                        sourceMapId: this.mapId,
                        data: Oa(e, l)
                    }, l), {
                        cancel: function () {
                            i && delete o.callbacks[s], o.target.postMessage({
                                id: s,
                                type: "<cancel>",
                                targetMapId: r,
                                sourceMapId: o.mapId
                            })
                        }
                    }
                }, ap.prototype.receive = function (t) {
                    var e = t.data, i = e.id;
                    if (i && (!e.targetMapId || this.mapId === e.targetMapId)) if ("<cancel>" === e.type) {
                        delete this.tasks[i];
                        var r = this.cancelCallbacks[i];
                        delete this.cancelCallbacks[i], r && r()
                    } else rt() || e.mustQueue ? (this.tasks[i] = e, this.taskQueue.push(i), this.invoker.trigger()) : this.processTask(i, e)
                }, ap.prototype.process = function () {
                    if (this.taskQueue.length) {
                        var t = this.taskQueue.shift(), e = this.tasks[t];
                        delete this.tasks[t], this.taskQueue.length && this.invoker.trigger(), e && this.processTask(t, e)
                    }
                }, ap.prototype.processTask = function (i, t) {
                    var r = this;
                    if ("<response>" === t.type) {
                        var e = this.callbacks[i];
                        delete this.callbacks[i], e && (t.error ? e(Fa(t.error)) : e(null, Fa(t.data)))
                    } else {
                        var n = !1, a = ot(this.globalScope) ? void 0 : [], o = t.hasCallback ? function (t, e) {
                            n = !0, delete r.cancelCallbacks[i], r.target.postMessage({
                                id: i,
                                type: "<response>",
                                sourceMapId: r.mapId,
                                error: t ? Oa(t) : null,
                                data: Oa(e, a)
                            }, a)
                        } : function (t) {
                            n = !0
                        }, s = null, l = Fa(t.data);
                        if (this.parent[t.type]) s = this.parent[t.type](t.sourceMapId, l, o, t.sourceId); else if (this.parent.getWorkerSource) {
                            var u = t.type.split(".");
                            s = this.parent.getWorkerSource(t.sourceMapId, u[0], l.source, l.crs)[u[1]](l, o)
                        } else o(new Error("Could not find function " + t.type));
                        !n && s && s.cancel && (this.cancelCallbacks[i] = s.cancel)
                    }
                }, ap.prototype.remove = function () {
                    this.invoker.remove(), this.target.removeEventListener("message", this.receive, !1)
                };
                var l = function (t, e) {
                    t && (e ? this.setSouthWest(t).setNorthEast(e) : 4 === t.length ? this.setSouthWest([t[0], t[1]]).setNorthEast([t[2], t[3]]) : this.setSouthWest(t[0]).setNorthEast(t[1]))
                };
                l.prototype.setNorthEast = function (t) {
                    return this._ne = t instanceof h ? new h(t.lng, t.lat) : h.convert(t), this
                }, l.prototype.setSouthWest = function (t) {
                    return this._sw = t instanceof h ? new h(t.lng, t.lat) : h.convert(t), this
                }, l.prototype.extend = function (t) {
                    var e, i, r = this._sw, n = this._ne;
                    if (t instanceof h) e = t, i = t; else {
                        if (!(t instanceof l)) return Array.isArray(t) ? 4 === t.length || t.every(Array.isArray) ? this.extend(l.convert(t)) : this.extend(h.convert(t)) : this;
                        if (i = t._ne, !(e = t._sw) || !i) return this
                    }
                    return r || n ? (r.lng = Math.min(e.lng, r.lng), r.lat = Math.min(e.lat, r.lat), n.lng = Math.max(i.lng, n.lng), n.lat = Math.max(i.lat, n.lat)) : (this._sw = new h(e.lng, e.lat), this._ne = new h(i.lng, i.lat)), this
                }, l.prototype.getCenter = function () {
                    return new h((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2)
                }, l.prototype.getSouthWest = function () {
                    return this._sw
                }, l.prototype.getNorthEast = function () {
                    return this._ne
                }, l.prototype.getNorthWest = function () {
                    return new h(this.getWest(), this.getNorth())
                }, l.prototype.getSouthEast = function () {
                    return new h(this.getEast(), this.getSouth())
                }, l.prototype.getWest = function () {
                    return this._sw.lng
                }, l.prototype.getSouth = function () {
                    return this._sw.lat
                }, l.prototype.getEast = function () {
                    return this._ne.lng
                }, l.prototype.getNorth = function () {
                    return this._ne.lat
                }, l.prototype.toArray = function () {
                    return [this._sw.toArray(), this._ne.toArray()]
                }, l.prototype.toString = function () {
                    return "LngLatBounds(" + this._sw.toString() + ", " + this._ne.toString() + ")"
                }, l.prototype.isEmpty = function () {
                    return !(this._sw && this._ne)
                }, l.prototype.contains = function (t) {
                    var e = h.convert(t), i = e.lng, r = e.lat, n = this._sw.lng <= i && i <= this._ne.lng;
                    return this._sw.lng > this._ne.lng && (n = this._sw.lng >= i && i >= this._ne.lng), this._sw.lat <= r && r <= this._ne.lat && n
                }, l.convert = function (t) {
                    return !t || t instanceof l ? t : new l(t)
                };
                var h = function (t, e) {
                    if (isNaN(t) || isNaN(e)) throw new Error("Invalid LngLat object: (" + t + ", " + e + ")");
                    this.lng = +t, this.lat = +e
                };
                h.prototype.wrap = function () {
                    return new h(N(this.lng, -180, 180), this.lat)
                }, h.prototype.toArray = function () {
                    return [this.lng, this.lat]
                }, h.prototype.toString = function () {
                    return "LngLat(" + this.lng + ", " + this.lat + ")"
                }, h.prototype.distanceTo = function (t) {
                    var e = Math.PI / 180, i = this.lat * e, r = t.lat * e,
                        n = Math.sin(i) * Math.sin(r) + Math.cos(i) * Math.cos(r) * Math.cos((t.lng - this.lng) * e);
                    return 6371008.8 * Math.acos(Math.min(n, 1))
                }, h.prototype.toBounds = function (t) {
                    void 0 === t && (t = 0);
                    var e = 360 * t / 40075017, i = e / Math.cos(Math.PI / 180 * this.lat);
                    return new l(new h(this.lng - i, this.lat - e), new h(this.lng + i, this.lat + e))
                }, h.convert = function (t) {
                    if (t instanceof h) return t;
                    if (Array.isArray(t) && (2 === t.length || 3 === t.length)) return new h(Number(t[0]), Number(t[1]));
                    if (!Array.isArray(t) && "object" == typeof t && null !== t) return new h(Number("lng" in t ? t.lng : t.lon), Number(t.lat));
                    throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")
                };
                var op = 2 * Math.PI * 6371008.8;

                function sp(t) {
                    return op * Math.cos(t * Math.PI / 180)
                }

                function lp(t, e) {
                    return t / sp(e)
                }

                function up(t) {
                    return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t) * Math.PI / 180)) - 90
                }

                var hp = function (t, e, i) {
                    void 0 === i && (i = 0), this.x = +t, this.y = +e, this.z = +i
                };
                hp.fromLngLat = function (t, e) {
                    void 0 === e && (e = 0);
                    var i = h.convert(t);
                    return new hp((180 + i.lng) / 360, (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + i.lat * Math.PI / 360))) / 360, lp(e, i.lat))
                }, hp.prototype.toLngLat = function () {
                    return new h(360 * this.x - 180, up(this.y))
                }, hp.prototype.toAltitude = function () {
                    return this.z * sp(up(this.y))
                }, hp.prototype.meterInMercatorCoordinateUnits = function () {
                    return 1 / op * (t = up(this.y), 1 / Math.cos(t * Math.PI / 180));
                    var t
                };
                var cp = function (t, e, i, r) {
                    this.z = t, this.x = e, this.y = i, this.key = fp(0, t, t, e, i), r && (this.indexExtent = r, this.worldWidth = r[2] - r[0], this.worldHeight = r[3] - r[1])
                };
                cp.prototype.equals = function (t) {
                    return this.z === t.z && this.x === t.x && this.y === t.y
                }, cp.prototype.getTileBBox = function () {
                    var t = Math.pow(2, this.z);
                    return this.indexExtent[0] + this.worldWidth * this.x / t + "," + (this.indexExtent[3] - this.worldHeight * (this.y + 1) / t) + "," + (this.indexExtent[0] + this.worldWidth * (this.x + 1) / t) + "," + (this.indexExtent[3] - this.worldHeight * this.y / t)
                }, cp.prototype.url = function (t, e, i, r, n) {
                    var a = this.getTileBBox(), o = function (t, e, i) {
                        for (var r, n = "", a = t; a > 0; a--) n += (e & (r = 1 << a - 1) ? 1 : 0) + (i & r ? 2 : 0);
                        return n
                    }(this.z, this.x, this.y);
                    i = i || 0;
                    var s = t[(this.x + this.y) % t.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z - i)).replace("{x}", String(this.x)).replace("{y}", String("tms" === e ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{quadkey}", o).replace("{bbox-epsg-3857}", a).replace("{bbox}", a).replace("{width}", r).replace("{height}", r);
                    if (this.getViewBounds) {
                        var l = this.getViewBounds();
                        l && (s = s.replace("{viewBounds}", l))
                    }
                    if (this.getTileBBoxReverseXY) {
                        var u = this.getTileBBoxReverseXY();
                        u && (s = s.replace("{bbox-wms-1.3.0}", u))
                    }
                    return n && (s = s.replace("{scale}", n)), s
                }, cp.prototype.getTilePoint = function (t) {
                    var e = Math.pow(2, this.z);
                    return new W(8192 * (t.x * e - this.x), 8192 * (t.y * e - this.y))
                }, cp.prototype.toString = function () {
                    return this.z + "/" + this.x + "/" + this.y
                }, cp.prototype.getTileBBoxReverseXY = function () {
                    var t = Math.pow(2, this.z);
                    return this.indexExtent[3] - this.worldHeight * (this.y + 1) / t + "," + (this.indexExtent[0] + this.worldWidth * this.x / t) + "," + (this.indexExtent[3] - this.worldHeight * this.y / t) + "," + (this.indexExtent[0] + this.worldWidth * (this.x + 1) / t)
                }, cp.prototype.getViewBounds = function () {
                    var t = Math.pow(2, this.z);
                    return '{"leftBottom":{"x":' + (this.indexExtent[0] + this.worldWidth * this.x / t) + ',"y":' + (this.indexExtent[3] - this.worldHeight * (this.y + 1) / t) + '},"rightTop":{"x":' + (this.indexExtent[0] + this.worldWidth * (this.x + 1) / t) + ',"y": ' + (this.indexExtent[3] - this.worldHeight * this.y / t) + "}}"
                };
                var pp = function (t, e) {
                    this.wrap = t, this.canonical = e, this.key = fp(t, e.z, e.z, e.x, e.y)
                }, I = function (t, e, i, r, n, a) {
                    this.overscaledZ = t, this.wrap = e, this.canonical = new cp(i, +r, +n, a), this.key = fp(e, t, i, r, n)
                };

                function fp(t, e, i, r, n) {
                    (t *= 2) < 0 && (t = -1 * t - 1);
                    var a = 1 << i;
                    return (a * a * t + a * n + r).toString(36) + i.toString(36) + e.toString(36)
                }

                I.prototype.equals = function (t) {
                    return this.overscaledZ === t.overscaledZ && this.wrap === t.wrap && this.canonical.equals(t.canonical)
                }, I.prototype.scaledTo = function (t) {
                    var e = this.canonical.z - t;
                    return t > this.canonical.z ? new I(t, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y, this.canonical.indexExtent) : new I(t, this.wrap, t, this.canonical.x >> e, this.canonical.y >> e, this.canonical.indexExtent)
                }, I.prototype.calculateScaledKey = function (t, e) {
                    var i = this.canonical.z - t;
                    return t > this.canonical.z ? fp(this.wrap * +e, t, this.canonical.z, this.canonical.x, this.canonical.y) : fp(this.wrap * +e, t, t, this.canonical.x >> i, this.canonical.y >> i)
                }, I.prototype.isChildOf = function (t) {
                    if (t.wrap !== this.wrap) return !1;
                    var e = this.canonical.z - t.canonical.z;
                    return 0 === t.overscaledZ || t.overscaledZ < this.overscaledZ && t.canonical.x === this.canonical.x >> e && t.canonical.y === this.canonical.y >> e
                }, I.prototype.children = function (t) {
                    if (this.overscaledZ >= t) return [new I(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y, this.canonical.indexExtent)];
                    var e = this.canonical.z + 1, i = 2 * this.canonical.x, r = 2 * this.canonical.y;
                    return [new I(e, this.wrap, e, i, r, this.canonical.indexExtent), new I(e, this.wrap, e, i + 1, r, this.canonical.indexExtent), new I(e, this.wrap, e, i, r + 1, this.canonical.indexExtent), new I(e, this.wrap, e, i + 1, r + 1, this.canonical.indexExtent)]
                }, I.prototype.isLessThan = function (t) {
                    return this.wrap < t.wrap || !(this.wrap > t.wrap) && (this.overscaledZ < t.overscaledZ || !(this.overscaledZ > t.overscaledZ) && (this.canonical.x < t.canonical.x || !(this.canonical.x > t.canonical.x) && this.canonical.y < t.canonical.y))
                }, I.prototype.wrapped = function () {
                    return new I(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y, this.canonical.indexExtent)
                }, I.prototype.unwrapTo = function (t) {
                    return new I(this.overscaledZ, t, this.canonical.z, this.canonical.x, this.canonical.y, this.canonical.indexExtent)
                }, I.prototype.overscaleFactor = function () {
                    return Math.pow(2, this.overscaledZ - this.canonical.z)
                }, I.prototype.toUnwrapped = function () {
                    return new pp(this.wrap, this.canonical)
                }, I.prototype.toString = function () {
                    return this.overscaledZ + "/" + this.canonical.x + "/" + this.canonical.y
                }, I.prototype.getTilePoint = function (t) {
                    return this.canonical.getTilePoint(new hp(t.x - this.wrap, t.y))
                }, e("CanonicalTileID", cp), e("OverscaledTileID", I, {omit: ["posMatrix"]});
                var dp = function (t, e, i) {
                    if (this.uid = t, e.height !== e.width) throw new RangeError("DEM tiles must be square");
                    if (i && "mapbox" !== i && "terrarium" !== i) return ht('"' + i + '" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');
                    this.stride = e.height;
                    var r = this.dim = e.height - 2;
                    this.data = new Uint32Array(e.data.buffer), this.encoding = i || "mapbox";
                    for (var n = 0; n < r; n++) this.data[this._idx(-1, n)] = this.data[this._idx(0, n)], this.data[this._idx(r, n)] = this.data[this._idx(r - 1, n)], this.data[this._idx(n, -1)] = this.data[this._idx(n, 0)], this.data[this._idx(n, r)] = this.data[this._idx(n, r - 1)];
                    this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(r, -1)] = this.data[this._idx(r - 1, 0)], this.data[this._idx(-1, r)] = this.data[this._idx(0, r - 1)], this.data[this._idx(r, r)] = this.data[this._idx(r - 1, r - 1)]
                };
                dp.prototype.get = function (t, e) {
                    var i = new Uint8Array(this.data.buffer), r = 4 * this._idx(t, e);
                    return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMapbox)(i[r], i[r + 1], i[r + 2])
                }, dp.prototype.getUnpackVector = function () {
                    return "terrarium" === this.encoding ? [256, 1, 1 / 256, 32768] : [6553.6, 25.6, .1, 1e4]
                }, dp.prototype._idx = function (t, e) {
                    if (t < -1 || t >= this.dim + 1 || e < -1 || e >= this.dim + 1) throw new RangeError("out of range source coordinates for DEM data");
                    return (e + 1) * this.stride + (t + 1)
                }, dp.prototype._unpackMapbox = function (t, e, i) {
                    return (256 * t * 256 + 256 * e + i) / 10 - 1e4
                }, dp.prototype._unpackTerrarium = function (t, e, i) {
                    return 256 * t + e + i / 256 - 32768
                }, dp.prototype.getPixels = function () {
                    return new x({width: this.stride, height: this.stride}, new Uint8Array(this.data.buffer))
                }, dp.prototype.backfillBorder = function (t, e, i) {
                    if (this.dim !== t.dim) throw new Error("dem dimension mismatch");
                    var r = e * this.dim, n = e * this.dim + this.dim, a = i * this.dim, o = i * this.dim + this.dim;
                    switch (e) {
                        case-1:
                            r = n - 1;
                            break;
                        case 1:
                            n = r + 1
                    }
                    switch (i) {
                        case-1:
                            a = o - 1;
                            break;
                        case 1:
                            o = a + 1
                    }
                    for (var s = -e * this.dim, l = -i * this.dim, u = a; u < o; u++) for (var h = r; h < n; h++) this.data[this._idx(h, u)] = t.data[this._idx(h + s, u + l)]
                }, e("DEMData", dp);
                var mp = function (t) {
                    this._stringToNumber = {}, this._numberToString = [];
                    for (var e = 0; e < t.length; e++) {
                        var i = t[e];
                        this._stringToNumber[i] = e, this._numberToString[e] = i
                    }
                };
                mp.prototype.encode = function (t) {
                    return this._stringToNumber[t]
                }, mp.prototype.decode = function (t) {
                    return this._numberToString[t]
                };
                var yp = function (t, e, i, r, n) {
                    this.type = "Feature", this._vectorTileFeature = t, t._z = e, t._x = i, t._y = r, this.properties = t.properties, this.id = n
                }, gp = {geometry: {configurable: !0}};
                gp.geometry.get = function () {
                    return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z, yp.toLngLat).geometry), this._geometry
                }, gp.geometry.set = function (t) {
                    this._geometry = t
                }, yp.prototype.toJSON = function () {
                    var t = {geometry: this.geometry};
                    for (var e in this) "_geometry" !== e && "_vectorTileFeature" !== e && (t[e] = this[e]);
                    return t
                }, Object.defineProperties(yp.prototype, gp);
                var _p = function () {
                    this.state = {}, this.stateChanges = {}, this.deletedStates = {}
                };
                _p.prototype.updateState = function (t, e, i) {
                    var r = String(e);
                    if (this.stateChanges[t] = this.stateChanges[t] || {}, this.stateChanges[t][r] = this.stateChanges[t][r] || {}, V(this.stateChanges[t][r], i), null === this.deletedStates[t]) for (var n in this.deletedStates[t] = {}, this.state[t]) n !== r && (this.deletedStates[t][n] = null); else if (this.deletedStates[t] && null === this.deletedStates[t][r]) for (var a in this.deletedStates[t][r] = {}, this.state[t][r]) i[a] || (this.deletedStates[t][r][a] = null); else for (var o in i) this.deletedStates[t] && this.deletedStates[t][r] && null === this.deletedStates[t][r][o] && delete this.deletedStates[t][r][o]
                }, _p.prototype.removeFeatureState = function (t, e, i) {
                    if (null !== this.deletedStates[t]) {
                        var r = String(e);
                        if (this.deletedStates[t] = this.deletedStates[t] || {}, i && void 0 !== e) null !== this.deletedStates[t][r] && (this.deletedStates[t][r] = this.deletedStates[t][r] || {}, this.deletedStates[t][r][i] = null); else if (void 0 !== e) if (this.stateChanges[t] && this.stateChanges[t][r]) for (i in this.deletedStates[t][r] = {}, this.stateChanges[t][r]) this.deletedStates[t][r][i] = null; else this.deletedStates[t][r] = null; else this.deletedStates[t] = null
                    }
                }, _p.prototype.getState = function (t, e) {
                    var i = String(e), r = V({}, (this.state[t] || {})[i], (this.stateChanges[t] || {})[i]);
                    if (null === this.deletedStates[t]) return {};
                    if (this.deletedStates[t]) {
                        var n = this.deletedStates[t][e];
                        if (null === n) return {};
                        for (var a in n) delete r[a]
                    }
                    return r
                }, _p.prototype.initializeTileState = function (t, e) {
                    t.setFeatureState(this.state, e)
                }, _p.prototype.coalesceChanges = function (t, e) {
                    var i = {};
                    for (var r in this.stateChanges) {
                        this.state[r] = this.state[r] || {};
                        var n = {};
                        for (var a in this.stateChanges[r]) this.state[r][a] || (this.state[r][a] = {}), V(this.state[r][a], this.stateChanges[r][a]), n[a] = this.state[r][a];
                        i[r] = n
                    }
                    for (var o in this.deletedStates) {
                        this.state[o] = this.state[o] || {};
                        var s = {};
                        if (null === this.deletedStates[o]) for (var l in this.state[o]) s[l] = {}, this.state[o][l] = {}; else for (var u in this.deletedStates[o]) {
                            if (null === this.deletedStates[o][u]) this.state[o][u] = {}; else for (var h = 0, c = Object.keys(this.deletedStates[o][u]); h < c.length; h += 1) delete this.state[o][u][c[h]];
                            s[u] = this.state[o][u]
                        }
                        i[o] = i[o] || {}, V(i[o], s)
                    }
                    if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(i).length) for (var p in t) t[p].setFeatureState(i, e)
                };
                var vp = function (t, e) {
                    this.tileID = t, this.x = t.canonical.x, this.y = t.canonical.y, this.z = t.canonical.z, this.grid = new xr(8192, 16, 0), this.grid3D = new xr(8192, 16, 0), this.featureIndexArray = new Ns, this.promoteId = e
                };

                function xp(t, r, n, a, o) {
                    return J(t, function (t, e) {
                        var i = r instanceof ts ? r.get(e) : null;
                        return i && i.evaluate ? i.evaluate(n, a, o) : i
                    })
                }

                function bp(t) {
                    for (var e = 1 / 0, i = 1 / 0, r = -1 / 0, n = -1 / 0, a = 0, o = t; a < o.length; a += 1) {
                        var s = o[a];
                        e = Math.min(e, s.x), i = Math.min(i, s.y), r = Math.max(r, s.x), n = Math.max(n, s.y)
                    }
                    return {minX: e, minY: i, maxX: r, maxY: n}
                }

                function wp(t, e) {
                    return e - t
                }

                vp.prototype.insert = function (t, e, i, r, n, a) {
                    var o = this.featureIndexArray.length;
                    this.featureIndexArray.emplaceBack(i, r, n);
                    for (var s = a ? this.grid3D : this.grid, l = 0; l < e.length; l++) {
                        for (var u = e[l], h = [1 / 0, 1 / 0, -1 / 0, -1 / 0], c = 0; c < u.length; c++) {
                            var p = u[c];
                            h[0] = Math.min(h[0], p.x), h[1] = Math.min(h[1], p.y), h[2] = Math.max(h[2], p.x), h[3] = Math.max(h[3], p.y)
                        }
                        h[0] < 8192 && h[1] < 8192 && h[2] >= 0 && h[3] >= 0 && s.insert(o, h[0], h[1], h[2], h[3])
                    }
                }, vp.prototype.loadVTLayers = function () {
                    return this.vtLayers || (this.vtLayers = new Wu.VectorTile(new wh(this.rawTileData)).layers, this.sourceLayerCoder = new mp(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])), this.vtLayers
                }, vp.prototype.query = function (n, a, o, s) {
                    var l = this;
                    this.loadVTLayers();
                    for (var u = n.params || {}, h = 8192 / n.tileSize / n.scale, c = no(u.filter), p = n.queryGeometry, f = n.queryPadding * h, t = bp(p), d = this.grid.query(t.minX - f, t.minY - f, t.maxX + f, t.maxY + f), e = bp(n.cameraQueryGeometry), i = this.grid3D.query(e.minX - f, e.minY - f, e.maxX + f, e.maxY + f, function (t, e, i, r) {
                        return function (t, e, i, r, n) {
                            for (var a = 0, o = t; a < o.length; a += 1) {
                                var s = o[a];
                                if (e <= s.x && i <= s.y && r >= s.x && n >= s.y) return !0
                            }
                            var l = [new W(e, i), new W(e, n), new W(r, n), new W(r, i)];
                            if (t.length > 2) for (var u = 0, h = l; u < h.length; u += 1) if (zl(t, h[u])) return !0;
                            for (var c = 0; c < t.length - 1; c++) if (kl(t[c], t[c + 1], l)) return !0;
                            return !1
                        }(n.cameraQueryGeometry, t - f, e - f, i + f, r + f)
                    }), r = 0, m = i; r < m.length; r += 1) d.push(m[r]);
                    d.sort(wp);
                    for (var y, g = {}, _ = function (t) {
                        var e = d[t];
                        if (e !== y) {
                            y = e;
                            var i = l.featureIndexArray.get(e), r = null;
                            l.loadMatchingFeature(g, i.bucketIndex, i.sourceLayerIndex, i.featureIndex, c, u.layers, u.availableImages, a, o, s, function (t, e, i) {
                                return r || (r = vl(t)), e.queryIntersectsFeature(p, t, i, r, l.z, n.transform, h, n.pixelPosMatrix)
                            })
                        }
                    }, v = 0; v < d.length; v++) _(v);
                    return g
                }, vp.prototype.loadMatchingFeature = function (t, e, i, r, n, a, o, s, l, u, h) {
                    var c = this.bucketLayerIDs[e];
                    if (!a || function (t, e) {
                        for (var i = 0; i < t.length; i++) if (e.indexOf(t[i]) >= 0) return !0;
                        return !1
                    }(a, c)) {
                        var p = this.sourceLayerCoder.decode(i), f = this.vtLayers[p].feature(r);
                        if (n.filter(new j(this.tileID.overscaledZ), f)) for (var d = this.getId(f, p), m = 0; m < c.length; m++) {
                            var y = c[m];
                            if (!(a && a.indexOf(y) < 0)) {
                                var g = s[y];
                                if (g) {
                                    var _ = {};
                                    void 0 !== d && u && (_ = u.getState(g.sourceLayer || "_geojsonTileLayer", d));
                                    var v = l[y];
                                    v.paint = xp(v.paint, g.paint, f, _, o), v.layout = xp(v.layout, g.layout, f, _, o);
                                    var x = !h || h(f, g, _);
                                    if (x) {
                                        var b = new yp(f, this.z, this.x, this.y, d);
                                        b.layer = v;
                                        var w = t[y];
                                        void 0 === w && (w = t[y] = []), w.push({
                                            featureIndex: r,
                                            feature: b,
                                            intersectionZ: x
                                        })
                                    }
                                }
                            }
                        }
                    }
                }, vp.prototype.lookupSymbolFeatures = function (t, e, i, r, n, a, o, s) {
                    var l = {};
                    this.loadVTLayers();
                    for (var u = no(n), h = 0, c = t; h < c.length; h += 1) this.loadMatchingFeature(l, i, r, c[h], u, a, o, s, e);
                    return l
                }, vp.prototype.hasLayer = function (t) {
                    for (var e = 0, i = this.bucketLayerIDs; e < i.length; e += 1) for (var r = 0, n = i[e]; r < n.length; r += 1) if (t === n[r]) return !0;
                    return !1
                }, vp.prototype.getId = function (t, e) {
                    var i = t.id;
                    return this.promoteId && "boolean" == typeof (i = t.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[e]]) && (i = Number(i)), i
                }, e("FeatureIndex", vp, {omit: ["rawTileData", "sourceLayerCoder"]});
                var A = function (t, e) {
                    this.tileID = t, this.uid = G(), this.uses = 0, this.tileSize = e, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = !1, this.hasRTLText = !1, this.dependencies = {}, this.expiredRequestCount = 0, this.state = "loading"
                };
                A.prototype.registerFadeDuration = function (t) {
                    var e = t + this.timeAdded;
                    e < gt.now() || this.fadeEndTime && e < this.fadeEndTime || (this.fadeEndTime = e)
                }, A.prototype.wasRequested = function () {
                    return "errored" === this.state || "loaded" === this.state || "reloading" === this.state
                }, A.prototype.loadVectorData = function (t, e, i) {
                    if (this.hasData() && this.unloadVectorData(), this.state = "loaded", t) {
                        for (var r in t.featureIndex && (this.latestFeatureIndex = t.featureIndex, t.rawTileData ? (this.latestRawTileData = t.rawTileData, this.latestFeatureIndex.rawTileData = t.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t.collisionBoxArray, this.buckets = function (t, n) {
                            var a = {};
                            if (!n) return a;
                            for (var e = function () {
                                var t = s[o], i = t.layerIds.map(function (t) {
                                    return n.getLayer(t)
                                }).filter(Boolean);
                                if (0 !== i.length) {
                                    t.layers = i, t.stateDependentLayerIds && (t.stateDependentLayers = t.stateDependentLayerIds.map(function (e) {
                                        return i.filter(function (t) {
                                            return t.id === e
                                        })[0]
                                    }));
                                    for (var e = 0, r = i; e < r.length; e += 1) a[r[e].id] = t
                                }
                            }, o = 0, s = t; o < s.length; o += 1) e();
                            return a
                        }(t.buckets, e.style), this.hasSymbolBuckets = !1, this.buckets) {
                            var n = this.buckets[r];
                            if (n instanceof ut) {
                                if (this.hasSymbolBuckets = !0, !i) break;
                                n.justReloaded = !0
                            }
                        }
                        if (this.hasRTLText = !1, this.hasSymbolBuckets) for (var a in this.buckets) {
                            var o = this.buckets[a];
                            if (o instanceof ut && o.hasRTLText) {
                                this.hasRTLText = !0, Wo.isLoading() || Wo.isLoaded() || "deferred" !== Go() || Zo();
                                break
                            }
                        }
                        for (var s in this.queryPadding = 0, this.buckets) {
                            var l = this.buckets[s];
                            this.queryPadding = Math.max(this.queryPadding, e.style.getLayer(s).queryRadius(l))
                        }
                        t.imageAtlas && (this.imageAtlas = t.imageAtlas), t.glyphAtlasImage && (this.glyphAtlasImage = t.glyphAtlasImage)
                    } else this.collisionBoxArray = new ks
                }, A.prototype.unloadVectorData = function () {
                    for (var t in this.buckets) this.buckets[t].destroy();
                    this.buckets = {}, this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.imageAtlas && (this.imageAtlas = null), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.latestFeatureIndex = null, this.state = "unloaded"
                }, A.prototype.getBucket = function (t) {
                    return this.buckets[t.id]
                }, A.prototype.upload = function (t) {
                    for (var e in this.buckets) {
                        var i = this.buckets[e];
                        i.uploadPending() && i.upload(t)
                    }
                    var r = t.gl;
                    this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new rp(t, this.imageAtlas.image, r.RGBA), this.imageAtlas.uploaded = !0), this.glyphAtlasImage && (this.glyphAtlasTexture = new rp(t, this.glyphAtlasImage, r.ALPHA), this.glyphAtlasImage = null)
                }, A.prototype.prepare = function (t) {
                    this.imageAtlas && this.imageAtlas.patchUpdatedImages(t, this.imageAtlasTexture)
                }, A.prototype.queryRenderedFeatures = function (t, e, i, r, n, a, o, s, l, u) {
                    return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({
                        queryGeometry: r,
                        cameraQueryGeometry: n,
                        scale: a,
                        tileSize: this.tileSize,
                        pixelPosMatrix: u,
                        transform: s,
                        params: o,
                        queryPadding: this.queryPadding * l
                    }, t, e, i) : {}
                }, A.prototype.querySourceFeatures = function (t, e) {
                    var i = this.latestFeatureIndex;
                    if (i && i.rawTileData) {
                        var r = i.loadVTLayers(), n = e ? e.sourceLayer : "", a = r._geojsonTileLayer || r[n];
                        if (a) for (var o = no(e && e.filter), s = this.tileID.canonical, l = s.z, u = s.x, h = s.y, c = {
                            z: l,
                            x: u,
                            y: h
                        }, p = 0; p < a.length; p++) {
                            var f = a.feature(p);
                            if (o.filter(new j(this.tileID.overscaledZ), f)) {
                                var d = i.getId(f, n), m = new yp(f, l, u, h, d);
                                m.tile = c, t.push(m)
                            }
                        }
                    }
                }, A.prototype.hasData = function () {
                    return "loaded" === this.state || "reloading" === this.state || "expired" === this.state
                }, A.prototype.patternsLoaded = function () {
                    return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length
                }, A.prototype.setExpiryData = function (t) {
                    var e = this.expirationTime;
                    if (t.cacheControl) {
                        var i = nt(t.cacheControl);
                        i["max-age"] && (this.expirationTime = Date.now() + 1e3 * i["max-age"])
                    } else t.expires && (this.expirationTime = new Date(t.expires).getTime());
                    if (this.expirationTime) {
                        var r = Date.now(), n = !1;
                        if (this.expirationTime > r) n = !1; else if (e) if (this.expirationTime < e) n = !0; else {
                            var a = this.expirationTime - e;
                            a ? this.expirationTime = r + Math.max(a, 3e4) : n = !0
                        } else n = !0;
                        n ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0
                    }
                }, A.prototype.getExpiryTimeout = function () {
                    if (this.expirationTime) return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - (new Date).getTime(), Math.pow(2, 31) - 1)
                }, A.prototype.setFeatureState = function (t, e) {
                    if (this.latestFeatureIndex && this.latestFeatureIndex.rawTileData && 0 !== Object.keys(t).length) {
                        var i = this.latestFeatureIndex.loadVTLayers();
                        for (var r in this.buckets) if (e.style.hasLayer(r)) {
                            var n = this.buckets[r], a = n.layers[0].sourceLayer || "_geojsonTileLayer", o = i[a],
                                s = t[a];
                            if (o && s && 0 !== Object.keys(s).length) {
                                n.update(s, o, this.imageAtlas && this.imageAtlas.patternPositions || {});
                                var l = e && e.style && e.style.getLayer(r);
                                l && (this.queryPadding = Math.max(this.queryPadding, l.queryRadius(n)))
                            }
                        }
                    }
                }, A.prototype.holdingForFade = function () {
                    return void 0 !== this.symbolFadeHoldUntil
                }, A.prototype.symbolFadeFinished = function () {
                    return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < gt.now()
                }, A.prototype.clearFadeHold = function () {
                    this.symbolFadeHoldUntil = void 0
                }, A.prototype.setHoldDuration = function (t) {
                    this.symbolFadeHoldUntil = gt.now() + t
                }, A.prototype.setDependencies = function (t, e) {
                    for (var i = {}, r = 0, n = e; r < n.length; r += 1) i[n[r]] = !0;
                    this.dependencies[t] = i
                }, A.prototype.hasDependency = function (t, e) {
                    for (var i = 0, r = t; i < r.length; i += 1) {
                        var n = this.dependencies[r[i]];
                        if (n) for (var a = 0, o = e; a < o.length; a += 1) if (n[o[a]]) return !0
                    }
                    return !1
                };
                var Mp = c.performance, Sp = function (t) {
                    this._marks = {
                        start: [t.url, "start"].join("#"),
                        end: [t.url, "end"].join("#"),
                        measure: t.url.toString()
                    }, Mp.mark(this._marks.start)
                };
                Sp.prototype.finish = function () {
                    Mp.mark(this._marks.end);
                    var t = Mp.getEntriesByName(this._marks.measure);
                    return 0 === t.length && (Mp.measure(this._marks.measure, this._marks.start, this._marks.end), t = Mp.getEntriesByName(this._marks.measure), Mp.clearMarks(this._marks.start), Mp.clearMarks(this._marks.end), Mp.clearMeasures(this._marks.measure)), t
                }, t.Actor = ap, t.AlphaImage = ja, t.CanonicalTileID = cp, t.CollisionBoxArray = ks, t.Color = S, t.DEMData = dp, t.DataConstantProperty = i, t.DictionaryCoder = mp, t.EXTENT = 8192, t.ErrorEvent = Wa, t.EvaluationParameters = j, t.Event = Za, t.Evented = Xa, t.Feature = yp, t.FeatureIndex = vp, t.FillBucket = Lu, t.FillExtrusionBucket = Yu, t.ImageAtlas = Zh, t.ImagePosition = qh, t.LineBucket = sh, t.LngLat = h, t.LngLatBounds = l, t.MercatorCoordinate = hp, t.ONE_EM = 24, t.OverscaledTileID = I, t.Point = W, t.Point$1 = W, t.Properties = ns, t.Protobuf = wh, t.RGBAImage = x, t.RequestManager = ji, t.RequestPerformance = Sp, t.ResourceType = cr, t.SegmentVector = L, t.SourceFeatureState = _p, t.StructArrayLayout1ui2 = Ps, t.StructArrayLayout2f1f2i16 = xs, t.StructArrayLayout2i4 = us, t.StructArrayLayout3ui6 = ws, t.StructArrayLayout4i8 = hs, t.SymbolBucket = ut, t.Texture = rp, t.Tile = A, t.Transitionable = Ko, t.Uniform1f = tl, t.Uniform1i = $s, t.Uniform2f = el, t.Uniform3f = il, t.Uniform4f = rl, t.UniformColor = nl, t.UniformMatrix4f = ol, t.UnwrappedTileID = pp, t.ValidationError = m, t.WritingMode = Wh, t.ZoomHistory = zo, t.add = function (t, e, i) {
                    return t[0] = e[0] + i[0], t[1] = e[1] + i[1], t[2] = e[2] + i[2], t
                }, t.addDynamicAttributes = Fc, t.aea = _i, t.aeqd = Pi, t.asyncAll = function (t, e, r) {
                    if (!t.length) return r(null, []);
                    var n = t.length, a = new Array(t.length), o = null;
                    t.forEach(function (t, i) {
                        e(t, function (t, e) {
                            t && (o = t), a[i] = e, 0 == --n && r(o, a)
                        })
                    })
                }, t.bezier = O, t.bindAll = H, t.browser = gt, t.cacheEntryPossiblyAdded = function (t) {
                    ++ur > ar && (t.getActor().send("enforceCacheSizeLimit", nr), ur = 0)
                }, t.cass = di, t.cea = xi, t.clamp = U, t.clearTileCache = function (t) {
                    var e = c.caches.delete("mapbox-tiles");
                    t && e.catch(t).then(function () {
                        return t()
                    })
                }, t.clipLine = gc, t.clone = function (t) {
                    var e = new Fl(16);
                    return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e
                }, t.clone$1 = $, t.clone$2 = function (t) {
                    var e = new Fl(3);
                    return e[0] = t[0], e[1] = t[1], e[2] = t[2], e
                }, t.collisionCircleLayout = gh, t.config = u, t.create = function () {
                    var t = new Fl(16);
                    return Fl != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0), t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t
                }, t.create$1 = function () {
                    var t = new Fl(9);
                    return Fl != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0), t[0] = 1, t[4] = 1, t[8] = 1, t
                }, t.create$2 = function () {
                    var t = new Fl(4);
                    return Fl != Float32Array && (t[1] = 0, t[2] = 0), t[0] = 1, t[3] = 1, t
                }, t.createCommonjsModule = z, t.createExpression = Ia, t.createLayout = o, t.createStyleLayer = function (t) {
                    return "custom" === t.type ? new Yc(t) : new Jc[t.type](t)
                }, t.cross = function (t, e, i) {
                    var r = e[0], n = e[1], a = e[2], o = i[0], s = i[1], l = i[2];
                    return t[0] = n * l - a * s, t[1] = a * o - r * l, t[2] = r * s - n * o, t
                }, t.deepEqual = function t(e, i) {
                    if (Array.isArray(e)) {
                        if (!Array.isArray(i) || e.length !== i.length) return !1;
                        for (var r = 0; r < e.length; r++) if (!t(e[r], i[r])) return !1;
                        return !0
                    }
                    if ("object" == typeof e && null !== e && null !== i) {
                        if ("object" != typeof i) return !1;
                        if (Object.keys(e).length !== Object.keys(i).length) return !1;
                        for (var n in e) if (!t(e[n], i[n])) return !1;
                        return !0
                    }
                    return e === i
                }, t.dot = function (t, e) {
                    return t[0] * e[0] + t[1] * e[1] + t[2] * e[2]
                }, t.dot$1 = function (t, e) {
                    return t[0] * e[0] + t[1] * e[1] + t[2] * e[2] + t[3] * e[3]
                }, t.ease = F, t.emitValidationErrors = Ao, t.endsWith = Y, t.enforceCacheSizeLimit = function (r) {
                    or(), Ji && Ji.then(function (i) {
                        i.keys().then(function (t) {
                            for (var e = 0; e < t.length - r; e++) i.delete(t[e])
                        })
                    })
                }, t.eqc = bi, t.eqdc = Ti, t.etmerc = Ye, t.evaluateSizeForFeature = lc, t.evaluateSizeForZoom = uc, t.evaluateVariableOffset = Ac, t.evented = qo, t.extend = V, t.featureFilter = no, t.filterObject = Q, t.fromRotation = function (t, e) {
                    var i = Math.sin(e), r = Math.cos(e);
                    return t[0] = r, t[1] = i, t[2] = 0, t[3] = -i, t[4] = r, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t
                },t.geocent = Fi,t.geos = Vi,t.getAnchorAlignment = rc,t.getAnchorJustification = zc,t.getArrayBuffer = gr,t.getImage = vr,t.getJSON = function (t, e) {
                    return yr(V(t, {type: "json"}), e)
                },t.getRTLTextPluginStatus = Go,t.getReferrer = fr,t.getVideo = function (t, e) {
                    var i, r, n = c.document.createElement("video");
                    n.muted = !0, n.onloadstart = function () {
                        e(null, n)
                    };
                    for (var a = 0; a < t.length; a++) {
                        var o = c.document.createElement("source");
                        i = t[a], r = void 0, (r = c.document.createElement("a")).href = i, (r.protocol !== c.document.location.protocol || r.host !== c.document.location.host) && (n.crossOrigin = "Anonymous"), o.src = t[a], n.appendChild(o)
                    }
                    return {
                        cancel: function () {
                        }
                    }
                },t.gnom = vi,t.identity = Ul,t.invert = function (t, e) {
                    var i = e[0], r = e[1], n = e[2], a = e[3], o = e[4], s = e[5], l = e[6], u = e[7], h = e[8],
                        c = e[9], p = e[10], f = e[11], d = e[12], m = e[13], y = e[14], g = e[15], _ = i * s - r * o,
                        v = i * l - n * o, x = i * u - a * o, b = r * l - n * s, w = r * u - a * s, M = n * u - a * l,
                        S = h * m - c * d, E = h * y - p * d, I = h * g - f * d, T = c * y - p * m, C = c * g - f * m,
                        P = p * g - f * y, A = _ * P - v * C + x * T + b * I - w * E + M * S;
                    return A ? (t[0] = (s * P - l * C + u * T) * (A = 1 / A), t[1] = (n * C - r * P - a * T) * A, t[2] = (m * M - y * w + g * b) * A, t[3] = (p * w - c * M - f * b) * A, t[4] = (l * I - o * P - u * E) * A, t[5] = (i * P - n * I + a * E) * A, t[6] = (y * x - d * M - g * v) * A, t[7] = (h * M - p * x + f * v) * A, t[8] = (o * C - s * I + u * S) * A, t[9] = (r * I - i * C - a * S) * A, t[10] = (d * w - m * x + g * _) * A, t[11] = (c * x - h * w - f * _) * A, t[12] = (s * E - o * T - l * S) * A, t[13] = (i * T - r * E + n * S) * A, t[14] = (m * v - d * b - y * _) * A, t[15] = (h * b - c * v + p * _) * A, t) : null
                },t.isChar = K,t.isMapboxURL = qi,t.keysDifference = function (t, e) {
                    var i = [];
                    for (var r in t) r in e || i.push(r);
                    return i
                },t.krovak = ai,t.laea = yi,t.lcc = ni,t.makeRequest = yr,t.mapObject = J,t.mercatorZfromAltitude = lp,t.mill = Si,t.moll = Ii,t.mul = jl,t.multiply = Nl,t.mvt = Wu,t.nextPowerOfTwo = function (t) {
                    return t <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t) / Math.LN2))
                },t.normalize = function (t, e) {
                    var i = e[0], r = e[1], n = e[2], a = i * i + r * r + n * n;
                    return a > 0 && (a = 1 / Math.sqrt(a)), t[0] = e[0] * a, t[1] = e[1] * a, t[2] = e[2] * a, t
                },t.number = E,t.nzmg = Mi,t.offscreenCanvasSupported = hr,t.omerc = ri,t.ortho = function (t, e, i, r, n, a, o) {
                    var s = 1 / (e - i), l = 1 / (r - n), u = 1 / (a - o);
                    return t[0] = -2 * s, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * l, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * u, t[11] = 0, t[12] = (e + i) * s, t[13] = (n + r) * l, t[14] = (o + a) * u, t[15] = 1, t
                },t.ortho$1 = Ai,t.parseCode = Zt,t.parseGlyphPBF = function (t) {
                    return new wh(t).readFields(Uh, [])
                },t.pbf = wh,t.performSymbolLayout = function (C, P, A, z, k, t, L) {
                    C.createArrays(), C.tilePixelRatio = 8192 / (512 * C.overscaling), C.compareText = {}, C.iconsNeedLinear = !1;
                    var D = C.layers[0].layout, e = C.layers[0]._unevaluatedLayout._values, R = {};
                    if ("composite" === C.textSizeData.kind) {
                        var i = C.textSizeData, r = i.maxZoom;
                        R.compositeTextSizes = [e["text-size"].possiblyEvaluate(new j(i.minZoom), L), e["text-size"].possiblyEvaluate(new j(r), L)]
                    }
                    if ("composite" === C.iconSizeData.kind) {
                        var n = C.iconSizeData, a = n.maxZoom;
                        R.compositeIconSizes = [e["icon-size"].possiblyEvaluate(new j(n.minZoom), L), e["icon-size"].possiblyEvaluate(new j(a), L)]
                    }
                    R.layoutTextSize = e["text-size"].possiblyEvaluate(new j(C.zoom + 1), L), R.layoutIconSize = e["icon-size"].possiblyEvaluate(new j(C.zoom + 1), L), R.textMaxSize = e["text-size"].possiblyEvaluate(new j(18));
                    for (var B = 24 * D.get("text-line-height"), O = "map" === D.get("text-rotation-alignment") && "point" !== D.get("symbol-placement"), F = D.get("text-keep-upright"), U = D.get("text-size"), o = function () {
                        var t = V[N], e = D.get("text-font").evaluate(t, {}, L).join(","), i = U.evaluate(t, {}, L),
                            r = R.layoutTextSize.evaluate(t, {}, L), n = R.layoutIconSize.evaluate(t, {}, L),
                            a = {horizontal: {}, vertical: void 0}, o = t.text, s = [0, 0];
                        if (o) {
                            var l = o.toString(), u = 24 * D.get("text-letter-spacing").evaluate(t, {}, L),
                                h = function (t) {
                                    for (var e = 0, i = t; e < i.length; e += 1) if (r = i[e].charCodeAt(0), K.Arabic(r) || K["Arabic Supplement"](r) || K["Arabic Extended-A"](r) || K["Arabic Presentation Forms-A"](r) || K["Arabic Presentation Forms-B"](r)) return !1;
                                    var r;
                                    return !0
                                }(l) ? u : 0, c = D.get("text-anchor").evaluate(t, {}, L),
                                p = D.get("text-variable-anchor");
                            if (!p) {
                                var f = D.get("text-radial-offset").evaluate(t, {}, L);
                                s = f ? Ac(c, [24 * f, Pc]) : D.get("text-offset").evaluate(t, {}, L).map(function (t) {
                                    return 24 * t
                                })
                            }
                            var d = O ? "center" : D.get("text-justify").evaluate(t, {}, L),
                                m = D.get("symbol-placement"),
                                y = "point" === m ? 24 * D.get("text-max-width").evaluate(t, {}, L) : 0,
                                g = function () {
                                    C.allowVerticalPlacement && ko(l) && (a.vertical = Kh(o, P, A, k, e, y, B, c, "left", h, s, Wh.vertical, !0, m, r, i))
                                };
                            if (!O && p) {
                                for (var _ = "auto" === d ? p.map(function (t) {
                                    return zc(t)
                                }) : [d], v = !1, x = 0; x < _.length; x++) {
                                    var b = _[x];
                                    if (!a.horizontal[b]) if (v) a.horizontal[b] = a.horizontal[0]; else {
                                        var w = Kh(o, P, A, k, e, y, B, "center", b, h, s, Wh.horizontal, !1, m, r, i);
                                        w && (a.horizontal[b] = w, v = 1 === w.positionedLines.length)
                                    }
                                }
                                g()
                            } else {
                                "auto" === d && (d = zc(c));
                                var M = Kh(o, P, A, k, e, y, B, c, d, h, s, Wh.horizontal, !1, m, r, i);
                                M && (a.horizontal[d] = M), g(), ko(l) && O && F && (a.vertical = Kh(o, P, A, k, e, y, B, c, d, h, s, Wh.vertical, !1, m, r, i))
                            }
                        }
                        var S = void 0, E = !1;
                        if (t.icon && t.icon.name) {
                            var I = z[t.icon.name];
                            I && (S = function (t, e, i) {
                                var r = rc(i), n = e[0] - t.displaySize[0] * r.horizontalAlign,
                                    a = e[1] - t.displaySize[1] * r.verticalAlign;
                                return {
                                    image: t,
                                    top: a,
                                    bottom: a + t.displaySize[1],
                                    left: n,
                                    right: n + t.displaySize[0]
                                }
                            }(k[t.icon.name], D.get("icon-offset").evaluate(t, {}, L), D.get("icon-anchor").evaluate(t, {}, L)), E = I.sdf, void 0 === C.sdfIcons ? C.sdfIcons = I.sdf : C.sdfIcons !== I.sdf && ht("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (I.pixelRatio !== C.pixelRatio || 0 !== D.get("icon-rotate").constantOr(1)) && (C.iconsNeedLinear = !0))
                        }
                        var T = Lc(a.horizontal) || a.vertical;
                        C.iconsInText = !!T && T.iconsInText, (T || S) && function (i, r, n, a, B, o, s, O, F, U, l) {
                            var t = o.textMaxSize.evaluate(r, {});
                            void 0 === t && (t = s);
                            var u, e = i.layers[0].layout, h = e.get("icon-offset").evaluate(r, {}, l),
                                c = Lc(n.horizontal), p = s / 24, N = i.tilePixelRatio * p,
                                f = i.tilePixelRatio * t / 24, V = i.tilePixelRatio * O,
                                d = i.tilePixelRatio * e.get("symbol-spacing"),
                                j = e.get("text-padding") * i.tilePixelRatio,
                                q = e.get("icon-padding") * i.tilePixelRatio,
                                m = e.get("text-max-angle") / 180 * Math.PI,
                                G = "map" === e.get("text-rotation-alignment") && "point" !== e.get("symbol-placement"),
                                Z = "map" === e.get("icon-rotation-alignment") && "point" !== e.get("symbol-placement"),
                                y = e.get("symbol-placement"), W = d / 2, g = e.get("icon-text-fit");
                            a && "none" !== g && (i.allowVerticalPlacement && n.vertical && (u = ac(a, n.vertical, g, e.get("icon-text-fit-padding"), h, p)), c && (a = ac(a, c, g, e.get("icon-text-fit-padding"), h, p)));
                            var _ = function (t, e) {
                                e.x < 0 || e.x >= 8192 || e.y < 0 || e.y >= 8192 || function (t, e, B, i, r, n, a, o, s, l, u, h, c, p, f, d, m, y, O, F, g, _, U, v, N) {
                                    var V, x, b, w, M, S = t.addToLineVertexArray(e, B), j = 0, q = 0, G = 0, Z = 0,
                                        E = -1, I = -1, T = {}, W = Ws(""), C = 0, P = 0;
                                    if (void 0 === o._unevaluatedLayout.getValue("text-radial-offset") ? (C = (V = o.layout.get("text-offset").evaluate(g, {}, v).map(function (t) {
                                        return 24 * t
                                    }))[0], P = V[1]) : (C = 24 * o.layout.get("text-radial-offset").evaluate(g, {}, v), P = Pc), t.allowVerticalPlacement && i.vertical) {
                                        var X = o.layout.get("text-rotate").evaluate(g, {}, v) + 90;
                                        w = new Mc(s, e, l, u, h, i.vertical, c, p, f, X), a && (M = new Mc(s, e, l, u, h, a, m, y, f, X))
                                    }
                                    if (r) {
                                        var A = o.layout.get("icon-rotate").evaluate(g, {}),
                                            H = "none" !== o.layout.get("icon-text-fit"), K = _c(r, A, U, H),
                                            z = a ? _c(a, A, U, H) : void 0;
                                        b = new Mc(s, e, l, u, h, r, m, y, !1, A), j = 4 * K.length;
                                        var Y = t.iconSizeData, k = null;
                                        "source" === Y.kind ? (k = [128 * o.layout.get("icon-size").evaluate(g, {})])[0] > 32640 && ht(t.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".') : "composite" === Y.kind && ((k = [128 * _.compositeIconSizes[0].evaluate(g, {}, v), 128 * _.compositeIconSizes[1].evaluate(g, {}, v)])[0] > 32640 || k[1] > 32640) && ht(t.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".'), t.addSymbols(t.icon, K, k, F, O, g, !1, e, S.lineStartIndex, S.lineLength, -1, v), E = t.icon.placedSymbolArray.length - 1, z && (q = 4 * z.length, t.addSymbols(t.icon, z, k, F, O, g, Wh.vertical, e, S.lineStartIndex, S.lineLength, -1, v), I = t.icon.placedSymbolArray.length - 1)
                                    }
                                    for (var J in i.horizontal) {
                                        var L = i.horizontal[J];
                                        if (!x) {
                                            W = Ws(L.text);
                                            var Q = o.layout.get("text-rotate").evaluate(g, {}, v);
                                            x = new Mc(s, e, l, u, h, L, c, p, f, Q)
                                        }
                                        var $ = 1 === L.positionedLines.length;
                                        if (G += kc(t, e, L, n, o, f, g, d, S, i.vertical ? Wh.horizontal : Wh.horizontalOnly, $ ? Object.keys(i.horizontal) : [J], T, E, _, v), $) break
                                    }
                                    i.vertical && (Z += kc(t, e, i.vertical, n, o, f, g, d, S, Wh.vertical, ["vertical"], T, I, _, v));
                                    var tt = x ? x.boxStartIndex : t.collisionBoxArray.length,
                                        et = x ? x.boxEndIndex : t.collisionBoxArray.length,
                                        it = w ? w.boxStartIndex : t.collisionBoxArray.length,
                                        rt = w ? w.boxEndIndex : t.collisionBoxArray.length,
                                        nt = b ? b.boxStartIndex : t.collisionBoxArray.length,
                                        at = b ? b.boxEndIndex : t.collisionBoxArray.length,
                                        ot = M ? M.boxStartIndex : t.collisionBoxArray.length,
                                        st = M ? M.boxEndIndex : t.collisionBoxArray.length, D = -1,
                                        R = function (t, e) {
                                            return t && t.circleDiameter ? Math.max(t.circleDiameter, e) : e
                                        };
                                    D = R(x, D), D = R(w, D), D = R(b, D);
                                    var lt = (D = R(M, D)) > -1 ? 1 : 0;
                                    lt && (D *= N / 24), t.glyphOffsetArray.length >= ut.MAX_GLYPHS && ht("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"), void 0 !== g.sortKey && t.addToSortKeyRanges(t.symbolInstances.length, g.sortKey), t.symbolInstances.emplaceBack(e.x, e.y, T.right >= 0 ? T.right : -1, T.center >= 0 ? T.center : -1, T.left >= 0 ? T.left : -1, T.vertical || -1, E, I, W, tt, et, it, rt, nt, at, ot, st, l, G, Z, j, q, lt, 0, c, C, P, D)
                                }(i, e, t, n, a, B, u, i.layers[0], i.collisionBoxArray, r.index, r.sourceLayerIndex, i.index, N, j, G, F, V, q, Z, h, r, o, U, l, s)
                            };
                            if ("line" === y) for (var v = 0, x = gc(r.geometry, 0, 0, 8192, 8192); v < x.length; v += 1) for (var b = x[v], w = 0, M = yc(b, d, m, n.vertical || c, a, 24, f, i.overscaling, 8192); w < M.length; w += 1) {
                                var S = M[w];
                                c && Dc(i, c.text, W, S) || _(b, S)
                            } else if ("line-center" === y) for (var E = 0, I = r.geometry; E < I.length; E += 1) {
                                var T = I[E];
                                if (T.length > 1) {
                                    var C = mc(T, m, n.vertical || c, a, 24, f);
                                    C && _(T, C)
                                }
                            } else if ("Polygon" === r.type) for (var P = 0, A = Pu(r.geometry, 0); P < A.length; P += 1) {
                                var X = A[P], H = Ic(X, 16);
                                _(X[0], new oc(H.x, H.y, 0))
                            } else if ("LineString" === r.type) for (var z = 0, K = r.geometry; z < K.length; z += 1) {
                                var k = K[z];
                                _(k, new oc(k[0].x, k[0].y, 0))
                            } else if ("Point" === r.type) for (var L = 0, Y = r.geometry; L < Y.length; L += 1) for (var D = 0, J = Y[L]; D < J.length; D += 1) {
                                var R = J[D];
                                _([R], new oc(R.x, R.y, 0))
                            }
                        }(C, t, a, S, z, R, r, n, s, E, L)
                    }, N = 0, V = C.features; N < V.length; N += 1) o();
                    t && C.generateCollisionDebugBuffers()
                },t.perspective = function (t, e, i, r, n) {
                    var a, o = 1 / Math.tan(e / 2);
                    return t[0] = o / i, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = o, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != n && n !== 1 / 0 ? (t[10] = (n + r) * (a = 1 / (r - n)), t[14] = 2 * n * r * a) : (t[10] = -1, t[14] = -2 * r), t
                },t.pick = function (t, e) {
                    for (var i = {}, r = 0; r < e.length; r++) {
                        var n = e[r];
                        n in t && (i[n] = t[n])
                    }
                    return i
                },t.plugin = Wo,t.poly = wi,t.polygonIntersectsPolygon = wl,t.postMapLoadEvent = rr,t.postTurnstileEvent = er,t.potpack = jh,t.proj4 = Te,t.qsc = Li,t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"],t.register = e,t.registerForPluginStateChange = function (t) {
                    return t({pluginStatus: Uo, pluginURL: No}), qo.on("pluginStateChange", t), t
                },t.renderColorRamp = Hl,t.robin = Oi,t.rotate = function (t, e, i) {
                    var r = e[0], n = e[1], a = e[2], o = e[3], s = Math.sin(i), l = Math.cos(i);
                    return t[0] = r * l + a * s, t[1] = n * l + o * s, t[2] = r * -s + a * l, t[3] = n * -s + o * l, t
                },t.rotateX = function (t, e, i) {
                    var r = Math.sin(i), n = Math.cos(i), a = e[4], o = e[5], s = e[6], l = e[7], u = e[8], h = e[9],
                        c = e[10], p = e[11];
                    return e !== t && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[4] = a * n + u * r, t[5] = o * n + h * r, t[6] = s * n + c * r, t[7] = l * n + p * r, t[8] = u * n - a * r, t[9] = h * n - o * r, t[10] = c * n - s * r, t[11] = p * n - l * r, t
                },t.rotateZ = function (t, e, i) {
                    var r = Math.sin(i), n = Math.cos(i), a = e[0], o = e[1], s = e[2], l = e[3], u = e[4], h = e[5],
                        c = e[6], p = e[7];
                    return e !== t && (t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = a * n + u * r, t[1] = o * n + h * r, t[2] = s * n + c * r, t[3] = l * n + p * r, t[4] = u * n - a * r, t[5] = h * n - o * r, t[6] = c * n - s * r, t[7] = p * n - l * r, t
                },t.scale = function (t, e, i) {
                    var r = i[0], n = i[1], a = i[2];
                    return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t[3] = e[3] * r, t[4] = e[4] * n, t[5] = e[5] * n, t[6] = e[6] * n, t[7] = e[7] * n, t[8] = e[8] * a, t[9] = e[9] * a, t[10] = e[10] * a, t[11] = e[11] * a, t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t
                },t.scale$1 = function (t, e, i) {
                    return t[0] = e[0] * i, t[1] = e[1] * i, t[2] = e[2] * i, t[3] = e[3] * i, t
                },t.scale$2 = function (t, e, i) {
                    return t[0] = e[0] * i, t[1] = e[1] * i, t[2] = e[2] * i, t
                },t.setCacheLimits = function (t, e) {
                    nr = t, ar = e
                },t.setRTLTextPlugin = function (t, e, i) {
                    if (void 0 === i && (i = !1), "deferred" === Uo || "loading" === Uo || "loaded" === Uo) throw new Error("setRTLTextPlugin cannot be called multiple times.");
                    No = gt.resolveURL(t), Uo = "deferred", Fo = e, jo(), i || Zo()
                },t.sinu = Ei,t.somerc = ii,t.sphericalToCartesian = function (t) {
                    var e = t[0], i = t[1], r = t[2];
                    return i += 90, i *= Math.PI / 180, r *= Math.PI / 180, {
                        x: e * Math.cos(i) * Math.sin(r),
                        y: e * Math.sin(i) * Math.sin(r),
                        z: e * Math.cos(r)
                    }
                },t.sqrLen = function (t) {
                    var e = t[0], i = t[1];
                    return e * e + i * i
                },t.stere = ei,t.sterea = ti,t.styleSpec = a,t.sub = function (t, e, i) {
                    return t[0] = e[0] - i[0], t[1] = e[1] - i[1], t[2] = e[2] - i[2], t
                },t.symbolSize = hc,t.tmerc = Ze,t.tpers = Ni,t.transformMat3 = function (t, e, i) {
                    var r = e[0], n = e[1], a = e[2];
                    return t[0] = r * i[0] + n * i[3] + a * i[6], t[1] = r * i[1] + n * i[4] + a * i[7], t[2] = r * i[2] + n * i[5] + a * i[8], t
                },t.transformMat4 = ql,t.translate = function (t, e, i) {
                    var r, n, a, o, s, l, u, h, c, p, f, d, m = i[0], y = i[1], g = i[2];
                    return e === t ? (t[12] = e[0] * m + e[4] * y + e[8] * g + e[12], t[13] = e[1] * m + e[5] * y + e[9] * g + e[13], t[14] = e[2] * m + e[6] * y + e[10] * g + e[14], t[15] = e[3] * m + e[7] * y + e[11] * g + e[15]) : (n = e[1], a = e[2], o = e[3], s = e[4], l = e[5], u = e[6], h = e[7], c = e[8], p = e[9], f = e[10], d = e[11], t[0] = r = e[0], t[1] = n, t[2] = a, t[3] = o, t[4] = s, t[5] = l, t[6] = u, t[7] = h, t[8] = c, t[9] = p, t[10] = f, t[11] = d, t[12] = r * m + s * y + c * g + e[12], t[13] = n * m + l * y + p * g + e[13], t[14] = a * m + u * y + f * g + e[14], t[15] = o * m + h * y + d * g + e[15]), t
                },t.triggerPluginCompletionEvent = Vo,t.uniqueId = G,t.utm = Je,t.validateCustomStyleLayer = function (t) {
                    var e = [], i = t.id;
                    return void 0 === i && e.push({message: "layers." + i + ': missing required property "id"'}), void 0 === t.render && e.push({message: "layers." + i + ': missing required method "render"'}), t.renderingMode && "2d" !== t.renderingMode && "3d" !== t.renderingMode && e.push({message: "layers." + i + ': property "renderingMode" must be either "2d" or "3d"'}), e
                },t.validateLight = To,t.validateStyle = Io,t.values = function (t) {
                    var e = [];
                    for (var i in t) e.push(t[i]);
                    return e
                },t.vandg = Ci,t.version = "1.12.1-3",t.warnOnce = ht,t.webpSupported = _t,t.window = c,t.wrap = N
            }), t(["./shared"], function (A) {
                "use strict";

                function l(t) {
                    var e = typeof t;
                    if ("number" === e || "boolean" === e || "string" === e || null == t) return JSON.stringify(t);
                    if (Array.isArray(t)) {
                        for (var i = "[", r = 0, n = t; r < n.length; r += 1) i += l(n[r]) + ",";
                        return i + "]"
                    }
                    for (var a = Object.keys(t).sort(), o = "{", s = 0; s < a.length; s++) o += JSON.stringify(a[s]) + ":" + l(t[a[s]]) + ",";
                    return o + "}"
                }

                function F(t) {
                    for (var e = "", i = 0, r = A.refProperties; i < r.length; i += 1) e += "/" + l(t[r[i]]);
                    return e
                }

                var i = function (t) {
                    this.keyCache = {}, t && this.replace(t)
                };
                i.prototype.replace = function (t) {
                    this._layerConfigs = {}, this._layers = {}, this.update(t, [])
                }, i.prototype.update = function (t, e) {
                    for (var i = this, r = 0, n = t; r < n.length; r += 1) {
                        var a = n[r];
                        this._layerConfigs[a.id] = a;
                        var o = this._layers[a.id] = A.createStyleLayer(a);
                        o._featureFilter = A.featureFilter(o.filter), this.keyCache[a.id] && delete this.keyCache[a.id]
                    }
                    for (var s = 0, l = e; s < l.length; s += 1) {
                        var u = l[s];
                        delete this.keyCache[u], delete this._layerConfigs[u], delete this._layers[u]
                    }
                    this.familiesBySource = {};
                    for (var h = 0, c = function (t, e) {
                        for (var i = {}, r = 0; r < t.length; r++) {
                            var n = e && e[t[r].id] || F(t[r]);
                            e && (e[t[r].id] = n);
                            var a = i[n];
                            a || (a = i[n] = []), a.push(t[r])
                        }
                        var o = [];
                        for (var s in i) o.push(i[s]);
                        return o
                    }(A.values(this._layerConfigs), this.keyCache); h < c.length; h += 1) {
                        var p = c[h].map(function (t) {
                            return i._layers[t.id]
                        }), f = p[0];
                        if ("none" !== f.visibility) {
                            var d = f.source || "", m = this.familiesBySource[d];
                            m || (m = this.familiesBySource[d] = {});
                            var y = f.sourceLayer || "_geojsonTileLayer", g = m[y];
                            g || (g = m[y] = []), g.push(p)
                        }
                    }
                };
                var z = function (t) {
                    var e = {}, i = [];
                    for (var r in t) {
                        var n = t[r], a = e[r] = {};
                        for (var o in n) {
                            var s = n[+o];
                            if (s && 0 !== s.bitmap.width && 0 !== s.bitmap.height) {
                                var l = {x: 0, y: 0, w: s.bitmap.width + 2, h: s.bitmap.height + 2};
                                i.push(l), a[o] = {rect: l, metrics: s.metrics}
                            }
                        }
                    }
                    var u = A.potpack(i), h = new A.AlphaImage({width: u.w || 1, height: u.h || 1});
                    for (var c in t) {
                        var p = t[c];
                        for (var f in p) {
                            var d = p[+f];
                            if (d && 0 !== d.bitmap.width && 0 !== d.bitmap.height) {
                                var m = e[c][f].rect;
                                A.AlphaImage.copy(d.bitmap, h, {x: 0, y: 0}, {x: m.x + 1, y: m.y + 1}, d.bitmap)
                            }
                        }
                    }
                    this.image = h, this.positions = e
                };
                A.register("GlyphAtlas", z);
                var e = function (t) {
                    this.tileID = new A.OverscaledTileID(t.tileID.overscaledZ, t.tileID.wrap, t.tileID.canonical.z, t.tileID.canonical.x, t.tileID.canonical.y, t.tileID.canonical.indexExtent), this.uid = t.uid, this.zoom = t.zoom, this.pixelRatio = t.pixelRatio, this.tileSize = t.tileSize, this.source = t.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t.showCollisionBoxes, this.collectResourceTiming = !!t.collectResourceTiming, this.returnDependencies = !!t.returnDependencies, this.promoteId = t.promoteId
                };

                function k(t, e, i) {
                    for (var r = new A.EvaluationParameters(e), n = 0, a = t; n < a.length; n += 1) a[n].recalculate(r, i)
                }

                function U(t, n) {
                    var e = A.getArrayBuffer(t.request, function (t, e, i, r) {
                        t ? n(t) : e && n(null, {
                            vectorTile: new A.mvt.VectorTile(new A.pbf(e)),
                            rawData: e,
                            cacheControl: i,
                            expires: r
                        })
                    });
                    return function () {
                        e.cancel(), n()
                    }
                }

                e.prototype.parse = function (t, e, n, i, a) {
                    var r = this;
                    this.status = "parsing", this.data = t, this.collisionBoxArray = new A.CollisionBoxArray;
                    var o = new A.DictionaryCoder(Object.keys(t.layers).sort()),
                        s = new A.FeatureIndex(this.tileID, this.promoteId);
                    s.bucketLayerIDs = [];
                    var l, u, h, c, p = {}, f = {
                        featureIndex: s,
                        iconDependencies: {},
                        patternDependencies: {},
                        glyphDependencies: {},
                        availableImages: n
                    }, d = e.familiesBySource[this.source];
                    for (var m in d) {
                        var y = t.layers[m];
                        if (y) {
                            1 === y.version && A.warnOnce('Vector tile source "' + this.source + '" layer "' + m + '" does not use vector tile spec v2 and therefore may have some rendering errors.');
                            for (var g = o.encode(m), _ = [], v = 0; v < y.length; v++) {
                                var x = y.feature(v), b = s.getId(x, m);
                                _.push({feature: x, id: b, index: v, sourceLayerIndex: g})
                            }
                            for (var w = 0, M = d[m]; w < M.length; w += 1) {
                                var S = M[w], E = S[0];
                                E.minzoom && this.zoom < Math.floor(E.minzoom) || E.maxzoom && this.zoom >= E.maxzoom || "none" !== E.visibility && (k(S, this.zoom, n), (p[E.id] = E.createBucket({
                                    index: s.bucketLayerIDs.length,
                                    layers: S,
                                    zoom: this.zoom,
                                    pixelRatio: this.pixelRatio,
                                    overscaling: this.overscaling,
                                    collisionBoxArray: this.collisionBoxArray,
                                    sourceLayerIndex: g,
                                    sourceID: this.source
                                })).populate(_, f, this.tileID.canonical), s.bucketLayerIDs.push(S.map(function (t) {
                                    return t.id
                                })))
                            }
                        }
                    }
                    var I = A.mapObject(f.glyphDependencies, function (t) {
                        return Object.keys(t).map(Number)
                    });
                    Object.keys(I).length ? i.send("getGlyphs", {uid: this.uid, stacks: I}, function (t, e) {
                        l || (l = t, u = e, P.call(r))
                    }, !1, this.source) : u = {};
                    var T = Object.keys(f.iconDependencies);
                    T.length ? i.send("getImages", {
                        icons: T,
                        source: this.source,
                        tileID: this.tileID,
                        type: "icons"
                    }, function (t, e) {
                        l || (l = t, h = e, P.call(r))
                    }, !1, this.source) : h = {};
                    var C = Object.keys(f.patternDependencies);

                    function P() {
                        if (l) return a(l);
                        if (u && h && c) {
                            var t = new z(u), e = new A.ImageAtlas(h, c);
                            for (var i in p) {
                                var r = p[i];
                                r instanceof A.SymbolBucket ? (k(r.layers, this.zoom, n), A.performSymbolLayout(r, u, t.positions, h, e.iconPositions, this.showCollisionBoxes, this.tileID.canonical)) : r.hasPattern && (r instanceof A.LineBucket || r instanceof A.FillBucket || r instanceof A.FillExtrusionBucket) && (k(r.layers, this.zoom, n), r.addFeatures(f, this.tileID.canonical, e.patternPositions))
                            }
                            this.status = "done", a(null, {
                                buckets: A.values(p).filter(function (t) {
                                    return !t.isEmpty()
                                }),
                                featureIndex: s,
                                collisionBoxArray: this.collisionBoxArray,
                                glyphAtlasImage: t.image,
                                imageAtlas: e,
                                glyphMap: this.returnDependencies ? u : null,
                                iconMap: this.returnDependencies ? h : null,
                                glyphPositions: this.returnDependencies ? t.positions : null
                            })
                        }
                    }

                    C.length ? i.send("getImages", {
                        icons: C,
                        source: this.source,
                        tileID: this.tileID,
                        type: "patterns"
                    }, function (t, e) {
                        l || (l = t, c = e, P.call(r))
                    }, !1, this.source) : c = {}, P.call(this)
                };
                var r = function (t, e, i, r) {
                    this.actor = t, this.layerIndex = e, this.availableImages = i, this.loadVectorData = r || U, this.loading = {}, this.loaded = {}
                };
                r.prototype.loadTile = function (t, o) {
                    var s = this, l = t.uid;
                    this.loading || (this.loading = {});
                    var u = !!(t && t.request && t.request.collectResourceTiming) && new A.RequestPerformance(t.request),
                        h = this.loading[l] = new e(t);
                    h.abort = this.loadVectorData(t, function (t, e) {
                        if (delete s.loading[l], t || !e) return h.status = "done", s.loaded[l] = h, o(t);
                        var i = e.rawData, r = {};
                        e.expires && (r.expires = e.expires), e.cacheControl && (r.cacheControl = e.cacheControl);
                        var n = {};
                        if (u) {
                            var a = u.finish();
                            a && (n.resourceTiming = JSON.parse(JSON.stringify(a)))
                        }
                        h.vectorTile = e.vectorTile, h.parse(e.vectorTile, s.layerIndex, s.availableImages, s.actor, function (t, e) {
                            if (t || !e) return o(t);
                            o(null, A.extend({rawTileData: i.slice(0)}, e, r, n))
                        }), s.loaded = s.loaded || {}, s.loaded[l] = h
                    })
                }, r.prototype.reloadTile = function (t, r) {
                    var n = this, e = this.loaded, i = t.uid, a = this;
                    if (e && e[i]) {
                        var o = e[i];
                        o.showCollisionBoxes = t.showCollisionBoxes;
                        var s = function (t, e) {
                            var i = o.reloadCallback;
                            i && (delete o.reloadCallback, o.parse(o.vectorTile, a.layerIndex, n.availableImages, a.actor, i)), r(t, e)
                        };
                        "parsing" === o.status ? o.reloadCallback = s : "done" === o.status && (o.vectorTile ? o.parse(o.vectorTile, this.layerIndex, this.availableImages, this.actor, s) : s())
                    }
                }, r.prototype.abortTile = function (t, e) {
                    var i = this.loading, r = t.uid;
                    i && i[r] && i[r].abort && (i[r].abort(), delete i[r]), e()
                }, r.prototype.removeTile = function (t, e) {
                    var i = this.loaded, r = t.uid;
                    i && i[r] && delete i[r], e()
                };
                var s = A.window.ImageBitmap, n = function () {
                    this.loaded = {}
                };

                function c(t, e) {
                    if (0 !== t.length) {
                        a(t[0], e);
                        for (var i = 1; i < t.length; i++) a(t[i], !e)
                    }
                }

                function a(t, e) {
                    for (var i = 0, r = 0, n = t.length, a = n - 1; r < n; a = r++) i += (t[r][0] - t[a][0]) * (t[a][1] + t[r][1]);
                    i >= 0 != !!e && t.reverse()
                }

                n.prototype.loadTile = function (t, e) {
                    var i = t.uid, r = t.encoding, n = t.rawImageData,
                        a = s && n instanceof s ? this.getImageData(n) : n, o = new A.DEMData(i, a, r);
                    this.loaded = this.loaded || {}, this.loaded[i] = o, e(null, o)
                }, n.prototype.getImageData = function (t) {
                    this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t.width, t.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t.width, this.offscreenCanvas.height = t.height, this.offscreenCanvasContext.drawImage(t, 0, 0, t.width, t.height);
                    var e = this.offscreenCanvasContext.getImageData(-1, -1, t.width + 2, t.height + 2);
                    return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new A.RGBAImage({
                        width: e.width,
                        height: e.height
                    }, e.data)
                }, n.prototype.removeTile = function (t) {
                    var e = this.loaded, i = t.uid;
                    e && e[i] && delete e[i]
                };
                var N = A.mvt.VectorTileFeature.prototype.toGeoJSON, o = function (t) {
                    this._feature = t, this.extent = A.EXTENT, this.type = t.type, this.properties = t.tags, "id" in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10))
                };
                o.prototype.loadGeometry = function () {
                    if (1 === this._feature.type) {
                        for (var t = [], e = 0, i = this._feature.geometry; e < i.length; e += 1) {
                            var r = i[e];
                            t.push([new A.Point$1(r[0], r[1])])
                        }
                        return t
                    }
                    for (var n = [], a = 0, o = this._feature.geometry; a < o.length; a += 1) {
                        for (var s = [], l = 0, u = o[a]; l < u.length; l += 1) {
                            var h = u[l];
                            s.push(new A.Point$1(h[0], h[1]))
                        }
                        n.push(s)
                    }
                    return n
                }, o.prototype.toGeoJSON = function (t, e, i) {
                    return N.call(this, t, e, i)
                };
                var V = function (t) {
                    this.layers = {_geojsonTileLayer: this}, this.name = "_geojsonTileLayer", this.extent = A.EXTENT, this.length = t.length, this._features = t
                };
                V.prototype.feature = function (t) {
                    return new o(this._features[t])
                };
                var j = f;

                function f(t, e, i, r, n) {
                    this.properties = {}, this.extent = i, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = r, this._values = n, t.readFields(q, this, e)
                }

                function q(t, e, i) {
                    1 == t ? e.id = i.readVarint() : 2 == t ? function (t, e) {
                        for (var i = t.readVarint() + t.pos; t.pos < i;) {
                            var r = e._keys[t.readVarint()], n = e._values[t.readVarint()];
                            e.properties[r] = n
                        }
                    }(i, e) : 3 == t ? e.type = i.readVarint() : 4 == t && (e._geometry = i.pos)
                }

                function G(t) {
                    for (var e, i, r = 0, n = 0, a = t.length, o = a - 1; n < a; o = n++) r += ((i = t[o]).x - (e = t[n]).x) * (e.y + i.y);
                    return r
                }

                f.types = ["Unknown", "Point", "LineString", "Polygon"], f.prototype.loadGeometry = function () {
                    var t = this._pbf;
                    t.pos = this._geometry;
                    for (var e, i = t.readVarint() + t.pos, r = 1, n = 0, a = 0, o = 0, s = []; t.pos < i;) {
                        if (n <= 0) {
                            var l = t.readVarint();
                            r = 7 & l, n = l >> 3
                        }
                        if (n--, 1 === r || 2 === r) a += t.readSVarint(), o += t.readSVarint(), 1 === r && (e && s.push(e), e = []), e.push(new A.Point$1(a, o)); else {
                            if (7 !== r) throw new Error("unknown command " + r);
                            e && e.push(e[0].clone())
                        }
                    }
                    return e && s.push(e), s
                }, f.prototype.bbox = function () {
                    var t = this._pbf;
                    t.pos = this._geometry;
                    for (var e = t.readVarint() + t.pos, i = 1, r = 0, n = 0, a = 0, o = 1 / 0, s = -1 / 0, l = 1 / 0, u = -1 / 0; t.pos < e;) {
                        if (r <= 0) {
                            var h = t.readVarint();
                            i = 7 & h, r = h >> 3
                        }
                        if (r--, 1 === i || 2 === i) (n += t.readSVarint()) < o && (o = n), n > s && (s = n), (a += t.readSVarint()) < l && (l = a), a > u && (u = a); else if (7 !== i) throw new Error("unknown command " + i)
                    }
                    return [o, l, s, u]
                }, f.prototype.toGeoJSON = function (t, e, i) {
                    var r, n, a = this.extent * Math.pow(2, i), o = this.extent * t, s = this.extent * e,
                        l = this.loadGeometry(), u = f.types[this.type];

                    function h(t) {
                        for (var e = 0; e < t.length; e++) {
                            var i = t[e], r = 180 - 360 * (i.y + s) / a, n = yLat && yLat(i.y + s, a);
                            t[e] = [360 * (i.x + o) / a - 180, n || 360 / Math.PI * Math.atan(Math.exp(r * Math.PI / 180)) - 90]
                        }
                    }

                    switch (this.type) {
                        case 1:
                            var c = [];
                            for (r = 0; r < l.length; r++) c[r] = l[r][0];
                            h(l = c);
                            break;
                        case 2:
                            for (r = 0; r < l.length; r++) h(l[r]);
                            break;
                        case 3:
                            for (l = function (t) {
                                var e = t.length;
                                if (e <= 1) return [t];
                                for (var i, r, n = [], a = 0; a < e; a++) {
                                    var o = G(t[a]);
                                    0 !== o && (void 0 === r && (r = o < 0), r === o < 0 ? (i && n.push(i), i = [t[a]]) : i.push(t[a]))
                                }
                                return i && n.push(i), n
                            }(l), r = 0; r < l.length; r++) for (n = 0; n < l[r].length; n++) h(l[r][n])
                    }
                    1 === l.length ? l = l[0] : u = "Multi" + u;
                    var p = {type: "Feature", geometry: {type: u, coordinates: l}, properties: this.properties};
                    return "id" in this && (p.id = this.id), p
                };
                var Z = W;

                function W(t, e) {
                    this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(X, this, e), this.length = this._features.length
                }

                function X(t, e, i) {
                    15 === t ? e.version = i.readVarint() : 1 === t ? e.name = i.readString() : 5 === t ? e.extent = i.readVarint() : 2 === t ? e._features.push(i.pos) : 3 === t ? e._keys.push(i.readString()) : 4 === t && e._values.push(function (t) {
                        for (var e = null, i = t.readVarint() + t.pos; t.pos < i;) {
                            var r = t.readVarint() >> 3;
                            e = 1 === r ? t.readString() : 2 === r ? t.readFloat() : 3 === r ? t.readDouble() : 4 === r ? t.readVarint64() : 5 === r ? t.readVarint() : 6 === r ? t.readSVarint() : 7 === r ? t.readBoolean() : null
                        }
                        return e
                    }(i))
                }

                function H(t, e, i) {
                    if (3 === t) {
                        var r = new Z(i, i.readVarint() + i.pos);
                        r.length && (e[r.name] = r)
                    }
                }

                W.prototype.feature = function (t) {
                    if (t < 0 || t >= this._features.length) throw new Error("feature index out of bounds");
                    this._pbf.pos = this._features[t];
                    var e = this._pbf.readVarint() + this._pbf.pos;
                    return new j(this._pbf, e, this.extent, this._keys, this._values)
                };
                var K = {
                    VectorTile: function (t, e) {
                        this.layers = t.readFields(H, {}, e)
                    }, VectorTileFeature: j, VectorTileLayer: Z
                }.VectorTileFeature, Y = J;

                function J(t, e) {
                    this.options = e || {}, this.features = t, this.length = t.length
                }

                function u(t, e) {
                    this.id = "number" == typeof t.id ? t.id : void 0, this.type = t.type, this.rawGeometry = 1 === t.type ? [t.geometry] : t.geometry, this.properties = t.tags, this.extent = e || 4096
                }

                J.prototype.feature = function (t) {
                    return new u(this.features[t], this.options.extent)
                }, u.prototype.loadGeometry = function () {
                    var t = this.rawGeometry;
                    this.geometry = [];
                    for (var e = 0; e < t.length; e++) {
                        for (var i = t[e], r = [], n = 0; n < i.length; n++) r.push(new A.Point$1(i[n][0], i[n][1]));
                        this.geometry.push(r)
                    }
                    return this.geometry
                }, u.prototype.bbox = function () {
                    this.geometry || this.loadGeometry();
                    for (var t = this.geometry, e = 1 / 0, i = -1 / 0, r = 1 / 0, n = -1 / 0, a = 0; a < t.length; a++) for (var o = t[a], s = 0; s < o.length; s++) {
                        var l = o[s];
                        e = Math.min(e, l.x), i = Math.max(i, l.x), r = Math.min(r, l.y), n = Math.max(n, l.y)
                    }
                    return [e, r, i, n]
                }, u.prototype.toGeoJSON = K.prototype.toGeoJSON;
                var h = p, Q = Y;

                function p(t) {
                    var e = new A.pbf;
                    return function (t, e) {
                        for (var i in t.layers) e.writeMessage(3, $, t.layers[i])
                    }(t, e), e.finish()
                }

                function $(t, e) {
                    var i;
                    e.writeVarintField(15, t.version || 1), e.writeStringField(1, t.name || ""), e.writeVarintField(5, t.extent || 4096);
                    var r = {keys: [], values: [], keycache: {}, valuecache: {}};
                    for (i = 0; i < t.length; i++) r.feature = t.feature(i), e.writeMessage(2, tt, r);
                    var n = r.keys;
                    for (i = 0; i < n.length; i++) e.writeStringField(3, n[i]);
                    var a = r.values;
                    for (i = 0; i < a.length; i++) e.writeMessage(4, nt, a[i])
                }

                function tt(t, e) {
                    var i = t.feature;
                    void 0 !== i.id && e.writeVarintField(1, i.id), e.writeMessage(2, et, t), e.writeVarintField(3, i.type), e.writeMessage(4, rt, i)
                }

                function et(t, e) {
                    var i = t.feature, r = t.keys, n = t.values, a = t.keycache, o = t.valuecache;
                    for (var s in i.properties) {
                        var l = a[s];
                        void 0 === l && (r.push(s), a[s] = l = r.length - 1), e.writeVarint(l);
                        var u = i.properties[s], h = typeof u;
                        "string" !== h && "boolean" !== h && "number" !== h && (u = JSON.stringify(u));
                        var c = h + ":" + u, p = o[c];
                        void 0 === p && (n.push(u), o[c] = p = n.length - 1), e.writeVarint(p)
                    }
                }

                function d(t, e) {
                    return (e << 3) + (7 & t)
                }

                function it(t) {
                    return t << 1 ^ t >> 31
                }

                function rt(t, e) {
                    for (var i = t.loadGeometry(), r = t.type, n = 0, a = 0, o = i.length, s = 0; s < o; s++) {
                        var l = i[s], u = 1;
                        1 === r && (u = l.length), e.writeVarint(d(1, u));
                        for (var h = 3 === r ? l.length - 1 : l.length, c = 0; c < h; c++) {
                            1 === c && 1 !== r && e.writeVarint(d(2, h - 1));
                            var p = l[c].x - n, f = l[c].y - a;
                            e.writeVarint(it(p)), e.writeVarint(it(f)), n += p, a += f
                        }
                        3 === r && e.writeVarint(d(7, 1))
                    }
                }

                function nt(t, e) {
                    var i = typeof t;
                    "string" === i ? e.writeStringField(1, t) : "boolean" === i ? e.writeBooleanField(7, t) : "number" === i && (t % 1 != 0 ? e.writeDoubleField(3, t) : t < 0 ? e.writeSVarintField(6, t) : e.writeVarintField(5, t))
                }

                function m(t, e, i, r) {
                    g(t, i, r), g(e, 2 * i, 2 * r), g(e, 2 * i + 1, 2 * r + 1)
                }

                function g(t, e, i) {
                    var r = t[e];
                    t[e] = t[i], t[i] = r
                }

                function at(t, e, i, r) {
                    var n = t - i, a = e - r;
                    return n * n + a * a
                }

                h.fromVectorTileJs = p, h.fromGeojsonVt = function (t, e) {
                    e = e || {};
                    var i = {};
                    for (var r in t) i[r] = new Y(t[r].features, e), i[r].name = r, i[r].version = e.version, i[r].extent = e.extent;
                    return p({layers: i})
                }, h.GeoJSONWrapper = Q;
                var ot = function (t) {
                    return t[0]
                }, st = function (t) {
                    return t[1]
                }, _ = function (t, e, i, r, n) {
                    void 0 === e && (e = ot), void 0 === i && (i = st), void 0 === r && (r = 64), void 0 === n && (n = Float64Array), this.nodeSize = r, this.points = t;
                    for (var a = t.length < 65536 ? Uint16Array : Uint32Array, o = this.ids = new a(t.length), s = this.coords = new n(2 * t.length), l = 0; l < t.length; l++) o[l] = l, s[2 * l] = e(t[l]), s[2 * l + 1] = i(t[l]);
                    !function t(e, i, r, n, a, o) {
                        if (!(a - n <= r)) {
                            var s = n + a >> 1;
                            !function t(e, i, r, n, a, o) {
                                for (; a > n;) {
                                    if (a - n > 600) {
                                        var s = a - n + 1, l = r - n + 1, u = Math.log(s), h = .5 * Math.exp(2 * u / 3),
                                            c = .5 * Math.sqrt(u * h * (s - h) / s) * (l - s / 2 < 0 ? -1 : 1);
                                        t(e, i, r, Math.max(n, Math.floor(r - l * h / s + c)), Math.min(a, Math.floor(r + (s - l) * h / s + c)), o)
                                    }
                                    var p = i[2 * r + o], f = n, d = a;
                                    for (m(e, i, n, r), i[2 * a + o] > p && m(e, i, n, a); f < d;) {
                                        for (m(e, i, f, d), f++, d--; i[2 * f + o] < p;) f++;
                                        for (; i[2 * d + o] > p;) d--
                                    }
                                    i[2 * n + o] === p ? m(e, i, n, d) : m(e, i, ++d, a), d <= r && (n = d + 1), r <= d && (a = d - 1)
                                }
                            }(e, i, s, n, a, o % 2), t(e, i, r, n, s - 1, o + 1), t(e, i, r, s + 1, a, o + 1)
                        }
                    }(o, s, r, 0, o.length - 1, 0)
                };
                _.prototype.range = function (t, e, i, r) {
                    return function (t, e, i, r, n, a, o) {
                        for (var s, l, u = [0, t.length - 1, 0], h = []; u.length;) {
                            var c = u.pop(), p = u.pop(), f = u.pop();
                            if (p - f <= o) for (var d = f; d <= p; d++) l = e[2 * d + 1], (s = e[2 * d]) >= i && s <= n && l >= r && l <= a && h.push(t[d]); else {
                                var m = Math.floor((f + p) / 2);
                                l = e[2 * m + 1], (s = e[2 * m]) >= i && s <= n && l >= r && l <= a && h.push(t[m]);
                                var y = (c + 1) % 2;
                                (0 === c ? i <= s : r <= l) && (u.push(f), u.push(m - 1), u.push(y)), (0 === c ? n >= s : a >= l) && (u.push(m + 1), u.push(p), u.push(y))
                            }
                        }
                        return h
                    }(this.ids, this.coords, t, e, i, r, this.nodeSize)
                }, _.prototype.within = function (t, e, i) {
                    return function (t, e, i, r, n, a) {
                        for (var o = [0, t.length - 1, 0], s = [], l = n * n; o.length;) {
                            var u = o.pop(), h = o.pop(), c = o.pop();
                            if (h - c <= a) for (var p = c; p <= h; p++) at(e[2 * p], e[2 * p + 1], i, r) <= l && s.push(t[p]); else {
                                var f = Math.floor((c + h) / 2), d = e[2 * f], m = e[2 * f + 1];
                                at(d, m, i, r) <= l && s.push(t[f]);
                                var y = (u + 1) % 2;
                                (0 === u ? i - n <= d : r - n <= m) && (o.push(c), o.push(f - 1), o.push(y)), (0 === u ? i + n >= d : r + n >= m) && (o.push(f + 1), o.push(h), o.push(y))
                            }
                        }
                        return s
                    }(this.ids, this.coords, t, e, i, this.nodeSize)
                };
                var lt = {
                    minZoom: 0,
                    maxZoom: 16,
                    minPoints: 2,
                    radius: 40,
                    extent: 512,
                    nodeSize: 64,
                    log: !1,
                    generateId: !1,
                    reduce: null,
                    map: function (t) {
                        return t
                    }
                }, v = function (t) {
                    this.options = b(Object.create(lt), t), this.trees = new Array(this.options.maxZoom + 1)
                };

                function ut(t, e, i, r, n) {
                    return {x: t, y: e, zoom: 1 / 0, id: i, parentId: -1, numPoints: r, properties: n}
                }

                function ht(t, e, i) {
                    var r, n, a = t.geometry.coordinates, o = a[0], s = a[1];
                    return {
                        x: (n = "object" == typeof customConvertPoint ? customConvertPoint.projectXY(o, s, i) : [(r = o, r / 360 + .5), ft(s)])[0],
                        y: n[1],
                        zoom: 1 / 0,
                        index: e,
                        parentId: -1
                    }
                }

                function ct(t, e) {
                    var i;
                    return i = "object" == typeof customConvertPoint ? customConvertPoint.toLngLat(t.x, t.y, e) : [dt(x), mt(y)], {
                        type: "Feature",
                        id: t.id,
                        properties: pt(t),
                        geometry: {type: "Point", coordinates: i}
                    }
                }

                function pt(t) {
                    var e = t.numPoints,
                        i = e >= 1e4 ? Math.round(e / 1e3) + "k" : e >= 1e3 ? Math.round(e / 100) / 10 + "k" : e;
                    return b(b({}, t.properties), {
                        cluster: !0,
                        cluster_id: t.id,
                        point_count: e,
                        point_count_abbreviated: i
                    })
                }

                function ft(t) {
                    var e = Math.sin(t * Math.PI / 180), i = .5 - .25 * Math.log((1 + e) / (1 - e)) / Math.PI;
                    return i < 0 ? 0 : i > 1 ? 1 : i
                }

                function dt(t) {
                    return 360 * (t - .5)
                }

                function mt(t) {
                    var e = (180 - 360 * t) * Math.PI / 180;
                    return 360 * Math.atan(Math.exp(e)) / Math.PI - 90
                }

                function b(t, e) {
                    for (var i in e) t[i] = e[i];
                    return t
                }

                function yt(t) {
                    return t.x
                }

                function gt(t) {
                    return t.y
                }

                function _t(t, e, i, r, n, a) {
                    var o = n - i, s = a - r;
                    if (0 !== o || 0 !== s) {
                        var l = ((t - i) * o + (e - r) * s) / (o * o + s * s);
                        l > 1 ? (i = n, r = a) : l > 0 && (i += o * l, r += s * l)
                    }
                    return (o = t - i) * o + (s = e - r) * s
                }

                function w(t, e, i, r) {
                    var n = {
                        id: void 0 === t ? null : t,
                        type: e,
                        geometry: i,
                        tags: r,
                        minX: 1 / 0,
                        minY: 1 / 0,
                        maxX: -1 / 0,
                        maxY: -1 / 0
                    };
                    return function (t) {
                        var e = t.geometry, i = t.type;
                        if ("Point" === i || "MultiPoint" === i || "LineString" === i) M(t, e); else if ("Polygon" === i || "MultiLineString" === i) for (var r = 0; r < e.length; r++) M(t, e[r]); else if ("MultiPolygon" === i) for (r = 0; r < e.length; r++) for (var n = 0; n < e[r].length; n++) M(t, e[r][n])
                    }(n), n
                }

                function M(t, e) {
                    for (var i = 0; i < e.length; i += 3) t.minX = Math.min(t.minX, e[i]), t.minY = Math.min(t.minY, e[i + 1]), t.maxX = Math.max(t.maxX, e[i]), t.maxY = Math.max(t.maxY, e[i + 1])
                }

                function S(t, e, i, r) {
                    if (e.geometry) {
                        var n = e.geometry.coordinates, a = e.geometry.type,
                            o = Math.pow(i.tolerance / ((1 << i.maxZoom) * i.extent), 2), s = [], l = e.id;
                        if (i.promoteId ? l = e.properties[i.promoteId] : i.generateId && (l = r || 0), "Point" === a) E(n, s, i.proj4Projection); else if ("MultiPoint" === a) for (var u = 0; u < n.length; u++) E(n[u], s, i.proj4Projection); else if ("LineString" === a) I(n, s, o, !1, i.proj4Projection); else if ("MultiLineString" === a) {
                            if (i.lineMetrics) {
                                for (u = 0; u < n.length; u++) I(n[u], s = [], o, !1, i.proj4Projection), t.push(w(l, "LineString", s, e.properties));
                                return
                            }
                            T(n, s, o, !1, i.proj4Projection)
                        } else if ("Polygon" === a) T(n, s, o, !0, i.proj4Projection); else {
                            if ("MultiPolygon" !== a) {
                                if ("GeometryCollection" === a) {
                                    for (u = 0; u < e.geometry.geometries.length; u++) S(t, {
                                        id: l,
                                        geometry: e.geometry.geometries[u],
                                        properties: e.properties
                                    }, i, r);
                                    return
                                }
                                throw new Error("Input data is not a valid GeoJSON object.")
                            }
                            for (u = 0; u < n.length; u++) {
                                var h = [];
                                T(n[u], h, o, !0, i.proj4Projection), s.push(h)
                            }
                        }
                        t.push(w(l, a, s, e.properties))
                    }
                }

                function E(t, e, i) {
                    var r = Math.min(85.051129, Math.max(-85.051129, t[1])),
                        n = "object" == typeof customConvertPoint ? customConvertPoint.projectXY(t[0], r, i) : t;
                    e.push(n[0]), e.push(n[1]), e.push(0)
                }

                function I(t, e, i, r, n) {
                    for (var a, o, s = 0, l = 0; l < t.length; l++) {
                        var u = [];
                        E(t[l], u, n);
                        var h = u[0], c = u[1];
                        e.push(h), e.push(c), e.push(0), l > 0 && (s += r ? (a * c - h * o) / 2 : Math.sqrt(Math.pow(h - a, 2) + Math.pow(c - o, 2))), a = h, o = c
                    }
                    var p = e.length - 3;
                    e[2] = 1, function t(e, i, r, n) {
                        for (var a, o = n, s = r - i >> 1, l = r - i, u = e[i], h = e[i + 1], c = e[r], p = e[r + 1], f = i + 3; f < r; f += 3) {
                            var d = _t(e[f], e[f + 1], u, h, c, p);
                            if (d > o) a = f, o = d; else if (d === o) {
                                var m = Math.abs(f - s);
                                m < l && (a = f, l = m)
                            }
                        }
                        o > n && (a - i > 3 && t(e, i, a, n), e[a + 2] = o, r - a > 3 && t(e, a, r, n))
                    }(e, 0, p, i), e[p + 2] = 1, e.size = Math.abs(s), e.start = 0, e.end = e.size
                }

                function T(t, e, i, r, n) {
                    for (var a = 0; a < t.length; a++) {
                        var o = [];
                        I(t[a], o, i, r, n), e.push(o)
                    }
                }

                function C(t, e, i, r, n, a, o, s) {
                    if (r /= e, a >= (i /= e) && o < r) return t;
                    if (o < i || a >= r) return null;
                    for (var l = [], u = 0; u < t.length; u++) {
                        var h = t[u], c = h.geometry, p = h.type, f = 0 === n ? h.minX : h.minY,
                            d = 0 === n ? h.maxX : h.maxY;
                        if (f >= i && d < r) l.push(h); else if (!(d < i || f >= r)) {
                            var m = [];
                            if ("Point" === p || "MultiPoint" === p) vt(c, m, i, r, n); else if ("LineString" === p) xt(c, m, i, r, n, !1, s.lineMetrics); else if ("MultiLineString" === p) P(c, m, i, r, n, !1); else if ("Polygon" === p) P(c, m, i, r, n, !0); else if ("MultiPolygon" === p) for (var y = 0; y < c.length; y++) {
                                var g = [];
                                P(c[y], g, i, r, n, !0), g.length && m.push(g)
                            }
                            if (m.length) {
                                if (s.lineMetrics && "LineString" === p) {
                                    for (y = 0; y < m.length; y++) l.push(w(h.id, p, m[y], h.tags));
                                    continue
                                }
                                "LineString" !== p && "MultiLineString" !== p || (1 === m.length ? (p = "LineString", m = m[0]) : p = "MultiLineString"), "Point" !== p && "MultiPoint" !== p || (p = 3 === m.length ? "Point" : "MultiPoint"), l.push(w(h.id, p, m, h.tags))
                            }
                        }
                    }
                    return l.length ? l : null
                }

                function vt(t, e, i, r, n) {
                    for (var a = 0; a < t.length; a += 3) {
                        var o = t[a + n];
                        o >= i && o <= r && (e.push(t[a]), e.push(t[a + 1]), e.push(t[a + 2]))
                    }
                }

                function xt(t, e, i, r, n, a, o) {
                    for (var s, l, u = bt(t), h = 0 === n ? wt : Mt, c = t.start, p = 0; p < t.length - 3; p += 3) {
                        var f = t[p], d = t[p + 1], m = t[p + 2], y = t[p + 3], g = t[p + 4], _ = 0 === n ? f : d,
                            v = 0 === n ? y : g, x = !1;
                        o && (s = Math.sqrt(Math.pow(f - y, 2) + Math.pow(d - g, 2))), _ < i ? v > i && (l = h(u, f, d, y, g, i), o && (u.start = c + s * l)) : _ > r ? v < r && (l = h(u, f, d, y, g, r), o && (u.start = c + s * l)) : L(u, f, d, m), v < i && _ >= i && (l = h(u, f, d, y, g, i), x = !0), v > r && _ <= r && (l = h(u, f, d, y, g, r), x = !0), !a && x && (o && (u.end = c + s * l), e.push(u), u = bt(t)), o && (c += s)
                    }
                    var b = t.length - 3;
                    f = t[b], d = t[b + 1], m = t[b + 2], (_ = 0 === n ? f : d) >= i && _ <= r && L(u, f, d, m), b = u.length - 3, a && b >= 3 && (u[b] !== u[0] || u[b + 1] !== u[1]) && L(u, u[0], u[1], u[2]), u.length && e.push(u)
                }

                function bt(t) {
                    var e = [];
                    return e.size = t.size, e.start = t.start, e.end = t.end, e
                }

                function P(t, e, i, r, n, a) {
                    for (var o = 0; o < t.length; o++) xt(t[o], e, i, r, n, a, !1)
                }

                function L(t, e, i, r) {
                    t.push(e), t.push(i), t.push(r)
                }

                function wt(t, e, i, r, n, a) {
                    var o = (a - e) / (r - e);
                    return t.push(a), t.push(i + (n - i) * o), t.push(1), o
                }

                function Mt(t, e, i, r, n, a) {
                    var o = (a - i) / (n - i);
                    return t.push(e + (r - e) * o), t.push(a), t.push(1), o
                }

                function St(t, e) {
                    for (var i = [], r = 0; r < t.length; r++) {
                        var n, a = t[r], o = a.type;
                        if ("Point" === o || "MultiPoint" === o || "LineString" === o) n = D(a.geometry, e); else if ("MultiLineString" === o || "Polygon" === o) {
                            n = [];
                            for (var s = 0; s < a.geometry.length; s++) n.push(D(a.geometry[s], e))
                        } else if ("MultiPolygon" === o) for (n = [], s = 0; s < a.geometry.length; s++) {
                            for (var l = [], u = 0; u < a.geometry[s].length; u++) l.push(D(a.geometry[s][u], e));
                            n.push(l)
                        }
                        i.push(w(a.id, o, n, a.tags))
                    }
                    return i
                }

                function D(t, e) {
                    var i = [];
                    i.size = t.size, void 0 !== t.start && (i.start = t.start, i.end = t.end);
                    for (var r = 0; r < t.length; r += 3) i.push(t[r] + e, t[r + 1], t[r + 2]);
                    return i
                }

                function Et(t, e) {
                    if (t.transformed) return t;
                    var i, r, n, a = 1 << t.z, o = t.x, s = t.y;
                    for (i = 0; i < t.features.length; i++) {
                        var l = t.features[i], u = l.geometry, h = l.type;
                        if (l.geometry = [], 1 === h) for (r = 0; r < u.length; r += 2) l.geometry.push(It(u[r], u[r + 1], e, a, o, s)); else for (r = 0; r < u.length; r++) {
                            var c = [];
                            for (n = 0; n < u[r].length; n += 2) c.push(It(u[r][n], u[r][n + 1], e, a, o, s));
                            l.geometry.push(c)
                        }
                    }
                    return t.transformed = !0, t
                }

                function It(t, e, i, r, n, a) {
                    return [Math.round(i * (t * r - n)), Math.round(i * (e * r - a))]
                }

                function Tt(t, e, i, r, n) {
                    for (var a = e === n.maxZoom ? 0 : n.tolerance / ((1 << e) * n.extent), o = {
                        features: [],
                        numPoints: 0,
                        numSimplified: 0,
                        numFeatures: 0,
                        source: null,
                        x: i,
                        y: r,
                        z: e,
                        transformed: !1,
                        minX: 2,
                        minY: 1,
                        maxX: -1,
                        maxY: 0
                    }, s = 0; s < t.length; s++) {
                        o.numFeatures++, Ct(o, t[s], a, n);
                        var l = t[s].minX, u = t[s].minY, h = t[s].maxX, c = t[s].maxY;
                        l < o.minX && (o.minX = l), u < o.minY && (o.minY = u), h > o.maxX && (o.maxX = h), c > o.maxY && (o.maxY = c)
                    }
                    return o
                }

                function Ct(t, e, i, r) {
                    var n = e.geometry, a = e.type, o = [];
                    if ("Point" === a || "MultiPoint" === a) for (var s = 0; s < n.length; s += 3) o.push(n[s]), o.push(n[s + 1]), t.numPoints++, t.numSimplified++; else if ("LineString" === a) R(o, n, t, i, !1, !1); else if ("MultiLineString" === a || "Polygon" === a) for (s = 0; s < n.length; s++) R(o, n[s], t, i, "Polygon" === a, 0 === s); else if ("MultiPolygon" === a) for (var l = 0; l < n.length; l++) {
                        var u = n[l];
                        for (s = 0; s < u.length; s++) R(o, u[s], t, i, !0, 0 === s)
                    }
                    if (o.length) {
                        var h = e.tags || null;
                        if ("LineString" === a && r.lineMetrics) {
                            for (var c in h = {}, e.tags) h[c] = e.tags[c];
                            h.mapbox_clip_start = n.start / n.size, h.mapbox_clip_end = n.end / n.size
                        }
                        var p = {
                            geometry: o,
                            type: "Polygon" === a || "MultiPolygon" === a ? 3 : "LineString" === a || "MultiLineString" === a ? 2 : 1,
                            tags: h
                        };
                        null !== e.id && (p.id = e.id), t.features.push(p)
                    }
                }

                function R(t, e, i, r, n, a) {
                    var o = r * r;
                    if (r > 0 && e.size < (n ? o : r)) i.numPoints += e.length / 3; else {
                        for (var s = [], l = 0; l < e.length; l += 3) (0 === r || e[l + 2] > o) && (i.numSimplified++, s.push(e[l]), s.push(e[l + 1])), i.numPoints++;
                        n && function (t, e) {
                            for (var i = 0, r = 0, n = t.length, a = n - 2; r < n; a = r, r += 2) i += (t[r] - t[a]) * (t[r + 1] + t[a + 1]);
                            if (i > 0 === e) for (r = 0, n = t.length; r < n / 2; r += 2) {
                                var o = t[r], s = t[r + 1];
                                t[r] = t[n - 2 - r], t[r + 1] = t[n - 1 - r], t[n - 2 - r] = o, t[n - 1 - r] = s
                            }
                        }(s, a), t.push(s)
                    }
                }

                function B(t, e) {
                    var i = (e = this.options = function (t, e) {
                        for (var i in e) t[i] = e[i];
                        return t
                    }(Object.create(this.options), e)).debug;
                    if (i && console.time("preprocess data"), e.maxZoom < 0 || e.maxZoom > 24) throw new Error("maxZoom should be in the 0-24 range");
                    if (e.promoteId && e.generateId) throw new Error("promoteId and generateId cannot be used together.");
                    var r = function (t, e) {
                        if (e.customprj && "undefined" == typeof customConvertPoint) try {
                            importScripts(e.customprj)
                        } catch (t) {
                            console.log(t)
                        }
                        if (!e.customprj && "undefined" != typeof customConvertPoint) try {
                            customConvertPoint = void 0
                        } catch (t) {
                            console.log(t)
                        }
                        var i = [];
                        if ("FeatureCollection" === t.type) for (var r = 0; r < t.features.length; r++) S(i, t.features[r], e, r); else S(i, "Feature" === t.type ? t : {geometry: t}, e);
                        return i
                    }(t, e);
                    this.tiles = {}, this.tileCoords = [], i && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", e.indexMaxZoom, e.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (r = function (t, e) {
                        var i = e.buffer / e.extent, r = t, n = C(t, 1, -1 - i, i, 0, -1, 2, e),
                            a = C(t, 1, 1 - i, 2 + i, 0, -1, 2, e);
                        return (n || a) && (r = C(t, 1, -i, 1 + i, 0, -1, 2, e) || [], n && (r = St(n, 1).concat(r)), a && (r = r.concat(St(a, -1)))), r
                    }(r, e)).length && this.splitTile(r, 0, 0, 0), i && (r.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)))
                }

                function O(t, e, i) {
                    return 32 * ((1 << t) * i + e) + t
                }

                function Pt(t, e) {
                    var i = t.tileID.canonical;
                    if (!this._geoJSONIndex) return e(null, null);
                    var r = this._geoJSONIndex.getTile(i.z, i.x, i.y);
                    if (!r) return e(null, null);
                    var n = new V(r.features), a = h(n);
                    0 === a.byteOffset && a.byteLength === a.buffer.byteLength || (a = new Uint8Array(a)), e(null, {
                        vectorTile: n,
                        rawData: a.buffer
                    })
                }

                v.prototype.load = function (t) {
                    var e = this.options, i = e.log, r = e.minZoom, n = e.maxZoom, a = e.nodeSize;
                    i && console.time("total time");
                    var o = "prepare " + t.length + " points";
                    i && console.time(o), this.points = t;
                    for (var s = [], l = 0; l < t.length; l++) t[l].geometry && s.push(ht(t[l], l, this.options.proj4Projection));
                    console.log(s), this.trees[n + 1] = new _(s, yt, gt, a, Float32Array), i && console.timeEnd(o);
                    for (var u = n; u >= r; u--) {
                        var h = +Date.now();
                        s = this._cluster(s, u), this.trees[u] = new _(s, yt, gt, a, Float32Array), i && console.log("z%d: %d clusters in %dms", u, s.length, +Date.now() - h)
                    }
                    return i && console.timeEnd("total time"), this
                }, v.prototype.getClusters = function (t, e) {
                    var i = ((t[0] + 180) % 360 + 360) % 360 - 180, r = Math.max(-90, Math.min(90, t[1])),
                        n = 180 === t[2] ? 180 : ((t[2] + 180) % 360 + 360) % 360 - 180,
                        a = Math.max(-90, Math.min(90, t[3]));
                    if (t[2] - t[0] >= 360) i = -180, n = 180; else if (i > n) {
                        var o = this.getClusters([i, r, 180, a], e), s = this.getClusters([-180, r, n, a], e);
                        return o.concat(s)
                    }
                    for (var l = this.trees[this._limitZoom(e)], u = lngLatXY(i, r), h = lngLatXY(i, n), c = [], p = 0, f = l.range(u[0], h[1], h[0], u[1]); p < f.length; p += 1) {
                        var d = l.points[f[p]];
                        c.push(d.numPoints ? ct(d, this.options.proj4Projection) : this.points[d.index])
                    }
                    return c
                }, v.prototype.getChildren = function (t) {
                    var e = this._getOriginId(t), i = this._getOriginZoom(t), r = "No cluster with the specified id.",
                        n = this.trees[i];
                    if (!n) throw new Error(r);
                    var a = n.points[e];
                    if (!a) throw new Error(r);
                    for (var o = this.options.radius / (this.options.extent * Math.pow(2, i - 1)), s = [], l = 0, u = n.within(a.x, a.y, o); l < u.length; l += 1) {
                        var h = n.points[u[l]];
                        h.parentId === t && s.push(h.numPoints ? ct(h, this.options.proj4Projection) : this.points[h.index])
                    }
                    if (0 === s.length) throw new Error(r);
                    return s
                }, v.prototype.getLeaves = function (t, e, i) {
                    var r = [];
                    return this._appendLeaves(r, t, e = e || 10, i = i || 0, 0), r
                }, v.prototype.getTile = function (t, e, i) {
                    var r = this.trees[this._limitZoom(t)], n = Math.pow(2, t), a = this.options,
                        o = a.radius / a.extent, s = (i - o) / n, l = (i + 1 + o) / n, u = {features: []};
                    return this._addTileFeatures(r.range((e - o) / n, s, (e + 1 + o) / n, l), r.points, e, i, n, u), 0 === e && this._addTileFeatures(r.range(1 - o / n, s, 1, l), r.points, n, i, n, u), e === n - 1 && this._addTileFeatures(r.range(0, s, o / n, l), r.points, -1, i, n, u), u.features.length ? u : null
                }, v.prototype.getClusterExpansionZoom = function (t) {
                    for (var e = this._getOriginZoom(t) - 1; e <= this.options.maxZoom;) {
                        var i = this.getChildren(t);
                        if (e++, 1 !== i.length) break;
                        t = i[0].properties.cluster_id
                    }
                    return e
                }, v.prototype._appendLeaves = function (t, e, i, r, n) {
                    for (var a = 0, o = this.getChildren(e); a < o.length; a += 1) {
                        var s = o[a], l = s.properties;
                        if (l && l.cluster ? n + l.point_count <= r ? n += l.point_count : n = this._appendLeaves(t, l.cluster_id, i, r, n) : n < r ? n++ : t.push(s), t.length === i) break
                    }
                    return n
                }, v.prototype._addTileFeatures = function (t, e, i, r, n, a) {
                    for (var o = 0, s = t; o < s.length; o += 1) {
                        var l = e[s[o]], u = l.numPoints, h = {
                            type: 1,
                            geometry: [[Math.round(this.options.extent * (l.x * n - i)), Math.round(this.options.extent * (l.y * n - r))]],
                            tags: u ? pt(l) : this.points[l.index].properties
                        }, c = void 0;
                        u ? c = l.id : this.options.generateId ? c = l.index : this.points[l.index].id && (c = this.points[l.index].id), void 0 !== c && (h.id = c), a.features.push(h)
                    }
                }, v.prototype._limitZoom = function (t) {
                    return Math.max(this.options.minZoom, Math.min(+t, this.options.maxZoom + 1))
                }, v.prototype._cluster = function (t, e) {
                    for (var i = [], r = this.options, n = r.reduce, a = r.minPoints, o = r.radius / (r.extent * Math.pow(2, e)), s = 0; s < t.length; s++) {
                        var l = t[s];
                        if (!(l.zoom <= e)) {
                            l.zoom = e;
                            for (var u = this.trees[e + 1], h = u.within(l.x, l.y, o), c = l.numPoints || 1, p = c, f = 0, d = h; f < d.length; f += 1) {
                                var m = u.points[d[f]];
                                m.zoom > e && (p += m.numPoints || 1)
                            }
                            if (p >= a) {
                                for (var y = l.x * c, g = l.y * c, _ = n && c > 1 ? this._map(l, !0) : null, v = (s << 5) + (e + 1) + this.points.length, x = 0, b = h; x < b.length; x += 1) {
                                    var w = u.points[b[x]];
                                    if (!(w.zoom <= e)) {
                                        w.zoom = e;
                                        var M = w.numPoints || 1;
                                        y += w.x * M, g += w.y * M, w.parentId = v, n && (_ || (_ = this._map(l, !0)), n(_, this._map(w)))
                                    }
                                }
                                l.parentId = v, i.push(ut(y / p, g / p, v, p, _))
                            } else if (i.push(l), p > 1) for (var S = 0, E = h; S < E.length; S += 1) {
                                var I = u.points[E[S]];
                                I.zoom <= e || (I.zoom = e, i.push(I))
                            }
                        }
                    }
                    return i
                }, v.prototype._getOriginId = function (t) {
                    return t - this.points.length >> 5
                }, v.prototype._getOriginZoom = function (t) {
                    return (t - this.points.length) % 32
                }, v.prototype._map = function (t, e) {
                    if (t.numPoints) return e ? b({}, t.properties) : t.properties;
                    var i = this.points[t.index].properties, r = this.options.map(i);
                    return e && r === i ? b({}, r) : r
                }, B.prototype.options = {
                    maxZoom: 14,
                    indexMaxZoom: 5,
                    indexMaxPoints: 1e5,
                    tolerance: 3,
                    extent: 4096,
                    buffer: 64,
                    lineMetrics: !1,
                    promoteId: null,
                    generateId: !1,
                    debug: 0
                }, B.prototype.splitTile = function (t, e, i, r, n, a, o) {
                    for (var s = [t, e, i, r], l = this.options, u = l.debug; s.length;) {
                        r = s.pop(), i = s.pop(), e = s.pop(), t = s.pop();
                        var h = 1 << e, c = O(e, i, r), p = this.tiles[c];
                        if (!p && (u > 1 && console.time("creation"), p = this.tiles[c] = Tt(t, e, i, r, l), this.tileCoords.push({
                            z: e,
                            x: i,
                            y: r
                        }), u)) {
                            u > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", e, i, r, p.numFeatures, p.numPoints, p.numSimplified), console.timeEnd("creation"));
                            var f = "z" + e;
                            this.stats[f] = (this.stats[f] || 0) + 1, this.total++
                        }
                        if (p.source = t, n) {
                            if (e === l.maxZoom || e === n) continue;
                            var d = 1 << n - e;
                            if (i !== Math.floor(a / d) || r !== Math.floor(o / d)) continue
                        } else if (e === l.indexMaxZoom || p.numPoints <= l.indexMaxPoints) continue;
                        if (p.source = null, 0 !== t.length) {
                            u > 1 && console.time("clipping");
                            var m, y, g, _, v, x, b = .5 * l.buffer / l.extent, w = .5 - b, M = .5 + b, S = 1 + b;
                            m = y = g = _ = null, v = C(t, h, i - b, i + M, 0, p.minX, p.maxX, l), x = C(t, h, i + w, i + S, 0, p.minX, p.maxX, l), t = null, v && (m = C(v, h, r - b, r + M, 1, p.minY, p.maxY, l), y = C(v, h, r + w, r + S, 1, p.minY, p.maxY, l), v = null), x && (g = C(x, h, r - b, r + M, 1, p.minY, p.maxY, l), _ = C(x, h, r + w, r + S, 1, p.minY, p.maxY, l), x = null), u > 1 && console.timeEnd("clipping"), s.push(m || [], e + 1, 2 * i, 2 * r), s.push(y || [], e + 1, 2 * i, 2 * r + 1), s.push(g || [], e + 1, 2 * i + 1, 2 * r), s.push(_ || [], e + 1, 2 * i + 1, 2 * r + 1)
                        }
                    }
                }, B.prototype.getTile = function (t, e, i) {
                    var r = this.options, n = r.extent, a = r.debug;
                    if (t < 0 || t > 24) return null;
                    var o = 1 << t, s = O(t, e = (e % o + o) % o, i);
                    if (this.tiles[s]) return Et(this.tiles[s], n);
                    a > 1 && console.log("drilling down to z%d-%d-%d", t, e, i);
                    for (var l, u = t, h = e, c = i; !l && u > 0;) u--, h = Math.floor(h / 2), c = Math.floor(c / 2), l = this.tiles[O(u, h, c)];
                    return l && l.source ? (a > 1 && console.log("found parent tile z%d-%d-%d", u, h, c), a > 1 && console.time("drilling down"), this.splitTile(l.source, u, h, c, t, e, i), a > 1 && console.timeEnd("drilling down"), this.tiles[s] ? Et(this.tiles[s], n) : null) : null
                };
                var At = function (a) {
                    function t(t, e, i, r, n) {
                        a.call(this, t, e, i, Pt), r && (this.loadGeoJSON = r), this.projction = n
                    }

                    return a && (t.__proto__ = a), (t.prototype = Object.create(a && a.prototype)).constructor = t, t.prototype.loadData = function (t, e) {
                        this._pendingCallback && this._pendingCallback(null, {abandoned: !0}), this._pendingCallback = e, this._pendingLoadDataParams = t, this._state && "Idle" !== this._state ? this._state = "NeedsLoadData" : (this._state = "Coalescing", this._loadData())
                    }, t.prototype._loadData = function () {
                        var s = this;
                        if (this._pendingCallback && this._pendingLoadDataParams) {
                            var l = this._pendingCallback, u = this._pendingLoadDataParams;
                            delete this._pendingCallback, delete this._pendingLoadDataParams;
                            var h = !!(u && u.request && u.request.collectResourceTiming) && new A.RequestPerformance(u.request);
                            this.loadGeoJSON(u, function (t, e) {
                                if (t || !e) return l(t);
                                if ("object" != typeof e) return l(new Error("Input data given to '" + u.source + "' is not a valid GeoJSON object."));
                                !function t(e, i) {
                                    var r, n = e && e.type;
                                    if ("FeatureCollection" === n) for (r = 0; r < e.features.length; r++) t(e.features[r], i); else if ("GeometryCollection" === n) for (r = 0; r < e.geometries.length; r++) t(e.geometries[r], i); else if ("Feature" === n) t(e.geometry, i); else if ("Polygon" === n) c(e.coordinates, i); else if ("MultiPolygon" === n) for (r = 0; r < e.coordinates.length; r++) c(e.coordinates[r], i);
                                    return e
                                }(e, !0);
                                try {
                                    if (u.superclusterOptions.customprj) try {
                                        importScripts(u.superclusterOptions.customprj)
                                    } catch (t) {
                                        console.log(u)
                                    }
                                    if (u.filter) {
                                        var i = A.createExpression(u.filter, {
                                            type: "boolean",
                                            "property-type": "data-driven",
                                            overridable: !1,
                                            transition: !1
                                        });
                                        if ("error" === i.result) throw new Error(i.value.map(function (t) {
                                            return t.key + ": " + t.message
                                        }).join(", "));
                                        var r = e.features.filter(function (t) {
                                            return i.value.evaluate({zoom: 0}, t)
                                        });
                                        e = {type: "FeatureCollection", features: r}
                                    }
                                    var n = u.geojsonVtOptions;
                                    n.proj4Projection = s.projction, u.superclusterOptions.proj4Projection = s.projction, s._geoJSONIndex = u.cluster ? new v(function (t) {
                                        var e = t.superclusterOptions, i = t.clusterProperties;
                                        if (!i || !e) return e;
                                        for (var a = {}, o = {}, s = {
                                            accumulated: null,
                                            zoom: 0
                                        }, l = {properties: null}, u = Object.keys(i), r = 0, n = u; r < n.length; r += 1) {
                                            var h = n[r], c = i[h], p = c[0], f = A.createExpression(c[1]),
                                                d = A.createExpression("string" == typeof p ? [p, ["accumulated"], ["get", h]] : p);
                                            a[h] = f.value, o[h] = d.value
                                        }
                                        return e.map = function (t) {
                                            l.properties = t;
                                            for (var e = {}, i = 0, r = u; i < r.length; i += 1) {
                                                var n = r[i];
                                                e[n] = a[n].evaluate(s, l)
                                            }
                                            return e
                                        }, e.reduce = function (t, e) {
                                            l.properties = e;
                                            for (var i = 0, r = u; i < r.length; i += 1) {
                                                var n = r[i];
                                                s.accumulated = t[n], t[n] = o[n].evaluate(s, l)
                                            }
                                        }, e
                                    }(u)).load(e.features) : function (t, e) {
                                        return new B(t, e)
                                    }(e, n)
                                } catch (t) {
                                    return l(t)
                                }
                                s.loaded = {};
                                var a = {};
                                if (a.data = e, h) {
                                    var o = h.finish();
                                    o && (a.resourceTiming = {}, a.resourceTiming[u.source] = JSON.parse(JSON.stringify(o)))
                                }
                                l(null, a)
                            })
                        }
                    }, t.prototype.coalesce = function () {
                        "Coalescing" === this._state ? this._state = "Idle" : "NeedsLoadData" === this._state && (this._state = "Coalescing", this._loadData())
                    }, t.prototype.reloadTile = function (t, e) {
                        var i = this.loaded;
                        return i && i[t.uid] ? a.prototype.reloadTile.call(this, t, e) : this.loadTile(t, e)
                    }, t.prototype.loadGeoJSON = function (e, i) {
                        if (e.request) A.getJSON(e.request, i); else {
                            if ("string" != typeof e.data) return i(new Error("Input data given to '" + e.source + "' is not a valid GeoJSON object."));
                            try {
                                return i(null, JSON.parse(e.data))
                            } catch (t) {
                                return i(new Error("Input data given to '" + e.source + "' is not a valid GeoJSON object."))
                            }
                        }
                    }, t.prototype.removeSource = function (t, e) {
                        this._pendingCallback && this._pendingCallback(null, {abandoned: !0}), e()
                    }, t.prototype.getClusterExpansionZoom = function (t, e) {
                        try {
                            e(null, this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))
                        } catch (t) {
                            e(t)
                        }
                    }, t.prototype.getClusterChildren = function (t, e) {
                        try {
                            e(null, this._geoJSONIndex.getChildren(t.clusterId))
                        } catch (t) {
                            e(t)
                        }
                    }, t.prototype.getClusterLeaves = function (t, e) {
                        try {
                            e(null, this._geoJSONIndex.getLeaves(t.clusterId, t.limit, t.offset))
                        } catch (t) {
                            e(t)
                        }
                    }, t
                }(r), t = function (t) {
                    var i = this;
                    this.self = t, this.actor = new A.Actor(t, this), this.layerIndexes = {}, this.availableImages = {}, this.workerSourceTypes = {
                        vector: r,
                        geojson: At
                    }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function (t, e) {
                        if (i.workerSourceTypes[t]) throw new Error('Worker source with name "' + t + '" already registered.');
                        i.workerSourceTypes[t] = e
                    }, this.self.registerRTLTextPlugin = function (t) {
                        if (A.plugin.isParsed()) throw new Error("RTL text plugin already registered.");
                        A.plugin.applyArabicShaping = t.applyArabicShaping, A.plugin.processBidirectionalText = t.processBidirectionalText, A.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText
                    }
                };
                return t.prototype.setReferrer = function (t, e) {
                    this.referrer = e
                }, t.prototype.setImages = function (t, e, i) {
                    for (var r in this.availableImages[t] = e, this.workerSources[t]) {
                        var n = this.workerSources[t][r];
                        for (var a in n) n[a].availableImages = e
                    }
                    i()
                }, t.prototype.setLayers = function (t, e, i) {
                    this.getLayerIndex(t).replace(e), i()
                }, t.prototype.updateLayers = function (t, e, i) {
                    this.getLayerIndex(t).update(e.layers, e.removedIds), i()
                }, t.prototype.loadTile = function (t, e, i) {
                    this.getWorkerSource(t, e.type, e.source).loadTile(e, i)
                }, t.prototype.loadDEMTile = function (t, e, i) {
                    this.getDEMWorkerSource(t, e.source).loadTile(e, i)
                }, t.prototype.reloadTile = function (t, e, i) {
                    this.getWorkerSource(t, e.type, e.source).reloadTile(e, i)
                }, t.prototype.abortTile = function (t, e, i) {
                    this.getWorkerSource(t, e.type, e.source).abortTile(e, i)
                }, t.prototype.removeTile = function (t, e, i) {
                    this.getWorkerSource(t, e.type, e.source).removeTile(e, i)
                }, t.prototype.removeDEMTile = function (t, e) {
                    this.getDEMWorkerSource(t, e.source).removeTile(e)
                }, t.prototype.removeSource = function (t, e, i) {
                    if (this.workerSources[t] && this.workerSources[t][e.type] && this.workerSources[t][e.type][e.source]) {
                        var r = this.workerSources[t][e.type][e.source];
                        delete this.workerSources[t][e.type][e.source], void 0 !== r.removeSource ? r.removeSource(e, i) : i()
                    }
                }, t.prototype.loadWorkerSource = function (t, e, i) {
                    try {
                        this.self.importScripts(e.url), i()
                    } catch (t) {
                        i(t.toString())
                    }
                }, t.prototype.syncRTLPluginState = function (t, e, i) {
                    try {
                        A.plugin.setState(e);
                        var r = A.plugin.getPluginURL();
                        if (A.plugin.isLoaded() && !A.plugin.isParsed() && null != r) {
                            this.self.importScripts(r);
                            var n = A.plugin.isParsed();
                            i(n ? void 0 : new Error("RTL Text Plugin failed to import scripts from " + r), n)
                        }
                    } catch (t) {
                        i(t.toString())
                    }
                }, t.prototype.getAvailableImages = function (t) {
                    var e = this.availableImages[t];
                    return e || (e = []), e
                }, t.prototype.getLayerIndex = function (t) {
                    var e = this.layerIndexes[t];
                    return e || (e = this.layerIndexes[t] = new i), e
                }, t.prototype.getWorkerSource = function (a, t, e, i) {
                    var o = this;
                    this.workerSources[a] || (this.workerSources[a] = {}), this.workerSources[a][t] || (this.workerSources[a][t] = {});
                    var r, n = !1;
                    return i && (n = i._id !== this._lastCRSId, this._lastCRSId = i._id, i.WKT ? (A.proj4.defs(i.epsgCode, i.WKT), r = A.proj4(i.epsgCode)) : r = A.proj4(i.epsgCode)), this.workerSources[a][t][e] ? n && (this.workerSources[a][t][e].projction = r) : this.workerSources[a][t][e] = new this.workerSourceTypes[t]({
                        send: function (t, e, i, r, n) {
                            o.actor.send(t, e, i, a, r, n)
                        }
                    }, this.getLayerIndex(a), this.getAvailableImages(a), null, r), this.workerSources[a][t][e]
                }, t.prototype.getDEMWorkerSource = function (t, e) {
                    return this.demWorkerSources[t] || (this.demWorkerSources[t] = {}), this.demWorkerSources[t][e] || (this.demWorkerSources[t][e] = new n), this.demWorkerSources[t][e]
                }, t.prototype.enforceCacheSizeLimit = function (t, e) {
                    A.enforceCacheSizeLimit(e)
                }, "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope && (self.worker = new t(self)), t
            }), t(["./shared"], function (ot) {
                "use strict";
                var A = ot.createCommonjsModule(function (t) {
                    function r(t) {
                        return !e(t)
                    }

                    function e(t) {
                        return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function () {
                            if (!("Worker" in window && "Blob" in window && "URL" in window)) return !1;
                            var t, e, i = new Blob([""], {type: "text/javascript"}), r = URL.createObjectURL(i);
                            try {
                                e = new Worker(r), t = !0
                            } catch (e) {
                                t = !1
                            }
                            return e && e.terminate(), URL.revokeObjectURL(r), t
                        }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function () {
                            var t = document.createElement("canvas");
                            t.width = t.height = 1;
                            var e = t.getContext("2d");
                            if (!e) return !1;
                            var i = e.getImageData(0, 0, 1, 1);
                            return i && i.width === t.width
                        }() ? (void 0 === i[e = t && t.failIfMajorPerformanceCaveat] && (i[e] = function (t) {
                            var e = function (t) {
                                var e = document.createElement("canvas"), i = Object.create(r.webGLContextAttributes);
                                return i.failIfMajorPerformanceCaveat = t, e.probablySupportsContext ? e.probablySupportsContext("webgl", i) || e.probablySupportsContext("experimental-webgl", i) : e.supportsContext ? e.supportsContext("webgl", i) || e.supportsContext("experimental-webgl", i) : e.getContext("webgl", i) || e.getContext("experimental-webgl", i)
                            }(t);
                            if (!e) return !1;
                            var i = e.createShader(e.VERTEX_SHADER);
                            return !(!i || e.isContextLost()) && (e.shaderSource(i, "void main() {}"), e.compileShader(i), !0 === e.getShaderParameter(i, e.COMPILE_STATUS))
                        }(e)), i[e] ? void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
                        var e
                    }

                    t.exports ? t.exports = r : window && (window.mapboxgl = window.mapboxgl || {}, window.mapboxgl.supported = r, window.mapboxgl.notSupportedReason = e);
                    var i = {};
                    r.webGLContextAttributes = {antialias: !1, alpha: !0, stencil: !0, depth: !0}
                }), x = {
                    create: function (t, e, i) {
                        var r = ot.window.document.createElement(t);
                        return void 0 !== e && (r.className = e), i && i.appendChild(r), r
                    }, createNS: function (t, e) {
                        return ot.window.document.createElementNS(t, e)
                    }
                }, z = ot.window.document && ot.window.document.documentElement.style;

                function k(t) {
                    if (!z) return t[0];
                    for (var e = 0; e < t.length; e++) if (t[e] in z) return t[e];
                    return t[0]
                }

                var L, D = k(["userSelect", "MozUserSelect", "WebkitUserSelect", "msUserSelect"]);
                x.disableDrag = function () {
                    z && D && (L = z[D], z[D] = "none")
                }, x.enableDrag = function () {
                    z && D && (z[D] = L)
                };
                var R = k(["transform", "WebkitTransform"]);
                x.setTransform = function (t, e) {
                    t.style[R] = e
                };
                var B = !1;
                try {
                    var O = Object.defineProperty({}, "passive", {
                        get: function () {
                            B = !0
                        }
                    });
                    ot.window.addEventListener("test", O, O), ot.window.removeEventListener("test", O, O)
                } catch (ot) {
                    B = !1
                }
                x.addEventListener = function (t, e, i, r) {
                    void 0 === r && (r = {}), t.addEventListener(e, i, "passive" in r && B ? r : r.capture)
                }, x.removeEventListener = function (t, e, i, r) {
                    void 0 === r && (r = {}), t.removeEventListener(e, i, "passive" in r && B ? r : r.capture)
                };
                var F = function (t) {
                    t.preventDefault(), t.stopPropagation(), ot.window.removeEventListener("click", F, !0)
                };

                function U(t, e, d) {
                    var m, y, g, i = ot.browser.devicePixelRatio > 1 ? "@2x" : "",
                        r = ot.getJSON(e.transformRequest(e.normalizeSpriteURL(t, i, ".json"), ot.ResourceType.SpriteJSON), function (t, e) {
                            r = null, g || (g = t, m = e, a())
                        }),
                        n = ot.getImage(e.transformRequest(e.normalizeSpriteURL(t, i, ".png"), ot.ResourceType.SpriteImage), function (t, e) {
                            n = null, g || (g = t, y = e, a())
                        });

                    function a() {
                        if (g) d(g); else if (m && y) {
                            var t = ot.browser.getImageData(y), e = {};
                            for (var i in m) {
                                var r = m[i], n = r.width, a = r.height, o = r.x, s = r.y, l = r.sdf, u = r.pixelRatio,
                                    h = r.stretchX, c = r.stretchY, p = r.content,
                                    f = new ot.RGBAImage({width: n, height: a});
                                ot.RGBAImage.copy(t, f, {x: o, y: s}, {x: 0, y: 0}, {
                                    width: n,
                                    height: a
                                }), e[i] = {data: f, pixelRatio: u, sdf: l, stretchX: h, stretchY: c, content: p}
                            }
                            d(null, e)
                        }
                    }

                    return {
                        cancel: function () {
                            r && (r.cancel(), r = null), n && (n.cancel(), n = null)
                        }
                    }
                }

                function j(t) {
                    var e = t.userImage;
                    return !!(e && e.render && e.render()) && (t.data.replace(new Uint8Array(e.data.buffer)), !0)
                }

                x.suppressClick = function () {
                    ot.window.addEventListener("click", F, !0), ot.window.setTimeout(function () {
                        ot.window.removeEventListener("click", F, !0)
                    }, 0)
                }, x.mousePos = function (t, e) {
                    var i = t.getBoundingClientRect();
                    return new ot.Point(e.clientX - i.left - t.clientLeft, e.clientY - i.top - t.clientTop)
                }, x.touchPos = function (t, e) {
                    for (var i = t.getBoundingClientRect(), r = [], n = 0; n < e.length; n++) r.push(new ot.Point(e[n].clientX - i.left - t.clientLeft, e[n].clientY - i.top - t.clientTop));
                    return r
                }, x.mouseButton = function (t) {
                    return void 0 !== ot.window.InstallTrigger && 2 === t.button && t.ctrlKey && ot.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : t.button
                }, x.remove = function (t) {
                    t.parentNode && t.parentNode.removeChild(t)
                };
                var q = function (t) {
                    function e() {
                        t.call(this), this.images = {}, this.updatedImages = {}, this.callbackDispatchedThisFrame = {}, this.loaded = !1, this.requestors = [], this.patterns = {}, this.atlasImage = new ot.RGBAImage({
                            width: 1,
                            height: 1
                        }), this.dirty = !0
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.isLoaded = function () {
                        return this.loaded
                    }, e.prototype.setLoaded = function (t) {
                        if (this.loaded !== t && (this.loaded = t, t)) {
                            for (var e = 0, i = this.requestors; e < i.length; e += 1) {
                                var r = i[e];
                                this._notify(r.ids, r.callback)
                            }
                            this.requestors = []
                        }
                    }, e.prototype.getImage = function (t) {
                        return this.images[t]
                    }, e.prototype.addImage = function (t, e) {
                        this._validate(t, e) && (this.images[t] = e)
                    }, e.prototype._validate = function (t, e) {
                        var i = !0;
                        return this._validateStretch(e.stretchX, e.data && e.data.width) || (this.fire(new ot.ErrorEvent(new Error('Image "' + t + '" has invalid "stretchX" value'))), i = !1), this._validateStretch(e.stretchY, e.data && e.data.height) || (this.fire(new ot.ErrorEvent(new Error('Image "' + t + '" has invalid "stretchY" value'))), i = !1), this._validateContent(e.content, e) || (this.fire(new ot.ErrorEvent(new Error('Image "' + t + '" has invalid "content" value'))), i = !1), i
                    }, e.prototype._validateStretch = function (t, e) {
                        if (!t) return !0;
                        for (var i = 0, r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r];
                            if (a[0] < i || a[1] < a[0] || e < a[1]) return !1;
                            i = a[1]
                        }
                        return !0
                    }, e.prototype._validateContent = function (t, e) {
                        return !(t && (4 !== t.length || t[0] < 0 || e.data.width < t[0] || t[1] < 0 || e.data.height < t[1] || t[2] < 0 || e.data.width < t[2] || t[3] < 0 || e.data.height < t[3] || t[2] < t[0] || t[3] < t[1]))
                    }, e.prototype.updateImage = function (t, e) {
                        e.version = this.images[t].version + 1, this.images[t] = e, this.updatedImages[t] = !0
                    }, e.prototype.removeImage = function (t) {
                        var e = this.images[t];
                        delete this.images[t], delete this.patterns[t], e.userImage && e.userImage.onRemove && e.userImage.onRemove()
                    }, e.prototype.listImages = function () {
                        return Object.keys(this.images)
                    }, e.prototype.getImages = function (t, e) {
                        var i = !0;
                        if (!this.isLoaded()) for (var r = 0, n = t; r < n.length; r += 1) this.images[n[r]] || (i = !1);
                        this.isLoaded() || i ? this._notify(t, e) : this.requestors.push({ids: t, callback: e})
                    }, e.prototype._notify = function (t, e) {
                        for (var i = {}, r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r], o = this.images[a];
                            !o && this.defaultImageManger && (o = this.defaultImageManger.getImage(a)), o || this.fire(new ot.Event("styleimagemissing", {id: a})), o ? i[a] = {
                                data: o.data.clone(),
                                pixelRatio: o.pixelRatio,
                                sdf: o.sdf,
                                version: o.version,
                                stretchX: o.stretchX,
                                stretchY: o.stretchY,
                                content: o.content,
                                hasRenderCallback: Boolean(o.userImage && o.userImage.render)
                            } : ot.warnOnce('Image "' + a + '" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')
                        }
                        e(null, i)
                    }, e.prototype.getPixelSize = function () {
                        var t = this.atlasImage;
                        return {width: t.width, height: t.height}
                    }, e.prototype.getPattern = function (t) {
                        var e = this.patterns[t], i = this.getImage(t);
                        if (!i) return null;
                        if (e && e.position.version === i.version) return e.position;
                        if (e) e.position.version = i.version; else {
                            var r = {w: i.data.width + 2, h: i.data.height + 2, x: 0, y: 0},
                                n = new ot.ImagePosition(r, i);
                            this.patterns[t] = {bin: r, position: n}
                        }
                        return this._updatePatternAtlas(), this.patterns[t].position
                    }, e.prototype.bind = function (t) {
                        var e = t.gl;
                        this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = !1) : this.atlasTexture = new ot.Texture(t, this.atlasImage, e.RGBA), this.atlasTexture.bind(e.LINEAR, e.CLAMP_TO_EDGE)
                    }, e.prototype._updatePatternAtlas = function () {
                        var t = [];
                        for (var e in this.patterns) t.push(this.patterns[e].bin);
                        var i = ot.potpack(t), r = i.w, n = i.h, a = this.atlasImage;
                        for (var o in a.resize({width: r || 1, height: n || 1}), this.patterns) {
                            var s = this.patterns[o].bin, l = s.x + 1, u = s.y + 1, h = this.images[o].data,
                                c = h.width, p = h.height;
                            ot.RGBAImage.copy(h, a, {x: 0, y: 0}, {x: l, y: u}, {
                                width: c,
                                height: p
                            }), ot.RGBAImage.copy(h, a, {x: 0, y: p - 1}, {x: l, y: u - 1}, {
                                width: c,
                                height: 1
                            }), ot.RGBAImage.copy(h, a, {x: 0, y: 0}, {x: l, y: u + p}, {
                                width: c,
                                height: 1
                            }), ot.RGBAImage.copy(h, a, {x: c - 1, y: 0}, {x: l - 1, y: u}, {
                                width: 1,
                                height: p
                            }), ot.RGBAImage.copy(h, a, {x: 0, y: 0}, {x: l + c, y: u}, {width: 1, height: p})
                        }
                        this.dirty = !0
                    }, e.prototype.beginFrame = function () {
                        this.callbackDispatchedThisFrame = {}
                    }, e.prototype.dispatchRenderCallbacks = function (t) {
                        for (var e = 0, i = t; e < i.length; e += 1) {
                            var r = i[e];
                            if (!this.callbackDispatchedThisFrame[r]) {
                                this.callbackDispatchedThisFrame[r] = !0;
                                var n = this.images[r];
                                j(n) && this.updateImage(r, n)
                            }
                        }
                    }, e
                }(ot.Evented), o = function () {
                    this.imageManagers = {image_manager_default: new q}, this.imageManagers.image_manager_default.setLoaded(!0)
                };
                o.prototype.getImage = function (t, e) {
                    return void 0 === e && (e = "image_manager_default"), this._getImageManager(e).getImage(t)
                }, o.prototype.setEventedParent = function (t, e, i) {
                    void 0 === i && (i = "image_manager_default"), this._getImageManager(i).setEventedParent(t, e)
                }, o.prototype.addImage = function (t, e, i) {
                    void 0 === i && (i = "image_manager_default"), this.imageManagers[i] || (this.imageManagers[i] = new q, "image_manager_default" !== i && (this.imageManagers[i].defaultImageManger = this.imageManagers.image_manager_default)), this._getImageManager(i).addImage(t, e)
                }, o.prototype.updateImage = function (t, e, i) {
                    if (void 0 === i && (i = "image_manager_default"), i) this._getImageManager(i).updateImage(t, e); else for (var r in this.imageManagers) this.imageManagers[r].updateImage(t, e)
                }, o.prototype.removeImage = function (t, e) {
                    void 0 === e && (e = "image_manager_default"), this._getImageManager(e).removeImage(t)
                }, o.prototype.listImages = function (t) {
                    var e = [];
                    for (var i in this.imageManagers) e.push.apply(e, this.imageManagers[i].listImages());
                    return e
                }, o.prototype.getImages = function (t, e, i) {
                    void 0 === i && (i = "image_manager_default"), this._getImageManager(i).getImages(t, e)
                }, o.prototype.getPixelSize = function (t) {
                    return void 0 === t && (t = "image_manager_default"), this._getImageManager(t).getPixelSize()
                }, o.prototype.getPattern = function (t, e) {
                    return void 0 === e && (e = "image_manager_default"), this._getImageManager(e).getPattern(t)
                }, o.prototype.bind = function (t, e) {
                    void 0 === e && (e = "image_manager_default"), this._getImageManager(e).bind(t)
                }, o.prototype.isLoaded = function (t) {
                    return void 0 === t && (t = "image_manager_default"), this._getImageManager(t).isLoaded()
                }, o.prototype.isAllLoaded = function () {
                    for (var t in this.imageManagers) if (!this.imageManagers[t].isLoaded()) return !1;
                    return !0
                }, o.prototype.beginFrame = function (t) {
                    return void 0 === t && (t = "image_manager_default"), this._getImageManager(t).beginFrame()
                }, o.prototype.dispatchRenderCallbacks = function (t, e) {
                    return void 0 === e && (e = "image_manager_default"), this._getImageManager(e).dispatchRenderCallbacks(t)
                }, o.prototype.setLoaded = function (t, e) {
                    return void 0 === e && (e = "image_manager_default"), this._getImageManager(e).setLoaded(t)
                }, o.prototype._getImageManager = function (t) {
                    return this.imageManagers[t] ? this.imageManagers[t] : this.imageManagers.image_manager_default
                };
                var G = 1e20, Z = function (t) {
                    void 0 === t && (t = {});
                    var e = t.fontSize;
                    void 0 === e && (e = 24);
                    var i = t.buffer;
                    void 0 === i && (i = 3);
                    var r = t.radius;
                    void 0 === r && (r = 8);
                    var n = t.cutoff;
                    void 0 === n && (n = .25);
                    var a = t.fontFamily;
                    void 0 === a && (a = "sans-serif");
                    var o = t.fontWeight;
                    void 0 === o && (o = "normal");
                    var s = t.fontStyle;
                    void 0 === s && (s = "normal"), this.buffer = i, this.cutoff = n, this.radius = r;
                    var l = this.size = e + 4 * i, u = this._createCanvas(l),
                        h = this.ctx = u.getContext("2d", {willReadFrequently: !0});
                    h.font = s + " " + o + " " + e + "px " + a, h.textBaseline = "alphabetic", h.textAlign = "left", h.fillStyle = "black", this.gridOuter = new Float64Array(l * l), this.gridInner = new Float64Array(l * l), this.f = new Float64Array(l), this.z = new Float64Array(l + 1), this.v = new Uint16Array(l)
                };

                function W(t, e, i, r, n, a, o, s, l) {
                    for (var u = e; u < e + r; u++) X(t, i * a + u, a, n, o, s, l);
                    for (var h = i; h < i + n; h++) X(t, h * a + e, 1, r, o, s, l)
                }

                function X(t, e, i, r, n, a, o) {
                    a[0] = 0, o[0] = -G, o[1] = G, n[0] = t[e];
                    for (var s = 1, l = 0, u = 0; s < r; s++) {
                        n[s] = t[e + s * i];
                        var h = s * s;
                        do {
                            var c = a[l];
                            u = (n[s] - n[c] + h - c * c) / (s - c) / 2
                        } while (u <= o[l] && --l > -1);
                        a[++l] = s, o[l] = u, o[l + 1] = G
                    }
                    for (var p = 0, f = 0; p < r; p++) {
                        for (; o[f + 1] < p;) f++;
                        var d = a[f], m = p - d;
                        t[e + p * i] = n[d] + m * m
                    }
                }

                Z.prototype._createCanvas = function (t) {
                    var e = document.createElement("canvas");
                    return e.width = e.height = t, e
                }, Z.prototype.draw = function (t) {
                    var e = this.ctx.measureText(t), i = e.width, r = e.actualBoundingBoxDescent,
                        n = e.actualBoundingBoxLeft, a = e.actualBoundingBoxRight,
                        o = Math.ceil(e.actualBoundingBoxAscent),
                        s = Math.max(0, Math.min(this.size - this.buffer, Math.ceil(a - n))),
                        l = Math.min(this.size - this.buffer, o + Math.ceil(r)), u = s + 2 * this.buffer,
                        h = l + 2 * this.buffer, c = Math.max(u * h, 0), p = new Uint8ClampedArray(c), f = {
                            data: p,
                            width: u,
                            height: h,
                            glyphWidth: s,
                            glyphHeight: l,
                            glyphTop: o,
                            glyphLeft: 0,
                            glyphAdvance: i
                        };
                    if (0 === s || 0 === l) return f;
                    var d = this.ctx, m = this.buffer, y = this.gridInner, g = this.gridOuter;
                    d.clearRect(m, m, s, l), d.fillText(t, m, m + o);
                    var _ = d.getImageData(m, m, s, l);
                    g.fill(G, 0, c), y.fill(0, 0, c);
                    for (var v = 0; v < l; v++) for (var x = 0; x < s; x++) {
                        var b = _.data[4 * (v * s + x) + 3] / 255;
                        if (0 !== b) {
                            var w = (v + m) * u + x + m;
                            if (1 === b) g[w] = 0, y[w] = G; else {
                                var M = .5 - b;
                                g[w] = M > 0 ? M * M : 0, y[w] = M < 0 ? M * M : 0
                            }
                        }
                    }
                    W(g, 0, 0, u, h, u, this.f, this.v, this.z), W(y, m, m, s, l, u, this.f, this.v, this.z);
                    for (var S = 0; S < c; S++) {
                        var E = Math.sqrt(g[S]) - Math.sqrt(y[S]);
                        p[S] = Math.round(255 - 255 * (E / this.radius + this.cutoff))
                    }
                    return f
                };
                var f = function (t, e) {
                    this.requestManager = t, this.localIdeographFontFamily = e, this.entries = {}, this.localGlyphs = {
                        200: {},
                        400: {},
                        500: {},
                        900: {}
                    }
                };
                f.prototype.setURL = function (t) {
                    this.url = t
                }, f.prototype.getGlyphs = function (t, u) {
                    var l = this, e = [];
                    for (var i in t) for (var r = 0, n = t[i]; r < n.length; r += 1) e.push({stack: i, id: n[r]});
                    ot.asyncAll(e, function (t, i) {
                        var r = t.stack, n = t.id, a = l.entries[r];
                        a || (a = l.entries[r] = {glyphs: {}, requests: {}, ranges: {}});
                        var e = a.glyphs[n];
                        if (void 0 === e) {
                            if (e = l._tinySDF(a, r, n)) return a.glyphs[n] = e, void i(null, {
                                stack: r,
                                id: n,
                                glyph: e
                            });
                            var o = Math.floor(n / 256);
                            if (256 * o > 65535) i(new Error("glyphs > 65535 not supported")); else if (a.ranges[o]) i(null, {
                                stack: r,
                                id: n,
                                glyph: e
                            }); else {
                                var s = a.requests[o];
                                s || (s = a.requests[o] = [], f.loadGlyphRange(r, o, l.url, l.requestManager, function (t, e) {
                                    if (e) {
                                        for (var i in e) l._doesCharSupportLocalGlyph(+i) || (a.glyphs[+i] = e[+i]);
                                        a.ranges[o] = !0
                                    }
                                    for (var r = 0, n = s; r < n.length; r += 1) (0, n[r])(t, e);
                                    delete a.requests[o]
                                })), s.push(function (t, e) {
                                    t ? i(t) : e && i(null, {stack: r, id: n, glyph: e[n] || null})
                                })
                            }
                        } else i(null, {stack: r, id: n, glyph: e})
                    }, function (t, e) {
                        if (t) u(t); else if (e) {
                            for (var i = {}, r = 0, n = e; r < n.length; r += 1) {
                                var a = n[r], o = a.stack, s = a.id, l = a.glyph;
                                (i[o] || (i[o] = {}))[s] = l && {id: l.id, bitmap: l.bitmap.clone(), metrics: l.metrics}
                            }
                            u(null, i)
                        }
                    })
                }, f.prototype._doesCharSupportLocalGlyph = function (t) {
                    return !!this.localIdeographFontFamily && (ot.isChar["CJK Unified Ideographs"](t) || ot.isChar["Hangul Syllables"](t) || ot.isChar.Hiragana(t) || ot.isChar.Katakana(t))
                }, f.prototype._include = function (t, e) {
                    for (var i = 0; i < t.length; i++) if (e.indexOf(t[i]) >= 0) return !0;
                    return !1
                }, f.prototype._tinySDF = function (t, e, i) {
                    var r = this.localIdeographFontFamily;
                    if (r && (this._include(r.split(","), e.split(",")) || this._doesCharSupportLocalGlyph(i))) {
                        var n = t.tinySDF;
                        if (!n) {
                            var a = "400";
                            /bold/i.test(e) ? a = "900" : /medium/i.test(e) ? a = "500" : /light/i.test(e) && (a = "200"), (n = t.tinySDF = new f.TinySDF({
                                fontSize: 48,
                                buffer: 6,
                                radius: 16,
                                fontFamily: r,
                                fontWeight: a
                            })).fontWeight = a
                        }
                        if (this.localGlyphs[n.fontWeight][i]) return this.localGlyphs[n.fontWeight][i];
                        var o = String.fromCodePoint(i), s = n.draw(o), l = s.glyphWidth, u = s.glyphHeight,
                            h = s.glyphLeft, c = s.glyphTop, p = s.glyphAdvance;
                        return this.localGlyphs[n.fontWeight][i] = {
                            id: i,
                            bitmap: new ot.AlphaImage({width: s.width, height: s.height}, s.data),
                            metrics: {
                                width: l / 2,
                                height: u / 2,
                                left: h / 2 + .5,
                                top: c / 2 - 27.5,
                                advance: p / 2,
                                localGlyph: !0,
                                isDoubleResolution: !0
                            }
                        }
                    }
                }, f.loadGlyphRange = function (t, e, i, r, o) {
                    var n = 256 * e, a = n + 255;
                    if (!i) throw new Error('use of "text-field" requires a style "glyphs" property for ' + t);
                    var s = r.transformRequest(r.normalizeGlyphsURL(i).replace("{fontstack}", t).replace("{range}", n + "-" + a), ot.ResourceType.Glyphs);
                    ot.getArrayBuffer(s, function (t, e) {
                        if (t) o(t); else if (e) {
                            for (var i = {}, r = 0, n = ot.parseGlyphPBF(e); r < n.length; r += 1) {
                                var a = n[r];
                                i[a.id] = a
                            }
                            o(null, i)
                        }
                    })
                }, f.TinySDF = Z;
                var H = function (t, e) {
                    this.requestManager = t, this.localIdeographFontFamily = e, this.glyphManagers = {image_manager_default: new f(this.requestManager, this.localIdeographFontFamily)}
                };
                H.prototype._getGlyphManager = function (t) {
                    return this.glyphManagers[t] ? this.glyphManagers[t] : this.glyphManagers.image_manager_default
                }, H.prototype.setURL = function (t, e) {
                    void 0 === e && (e = "image_manager_default"), this.glyphManagers[e] || (this.glyphManagers[e] = new f(this.requestManager, this.localIdeographFontFamily)), this._getGlyphManager(e).setURL(t)
                }, H.prototype.getGlyphs = function (t, e, i) {
                    void 0 === i && (i = "image_manager_default"), this._getGlyphManager(i).getGlyphs(t, e)
                };
                var K = function () {
                    this.specification = ot.styleSpec.light.position
                };
                K.prototype.possiblyEvaluate = function (t, e) {
                    return ot.sphericalToCartesian(t.expression.evaluate(e))
                }, K.prototype.interpolate = function (t, e, i) {
                    return {x: ot.number(t.x, e.x, i), y: ot.number(t.y, e.y, i), z: ot.number(t.z, e.z, i)}
                };
                var J = new ot.Properties({
                    anchor: new ot.DataConstantProperty(ot.styleSpec.light.anchor),
                    position: new K,
                    color: new ot.DataConstantProperty(ot.styleSpec.light.color),
                    intensity: new ot.DataConstantProperty(ot.styleSpec.light.intensity)
                }), Q = function (e) {
                    function t(t) {
                        e.call(this), this._transitionable = new ot.Transitionable(J), this.setLight(t), this._transitioning = this._transitionable.untransitioned()
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.getLight = function () {
                        return this._transitionable.serialize()
                    }, t.prototype.setLight = function (t, e) {
                        if (void 0 === e && (e = {}), !this._validate(ot.validateLight, t, e)) for (var i in t) {
                            var r = t[i];
                            ot.endsWith(i, "-transition") ? this._transitionable.setTransition(i.slice(0, -"-transition".length), r) : this._transitionable.setValue(i, r)
                        }
                    }, t.prototype.updateTransitions = function (t) {
                        this._transitioning = this._transitionable.transitioned(t, this._transitioning)
                    }, t.prototype.hasTransition = function () {
                        return this._transitioning.hasTransition()
                    }, t.prototype.recalculate = function (t) {
                        this.properties = this._transitioning.possiblyEvaluate(t)
                    }, t.prototype._validate = function (t, e, i) {
                        return (!i || !1 !== i.validate) && ot.emitValidationErrors(this, t.call(ot.validateStyle, ot.extend({
                            value: e,
                            style: {glyphs: !0, sprite: !0},
                            styleSpec: ot.styleSpec
                        })))
                    }, t
                }(ot.Evented), $ = function (t, e) {
                    this.width = t, this.height = e, this.nextRow = 0, this.data = new Uint8Array(this.width * this.height), this.dashEntry = {}
                };
                $.prototype.getDash = function (t, e) {
                    var i = t.join(",") + String(e);
                    return this.dashEntry[i] || (this.dashEntry[i] = this.addDash(t, e)), this.dashEntry[i]
                }, $.prototype.getDashRanges = function (t, e, i) {
                    var r = [], n = t.length % 2 == 1 ? -t[t.length - 1] * i : 0, a = t[0] * i, o = !0;
                    r.push({left: n, right: a, isDash: o, zeroLength: 0 === t[0]});
                    for (var s = t[0], l = 1; l < t.length; l++) {
                        var u = t[l];
                        r.push({left: n = s * i, right: a = (s += u) * i, isDash: o = !o, zeroLength: 0 === u})
                    }
                    return r
                }, $.prototype.addRoundDash = function (t, e, i) {
                    for (var r = e / 2, n = -i; n <= i; n++) for (var a = this.width * (this.nextRow + i + n), o = 0, s = t[o], l = 0; l < this.width; l++) {
                        l / s.right > 1 && (s = t[++o]);
                        var u = Math.abs(l - s.left), h = Math.abs(l - s.right), c = Math.min(u, h), p = void 0,
                            f = n / i * (r + 1);
                        if (s.isDash) {
                            var d = r - Math.abs(f);
                            p = Math.sqrt(c * c + d * d)
                        } else p = r - Math.sqrt(c * c + f * f);
                        this.data[a + l] = Math.max(0, Math.min(255, p + 128))
                    }
                }, $.prototype.addRegularDash = function (t) {
                    for (var e = t.length - 1; e >= 0; --e) {
                        var i = t[e], r = t[e + 1];
                        i.zeroLength ? t.splice(e, 1) : r && r.isDash === i.isDash && (r.left = i.left, t.splice(e, 1))
                    }
                    var n = t[0], a = t[t.length - 1];
                    n.isDash === a.isDash && (n.left = a.left - this.width, a.right = n.right + this.width);
                    for (var o = this.width * this.nextRow, s = 0, l = t[s], u = 0; u < this.width; u++) {
                        u / l.right > 1 && (l = t[++s]);
                        var h = Math.abs(u - l.left), c = Math.abs(u - l.right), p = Math.min(h, c);
                        this.data[o + u] = Math.max(0, Math.min(255, (l.isDash ? p : -p) + 128))
                    }
                }, $.prototype.addDash = function (t, e) {
                    var i = e ? 7 : 0, r = 2 * i + 1;
                    if (this.nextRow + r > this.height) return ot.warnOnce("LineAtlas out of space"), null;
                    for (var n = 0, a = 0; a < t.length; a++) n += t[a];
                    if (0 !== n) {
                        var o = this.width / n, s = this.getDashRanges(t, this.width, o);
                        e ? this.addRoundDash(s, o, i) : this.addRegularDash(s)
                    }
                    var l = {y: (this.nextRow + i + .5) / this.height, height: 2 * i / this.height, width: n};
                    return this.nextRow += r, this.dirty = !0, l
                }, $.prototype.bind = function (t) {
                    var e = t.gl;
                    this.texture ? (e.bindTexture(e.TEXTURE_2D, this.texture), this.dirty && (this.dirty = !1, e.texSubImage2D(e.TEXTURE_2D, 0, 0, 0, this.width, this.height, e.ALPHA, e.UNSIGNED_BYTE, this.data))) : (this.texture = e.createTexture(), e.bindTexture(e.TEXTURE_2D, this.texture), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, e.LINEAR), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, e.LINEAR), e.texImage2D(e.TEXTURE_2D, 0, e.ALPHA, this.width, this.height, 0, e.ALPHA, e.UNSIGNED_BYTE, this.data))
                };
                var tt = function t(e, i) {
                    this.workerPool = e, this.actors = [], this.currentActor = 0, this.id = ot.uniqueId();
                    for (var r = this.workerPool.acquire(this.id), n = 0; n < r.length; n++) {
                        var a = new t.Actor(r[n], i, this.id);
                        a.name = "Worker " + n, this.actors.push(a)
                    }
                };

                function et(r, n, a) {
                    var t = function (t, e) {
                        if (t) return a(t);
                        if (e) {
                            var i = ot.pick(ot.extend(e, r), ["tiles", "minzoom", "maxzoom", "attribution", "mapbox_logo", "bounds", "scheme", "tileSize", "encoding"]);
                            e.vector_layers && (i.vectorLayers = e.vector_layers, i.vectorLayerIds = i.vectorLayers.map(function (t) {
                                return t.id
                            })), i.tiles = n.canonicalizeTileset(i, r.url), a(null, i)
                        }
                    };
                    return r.url ? ot.getJSON(n.transformRequest(n.normalizeSourceURL(r.url), ot.ResourceType.Source), t) : ot.browser.frame(function () {
                        return t(null, r)
                    })
                }

                tt.prototype.broadcast = function (i, r, t) {
                    ot.asyncAll(this.actors, function (t, e) {
                        t.send(i, r, e)
                    }, t = t || function () {
                    })
                }, tt.prototype.getActor = function () {
                    return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor]
                }, tt.prototype.remove = function () {
                    this.actors.forEach(function (t) {
                        t.remove()
                    }), this.actors = [], this.workerPool.release(this.id)
                }, tt.Actor = ot.Actor;
                var it = function (t, e, i) {
                    this.bounds = ot.LngLatBounds.convert(this.validateBounds(t)), this.minzoom = e || 0, this.maxzoom = i || 24
                };
                it.prototype.validateBounds = function (t) {
                    return Array.isArray(t) && 4 === t.length ? [Math.max(-180, t[0]), Math.max(-90, t[1]), Math.min(180, t[2]), Math.min(90, t[3])] : [-180, -90, 180, 90]
                }, it.prototype.contains = function (t, e, i, r, n, a) {
                    var o = Math.pow(2, t.z), s = this.bounds.getWest(), l = this.bounds.getNorth(),
                        u = this.bounds.getEast(), h = this.bounds.getSouth(), c = this.bounds.getCenter();
                    if (a) {
                        var p = a.lngLatExtent[3], f = a.lngLatExtent[1], d = a.lngLatExtent[2], m = a.lngLatExtent[0];
                        l = Math.min(Math.max(f, l), p), h = Math.min(Math.max(f, h), p), s = Math.min(Math.max(m, s), d), u = Math.min(Math.max(m, u), d), c.lat = (l + h) / 2, c.lng = (s + u) / 2, s = a.fromWGS84([s, c.lat])[0], l = a.fromWGS84([c.lng, l])[1], u = a.fromWGS84([u, c.lat])[0], h = a.fromWGS84([c.lng, h])[1]
                    }
                    var y = Math.floor((s - e) * o / r), g = Math.floor((i - l) * o / n),
                        _ = Math.ceil((u - e) * o / r), v = Math.ceil((i - h) * o / n);
                    return t.x >= y && t.x < _ && t.y >= g && t.y < v
                };
                var rt = function (n) {
                    function t(t, e, i, r) {
                        if (n.call(this), this.id = t, this.dispatcher = i, this.type = "vector", this.minzoom = 0, this.maxzoom = 22, this.scheme = "xyz", this.tileSize = 512, this._scales = [], this._resolutions = [], this.reparseOverscaled = !0, this.isTileClipped = !0, this._loaded = !1, ot.extend(this, ot.pick(e, ["url", "scheme", "tileSize", "promoteId"])), this._options = ot.extend({type: "vector"}, e), this._collectResourceTiming = e.collectResourceTiming, 512 !== this.tileSize) throw new Error("vector tile sources must have a tileSize of 512");
                        this.setEventedParent(r)
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.load = function () {
                        var i = this;
                        this._loaded = !1, this.fire(new ot.Event("dataloading", {dataType: "source"})), this._tileJSONRequest = et(this._options, this.map._requestManager, function (t, e) {
                            i._tileJSONRequest = null, i._loaded = !0, t ? i.fire(new ot.ErrorEvent(t)) : e && (ot.extend(i, e), e.bounds && (i.tileBounds = new it(e.bounds, i.minzoom, i.maxzoom)), ot.postTurnstileEvent(e.tiles, i.map._requestManager._customAccessToken), ot.postMapLoadEvent(e.tiles, i.map._getMapId(), i.map._requestManager._skuToken, i.map._requestManager._customAccessToken), i.fire(new ot.Event("data", {
                                dataType: "source",
                                sourceDataType: "metadata"
                            })), i.fire(new ot.Event("data", {dataType: "source", sourceDataType: "content"})))
                        })
                    }, t.prototype.loaded = function () {
                        return this._loaded
                    }, t.prototype.hasTile = function (t) {
                        return !this.tileBounds || this.tileBounds.contains(t.canonical, this.originX, this.originY, this.worldWidth, this.worldHeight, this.map.getCRS())
                    }, t.prototype.onAdd = function (t) {
                        this.map = t;
                        var e = t.getCRS();
                        this.worldWidth = e.getWidth(), this.worldHeight = e.getHeight(), this.originX = e.getOriginX(), this.originY = e.getOriginY(), this.load()
                    }, t.prototype.setSourceProperty = function (t) {
                        this._tileJSONRequest && this._tileJSONRequest.cancel(), t(), this.map.style.sourceCaches[this.id].clearTiles(), this.load()
                    }, t.prototype.setTiles = function (t) {
                        var e = this;
                        return this.setSourceProperty(function () {
                            e._options.tiles = t
                        }), this
                    }, t.prototype.setUrl = function (t) {
                        var e = this;
                        return this.setSourceProperty(function () {
                            e.url = t, e._options.url = t
                        }), this
                    }, t.prototype.onRemove = function () {
                        this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null)
                    }, t.prototype.serialize = function () {
                        return ot.extend({}, this._options)
                    }, t.prototype.loadTile = function (i, r) {
                        var t = this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles, this.scheme, 0, this.tileSize, this.getScale ? this.getScale(i.tileID.canonical.z, this.tileSize) : void 0), this.url, null),
                            e = {
                                request: this.map._requestManager.transformRequest(t, ot.ResourceType.Tile),
                                uid: i.uid,
                                tileID: i.tileID,
                                zoom: i.tileID.overscaledZ,
                                tileSize: this.tileSize * i.tileID.overscaleFactor(),
                                type: this.type,
                                source: this.id,
                                pixelRatio: ot.browser.devicePixelRatio,
                                showCollisionBoxes: this.map.showCollisionBoxes,
                                promoteId: this.promoteId
                            };

                        function n(t, e) {
                            return delete i.request, i.aborted ? r(null) : t && 404 !== t.status ? r(t) : (e && e.resourceTiming && (i.resourceTiming = e.resourceTiming), this.map._refreshExpiredTiles && e && i.setExpiryData(e), i.loadVectorData(e, this.map.painter), ot.cacheEntryPossiblyAdded(this.dispatcher), r(null), void (i.reloadCallback && (this.loadTile(i, i.reloadCallback), i.reloadCallback = null)))
                        }

                        e.request.collectResourceTiming = this._collectResourceTiming, i.actor && "expired" !== i.state ? "loading" === i.state ? i.reloadCallback = r : i.request = i.actor.send("reloadTile", e, n.bind(this)) : (i.actor = this.dispatcher.getActor(), i.request = i.actor.send("loadTile", e, n.bind(this)))
                    }, t.prototype.abortTile = function (t) {
                        t.request && (t.request.cancel(), delete t.request), t.actor && t.actor.send("abortTile", {
                            uid: t.uid,
                            type: this.type,
                            source: this.id
                        }, void 0)
                    }, t.prototype.unloadTile = function (t) {
                        t.unloadVectorData(), t.actor && t.actor.send("removeTile", {
                            uid: t.uid,
                            type: this.type,
                            source: this.id
                        }, void 0)
                    }, t.prototype.hasTransition = function () {
                        return !1
                    }, t.prototype.getMeterPerMapUnit = function (t) {
                        var e = 1;
                        return "degree" === t || "degrees" === t || "d" === t ? e = 2 * Math.PI * 6378137 / 360 : "kilometer" === t || "km" === t ? e = .001 : "inch" === t ? e = 1 / .025399999918 : "foot" === t && (e = .3048), e
                    }, t.prototype.getResolution = function (t, e) {
                        return this._resolutions[t] || (this._resolutions[t] = this.worldWidth / Math.pow(2, t) / e), this._resolutions[t]
                    }, t.prototype.getScale = function (t, e) {
                        if (!this._scales[t]) {
                            var i = this.getResolution(t, e), r = this.getMeterPerMapUnit(this.map.getCRS().getUnit());
                            this._scales[t] = 1 / (96 * i * (1 / .0254) * r)
                        }
                        return this._scales[t]
                    }, t
                }(ot.Evented), nt = function (n) {
                    function t(t, e, i, r) {
                        n.call(this), this.id = t, this.dispatcher = i, this.setEventedParent(r), this.type = "raster", this.minzoom = 0, this.maxzoom = 22, this.roundZoom = !0, this.scheme = "xyz", this.tileSize = 512, this._loaded = !1, this._scales = [], this._resolutions = [], this.transparent = !0, this.rasterSource = "", this.cacheEnabled = !0, this.redirect = !1, this.layersID = null, this.proxy = null, this.tileversion = null, this.rasterfunction = null, this.prjCoordSys = null, this.format = "png", this._options = ot.extend({type: "raster"}, e), ot.extend(this, ot.pick(e, ["url", "scheme", "tileSize", "rasterSource", "transparent", "cacheEnabled", "redirect", "layersID", "proxy", "tileversion", "rasterfunction", "format", "prjCoordSys"]))
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.load = function () {
                        var i = this;
                        this._loaded = !1, this.fire(new ot.Event("dataloading", {dataType: "source"})), this._tileJSONRequest = et(this._options, this.map._requestManager, function (t, e) {
                            i._tileJSONRequest = null, i._loaded = !0, t ? i.fire(new ot.ErrorEvent(t)) : e && (ot.extend(i, e), e.bounds && (i.tileBounds = new it(e.bounds, i.minzoom, i.maxzoom)), ot.postTurnstileEvent(e.tiles), ot.postMapLoadEvent(e.tiles, i.map._getMapId(), i.map._requestManager._skuToken), i.fire(new ot.Event("data", {
                                dataType: "source",
                                sourceDataType: "metadata"
                            })), i.fire(new ot.Event("data", {dataType: "source", sourceDataType: "content"})))
                        })
                    }, t.prototype.loaded = function () {
                        return this._loaded
                    }, t.prototype.onAdd = function (t) {
                        this.map = t;
                        var e = t.getCRS();
                        this.worldWidth = e.getWidth(), this.worldHeight = e.getHeight(), this.originX = e.getOriginX(), this.originY = e.getOriginY(), this.load()
                    }, t.prototype.onRemove = function () {
                        this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null)
                    }, t.prototype.serialize = function () {
                        return ot.extend({}, this._options)
                    }, t.prototype.hasTile = function (t) {
                        return !this.tileBounds || this.tileBounds.contains(t.canonical, this.originX, this.originY, this.worldWidth, this.worldHeight, this.map.getCRS())
                    }, t.prototype.loadTile = function (n, a) {
                        var o = this, t = null;
                        if ("iserver" === this.rasterSource && this.getScale) {
                            var e = this.getScale(n.tileID.canonical.z, this.tileSize),
                                i = this.map._mapCRS.getOrigin(),
                                r = ("" + this.tiles[(n.tileID.canonical.x + n.tileID.canonical.y) % this.tiles.length]).split("?");
                            t = r[0] + "/tileimage." + this.format + "?scale=" + e + "&x=" + n.tileID.canonical.x + "&y=" + n.tileID.canonical.y + "&width=" + this.tileSize + "&height=" + this.tileSize + "&transparent=" + this.transparent + "&redirect=" + this.redirect + "&cacheEnabled=" + this.cacheEnabled + "&origin=" + encodeURIComponent(JSON.stringify({
                                x: i[0],
                                y: i[1]
                            })), this.layersID && (t = t + "&layersID=" + this.layersID), this.tileversion && (t = t + "&tileversion=" + this.tileversion), this.rasterfunction && (t = t + "&rasterfunction=" + encodeURIComponent(JSON.stringify(this.rasterfunction))), this.prjCoordSys && (t = t + "&prjCoordSys=" + encodeURIComponent(JSON.stringify(this.prjCoordSys))), r[1] && (t = t + "&" + r[1])
                        } else {
                            var s = parseInt(this._options.zoomOffset) ? parseInt(this._options.zoomOffset) : 0;
                            t = this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles, this.scheme, s, this.tileSize, this.getScale ? this.getScale(n.tileID.canonical.z, this.tileSize) : void 0), this.url, this.tileSize)
                        }
                        this.proxy && (t = "" + this.proxy + encodeURIComponent(t)), n.request = ot.getImage(this.map._requestManager.transformRequest(t, ot.ResourceType.Tile), function (t, e) {
                            if (delete n.request, n.aborted) n.state = "unloaded", a(null); else if (t) n.state = "errored", a(t); else if (e) {
                                o.map._refreshExpiredTiles && n.setExpiryData(e), delete e.cacheControl, delete e.expires;
                                var i = o.map.painter.context, r = i.gl;
                                n.texture = o.map.painter.getTileTexture(e.width), n.texture ? n.texture.update(e, {useMipmap: !0}) : (n.texture = new ot.Texture(i, e, r.RGBA, {useMipmap: !0}), n.texture.bind(r.LINEAR, r.CLAMP_TO_EDGE, r.LINEAR_MIPMAP_NEAREST), i.extTextureFilterAnisotropic && r.texParameterf(r.TEXTURE_2D, i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, i.extTextureFilterAnisotropicMax)), n.state = "loaded", ot.cacheEntryPossiblyAdded(o.dispatcher), a(null)
                            }
                        })
                    }, t.prototype.abortTile = function (t, e) {
                        t.request && (t.request.cancel(), delete t.request), e()
                    }, t.prototype.unloadTile = function (t, e) {
                        t.texture && this.map.painter.saveTileTexture(t.texture), e()
                    }, t.prototype.hasTransition = function () {
                        return !1
                    }, t.prototype.getMeterPerMapUnit = function (t) {
                        var e = 1;
                        return "degree" === t || "degrees" === t || "d" === t ? e = 2 * Math.PI * 6378137 / 360 : "kilometer" === t || "km" === t ? e = .001 : "inch" === t ? e = 1 / .025399999918 : "foot" === t && (e = .3048), e
                    }, t.prototype.getResolution = function (t, e) {
                        return this._resolutions[t] || (this._resolutions[t] = this.worldWidth / Math.pow(2, t) / e), this._resolutions[t]
                    }, t.prototype.getScale = function (t, e) {
                        if (!this._scales[t]) {
                            var i = this.getResolution(t, e), r = this.getMeterPerMapUnit(this.map.getCRS().getUnit());
                            this._scales[t] = 1 / (96 * i * (1 / .0254) * r)
                        }
                        return this._scales[t]
                    }, t
                }(ot.Evented), at = function (n) {
                    function t(t, e, i, r) {
                        n.call(this, t, e, i, r), this.type = "raster-dem", this.maxzoom = 22, this._options = ot.extend({type: "raster-dem"}, e), this.encoding = e.encoding || "mapbox"
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.serialize = function () {
                        return {
                            type: "raster-dem",
                            url: this.url,
                            tileSize: this.tileSize,
                            tiles: this.tiles,
                            bounds: this.bounds,
                            encoding: this.encoding
                        }
                    }, t.prototype.loadTile = function (n, a) {
                        var t = this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles, this.scheme), this.tileSize);

                        function o(t, e) {
                            t && (n.state = "errored", a(t)), e && (n.dem = e, n.needsHillshadePrepare = !0, n.state = "loaded", a(null))
                        }

                        n.request = ot.getImage(this.map._requestManager.transformRequest(t, ot.ResourceType.Tile), function (t, e) {
                            if (delete n.request, n.aborted) n.state = "unloaded", a(null); else if (t) n.state = "errored", a(t); else if (e) {
                                this.map._refreshExpiredTiles && n.setExpiryData(e), delete e.cacheControl, delete e.expires;
                                var i = ot.window.ImageBitmap && e instanceof ot.window.ImageBitmap && ot.offscreenCanvasSupported() ? e : ot.browser.getImageData(e, 1),
                                    r = {
                                        uid: n.uid,
                                        coord: n.tileID,
                                        source: this.id,
                                        rawImageData: i,
                                        encoding: this.encoding
                                    };
                                n.actor && "expired" !== n.state || (n.actor = this.dispatcher.getActor(), n.actor.send("loadDEMTile", r, o.bind(this)))
                            }
                        }.bind(this)), n.neighboringTiles = this._getNeighboringTiles(n.tileID)
                    }, t.prototype._getNeighboringTiles = function (t) {
                        var e = t.canonical, i = Math.pow(2, e.z), r = (e.x - 1 + i) % i,
                            n = 0 === e.x ? t.wrap - 1 : t.wrap, a = (e.x + 1 + i) % i,
                            o = e.x + 1 === i ? t.wrap + 1 : t.wrap, s = {};
                        return s[new ot.OverscaledTileID(t.overscaledZ, n, e.z, r, e.y).key] = {backfilled: !1}, s[new ot.OverscaledTileID(t.overscaledZ, o, e.z, a, e.y).key] = {backfilled: !1}, e.y > 0 && (s[new ot.OverscaledTileID(t.overscaledZ, n, e.z, r, e.y - 1).key] = {backfilled: !1}, s[new ot.OverscaledTileID(t.overscaledZ, t.wrap, e.z, e.x, e.y - 1).key] = {backfilled: !1}, s[new ot.OverscaledTileID(t.overscaledZ, o, e.z, a, e.y - 1).key] = {backfilled: !1}), e.y + 1 < i && (s[new ot.OverscaledTileID(t.overscaledZ, n, e.z, r, e.y + 1).key] = {backfilled: !1}, s[new ot.OverscaledTileID(t.overscaledZ, t.wrap, e.z, e.x, e.y + 1).key] = {backfilled: !1}, s[new ot.OverscaledTileID(t.overscaledZ, o, e.z, a, e.y + 1).key] = {backfilled: !1}), s
                    }, t.prototype.unloadTile = function (t) {
                        t.demTexture && this.map.painter.saveTileTexture(t.demTexture), t.fbo && (t.fbo.destroy(), delete t.fbo), t.dem && delete t.dem, delete t.neighboringTiles, t.state = "unloaded", t.actor && t.actor.send("removeDEMTile", {
                            uid: t.uid,
                            source: this.id
                        })
                    }, t
                }(nt), ut = function (a) {
                    function t(t, e, i, r) {
                        a.call(this), this.id = t, this.type = "geojson", this.minzoom = 0, this.maxzoom = 18, this.tileSize = 512, this.isTileClipped = !0, this.reparseOverscaled = !0, this._removed = !1, this._loaded = !1, this.actor = i.getActor(), this.setEventedParent(r), this._data = e.data, this._options = ot.extend({}, e), this._collectResourceTiming = e.collectResourceTiming, this._resourceTiming = [], void 0 !== e.maxzoom && (this.maxzoom = e.maxzoom), e.type && (this.type = e.type), e.attribution && (this.attribution = e.attribution), this.promoteId = e.promoteId;
                        var n = ot.EXTENT / this.tileSize;
                        this.workerOptions = ot.extend({
                            source: this.id,
                            cluster: e.cluster || !1,
                            geojsonVtOptions: {
                                buffer: (void 0 !== e.buffer ? e.buffer : 128) * n,
                                tolerance: (void 0 !== e.tolerance ? e.tolerance : .375) * n,
                                extent: ot.EXTENT,
                                customprj: e.customprj,
                                maxZoom: this.maxzoom,
                                lineMetrics: e.lineMetrics || !1,
                                generateId: e.generateId || !1
                            },
                            superclusterOptions: {
                                maxZoom: void 0 !== e.clusterMaxZoom ? Math.min(e.clusterMaxZoom, this.maxzoom - 1) : this.maxzoom - 1,
                                minPoints: Math.max(2, e.clusterMinPoints || 2),
                                extent: ot.EXTENT,
                                customprj: e.customprj,
                                radius: (e.clusterRadius || 50) * n,
                                log: !1,
                                generateId: e.generateId || !1
                            },
                            clusterProperties: e.clusterProperties,
                            filter: e.filter
                        }, e.workerOptions)
                    }

                    return a && (t.__proto__ = a), (t.prototype = Object.create(a && a.prototype)).constructor = t, t.prototype.load = function () {
                        var i = this;
                        this.fire(new ot.Event("dataloading", {dataType: "source"})), this._updateWorkerData(function (t) {
                            if (t) i.fire(new ot.ErrorEvent(t)); else {
                                var e = {dataType: "source", sourceDataType: "metadata"};
                                i._collectResourceTiming && i._resourceTiming && i._resourceTiming.length > 0 && (e.resourceTiming = i._resourceTiming, i._resourceTiming = []), i.fire(new ot.Event("data", e))
                            }
                        })
                    }, t.prototype.onAdd = function (t) {
                        this.map = t, this.workerOptions.crs = {
                            epsgCode: this.map.getCRS().epsgCode,
                            WKT: this.map.getCRS().getWKT(),
                            _id: this.map.getCRS()._id
                        }, this.load()
                    }, t.prototype.setCustomprj = function (t) {
                        this._options.customprj = t, this.workerOptions.superclusterOptions.customprj = t, this.workerOptions.geojsonVtOptions.customprj = t, this.workerOptions.crs = {
                            epsgCode: this.map.getCRS().epsgCode,
                            WKT: this.map.getCRS().getWKT(),
                            _id: this.map.getCRS()._id
                        }, this.load()
                    }, t.prototype.setData = function (t) {
                        var i = this;
                        return this._data = t, this.fire(new ot.Event("dataloading", {dataType: "source"})), this._updateWorkerData(function (t) {
                            if (t) i.fire(new ot.ErrorEvent(t)); else {
                                var e = {dataType: "source", sourceDataType: "content"};
                                i._collectResourceTiming && i._resourceTiming && i._resourceTiming.length > 0 && (e.resourceTiming = i._resourceTiming, i._resourceTiming = []), i.fire(new ot.Event("data", e))
                            }
                        }), this
                    }, t.prototype.getData = function () {
                        return this._originData ? this._originData : "string" != typeof this._data ? this._data : void 0
                    }, t.prototype.getClusterExpansionZoom = function (t, e) {
                        return this.actor.send("geojson.getClusterExpansionZoom", {
                            clusterId: t,
                            source: this.id
                        }, e), this
                    }, t.prototype.getClusterChildren = function (t, e) {
                        return this.actor.send("geojson.getClusterChildren", {clusterId: t, source: this.id}, e), this
                    }, t.prototype.getClusterLeaves = function (t, e, i, r) {
                        return this.actor.send("geojson.getClusterLeaves", {
                            source: this.id,
                            clusterId: t,
                            limit: e,
                            offset: i
                        }, r), this
                    }, t.prototype._updateWorkerData = function (i) {
                        var r = this;
                        this._loaded = !1;
                        var n = ot.extend({}, this.workerOptions), t = this._data;
                        "string" == typeof t ? (n.request = this.map._requestManager.transformRequest(ot.browser.resolveURL(t), ot.ResourceType.Source), n.request.collectResourceTiming = this._collectResourceTiming) : n.data = JSON.stringify(t), this.actor.send(this.type + ".loadData", n, function (t, e) {
                            r._originData = e.data || null, r._removed || e && e.abandoned || (r._loaded = !0, e && e.resourceTiming && e.resourceTiming[r.id] && (r._resourceTiming = e.resourceTiming[r.id].slice(0)), r.actor.send(r.type + ".coalesce", {source: n.source}, null), i(t))
                        })
                    }, t.prototype.loaded = function () {
                        return this._loaded
                    }, t.prototype.loadTile = function (i, r) {
                        var n = this, a = i.actor ? "reloadTile" : "loadTile";
                        i.actor = this.actor, i.request = this.actor.send(a, {
                            type: this.type,
                            uid: i.uid,
                            tileID: i.tileID,
                            zoom: i.tileID.overscaledZ,
                            maxZoom: this.maxzoom,
                            tileSize: this.tileSize,
                            source: this.id,
                            pixelRatio: ot.browser.devicePixelRatio,
                            showCollisionBoxes: this.map.showCollisionBoxes,
                            promoteId: this.promoteId
                        }, function (t, e) {
                            return delete i.request, i.unloadVectorData(), i.aborted ? r(null) : t ? r(t) : (i.loadVectorData(e, n.map.painter, "reloadTile" === a), r(null))
                        })
                    }, t.prototype.abortTile = function (t) {
                        t.request && (t.request.cancel(), delete t.request), t.aborted = !0
                    }, t.prototype.unloadTile = function (t) {
                        t.unloadVectorData(), this.actor.send("removeTile", {
                            uid: t.uid,
                            type: this.type,
                            source: this.id
                        })
                    }, t.prototype.onRemove = function () {
                        this._removed = !0, this.actor.send("removeSource", {type: this.type, source: this.id})
                    }, t.prototype.serialize = function () {
                        return ot.extend({}, this._options, {type: this.type, data: this._data})
                    }, t.prototype.hasTransition = function () {
                        return !1
                    }, t
                }(ot.Evented), ht = ot.createLayout([{name: "a_pos", type: "Int16", components: 2}, {
                    name: "a_texture_pos",
                    type: "Int16",
                    components: 2
                }]), ct = function (n) {
                    function t(t, e, i, r) {
                        n.call(this), this.id = t, this.dispatcher = i, this.coordinates = e.coordinates, this.type = "image", this.minzoom = 0, this.maxzoom = 22, this.tileSize = 512, this.tiles = {}, this._loaded = !1, this.setEventedParent(r), this.options = e
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.load = function (i, r) {
                        var n = this;
                        this._loaded = !1, this.fire(new ot.Event("dataloading", {dataType: "source"})), this.url = this.options.url, ot.getImage(this.map._requestManager.transformRequest(this.url, ot.ResourceType.Image), function (t, e) {
                            n._loaded = !0, t ? n.fire(new ot.ErrorEvent(t)) : e && (n.image = e, i && (n.coordinates = i), r && r(), n._finishLoading())
                        })
                    }, t.prototype.loaded = function () {
                        return this._loaded
                    }, t.prototype.updateImage = function (t) {
                        var e = this;
                        return this.image && t.url ? (this.options.url = t.url, this.load(t.coordinates, function () {
                            e.texture = null
                        }), this) : this
                    }, t.prototype._finishLoading = function () {
                        this.map && (this.setCoordinates(this.coordinates), this.fire(new ot.Event("data", {
                            dataType: "source",
                            sourceDataType: "metadata"
                        })))
                    }, t.prototype.onAdd = function (t) {
                        this.map = t, this.load()
                    }, t.prototype.setCoordinates = function (t) {
                        var e = this;
                        this.coordinates = t;
                        var i = t.map(function (t) {
                            return e.map.getCRS().fromLngLat(t)
                        });
                        this.tileID = function (t, e) {
                            for (var i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = 0, s = t; o < s.length; o += 1) {
                                var l = s[o];
                                i = Math.min(i, l.x), r = Math.min(r, l.y), n = Math.max(n, l.x), a = Math.max(a, l.y)
                            }
                            var u = Math.max(n - i, a - r), h = Math.max(0, Math.floor(-Math.log(u) / Math.LN2)),
                                c = Math.pow(2, h);
                            return new ot.CanonicalTileID(h, Math.floor((i + n) / 2 * c), Math.floor((r + a) / 2 * c), e)
                        }(i, this.map.getCRS().getExtent()), this.minzoom = this.maxzoom = this.tileID.z;
                        var r = i.map(function (t) {
                            return e.tileID.getTilePoint(t)._round()
                        });
                        return this._boundsArray = new ot.StructArrayLayout4i8, this._boundsArray.emplaceBack(r[0].x, r[0].y, 0, 0), this._boundsArray.emplaceBack(r[1].x, r[1].y, ot.EXTENT, 0), this._boundsArray.emplaceBack(r[3].x, r[3].y, 0, ot.EXTENT), this._boundsArray.emplaceBack(r[2].x, r[2].y, ot.EXTENT, ot.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this.fire(new ot.Event("data", {
                            dataType: "source",
                            sourceDataType: "content"
                        })), this
                    }, t.prototype.prepare = function () {
                        if (0 !== Object.keys(this.tiles).length && this.image) {
                            var t = this.map.painter.context, e = t.gl;
                            for (var i in this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, ht.members)), this.boundsSegments || (this.boundsSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new ot.Texture(t, this.image, e.RGBA), this.texture.bind(e.LINEAR, e.CLAMP_TO_EDGE)), this.tiles) {
                                var r = this.tiles[i];
                                "loaded" !== r.state && (r.state = "loaded", r.texture = this.texture)
                            }
                        }
                    }, t.prototype.loadTile = function (t, e) {
                        this.tileID && this.tileID.equals(t.tileID.canonical) ? (this.tiles[String(t.tileID.wrap)] = t, t.buckets = {}, e(null)) : (t.state = "errored", e(null))
                    }, t.prototype.serialize = function () {
                        return {type: "image", url: this.options.url, coordinates: this.coordinates}
                    }, t.prototype.hasTransition = function () {
                        return !1
                    }, t
                }(ot.Evented), pt = function (n) {
                    function t(t, e, i, r) {
                        n.call(this, t, e, i, r), this.roundZoom = !0, this.type = "video", this.options = e
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.load = function () {
                        this._loaded = !1, this._acceptedVideo = !1;
                        var t = this.options;
                        this.urls = [];
                        for (var e = 0, i = t.urls; e < i.length; e += 1) this.urls.push(this.map._requestManager.transformRequest(i[e], ot.ResourceType.Source).url);
                        if (/^(http|https):\/\/.*/.test(this.urls[0])) ot.getVideo(this.urls, this.initVideo.bind(this)); else {
                            this._acceptedVideo = !0;
                            var r = document.getElementById(this.urls[0]);
                            this.initVideo(!r && new ot.ValidationError("sources." + this.id, null, "video is not found"), r)
                        }
                    }, t.prototype.initVideo = function (t, e) {
                        var i = this;
                        i._manualFakePlay = !0, this._loaded = !0, t ? this.fire(new ot.ErrorEvent(t)) : e && (this.video = e, this._acceptedVideo && !1 === this.video.loop || (this.video.loop = !0), this.video.addEventListener("playing", function () {
                            i.map.triggerRepaint()
                        }), this.video.addEventListener("timeupdate", function () {
                            i._firstFrameRendered && i._manualFakePlay && (i.video.autoplay || (i.video.currentTime = 0, i.video.pause()), i._manualFakePlay = !1, i.fire(new Event("videoloaded")))
                        }), this.map && (this._acceptedVideo || (this.video.autoplay = !0), this.video.muted = !0, this.video.play()), this._finishLoading())
                    }, t.prototype.pause = function () {
                        this.video && this.video.pause()
                    }, t.prototype.play = function () {
                        this.video && this.video.play()
                    }, t.prototype.seek = function (t) {
                        if (this.video) {
                            var e = this.video.seekable;
                            t < e.start(0) || t > e.end(0) ? this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + this.id, null, "Playback for this video can be set only between the " + e.start(0) + " and " + e.end(0) + "-second mark."))) : this.video.currentTime = t
                        }
                    }, t.prototype.getVideo = function () {
                        return this.video
                    }, t.prototype.onAdd = function (t) {
                        this.map || (this.map = t, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)))
                    }, t.prototype.prepare = function () {
                        if (!(0 === Object.keys(this.tiles).length || this.video.readyState < 2)) {
                            var t = this.map.painter.context, e = t.gl;
                            for (var i in this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, ht.members)), this.boundsSegments || (this.boundsSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(e.LINEAR, e.CLAMP_TO_EDGE), e.texSubImage2D(e.TEXTURE_2D, 0, 0, 0, e.RGBA, e.UNSIGNED_BYTE, this.video), this._firstFrameRendered = !0) : (this.texture = new ot.Texture(t, this.video, e.RGBA), this.texture.bind(e.LINEAR, e.CLAMP_TO_EDGE)), this.tiles) {
                                var r = this.tiles[i];
                                "loaded" !== r.state && (r.state = "loaded", r.texture = this.texture)
                            }
                        }
                    }, t.prototype.serialize = function () {
                        return {type: "video", urls: this.urls, coordinates: this.coordinates}
                    }, t.prototype.hasTransition = function () {
                        return this.video && !this.video.paused
                    }, t
                }(ct), ft = function (n) {
                    function t(t, e, i, r) {
                        n.call(this, t, e, i, r), e.coordinates ? Array.isArray(e.coordinates) && 4 === e.coordinates.length && !e.coordinates.some(function (t) {
                            return !Array.isArray(t) || 2 !== t.length || t.some(function (t) {
                                return "number" != typeof t
                            })
                        }) || this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + t, null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + t, null, 'missing required property "coordinates"'))), e.animate && "boolean" != typeof e.animate && this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + t, null, 'optional "animate" property must be a boolean value'))), e.canvas ? "string" == typeof e.canvas || e.canvas instanceof ot.window.HTMLCanvasElement || this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + t, null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : this.fire(new ot.ErrorEvent(new ot.ValidationError("sources." + t, null, 'missing required property "canvas"'))), this.options = e, this.animate = void 0 === e.animate || e.animate
                    }

                    return n && (t.__proto__ = n), (t.prototype = Object.create(n && n.prototype)).constructor = t, t.prototype.load = function () {
                        this._loaded = !0, this.canvas || (this.canvas = this.options.canvas instanceof ot.window.HTMLCanvasElement ? this.options.canvas : ot.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new ot.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function () {
                            this._playing = !0, this.map.triggerRepaint()
                        }, this.pause = function () {
                            this._playing && (this.prepare(), this._playing = !1)
                        }, this._finishLoading())
                    }, t.prototype.getCanvas = function () {
                        return this.canvas
                    }, t.prototype.onAdd = function (t) {
                        this.map = t, this.load(), this.canvas && this.animate && this.play()
                    }, t.prototype.onRemove = function () {
                        this.pause()
                    }, t.prototype.prepare = function () {
                        var t = !1;
                        if (this.canvas.width !== this.width && (this.width = this.canvas.width, t = !0), this.canvas.height !== this.height && (this.height = this.canvas.height, t = !0), !this._hasInvalidDimensions() && 0 !== Object.keys(this.tiles).length) {
                            var e = this.map.painter.context, i = e.gl;
                            for (var r in this.boundsBuffer || (this.boundsBuffer = e.createVertexBuffer(this._boundsArray, ht.members)), this.boundsSegments || (this.boundsSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (t || this._playing) && this.texture.update(this.canvas, {premultiply: !0}) : this.texture = new ot.Texture(e, this.canvas, i.RGBA, {premultiply: !0}), this.tiles) {
                                var n = this.tiles[r];
                                "loaded" !== n.state && (n.state = "loaded", n.texture = this.texture)
                            }
                        }
                    }, t.prototype.serialize = function () {
                        return {type: "canvas", coordinates: this.coordinates}
                    }, t.prototype.hasTransition = function () {
                        return this._playing
                    }, t.prototype._hasInvalidDimensions = function () {
                        for (var t = 0, e = [this.canvas.width, this.canvas.height]; t < e.length; t += 1) {
                            var i = e[t];
                            if (isNaN(i) || i <= 0) return !0
                        }
                        return !1
                    }, t
                }(ct), dt = {vector: rt, raster: nt, "raster-dem": at, geojson: ut, video: pt, image: ct, canvas: ft};

                function mt(t, e) {
                    var i = ot.identity([]);
                    return ot.translate(i, i, [1, 1, 0]), ot.scale(i, i, [.5 * t.width, .5 * t.height, 1]), ot.multiply(i, i, t.calculatePosMatrix(e.toUnwrapped()))
                }

                function yt(r, t, e, i, n, a) {
                    var o = function (t, e, i) {
                        if (t) for (var r = 0, n = t; r < n.length; r += 1) {
                            var a = e[n[r]];
                            if (a && a.source === i && "fill-extrusion" === a.type) return !0
                        } else for (var o in e) {
                            var s = e[o];
                            if (s.source === i && "fill-extrusion" === s.type) return !0
                        }
                        return !1
                    }(n && n.layers, t, r.id), s = a.maxPitchScaleFactor(), l = r.tilesIn(i, s, o);
                    l.sort(gt);
                    for (var u = [], h = 0, c = l; h < c.length; h += 1) {
                        var p = c[h];
                        u.push({
                            wrappedTileID: p.tileID.wrapped().key,
                            queryResults: p.tile.queryRenderedFeatures(t, e, r._state, p.queryGeometry, p.cameraQueryGeometry, p.scale, n, a, s, mt(r.transform, p.tileID))
                        })
                    }
                    var f = function (t) {
                        for (var e = {}, i = {}, r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r], o = a.queryResults, s = a.wrappedTileID, l = i[s] = i[s] || {};
                            for (var u in o) for (var h = o[u], c = l[u] = l[u] || {}, p = e[u] = e[u] || [], f = 0, d = h; f < d.length; f += 1) {
                                var m = d[f];
                                c[m.featureIndex] || (c[m.featureIndex] = !0, p.push(m))
                            }
                        }
                        return e
                    }(u);
                    for (var d in f) f[d].forEach(function (t) {
                        var e = t.feature, i = r.getFeatureState(e.layer["source-layer"], e.id);
                        e.source = e.layer.source, e.layer["source-layer"] && (e.sourceLayer = e.layer["source-layer"]), e.state = i
                    });
                    return f
                }

                function gt(t, e) {
                    var i = t.tileID, r = e.tileID;
                    return i.overscaledZ - r.overscaledZ || i.canonical.y - r.canonical.y || i.wrap - r.wrap || i.canonical.x - r.canonical.x
                }

                var a = function (t, e) {
                    this.max = t, this.onRemove = e, this.reset()
                };
                a.prototype.reset = function () {
                    for (var t in this.data) for (var e = 0, i = this.data[t]; e < i.length; e += 1) {
                        var r = i[e];
                        r.timeout && clearTimeout(r.timeout), this.onRemove(r.value)
                    }
                    return this.data = {}, this.order = [], this
                }, a.prototype.add = function (t, e, i) {
                    var r = this, n = t.wrapped().key;
                    void 0 === this.data[n] && (this.data[n] = []);
                    var a = {value: e, timeout: void 0};
                    if (void 0 !== i && (a.timeout = setTimeout(function () {
                        r.remove(t, a)
                    }, i)), this.data[n].push(a), this.order.push(n), this.order.length > this.max) {
                        var o = this._getAndRemoveByKey(this.order[0]);
                        o && this.onRemove(o)
                    }
                    return this
                }, a.prototype.has = function (t) {
                    return t.wrapped().key in this.data
                }, a.prototype.getAndRemove = function (t) {
                    return this.has(t) ? this._getAndRemoveByKey(t.wrapped().key) : null
                }, a.prototype._getAndRemoveByKey = function (t) {
                    var e = this.data[t].shift();
                    return e.timeout && clearTimeout(e.timeout), 0 === this.data[t].length && delete this.data[t], this.order.splice(this.order.indexOf(t), 1), e.value
                }, a.prototype.getByKey = function (t) {
                    var e = this.data[t];
                    return e ? e[0].value : null
                }, a.prototype.get = function (t) {
                    return this.has(t) ? this.data[t.wrapped().key][0].value : null
                }, a.prototype.remove = function (t, e) {
                    if (!this.has(t)) return this;
                    var i = t.wrapped().key, r = void 0 === e ? 0 : this.data[i].indexOf(e), n = this.data[i][r];
                    return this.data[i].splice(r, 1), n.timeout && clearTimeout(n.timeout), 0 === this.data[i].length && delete this.data[i], this.onRemove(n.value), this.order.splice(this.order.indexOf(i), 1), this
                }, a.prototype.setMaxSize = function (t) {
                    for (this.max = t; this.order.length > this.max;) {
                        var e = this._getAndRemoveByKey(this.order[0]);
                        e && this.onRemove(e)
                    }
                    return this
                }, a.prototype.filter = function (t) {
                    var e = [];
                    for (var i in this.data) for (var r = 0, n = this.data[i]; r < n.length; r += 1) {
                        var a = n[r];
                        t(a.value) || e.push(a)
                    }
                    for (var o = 0, s = e; o < s.length; o += 1) {
                        var l = s[o];
                        this.remove(l.value.tileID, l)
                    }
                };
                var _t = function (t, e, i) {
                    this.context = t;
                    var r = t.gl;
                    this.buffer = r.createBuffer(), this.dynamicDraw = Boolean(i), this.context.unbindVAO(), t.bindElementBuffer.set(this.buffer), r.bufferData(r.ELEMENT_ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? r.DYNAMIC_DRAW : r.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer
                };
                _t.prototype.bind = function () {
                    this.context.bindElementBuffer.set(this.buffer)
                }, _t.prototype.updateData = function (t) {
                    var e = this.context.gl;
                    this.context.unbindVAO(), this.bind(), e.bufferSubData(e.ELEMENT_ARRAY_BUFFER, 0, t.arrayBuffer)
                }, _t.prototype.destroy = function () {
                    this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer)
                };
                var vt = {
                    Int8: "BYTE",
                    Uint8: "UNSIGNED_BYTE",
                    Int16: "SHORT",
                    Uint16: "UNSIGNED_SHORT",
                    Int32: "INT",
                    Uint32: "UNSIGNED_INT",
                    Float32: "FLOAT"
                }, xt = function (t, e, i, r) {
                    this.length = e.length, this.attributes = i, this.itemSize = e.bytesPerElement, this.dynamicDraw = r, this.context = t;
                    var n = t.gl;
                    this.buffer = n.createBuffer(), t.bindVertexBuffer.set(this.buffer), n.bufferData(n.ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? n.DYNAMIC_DRAW : n.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer
                };
                xt.prototype.bind = function () {
                    this.context.bindVertexBuffer.set(this.buffer)
                }, xt.prototype.updateData = function (t) {
                    var e = this.context.gl;
                    this.bind(), e.bufferSubData(e.ARRAY_BUFFER, 0, t.arrayBuffer)
                }, xt.prototype.enableAttributes = function (t, e) {
                    for (var i = 0; i < this.attributes.length; i++) {
                        var r = e.attributes[this.attributes[i].name];
                        void 0 !== r && t.enableVertexAttribArray(r)
                    }
                }, xt.prototype.setVertexAttribPointers = function (t, e, i) {
                    for (var r = 0; r < this.attributes.length; r++) {
                        var n = this.attributes[r], a = e.attributes[n.name];
                        void 0 !== a && t.vertexAttribPointer(a, n.components, t[vt[n.type]], !1, this.itemSize, n.offset + this.itemSize * (i || 0))
                    }
                }, xt.prototype.destroy = function () {
                    this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer)
                };
                var t = function (t) {
                    this.gl = t.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = !1
                };
                t.prototype.get = function () {
                    return this.current
                }, t.prototype.set = function (t) {
                }, t.prototype.getDefault = function () {
                    return this.default
                }, t.prototype.setDefault = function () {
                    this.set(this.default)
                };
                var bt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return ot.Color.transparent
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.clearColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1)
                    }, e
                }(t), wt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return 1
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.clearDepth(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Mt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return 0
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.clearStencil(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), St = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return [!0, !0, !0, !0]
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.colorMask(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1)
                    }, e
                }(t), Et = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !0
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.depthMask(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), It = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return 255
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.stencilMask(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Tt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return {func: this.gl.ALWAYS, ref: 0, mask: 255}
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t.func !== e.func || t.ref !== e.ref || t.mask !== e.mask || this.dirty) && (this.gl.stencilFunc(t.func, t.ref, t.mask), this.current = t, this.dirty = !1)
                    }, e
                }(t), Ct = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        var t = this.gl;
                        return [t.KEEP, t.KEEP, t.KEEP]
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || this.dirty) && (this.gl.stencilOp(t[0], t[1], t[2]), this.current = t, this.dirty = !1)
                    }, e
                }(t), Pt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            t ? e.enable(e.STENCIL_TEST) : e.disable(e.STENCIL_TEST), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), At = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return [0, 1]
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.depthRange(t[0], t[1]), this.current = t, this.dirty = !1)
                    }, e
                }(t), zt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            t ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), kt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return this.gl.LESS
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.depthFunc(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Lt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            t ? e.enable(e.BLEND) : e.disable(e.BLEND), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Dt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        var t = this.gl;
                        return [t.ONE, t.ZERO]
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.blendFunc(t[0], t[1]), this.current = t, this.dirty = !1)
                    }, e
                }(t), Rt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return ot.Color.transparent
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.blendColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1)
                    }, e
                }(t), Bt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return this.gl.FUNC_ADD
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.blendEquation(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Ot = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            t ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Ft = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return this.gl.BACK
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.cullFace(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Ut = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return this.gl.CCW
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.frontFace(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Nt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.useProgram(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), Vt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return this.gl.TEXTURE0
                    }, e.prototype.set = function (t) {
                        (t !== this.current || this.dirty) && (this.gl.activeTexture(t), this.current = t, this.dirty = !1)
                    }, e
                }(t), jt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        var t = this.gl;
                        return [0, 0, t.drawingBufferWidth, t.drawingBufferHeight]
                    }, e.prototype.set = function (t) {
                        var e = this.current;
                        (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.viewport(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1)
                    }, e
                }(t), qt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.bindFramebuffer(e.FRAMEBUFFER, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Gt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.bindRenderbuffer(e.RENDERBUFFER, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Zt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.bindTexture(e.TEXTURE_2D, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Wt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.bindBuffer(e.ARRAY_BUFFER, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Xt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return null
                    }, e.prototype.set = function (t) {
                        var e = this.gl;
                        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, t), this.current = t, this.dirty = !1
                    }, e
                }(t), Ht = function (e) {
                    function t(t) {
                        e.call(this, t), this.vao = t.extVertexArrayObject
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.getDefault = function () {
                        return null
                    }, t.prototype.set = function (t) {
                        this.vao && (t !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t), this.current = t, this.dirty = !1)
                    }, t
                }(t), Kt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return 4
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.pixelStorei(e.UNPACK_ALIGNMENT, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Yt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Jt = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                        return !1
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            var e = this.gl;
                            e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(t), Qt = function (i) {
                    function t(t, e) {
                        i.call(this, t), this.context = t, this.parent = e
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.getDefault = function () {
                        return null
                    }, t
                }(t), $t = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.setDirty = function () {
                        this.dirty = !0
                    }, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            this.context.bindFramebuffer.set(this.parent);
                            var e = this.gl;
                            e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, t, 0), this.current = t, this.dirty = !1
                        }
                    }, e
                }(Qt), te = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                        if (t !== this.current || this.dirty) {
                            this.context.bindFramebuffer.set(this.parent);
                            var e = this.gl;
                            e.framebufferRenderbuffer(e.FRAMEBUFFER, e.DEPTH_ATTACHMENT, e.RENDERBUFFER, t), this.current = t, this.dirty = !1
                        }
                    }, e
                }(Qt), ee = function (t, e, i, r) {
                    this.context = t, this.width = e, this.height = i;
                    var n = this.framebuffer = t.gl.createFramebuffer();
                    this.colorAttachment = new $t(t, n), r && (this.depthAttachment = new te(t, n))
                };
                ee.prototype.destroy = function () {
                    var t = this.context.gl, e = this.colorAttachment.get();
                    if (e && t.deleteTexture(e), this.depthAttachment) {
                        var i = this.depthAttachment.get();
                        i && t.deleteRenderbuffer(i)
                    }
                    t.deleteFramebuffer(this.framebuffer)
                };
                var st = function (t, e, i) {
                    this.func = t, this.mask = e, this.range = i
                };
                st.ReadOnly = !1, st.ReadWrite = !0, st.disabled = new st(519, st.ReadOnly, [0, 1]);
                var N = function (t, e, i, r, n, a) {
                    this.test = t, this.ref = e, this.mask = i, this.fail = r, this.depthFail = n, this.pass = a
                };
                N.disabled = new N({func: 519, mask: 0}, 0, 0, 7680, 7680, 7680);
                var m = function (t, e, i) {
                    this.blendFunction = t, this.blendColor = e, this.mask = i
                };
                m.disabled = new m(m.Replace = [1, 0], ot.Color.transparent, [!1, !1, !1, !1]), m.unblended = new m(m.Replace, ot.Color.transparent, [!0, !0, !0, !0]), m.alphaBlended = new m([1, 771], ot.Color.transparent, [!0, !0, !0, !0]);
                var V = function (t, e, i) {
                    this.enable = t, this.mode = e, this.frontFace = i
                };
                V.disabled = new V(!1, 1029, 2305), V.backCCW = new V(!0, 1029, 2305);
                var i = function (t) {
                    this.gl = t, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new bt(this), this.clearDepth = new wt(this), this.clearStencil = new Mt(this), this.colorMask = new St(this), this.depthMask = new Et(this), this.stencilMask = new It(this), this.stencilFunc = new Tt(this), this.stencilOp = new Ct(this), this.stencilTest = new Pt(this), this.depthRange = new At(this), this.depthTest = new zt(this), this.depthFunc = new kt(this), this.blend = new Lt(this), this.blendFunc = new Dt(this), this.blendColor = new Rt(this), this.blendEquation = new Bt(this), this.cullFace = new Ot(this), this.cullFaceSide = new Ft(this), this.frontFace = new Ut(this), this.program = new Nt(this), this.activeTexture = new Vt(this), this.viewport = new jt(this), this.bindFramebuffer = new qt(this), this.bindRenderbuffer = new Gt(this), this.bindTexture = new Zt(this), this.bindVertexBuffer = new Wt(this), this.bindElementBuffer = new Xt(this), this.bindVertexArrayOES = this.extVertexArrayObject && new Ht(this), this.pixelStoreUnpack = new Kt(this), this.pixelStoreUnpackPremultiplyAlpha = new Yt(this), this.pixelStoreUnpackFlipY = new Jt(this), this.extTextureFilterAnisotropic = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureHalfFloat = t.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t.getExtension("EXT_disjoint_timer_query"), this.maxTextureSize = t.getParameter(t.MAX_TEXTURE_SIZE)
                };
                i.prototype.setDefault = function () {
                    this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault()
                }, i.prototype.setDirty = function () {
                    this.clearColor.dirty = !0, this.clearDepth.dirty = !0, this.clearStencil.dirty = !0, this.colorMask.dirty = !0, this.depthMask.dirty = !0, this.stencilMask.dirty = !0, this.stencilFunc.dirty = !0, this.stencilOp.dirty = !0, this.stencilTest.dirty = !0, this.depthRange.dirty = !0, this.depthTest.dirty = !0, this.depthFunc.dirty = !0, this.blend.dirty = !0, this.blendFunc.dirty = !0, this.blendColor.dirty = !0, this.blendEquation.dirty = !0, this.cullFace.dirty = !0, this.cullFaceSide.dirty = !0, this.frontFace.dirty = !0, this.program.dirty = !0, this.activeTexture.dirty = !0, this.viewport.dirty = !0, this.bindFramebuffer.dirty = !0, this.bindRenderbuffer.dirty = !0, this.bindTexture.dirty = !0, this.bindVertexBuffer.dirty = !0, this.bindElementBuffer.dirty = !0, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0), this.pixelStoreUnpack.dirty = !0, this.pixelStoreUnpackPremultiplyAlpha.dirty = !0, this.pixelStoreUnpackFlipY.dirty = !0
                }, i.prototype.createIndexBuffer = function (t, e) {
                    return new _t(this, t, e)
                }, i.prototype.createVertexBuffer = function (t, e, i) {
                    return new xt(this, t, e, i)
                }, i.prototype.createRenderbuffer = function (t, e, i) {
                    var r = this.gl, n = r.createRenderbuffer();
                    return this.bindRenderbuffer.set(n), r.renderbufferStorage(r.RENDERBUFFER, t, e, i), this.bindRenderbuffer.set(null), n
                }, i.prototype.createFramebuffer = function (t, e, i) {
                    return new ee(this, t, e, i)
                }, i.prototype.clear = function (t) {
                    var e = t.color, i = t.depth, r = this.gl, n = 0;
                    e && (n |= r.COLOR_BUFFER_BIT, this.clearColor.set(e), this.colorMask.set([!0, !0, !0, !0])), void 0 !== i && (n |= r.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(i), this.depthMask.set(!0)), r.clear(n)
                }, i.prototype.setCullFace = function (t) {
                    !1 === t.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0), this.cullFaceSide.set(t.mode), this.frontFace.set(t.frontFace))
                }, i.prototype.setDepthMode = function (t) {
                    t.func !== this.gl.ALWAYS || t.mask ? (this.depthTest.set(!0), this.depthFunc.set(t.func), this.depthMask.set(t.mask), this.depthRange.set(t.range)) : this.depthTest.set(!1)
                }, i.prototype.setStencilMode = function (t) {
                    t.test.func !== this.gl.ALWAYS || t.mask ? (this.stencilTest.set(!0), this.stencilMask.set(t.mask), this.stencilOp.set([t.fail, t.depthFail, t.pass]), this.stencilFunc.set({
                        func: t.test.func,
                        ref: t.ref,
                        mask: t.test.mask
                    })) : this.stencilTest.set(!1)
                }, i.prototype.setColorMode = function (t) {
                    ot.deepEqual(t.blendFunction, m.Replace) ? this.blend.set(!1) : (this.blend.set(!0), this.blendFunc.set(t.blendFunction), this.blendColor.set(t.blendColor)), this.colorMask.set(t.mask)
                }, i.prototype.unbindVAO = function () {
                    this.extVertexArrayObject && this.bindVertexArrayOES.set(null)
                };
                var ie = function (n) {
                    function b(t, e, i) {
                        var r = this;
                        n.call(this), this.id = t, this.dispatcher = i, this.on("data", function (t) {
                            "source" === t.dataType && "metadata" === t.sourceDataType && (r._sourceLoaded = !0), r._sourceLoaded && !r._paused && "source" === t.dataType && "content" === t.sourceDataType && (r.reload(), r.transform && r.update(r.transform))
                        }), this.on("error", function () {
                            r._sourceErrored = !0
                        }), this._source = function (t, e, i, r) {
                            var n = new dt[e.type](t, e, i, r);
                            if (n.id !== t) throw new Error("Expected Source id to be " + t + " instead of " + n.id);
                            return ot.bindAll(["load", "abort", "unload", "serialize", "prepare"], n), n
                        }(t, e, i, this), this._tiles = {}, this._cache = new a(0, this._unloadTile.bind(this)), this._timers = {}, this._cacheTimers = {}, this._maxTileCacheSize = null, this._loadedParentTiles = {}, this._coveredTiles = {}, this._state = new ot.SourceFeatureState
                    }

                    return n && (b.__proto__ = n), (b.prototype = Object.create(n && n.prototype)).constructor = b, b.prototype.onAdd = function (t) {
                        this.map = t, this._maxTileCacheSize = t ? t._maxTileCacheSize : null, this._source && this._source.onAdd && this._source.onAdd(t)
                    }, b.prototype.onRemove = function (t) {
                        this._source && this._source.onRemove && this._source.onRemove(t)
                    }, b.prototype.loaded = function () {
                        if (this._sourceErrored) return !0;
                        if (!this._sourceLoaded) return !1;
                        if (!this._source.loaded()) return !1;
                        for (var t in this._tiles) {
                            var e = this._tiles[t];
                            if ("loaded" !== e.state && "errored" !== e.state) return !1
                        }
                        return !0
                    }, b.prototype.getSource = function () {
                        return this._source
                    }, b.prototype.pause = function () {
                        this._paused = !0
                    }, b.prototype.resume = function () {
                        if (this._paused) {
                            var t = this._shouldReloadOnResume;
                            this._paused = !1, this._shouldReloadOnResume = !1, t && this.reload(), this.transform && this.update(this.transform)
                        }
                    }, b.prototype._loadTile = function (t, e) {
                        return this._source.loadTile(t, e)
                    }, b.prototype._unloadTile = function (t) {
                        if (this._source.unloadTile) return this._source.unloadTile(t, function () {
                        })
                    }, b.prototype._abortTile = function (t) {
                        if (this._source.abortTile) return this._source.abortTile(t, function () {
                        })
                    }, b.prototype.serialize = function () {
                        return this._source.serialize()
                    }, b.prototype.prepare = function (t) {
                        for (var e in this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null), this._tiles) {
                            var i = this._tiles[e];
                            i.upload(t), i.prepare(this.map.style.imageManagerFactory._getImageManager(this.id))
                        }
                    }, b.prototype.getIds = function () {
                        return ot.values(this._tiles).map(function (t) {
                            return t.tileID
                        }).sort(re).map(function (t) {
                            return t.key
                        })
                    }, b.prototype.getRenderableIds = function (t) {
                        var o = this, e = [];
                        for (var i in this._tiles) this._isIdRenderable(i, t) && e.push(this._tiles[i]);
                        return t ? e.sort(function (t, e) {
                            var i = t.tileID, r = e.tileID,
                                n = new ot.Point(i.canonical.x, i.canonical.y)._rotate(o.transform.angle),
                                a = new ot.Point(r.canonical.x, r.canonical.y)._rotate(o.transform.angle);
                            return i.overscaledZ - r.overscaledZ || a.y - n.y || a.x - n.x
                        }).map(function (t) {
                            return t.tileID.key
                        }) : e.map(function (t) {
                            return t.tileID
                        }).sort(re).map(function (t) {
                            return t.key
                        })
                    }, b.prototype.hasRenderableParent = function (t) {
                        var e = this.findLoadedParent(t, 0);
                        return !!e && this._isIdRenderable(e.tileID.key)
                    }, b.prototype._isIdRenderable = function (t, e) {
                        return this._tiles[t] && this._tiles[t].hasData() && !this._coveredTiles[t] && (e || !this._tiles[t].holdingForFade())
                    }, b.prototype.reload = function () {
                        if (this._paused) this._shouldReloadOnResume = !0; else for (var t in this._cache.reset(), this._tiles) "errored" !== this._tiles[t].state && this._reloadTile(t, "reloading")
                    }, b.prototype._reloadTile = function (t, e) {
                        var i = this._tiles[t];
                        i && ("loading" !== i.state && (i.state = e), this._loadTile(i, this._tileLoaded.bind(this, i, t, e)))
                    }, b.prototype._tileLoaded = function (t, e, i, r) {
                        if (r) return t.state = "errored", void (404 !== r.status ? this._source.fire(new ot.ErrorEvent(r, {tile: t})) : this.update(this.transform));
                        t.timeAdded = ot.browser.now(), "expired" === i && (t.refreshedUponExpiration = !0), this._setTileReloadTimer(e, t), "raster-dem" === this.getSource().type && t.dem && this._backfillDEM(t), this._state.initializeTileState(t, this.map ? this.map.painter : null), this._source.fire(new ot.Event("data", {
                            dataType: "source",
                            tile: t,
                            coord: t.tileID
                        }))
                    }, b.prototype._backfillDEM = function (t) {
                        for (var e = this.getRenderableIds(), i = 0; i < e.length; i++) {
                            var r = e[i];
                            if (t.neighboringTiles && t.neighboringTiles[r]) {
                                var n = this.getTileByID(r);
                                a(t, n), a(n, t)
                            }
                        }

                        function a(t, e) {
                            t.needsHillshadePrepare = !0;
                            var i = e.tileID.canonical.x - t.tileID.canonical.x,
                                r = e.tileID.canonical.y - t.tileID.canonical.y, n = Math.pow(2, t.tileID.canonical.z),
                                a = e.tileID.key;
                            0 === i && 0 === r || Math.abs(r) > 1 || (Math.abs(i) > 1 && (1 === Math.abs(i + n) ? i += n : 1 === Math.abs(i - n) && (i -= n)), e.dem && t.dem && (t.dem.backfillBorder(e.dem, i, r), t.neighboringTiles && t.neighboringTiles[a] && (t.neighboringTiles[a].backfilled = !0)))
                        }
                    }, b.prototype.getTile = function (t) {
                        return this.getTileByID(t.key)
                    }, b.prototype.getTileByID = function (t) {
                        return this._tiles[t]
                    }, b.prototype._retainLoadedChildren = function (t, e, i, r) {
                        for (var n in this._tiles) {
                            var a = this._tiles[n];
                            if (!(r[n] || !a.hasData() || a.tileID.overscaledZ <= e || a.tileID.overscaledZ > i)) {
                                for (var o = a.tileID; a && a.tileID.overscaledZ > e + 1;) {
                                    var s = a.tileID.scaledTo(a.tileID.overscaledZ - 1);
                                    (a = this._tiles[s.key]) && a.hasData() && (o = s)
                                }
                                for (var l = o; l.overscaledZ > e;) if (t[(l = l.scaledTo(l.overscaledZ - 1)).key]) {
                                    r[o.key] = o;
                                    break
                                }
                            }
                        }
                    }, b.prototype.findLoadedParent = function (t, e) {
                        if (t.key in this._loadedParentTiles) {
                            var i = this._loadedParentTiles[t.key];
                            return i && i.tileID.overscaledZ >= e ? i : null
                        }
                        for (var r = t.overscaledZ - 1; r >= e; r--) {
                            var n = t.scaledTo(r), a = this._getLoadedTile(n);
                            if (a) return a
                        }
                    }, b.prototype._getLoadedTile = function (t) {
                        var e = this._tiles[t.key];
                        return e && e.hasData() ? e : this._cache.getByKey(t.wrapped().key)
                    }, b.prototype.updateCacheSize = function (t) {
                        var e = Math.ceil(t.width / this._source.tileSize) + 1,
                            i = Math.ceil(t.height / this._source.tileSize) + 1, r = Math.floor(e * i * 5),
                            n = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, r) : r;
                        this._cache.setMaxSize(n)
                    }, b.prototype.handleWrapJump = function (t) {
                        var e = Math.round((t - (void 0 === this._prevLng ? t : this._prevLng)) / 360);
                        if (this._prevLng = t, e) {
                            var i = {};
                            for (var r in this._tiles) {
                                var n = this._tiles[r];
                                n.tileID = n.tileID.unwrapTo(n.tileID.wrap + e), i[n.tileID.key] = n
                            }
                            for (var a in this._tiles = i, this._timers) clearTimeout(this._timers[a]), delete this._timers[a];
                            for (var o in this._tiles) this._setTileReloadTimer(o, this._tiles[o])
                        }
                    }, b.prototype.update = function (t) {
                        var e = this;
                        if (this.transform = t, this._sourceLoaded && !this._paused) {
                            var i;
                            this.updateCacheSize(t), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used ? this._source.tileID ? i = t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function (t) {
                                return new ot.OverscaledTileID(t.canonical.z, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y, e.indexExtent)
                            }) : (i = t.coveringTiles({
                                tileSize: this._source.tileSize,
                                minzoom: this._source.minzoom,
                                maxzoom: this._source.maxzoom,
                                roundZoom: this._source.roundZoom,
                                reparseOverscaled: this._source.reparseOverscaled
                            }), this._source.hasTile && (i = i.filter(function (t) {
                                return e._source.hasTile(t)
                            }))) : i = [];
                            var r = t.coveringZoomLevel(this._source),
                                n = Math.max(r - b.maxOverzooming, this._source.minzoom),
                                a = Math.max(r + b.maxUnderzooming, this._source.minzoom),
                                o = this._updateRetainedTiles(i, r);
                            if (ne(this._source.type)) {
                                for (var s = {}, l = {}, u = 0, h = Object.keys(o); u < h.length; u += 1) {
                                    var c = h[u], p = o[c], f = this._tiles[c];
                                    if (f && !(f.fadeEndTime && f.fadeEndTime <= ot.browser.now())) {
                                        var d = this.findLoadedParent(p, n);
                                        d && (this._addTile(d.tileID), s[d.tileID.key] = d.tileID), l[c] = p
                                    }
                                }
                                for (var m in this._retainLoadedChildren(l, r, a, o), s) o[m] || (this._coveredTiles[m] = !0, o[m] = s[m])
                            }
                            for (var y in o) this._tiles[y].clearFadeHold();
                            for (var g = 0, _ = ot.keysDifference(this._tiles, o); g < _.length; g += 1) {
                                var v = _[g], x = this._tiles[v];
                                x.hasSymbolBuckets && !x.holdingForFade() ? x.setHoldDuration(this.map._fadeDuration) : x.hasSymbolBuckets && !x.symbolFadeFinished() || this._removeTile(v)
                            }
                            this._updateLoadedParentTileCache()
                        }
                    }, b.prototype.releaseSymbolFadeTiles = function () {
                        for (var t in this._tiles) this._tiles[t].holdingForFade() && this._removeTile(t)
                    }, b.prototype._updateRetainedTiles = function (t, e) {
                        for (var i = {}, r = {}, n = Math.max(e - b.maxOverzooming, this._source.minzoom), a = Math.max(e + b.maxUnderzooming, this._source.minzoom), o = {}, s = 0, l = t; s < l.length; s += 1) {
                            var u = l[s], h = this._addTile(u);
                            i[u.key] = u, h.hasData() || e < this._source.maxzoom && (o[u.key] = u)
                        }
                        this._retainLoadedChildren(o, e, a, i);
                        for (var c = 0, p = t; c < p.length; c += 1) {
                            var f = p[c], d = this._tiles[f.key];
                            if (!d.hasData()) {
                                if (e + 1 > this._source.maxzoom) {
                                    var m = f.children(this._source.maxzoom)[0], y = this.getTile(m);
                                    if (y && y.hasData()) {
                                        i[m.key] = m;
                                        continue
                                    }
                                } else {
                                    var g = f.children(this._source.maxzoom);
                                    if (i[g[0].key] && i[g[1].key] && i[g[2].key] && i[g[3].key]) continue
                                }
                                for (var _ = d.wasRequested(), v = f.overscaledZ - 1; v >= n; --v) {
                                    var x = f.scaledTo(v);
                                    if (r[x.key]) break;
                                    if (r[x.key] = !0, !(d = this.getTile(x)) && _ && (d = this._addTile(x)), d && (i[x.key] = x, _ = d.wasRequested(), d.hasData())) break
                                }
                            }
                        }
                        return i
                    }, b.prototype._updateLoadedParentTileCache = function () {
                        for (var t in this._loadedParentTiles = {}, this._tiles) {
                            for (var e = [], i = void 0, r = this._tiles[t].tileID; r.overscaledZ > 0;) {
                                if (r.key in this._loadedParentTiles) {
                                    i = this._loadedParentTiles[r.key];
                                    break
                                }
                                e.push(r.key);
                                var n = r.scaledTo(r.overscaledZ - 1);
                                if (i = this._getLoadedTile(n)) break;
                                r = n
                            }
                            for (var a = 0, o = e; a < o.length; a += 1) this._loadedParentTiles[o[a]] = i
                        }
                    }, b.prototype._addTile = function (t) {
                        var e = this._tiles[t.key];
                        if (e) return e;
                        (e = this._cache.getAndRemove(t)) && (this._setTileReloadTimer(t.key, e), e.tileID = t, this._state.initializeTileState(e, this.map ? this.map.painter : null), this._cacheTimers[t.key] && (clearTimeout(this._cacheTimers[t.key]), delete this._cacheTimers[t.key], this._setTileReloadTimer(t.key, e)));
                        var i = Boolean(e);
                        return i || (e = new ot.Tile(t, this._source.tileSize * t.overscaleFactor()), this._loadTile(e, this._tileLoaded.bind(this, e, t.key, e.state))), e ? (e.uses++, this._tiles[t.key] = e, i || this._source.fire(new ot.Event("dataloading", {
                            tile: e,
                            coord: e.tileID,
                            dataType: "source"
                        })), e) : null
                    }, b.prototype._setTileReloadTimer = function (t, e) {
                        var i = this;
                        t in this._timers && (clearTimeout(this._timers[t]), delete this._timers[t]);
                        var r = e.getExpiryTimeout();
                        r && (this._timers[t] = setTimeout(function () {
                            i._reloadTile(t, "expired"), delete i._timers[t]
                        }, r))
                    }, b.prototype._removeTile = function (t) {
                        var e = this._tiles[t];
                        e && (e.uses--, delete this._tiles[t], this._timers[t] && (clearTimeout(this._timers[t]), delete this._timers[t]), e.uses > 0 || (e.hasData() && "reloading" !== e.state ? this._cache.add(e.tileID, e, e.getExpiryTimeout()) : (e.aborted = !0, this._abortTile(e), this._unloadTile(e))))
                    }, b.prototype.clearTiles = function () {
                        for (var t in this._shouldReloadOnResume = !1, this._paused = !1, this._tiles) this._removeTile(t);
                        this._cache.reset()
                    }, b.prototype.tilesIn = function (t, l, e) {
                        var u = this, h = [], c = this.transform;
                        if (!c) return h;
                        for (var i = e ? c.getCameraQueryGeometry(t) : t, p = t.map(function (t) {
                            return c.pointCoordinate(t)
                        }), f = i.map(function (t) {
                            return c.pointCoordinate(t)
                        }), d = this.getIds(), m = 1 / 0, y = 1 / 0, g = -1 / 0, _ = -1 / 0, r = 0, n = f; r < n.length; r += 1) {
                            var a = n[r];
                            m = Math.min(m, a.x), y = Math.min(y, a.y), g = Math.max(g, a.x), _ = Math.max(_, a.y)
                        }
                        for (var o = function (t) {
                            var e = u._tiles[d[t]];
                            if (!e.holdingForFade()) {
                                var i = e.tileID, r = Math.pow(2, c.zoom - e.tileID.overscaledZ),
                                    n = l * e.queryPadding * ot.EXTENT / e.tileSize / r,
                                    a = [i.getTilePoint(new ot.MercatorCoordinate(m, y)), i.getTilePoint(new ot.MercatorCoordinate(g, _))];
                                if (a[0].x - n < ot.EXTENT && a[0].y - n < ot.EXTENT && a[1].x + n >= 0 && a[1].y + n >= 0) {
                                    var o = p.map(function (t) {
                                        return i.getTilePoint(t)
                                    }), s = f.map(function (t) {
                                        return i.getTilePoint(t)
                                    });
                                    h.push({tile: e, tileID: i, queryGeometry: o, cameraQueryGeometry: s, scale: r})
                                }
                            }
                        }, s = 0; s < d.length; s++) o(s);
                        return h
                    }, b.prototype.getVisibleCoordinates = function (t) {
                        for (var e = this, i = this.getRenderableIds(t).map(function (t) {
                            return e._tiles[t].tileID
                        }), r = 0, n = i; r < n.length; r += 1) {
                            var a = n[r];
                            a.posMatrix = this.transform.calculatePosMatrix(a.toUnwrapped())
                        }
                        return i
                    }, b.prototype.hasTransition = function () {
                        if (this._source.hasTransition()) return !0;
                        if (ne(this._source.type)) for (var t in this._tiles) {
                            var e = this._tiles[t];
                            if (void 0 !== e.fadeEndTime && e.fadeEndTime >= ot.browser.now()) return !0
                        }
                        return !1
                    }, b.prototype.setFeatureState = function (t, e, i) {
                        this._state.updateState(t = t || "_geojsonTileLayer", e, i)
                    }, b.prototype.removeFeatureState = function (t, e, i) {
                        this._state.removeFeatureState(t = t || "_geojsonTileLayer", e, i)
                    }, b.prototype.getFeatureState = function (t, e) {
                        return this._state.getState(t = t || "_geojsonTileLayer", e)
                    }, b.prototype.setDependencies = function (t, e, i) {
                        var r = this._tiles[t];
                        r && r.setDependencies(e, i)
                    }, b.prototype.reloadTilesForDependencies = function (e, i) {
                        for (var t in this._tiles) this._tiles[t].hasDependency(e, i) && this._reloadTile(t, "reloading");
                        this._cache.filter(function (t) {
                            return !t.hasDependency(e, i)
                        })
                    }, b
                }(ot.Evented);

                function re(t, e) {
                    var i = Math.abs(2 * t.wrap) - +(t.wrap < 0), r = Math.abs(2 * e.wrap) - +(e.wrap < 0);
                    return t.overscaledZ - e.overscaledZ || r - i || e.canonical.y - t.canonical.y || e.canonical.x - t.canonical.x
                }

                function ne(t) {
                    return "raster" === t || "image" === t || "video" === t
                }

                function ae() {
                    return new ot.window.Worker(Qn.workerUrl)
                }

                ie.maxOverzooming = 10, ie.maxUnderzooming = 3;
                var oe = "mapboxgl_preloaded_worker_pool", se = function () {
                    this.active = {}
                };
                se.prototype.acquire = function (t) {
                    if (!this.workers) for (this.workers = []; this.workers.length < se.workerCount;) this.workers.push(new ae);
                    return this.active[t] = !0, this.workers.slice()
                }, se.prototype.release = function (t) {
                    delete this.active[t], 0 === this.numActive() && (this.workers.forEach(function (t) {
                        t.terminate()
                    }), this.workers = null)
                }, se.prototype.isPreloaded = function () {
                    return !!this.active[oe]
                }, se.prototype.numActive = function () {
                    return Object.keys(this.active).length
                };
                var le, ue = Math.floor(ot.browser.hardwareConcurrency / 2);

                function he() {
                    return le || (le = new se), le
                }

                function ce(t, e) {
                    var i = {};
                    for (var r in t) "ref" !== r && (i[r] = t[r]);
                    return ot.refProperties.forEach(function (t) {
                        t in e && (i[t] = e[t])
                    }), i
                }

                function pe(t) {
                    t = t.slice();
                    for (var e = Object.create(null), i = 0; i < t.length; i++) e[t[i].id] = t[i];
                    for (var r = 0; r < t.length; r++) "ref" in t[r] && (t[r] = ce(t[r], e[t[r].ref]));
                    return t
                }

                se.workerCount = Math.max(Math.min(ue, 6), 1);
                var y = {
                    setStyle: "setStyle",
                    addLayer: "addLayer",
                    removeLayer: "removeLayer",
                    setPaintProperty: "setPaintProperty",
                    setLayoutProperty: "setLayoutProperty",
                    setFilter: "setFilter",
                    addSource: "addSource",
                    removeSource: "removeSource",
                    setGeoJSONSourceData: "setGeoJSONSourceData",
                    setLayerZoomRange: "setLayerZoomRange",
                    setLayerProperty: "setLayerProperty",
                    setCenter: "setCenter",
                    setZoom: "setZoom",
                    setBearing: "setBearing",
                    setPitch: "setPitch",
                    setSprite: "setSprite",
                    setGlyphs: "setGlyphs",
                    setTransition: "setTransition",
                    setLight: "setLight"
                };

                function fe(t, e, i) {
                    i.push({command: y.addSource, args: [t, e[t]]})
                }

                function de(t, e, i) {
                    e.push({command: y.removeSource, args: [t]}), i[t] = !0
                }

                function me(t, e, i, r) {
                    de(t, i, r), fe(t, e, i)
                }

                function ye(t, e, i) {
                    var r;
                    for (r in t[i]) if (t[i].hasOwnProperty(r) && "data" !== r && !ot.deepEqual(t[i][r], e[i][r])) return !1;
                    for (r in e[i]) if (e[i].hasOwnProperty(r) && "data" !== r && !ot.deepEqual(t[i][r], e[i][r])) return !1;
                    return !0
                }

                function ge(t, e, i, r, n, a) {
                    var o;
                    for (o in e = e || {}, t = t || {}) t.hasOwnProperty(o) && (ot.deepEqual(t[o], e[o]) || i.push({
                        command: a,
                        args: [r, o, e[o], n]
                    }));
                    for (o in e) e.hasOwnProperty(o) && !t.hasOwnProperty(o) && (ot.deepEqual(t[o], e[o]) || i.push({
                        command: a,
                        args: [r, o, e[o], n]
                    }))
                }

                function _e(t) {
                    return t.id
                }

                function ve(t, e) {
                    return t[e.id] = e, t
                }

                var xe = function (t, e) {
                    this.reset(t, e)
                };
                xe.prototype.reset = function (t, e) {
                    this.points = t || [], this._distances = [0];
                    for (var i = 1; i < this.points.length; i++) this._distances[i] = this._distances[i - 1] + this.points[i].dist(this.points[i - 1]);
                    this.length = this._distances[this._distances.length - 1], this.padding = Math.min(e || 0, .5 * this.length), this.paddedLength = this.length - 2 * this.padding
                }, xe.prototype.lerp = function (t) {
                    if (1 === this.points.length) return this.points[0];
                    t = ot.clamp(t, 0, 1);
                    for (var e = 1, i = this._distances[e], r = t * this.paddedLength + this.padding; i < r && e < this._distances.length;) i = this._distances[++e];
                    var n = e - 1, a = this._distances[n], o = i - a, s = o > 0 ? (r - a) / o : 0;
                    return this.points[n].mult(1 - s).add(this.points[e].mult(s))
                };
                var r = function (t, e, i) {
                    var r = this.boxCells = [], n = this.circleCells = [];
                    this.xCellCount = Math.ceil(t / i), this.yCellCount = Math.ceil(e / i);
                    for (var a = 0; a < this.xCellCount * this.yCellCount; a++) r.push([]), n.push([]);
                    this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = t, this.height = e, this.xScale = this.xCellCount / t, this.yScale = this.yCellCount / e, this.boxUid = 0, this.circleUid = 0
                };

                function be(t, e, i, r, n) {
                    var a = ot.create();
                    return e ? (ot.scale(a, a, [1 / n, 1 / n, 1]), i || ot.rotateZ(a, a, r.angle)) : ot.multiply(a, r.labelPlaneMatrix, t), a
                }

                function we(t, e, i, r, n) {
                    if (e) {
                        var a = ot.clone(t);
                        return ot.scale(a, a, [n, n, 1]), i || ot.rotateZ(a, a, -r.angle), a
                    }
                    return r.glCoordMatrix
                }

                function Y(t, e) {
                    var i = [t.x, t.y, 0, 1];
                    Le(i, i, e);
                    var r = i[3];
                    return {point: new ot.Point(i[0] / r, i[1] / r), signedDistanceFromCamera: r}
                }

                function Me(t, e) {
                    return .5 + t / e * .5
                }

                function Se(t, e) {
                    var i = t[0] / t[3], r = t[1] / t[3];
                    return i >= -e[0] && i <= e[0] && r >= -e[1] && r <= e[1]
                }

                function Ee(t, e, i, r, n, a, o, s) {
                    var l = r ? t.textSizeData : t.iconSizeData, u = ot.evaluateSizeForZoom(l, i.transform.zoom),
                        h = [256 / i.width * 2 + 1, 256 / i.height * 2 + 1],
                        c = r ? t.text.dynamicLayoutVertexArray : t.icon.dynamicLayoutVertexArray;
                    c.clear();
                    for (var p = t.lineVertexArray, f = r ? t.text.placedSymbolArray : t.icon.placedSymbolArray, d = i.transform.width / i.transform.height, m = !1, y = 0; y < f.length; y++) {
                        var g = f.get(y);
                        if (g.hidden || g.writingMode === ot.WritingMode.vertical && !m) ke(g.numGlyphs, c); else {
                            m = !1;
                            var _ = [g.anchorX, g.anchorY, 0, 1];
                            if (ot.transformMat4(_, _, e), Se(_, h)) {
                                var v = Me(i.transform.cameraToCenterDistance, _[3]),
                                    x = ot.evaluateSizeForFeature(l, u, g), b = o ? x / v : x * v,
                                    w = new ot.Point(g.anchorX, g.anchorY), M = Y(w, n).point, S = {},
                                    E = Ce(g, b, !1, s, e, n, a, t.glyphOffsetArray, p, c, M, w, S, d);
                                m = E.useVertical, (E.notEnoughRoom || m || E.needsFlipping && Ce(g, b, !0, s, e, n, a, t.glyphOffsetArray, p, c, M, w, S, d).notEnoughRoom) && ke(g.numGlyphs, c)
                            } else ke(g.numGlyphs, c)
                        }
                    }
                    r ? t.text.dynamicLayoutVertexBuffer.updateData(c) : t.icon.dynamicLayoutVertexBuffer.updateData(c)
                }

                function Ie(t, e, i, r, n, a, o, s, l, u, h) {
                    var c = s.glyphStartIndex + s.numGlyphs, p = s.lineStartIndex, f = s.lineStartIndex + s.lineLength,
                        d = e.getoffsetX(s.glyphStartIndex), m = e.getoffsetX(c - 1),
                        y = Ae(t * d, i, r, n, a, o, s.segment, p, f, l, u, h);
                    if (!y) return null;
                    var g = Ae(t * m, i, r, n, a, o, s.segment, p, f, l, u, h);
                    return g ? {first: y, last: g} : null
                }

                function Te(t, e, i, r) {
                    return t === ot.WritingMode.horizontal && Math.abs(i.y - e.y) > Math.abs(i.x - e.x) * r ? {useVertical: !0} : (t === ot.WritingMode.vertical ? e.y < i.y : e.x > i.x) ? {needsFlipping: !0} : null
                }

                function Ce(t, e, i, r, n, a, o, s, l, u, h, c, p, f) {
                    var d, m = e / 24, y = t.lineOffsetX * m, g = t.lineOffsetY * m;
                    if (t.numGlyphs > 1) {
                        var _ = t.glyphStartIndex + t.numGlyphs, v = t.lineStartIndex,
                            x = t.lineStartIndex + t.lineLength, b = Ie(m, s, y, g, i, h, c, t, l, a, p);
                        if (!b) return {notEnoughRoom: !0};
                        var w = Y(b.first.point, o).point, M = Y(b.last.point, o).point;
                        if (r && !i) {
                            var S = Te(t.writingMode, w, M, f);
                            if (S) return S
                        }
                        d = [b.first];
                        for (var E = t.glyphStartIndex + 1; E < _ - 1; E++) d.push(Ae(m * s.getoffsetX(E), y, g, i, h, c, t.segment, v, x, l, a, p));
                        d.push(b.last)
                    } else {
                        if (r && !i) {
                            var I = Y(c, n).point, T = t.lineStartIndex + t.segment + 1,
                                C = new ot.Point(l.getx(T), l.gety(T)), P = Y(C, n),
                                A = P.signedDistanceFromCamera > 0 ? P.point : Pe(c, C, I, 1, n),
                                z = Te(t.writingMode, I, A, f);
                            if (z) return z
                        }
                        var k = Ae(m * s.getoffsetX(t.glyphStartIndex), y, g, i, h, c, t.segment, t.lineStartIndex, t.lineStartIndex + t.lineLength, l, a, p);
                        if (!k) return {notEnoughRoom: !0};
                        d = [k]
                    }
                    for (var L = 0, D = d; L < D.length; L += 1) {
                        var R = D[L];
                        ot.addDynamicAttributes(u, R.point, R.angle)
                    }
                    return {}
                }

                function Pe(t, e, i, r, n) {
                    var a = Y(t.add(t.sub(e)._unit()), n).point, o = i.sub(a);
                    return i.add(o._mult(r / o.mag()))
                }

                function Ae(t, e, i, r, n, a, o, s, l, u, h, c) {
                    var p = r ? t - e : t + e, f = p > 0 ? 1 : -1, d = 0;
                    r && (f *= -1, d = Math.PI), f < 0 && (d += Math.PI);
                    for (var m = f > 0 ? s + o : s + o + 1, y = n, g = n, _ = 0, v = 0, x = Math.abs(p), b = []; _ + v <= x;) {
                        if ((m += f) < s || m >= l) return null;
                        if (g = y, b.push(y), void 0 === (y = c[m])) {
                            var w = new ot.Point(u.getx(m), u.gety(m)), M = Y(w, h);
                            if (M.signedDistanceFromCamera > 0) y = c[m] = M.point; else {
                                var S = m - f;
                                y = Pe(0 === _ ? a : new ot.Point(u.getx(S), u.gety(S)), w, g, x - _ + 1, h)
                            }
                        }
                        _ += v, v = g.dist(y)
                    }
                    var E = (x - _) / v, I = y.sub(g), T = I.mult(E)._add(g);
                    T._add(I._unit()._perp()._mult(i * f));
                    var C = d + Math.atan2(y.y - g.y, y.x - g.x);
                    return b.push(T), {point: T, angle: C, path: b}
                }

                r.prototype.keysLength = function () {
                    return this.boxKeys.length + this.circleKeys.length
                }, r.prototype.insert = function (t, e, i, r, n) {
                    this._forEachCell(e, i, r, n, this._insertBoxCell, this.boxUid++), this.boxKeys.push(t), this.bboxes.push(e), this.bboxes.push(i), this.bboxes.push(r), this.bboxes.push(n)
                }, r.prototype.insertCircle = function (t, e, i, r) {
                    this._forEachCell(e - r, i - r, e + r, i + r, this._insertCircleCell, this.circleUid++), this.circleKeys.push(t), this.circles.push(e), this.circles.push(i), this.circles.push(r)
                }, r.prototype._insertBoxCell = function (t, e, i, r, n, a) {
                    this.boxCells[n].push(a)
                }, r.prototype._insertCircleCell = function (t, e, i, r, n, a) {
                    this.circleCells[n].push(a)
                }, r.prototype._query = function (t, e, i, r, n, a) {
                    if (i < 0 || t > this.width || r < 0 || e > this.height) return !n && [];
                    var o = [];
                    if (t <= 0 && e <= 0 && this.width <= i && this.height <= r) {
                        if (n) return !0;
                        for (var s = 0; s < this.boxKeys.length; s++) o.push({
                            key: this.boxKeys[s],
                            x1: this.bboxes[4 * s],
                            y1: this.bboxes[4 * s + 1],
                            x2: this.bboxes[4 * s + 2],
                            y2: this.bboxes[4 * s + 3]
                        });
                        for (var l = 0; l < this.circleKeys.length; l++) {
                            var u = this.circles[3 * l], h = this.circles[3 * l + 1], c = this.circles[3 * l + 2];
                            o.push({key: this.circleKeys[l], x1: u - c, y1: h - c, x2: u + c, y2: h + c})
                        }
                        return a ? o.filter(a) : o
                    }
                    return this._forEachCell(t, e, i, r, this._queryCell, o, {
                        hitTest: n,
                        seenUids: {box: {}, circle: {}}
                    }, a), n ? o.length > 0 : o
                }, r.prototype._queryCircle = function (t, e, i, r, n) {
                    var a = t - i, o = t + i, s = e - i, l = e + i;
                    if (o < 0 || a > this.width || l < 0 || s > this.height) return !r && [];
                    var u = [];
                    return this._forEachCell(a, s, o, l, this._queryCellCircle, u, {
                        hitTest: r,
                        circle: {x: t, y: e, radius: i},
                        seenUids: {box: {}, circle: {}}
                    }, n), r ? u.length > 0 : u
                }, r.prototype.query = function (t, e, i, r, n) {
                    return this._query(t, e, i, r, !1, n)
                }, r.prototype.hitTest = function (t, e, i, r, n) {
                    return this._query(t, e, i, r, !0, n)
                }, r.prototype.hitTestCircle = function (t, e, i, r) {
                    return this._queryCircle(t, e, i, !0, r)
                }, r.prototype._queryCell = function (t, e, i, r, n, a, o, s) {
                    var l = o.seenUids, u = this.boxCells[n];
                    if (null !== u) for (var h = this.bboxes, c = 0, p = u; c < p.length; c += 1) {
                        var f = p[c];
                        if (!l.box[f]) {
                            l.box[f] = !0;
                            var d = 4 * f;
                            if (t <= h[d + 2] && e <= h[d + 3] && i >= h[d + 0] && r >= h[d + 1] && (!s || s(this.boxKeys[f]))) {
                                if (o.hitTest) return a.push(!0), !0;
                                a.push({key: this.boxKeys[f], x1: h[d], y1: h[d + 1], x2: h[d + 2], y2: h[d + 3]})
                            }
                        }
                    }
                    var m = this.circleCells[n];
                    if (null !== m) for (var y = this.circles, g = 0, _ = m; g < _.length; g += 1) {
                        var v = _[g];
                        if (!l.circle[v]) {
                            l.circle[v] = !0;
                            var x = 3 * v;
                            if (this._circleAndRectCollide(y[x], y[x + 1], y[x + 2], t, e, i, r) && (!s || s(this.circleKeys[v]))) {
                                if (o.hitTest) return a.push(!0), !0;
                                var b = y[x], w = y[x + 1], M = y[x + 2];
                                a.push({key: this.circleKeys[v], x1: b - M, y1: w - M, x2: b + M, y2: w + M})
                            }
                        }
                    }
                }, r.prototype._queryCellCircle = function (t, e, i, r, n, a, o, s) {
                    var l = o.circle, u = o.seenUids, h = this.boxCells[n];
                    if (null !== h) for (var c = this.bboxes, p = 0, f = h; p < f.length; p += 1) {
                        var d = f[p];
                        if (!u.box[d]) {
                            u.box[d] = !0;
                            var m = 4 * d;
                            if (this._circleAndRectCollide(l.x, l.y, l.radius, c[m + 0], c[m + 1], c[m + 2], c[m + 3]) && (!s || s(this.boxKeys[d]))) return a.push(!0), !0
                        }
                    }
                    var y = this.circleCells[n];
                    if (null !== y) for (var g = this.circles, _ = 0, v = y; _ < v.length; _ += 1) {
                        var x = v[_];
                        if (!u.circle[x]) {
                            u.circle[x] = !0;
                            var b = 3 * x;
                            if (this._circlesCollide(g[b], g[b + 1], g[b + 2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[x]))) return a.push(!0), !0
                        }
                    }
                }, r.prototype._forEachCell = function (t, e, i, r, n, a, o, s) {
                    for (var l = this._convertToXCellCoord(t), u = this._convertToYCellCoord(e), h = this._convertToXCellCoord(i), c = this._convertToYCellCoord(r), p = l; p <= h; p++) for (var f = u; f <= c; f++) if (n.call(this, t, e, i, r, this.xCellCount * f + p, a, o, s)) return
                }, r.prototype._convertToXCellCoord = function (t) {
                    return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(t * this.xScale)))
                }, r.prototype._convertToYCellCoord = function (t) {
                    return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(t * this.yScale)))
                }, r.prototype._circlesCollide = function (t, e, i, r, n, a) {
                    var o = r - t, s = n - e, l = i + a;
                    return l * l > o * o + s * s
                }, r.prototype._circleAndRectCollide = function (t, e, i, r, n, a, o) {
                    var s = (a - r) / 2, l = Math.abs(t - (r + s));
                    if (l > s + i) return !1;
                    var u = (o - n) / 2, h = Math.abs(e - (n + u));
                    if (h > u + i) return !1;
                    if (l <= s || h <= u) return !0;
                    var c = l - s, p = h - u;
                    return c * c + p * p <= i * i
                };
                var ze = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);

                function ke(t, e) {
                    for (var i = 0; i < t; i++) {
                        var r = e.length;
                        e.resize(r + 4), e.float32.set(ze, 3 * r)
                    }
                }

                function Le(t, e, i) {
                    var r = e[0], n = e[1];
                    return t[0] = i[0] * r + i[4] * n + i[12], t[1] = i[1] * r + i[5] * n + i[13], t[3] = i[3] * r + i[7] * n + i[15], t
                }

                var n = function (t, e, i) {
                    void 0 === e && (e = new r(t.width + 200, t.height + 200, 25)), void 0 === i && (i = new r(t.width + 200, t.height + 200, 25)), this.transform = t, this.grid = e, this.ignoredGrid = i, this.pitchfactor = Math.cos(t._pitch) * t.cameraToCenterDistance, this.screenRightBoundary = t.width + 100, this.screenBottomBoundary = t.height + 100, this.gridRightBoundary = t.width + 200, this.gridBottomBoundary = t.height + 200
                };

                function lt(t, e, i) {
                    return e * (ot.EXTENT / (t.tileSize * Math.pow(2, i - t.tileID.overscaledZ)))
                }

                n.prototype.placeCollisionBox = function (t, e, i, r, n) {
                    var a = this.projectAndGetPerspectiveRatio(r, t.anchorPointX, t.anchorPointY),
                        o = i * a.perspectiveRatio, s = t.x1 * o + a.point.x, l = t.y1 * o + a.point.y,
                        u = t.x2 * o + a.point.x, h = t.y2 * o + a.point.y;
                    return !this.isInsideGrid(s, l, u, h) || !e && this.grid.hitTest(s, l, u, h, n) ? {
                        box: [],
                        offscreen: !1
                    } : {box: [s, l, u, h], offscreen: this.isOffscreen(s, l, u, h)}
                }, n.prototype.placeCollisionCircles = function (B, t, O, F, e, U, i, r, n, N, V, j, q) {
                    var a = [], o = new ot.Point(t.anchorX, t.anchorY), G = Y(o, U),
                        s = Me(this.transform.cameraToCenterDistance, G.signedDistanceFromCamera),
                        l = (N ? e / s : e * s) / ot.ONE_EM, Z = Y(o, i).point,
                        u = Ie(l, F, t.lineOffsetX * l, t.lineOffsetY * l, !1, Z, o, t, O, i, {}), h = !1, c = !1,
                        p = !0;
                    if (u) {
                        for (var f = .5 * j * s + q, d = new ot.Point(-100, -100), m = new ot.Point(this.screenRightBoundary, this.screenBottomBoundary), y = new xe, g = u.first, _ = u.last, v = [], x = g.path.length - 1; x >= 1; x--) v.push(g.path[x]);
                        for (var b = 1; b < _.path.length; b++) v.push(_.path[b]);
                        var W = 2.5 * f;
                        if (r) {
                            var w = v.map(function (t) {
                                return Y(t, r)
                            });
                            v = w.some(function (t) {
                                return t.signedDistanceFromCamera <= 0
                            }) ? [] : w.map(function (t) {
                                return t.point
                            })
                        }
                        var M = [];
                        if (v.length > 0) {
                            for (var S = v[0].clone(), E = v[0].clone(), I = 1; I < v.length; I++) S.x = Math.min(S.x, v[I].x), S.y = Math.min(S.y, v[I].y), E.x = Math.max(E.x, v[I].x), E.y = Math.max(E.y, v[I].y);
                            M = S.x >= d.x && E.x <= m.x && S.y >= d.y && E.y <= m.y ? [v] : E.x < d.x || S.x > m.x || E.y < d.y || S.y > m.y ? [] : ot.clipLine([v], d.x, d.y, m.x, m.y)
                        }
                        for (var T = 0, C = M; T < C.length; T += 1) {
                            var P;
                            y.reset(C[T], .25 * f), P = y.length <= .5 * f ? 1 : Math.ceil(y.paddedLength / W) + 1;
                            for (var A = 0; A < P; A++) {
                                var X = A / Math.max(P - 1, 1), z = y.lerp(X), k = z.x + 100, L = z.y + 100;
                                a.push(k, L, f, 0);
                                var D = k - f, R = L - f, H = k + f, K = L + f;
                                if (p = p && this.isOffscreen(D, R, H, K), c = c || this.isInsideGrid(D, R, H, K), !B && this.grid.hitTestCircle(k, L, f, V) && (h = !0, !n)) return {
                                    circles: [],
                                    offscreen: !1,
                                    collisionDetected: h
                                }
                            }
                        }
                    }
                    return {circles: !n && h || !c ? [] : a, offscreen: p, collisionDetected: h}
                }, n.prototype.queryRenderedSymbols = function (t) {
                    if (0 === t.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength()) return {};
                    for (var e = [], i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = 0, s = t; o < s.length; o += 1) {
                        var l = s[o], u = new ot.Point(l.x + 100, l.y + 100);
                        i = Math.min(i, u.x), r = Math.min(r, u.y), n = Math.max(n, u.x), a = Math.max(a, u.y), e.push(u)
                    }
                    for (var h = {}, c = {}, p = 0, f = this.grid.query(i, r, n, a).concat(this.ignoredGrid.query(i, r, n, a)); p < f.length; p += 1) {
                        var d = f[p], m = d.key;
                        if (void 0 === h[m.bucketInstanceId] && (h[m.bucketInstanceId] = {}), !h[m.bucketInstanceId][m.featureIndex]) {
                            var y = [new ot.Point(d.x1, d.y1), new ot.Point(d.x2, d.y1), new ot.Point(d.x2, d.y2), new ot.Point(d.x1, d.y2)];
                            ot.polygonIntersectsPolygon(e, y) && (h[m.bucketInstanceId][m.featureIndex] = !0, void 0 === c[m.bucketInstanceId] && (c[m.bucketInstanceId] = []), c[m.bucketInstanceId].push(m.featureIndex))
                        }
                    }
                    return c
                }, n.prototype.insertCollisionBox = function (t, e, i, r, n) {
                    (e ? this.ignoredGrid : this.grid).insert({
                        bucketInstanceId: i,
                        featureIndex: r,
                        collisionGroupID: n
                    }, t[0], t[1], t[2], t[3])
                }, n.prototype.insertCollisionCircles = function (t, e, i, r, n) {
                    for (var a = e ? this.ignoredGrid : this.grid, o = {
                        bucketInstanceId: i,
                        featureIndex: r,
                        collisionGroupID: n
                    }, s = 0; s < t.length; s += 4) a.insertCircle(o, t[s], t[s + 1], t[s + 2])
                }, n.prototype.projectAndGetPerspectiveRatio = function (t, e, i) {
                    var r = [e, i, 0, 1];
                    return Le(r, r, t), {
                        point: new ot.Point((r[0] / r[3] + 1) / 2 * this.transform.width + 100, (-r[1] / r[3] + 1) / 2 * this.transform.height + 100),
                        perspectiveRatio: .5 + this.transform.cameraToCenterDistance / r[3] * .5
                    }
                }, n.prototype.isOffscreen = function (t, e, i, r) {
                    return i < 100 || t >= this.screenRightBoundary || r < 100 || e > this.screenBottomBoundary
                }, n.prototype.isInsideGrid = function (t, e, i, r) {
                    return i >= 0 && t < this.gridRightBoundary && r >= 0 && e < this.gridBottomBoundary
                }, n.prototype.getViewportMatrix = function () {
                    var t = ot.identity([]);
                    return ot.translate(t, t, [-100, -100, 0]), t
                };
                var De = function (t, e, i, r) {
                    this.opacity = t ? Math.max(0, Math.min(1, t.opacity + (t.placed ? e : -e))) : r && i ? 1 : 0, this.placed = i
                };
                De.prototype.isHidden = function () {
                    return 0 === this.opacity && !this.placed
                };
                var Re = function (t, e, i, r, n) {
                    this.text = new De(t ? t.text : null, e, i, n), this.icon = new De(t ? t.icon : null, e, r, n)
                };
                Re.prototype.isHidden = function () {
                    return this.text.isHidden() && this.icon.isHidden()
                };
                var Be = function (t, e, i) {
                    this.text = t, this.icon = e, this.skipFade = i
                }, Oe = function () {
                    this.invProjMatrix = ot.create(), this.viewportMatrix = ot.create(), this.circles = []
                }, Fe = function (t, e, i, r, n) {
                    this.bucketInstanceId = t, this.featureIndex = e, this.sourceLayerIndex = i, this.bucketIndex = r, this.tileID = n
                }, Ue = function (t) {
                    this.crossSourceCollisions = t, this.maxGroupID = 0, this.collisionGroups = {}
                };

                function Ne(t, e, i, r, n) {
                    var a = ot.getAnchorAlignment(t), o = -(a.horizontalAlign - .5) * e,
                        s = -(a.verticalAlign - .5) * i, l = ot.evaluateVariableOffset(t, r);
                    return new ot.Point(o + l[0] * n, s + l[1] * n)
                }

                function Ve(t, e, i, r, n, a) {
                    var o = t.x1, s = t.x2, l = t.y1, u = t.y2, h = t.anchorPointX, c = t.anchorPointY,
                        p = new ot.Point(e, i);
                    return r && p._rotate(n ? a : -a), {
                        x1: o + p.x,
                        y1: l + p.y,
                        x2: s + p.x,
                        y2: u + p.y,
                        anchorPointX: h,
                        anchorPointY: c
                    }
                }

                Ue.prototype.get = function (t) {
                    if (this.crossSourceCollisions) return {ID: 0, predicate: null};
                    if (!this.collisionGroups[t]) {
                        var e = ++this.maxGroupID;
                        this.collisionGroups[t] = {
                            ID: e, predicate: function (t) {
                                return t.collisionGroupID === e
                            }
                        }
                    }
                    return this.collisionGroups[t]
                };
                var s = function (t, e, i, r) {
                    this.transform = t.clone(), this.collisionIndex = new n(this.transform), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = !1, this.commitTime = 0, this.fadeDuration = e, this.retainedQueryData = {}, this.collisionGroups = new Ue(i), this.collisionCircleArrays = {}, this.prevPlacement = r, r && (r.prevPlacement = void 0), this.placedOrientations = {}
                };

                function je(t, e, i, r, n) {
                    t.emplaceBack(e ? 1 : 0, i ? 1 : 0, r || 0, n || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, r || 0, n || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, r || 0, n || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, r || 0, n || 0)
                }

                s.prototype.getBucketParts = function (t, e, i, r) {
                    var n = i.getBucket(e), a = i.latestFeatureIndex;
                    if (n && a && e.id === n.layerIds[0]) {
                        var o = i.collisionBoxArray, s = n.layers[0].layout,
                            l = Math.pow(2, this.transform.zoom - i.tileID.overscaledZ), u = i.tileSize / ot.EXTENT,
                            h = this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),
                            c = "map" === s.get("text-pitch-alignment"), p = "map" === s.get("text-rotation-alignment"),
                            f = lt(i, 1, this.transform.zoom), d = be(h, c, p, this.transform, f), m = null;
                        if (c) {
                            var y = we(h, c, p, this.transform, f);
                            m = ot.multiply([], this.transform.labelPlaneMatrix, y)
                        }
                        this.retainedQueryData[n.bucketInstanceId] = new Fe(n.bucketInstanceId, a, n.sourceLayerIndex, n.index, i.tileID);
                        var g = {
                            bucket: n,
                            layout: s,
                            posMatrix: h,
                            textLabelPlaneMatrix: d,
                            labelToScreenMatrix: m,
                            scale: l,
                            textPixelRatio: u,
                            holdingForFade: i.holdingForFade(),
                            collisionBoxArray: o,
                            partiallyEvaluatedTextSize: ot.evaluateSizeForZoom(n.textSizeData, this.transform.zoom),
                            collisionGroup: this.collisionGroups.get(n.sourceID)
                        };
                        if (r) for (var _ = 0, v = n.sortKeyRanges; _ < v.length; _ += 1) {
                            var x = v[_];
                            t.push({
                                sortKey: x.sortKey,
                                symbolInstanceStart: x.symbolInstanceStart,
                                symbolInstanceEnd: x.symbolInstanceEnd,
                                parameters: g
                            })
                        } else t.push({
                            symbolInstanceStart: 0,
                            symbolInstanceEnd: n.symbolInstances.length,
                            parameters: g
                        })
                    }
                }, s.prototype.attemptAnchorPlacement = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d) {
                    var m, y = [c.textOffset0, c.textOffset1], g = Ne(t, i, r, y, n),
                        _ = this.collisionIndex.placeCollisionBox(Ve(e, g.x, g.y, a, o, this.transform.angle), h, s, l, u.predicate);
                    if (!d || 0 !== this.collisionIndex.placeCollisionBox(Ve(d, g.x, g.y, a, o, this.transform.angle), h, s, l, u.predicate).box.length) return _.box.length > 0 ? (this.prevPlacement && this.prevPlacement.variableOffsets[c.crossTileID] && this.prevPlacement.placements[c.crossTileID] && this.prevPlacement.placements[c.crossTileID].text && (m = this.prevPlacement.variableOffsets[c.crossTileID].anchor), this.variableOffsets[c.crossTileID] = {
                        textOffset: y,
                        width: i,
                        height: r,
                        anchor: t,
                        textBoxScale: n,
                        prevAnchor: m
                    }, this.markUsedJustification(p, t, c, f), p.allowVerticalPlacement && (this.markUsedOrientation(p, f, c), this.placedOrientations[c.crossTileID] = f), {
                        shift: g,
                        placedGlyphBoxes: _
                    }) : void 0
                }, s.prototype.placeLayerBucketPart = function (t, k, L) {
                    var D = this, e = t.parameters, R = e.bucket, B = e.layout, O = e.posMatrix,
                        F = e.textLabelPlaneMatrix, U = e.labelToScreenMatrix, N = e.textPixelRatio,
                        V = e.holdingForFade, i = e.collisionBoxArray, j = e.partiallyEvaluatedTextSize,
                        q = e.collisionGroup, G = B.get("text-optional"), Z = B.get("icon-optional"),
                        W = B.get("text-allow-overlap"), X = B.get("icon-allow-overlap"),
                        H = "map" === B.get("text-rotation-alignment"), K = "map" === B.get("text-pitch-alignment"),
                        Y = "none" !== B.get("icon-text-fit"), r = "viewport-y" === B.get("symbol-z-order"),
                        J = W && (X || !R.hasIconData() || Z), Q = X && (W || !R.hasTextData() || G);
                    !R.collisionArrays && i && R.deserializeCollisionBoxes(i);
                    var n = function (c, n) {
                        if (!k[c.crossTileID]) if (V) D.placements[c.crossTileID] = new Be(!1, !1, !1); else {
                            var t, p = !1, e = !1, i = !0, f = null, a = {box: null, offscreen: null},
                                o = {box: null, offscreen: null}, r = null, s = null, l = 0, u = 0, h = 0;
                            n.textFeatureIndex ? l = n.textFeatureIndex : c.useRuntimeCollisionCircles && (l = c.featureIndex), n.verticalTextFeatureIndex && (u = n.verticalTextFeatureIndex);
                            var d = n.textBox;
                            if (d) {
                                var m = function (t) {
                                    var e = ot.WritingMode.horizontal;
                                    if (R.allowVerticalPlacement && !t && D.prevPlacement) {
                                        var i = D.prevPlacement.placedOrientations[c.crossTileID];
                                        i && (D.placedOrientations[c.crossTileID] = i, D.markUsedOrientation(R, e = i, c))
                                    }
                                    return e
                                }, y = function (t, e) {
                                    if (R.allowVerticalPlacement && c.numVerticalGlyphVertices > 0 && n.verticalTextBox) for (var i = 0, r = R.writingModes; i < r.length && (r[i] === ot.WritingMode.vertical ? (a = e(), o = a) : a = t(), !(a && a.box && a.box.length)); i += 1) ; else a = t()
                                };
                                if (B.get("text-variable-anchor")) {
                                    var g = B.get("text-variable-anchor");
                                    if (D.prevPlacement && D.prevPlacement.variableOffsets[c.crossTileID]) {
                                        var _ = D.prevPlacement.variableOffsets[c.crossTileID];
                                        g.indexOf(_.anchor) > 0 && (g = g.filter(function (t) {
                                            return t !== _.anchor
                                        })).unshift(_.anchor)
                                    }
                                    var v = function (t, e, i) {
                                        for (var r = t.x2 - t.x1, n = t.y2 - t.y1, a = c.textBoxScale, o = Y && !X ? e : null, s = {
                                            box: [],
                                            offscreen: !1
                                        }, l = W ? 2 * g.length : g.length, u = 0; u < l; ++u) {
                                            var h = D.attemptAnchorPlacement(g[u % g.length], t, r, n, a, H, K, N, O, q, u >= g.length, c, R, i, o);
                                            if (h && (s = h.placedGlyphBoxes) && s.box && s.box.length) {
                                                p = !0, f = h.shift;
                                                break
                                            }
                                        }
                                        return s
                                    };
                                    y(function () {
                                        return v(d, n.iconBox, ot.WritingMode.horizontal)
                                    }, function () {
                                        var t = n.verticalTextBox;
                                        return R.allowVerticalPlacement && !(a && a.box && a.box.length) && c.numVerticalGlyphVertices > 0 && t ? v(t, n.verticalIconBox, ot.WritingMode.vertical) : {
                                            box: null,
                                            offscreen: null
                                        }
                                    }), a && (p = a.box, i = a.offscreen);
                                    var x = m(a && a.box);
                                    if (!p && D.prevPlacement) {
                                        var b = D.prevPlacement.variableOffsets[c.crossTileID];
                                        b && (D.variableOffsets[c.crossTileID] = b, D.markUsedJustification(R, b.anchor, c, x))
                                    }
                                } else {
                                    var w = function (t, e) {
                                        var i = D.collisionIndex.placeCollisionBox(t, W, N, O, q.predicate);
                                        return i && i.box && i.box.length && (D.markUsedOrientation(R, e, c), D.placedOrientations[c.crossTileID] = e), i
                                    };
                                    y(function () {
                                        return w(d, ot.WritingMode.horizontal)
                                    }, function () {
                                        var t = n.verticalTextBox;
                                        return R.allowVerticalPlacement && c.numVerticalGlyphVertices > 0 && t ? w(t, ot.WritingMode.vertical) : {
                                            box: null,
                                            offscreen: null
                                        }
                                    }), m(a && a.box && a.box.length)
                                }
                            }
                            if (p = (t = a) && t.box && t.box.length > 0, i = t && t.offscreen, c.useRuntimeCollisionCircles) {
                                var M = R.text.placedSymbolArray.get(c.centerJustifiedTextSymbolIndex),
                                    S = ot.evaluateSizeForFeature(R.textSizeData, j, M), E = B.get("text-padding");
                                r = D.collisionIndex.placeCollisionCircles(W, M, R.lineVertexArray, R.glyphOffsetArray, S, O, F, U, L, K, q.predicate, c.collisionCircleDiameter, E), p = W || r.circles.length > 0 && !r.collisionDetected, i = i && r.offscreen
                            }
                            if (n.iconFeatureIndex && (h = n.iconFeatureIndex), n.iconBox) {
                                var I = function (t) {
                                    var e = Y && f ? Ve(t, f.x, f.y, H, K, D.transform.angle) : t;
                                    return D.collisionIndex.placeCollisionBox(e, X, N, O, q.predicate)
                                };
                                e = o && o.box && o.box.length && n.verticalIconBox ? (s = I(n.verticalIconBox)).box.length > 0 : (s = I(n.iconBox)).box.length > 0, i = i && s.offscreen
                            }
                            var T = G || 0 === c.numHorizontalGlyphVertices && 0 === c.numVerticalGlyphVertices,
                                C = Z || 0 === c.numIconVertices;
                            if (T || C ? C ? T || (e = e && p) : p = e && p : e = p = e && p, p && t && t.box && D.collisionIndex.insertCollisionBox(t.box, B.get("text-ignore-placement"), R.bucketInstanceId, o && o.box && u ? u : l, q.ID), e && s && D.collisionIndex.insertCollisionBox(s.box, B.get("icon-ignore-placement"), R.bucketInstanceId, h, q.ID), r && (p && D.collisionIndex.insertCollisionCircles(r.circles, B.get("text-ignore-placement"), R.bucketInstanceId, l, q.ID), L)) {
                                var P = R.bucketInstanceId, A = D.collisionCircleArrays[P];
                                void 0 === A && (A = D.collisionCircleArrays[P] = new Oe);
                                for (var z = 0; z < r.circles.length; z += 4) A.circles.push(r.circles[z + 0]), A.circles.push(r.circles[z + 1]), A.circles.push(r.circles[z + 2]), A.circles.push(r.collisionDetected ? 1 : 0)
                            }
                            D.placements[c.crossTileID] = new Be(p || J, e || Q, i || R.justReloaded), k[c.crossTileID] = !0
                        }
                    };
                    if (r) for (var a = R.getSortedSymbolIndexes(this.transform.angle), o = a.length - 1; o >= 0; --o) {
                        var s = a[o];
                        n(R.symbolInstances.get(s), R.collisionArrays[s])
                    } else for (var l = t.symbolInstanceStart; l < t.symbolInstanceEnd; l++) n(R.symbolInstances.get(l), R.collisionArrays[l]);
                    if (L && R.bucketInstanceId in this.collisionCircleArrays) {
                        var u = this.collisionCircleArrays[R.bucketInstanceId];
                        ot.invert(u.invProjMatrix, O), u.viewportMatrix = this.collisionIndex.getViewportMatrix()
                    }
                    R.justReloaded = !1
                }, s.prototype.markUsedJustification = function (t, e, i, r) {
                    var n;
                    n = r === ot.WritingMode.vertical ? i.verticalPlacedTextSymbolIndex : {
                        left: i.leftJustifiedTextSymbolIndex,
                        center: i.centerJustifiedTextSymbolIndex,
                        right: i.rightJustifiedTextSymbolIndex
                    }[ot.getAnchorJustification(e)];
                    for (var a = 0, o = [i.leftJustifiedTextSymbolIndex, i.centerJustifiedTextSymbolIndex, i.rightJustifiedTextSymbolIndex, i.verticalPlacedTextSymbolIndex]; a < o.length; a += 1) {
                        var s = o[a];
                        s >= 0 && (t.text.placedSymbolArray.get(s).crossTileID = n >= 0 && s !== n ? 0 : i.crossTileID)
                    }
                }, s.prototype.markUsedOrientation = function (t, e, i) {
                    for (var r = e === ot.WritingMode.horizontal || e === ot.WritingMode.horizontalOnly ? e : 0, n = e === ot.WritingMode.vertical ? e : 0, a = 0, o = [i.leftJustifiedTextSymbolIndex, i.centerJustifiedTextSymbolIndex, i.rightJustifiedTextSymbolIndex]; a < o.length; a += 1) t.text.placedSymbolArray.get(o[a]).placedOrientation = r;
                    i.verticalPlacedTextSymbolIndex && (t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation = n)
                }, s.prototype.commit = function (t) {
                    this.commitTime = t, this.zoomAtLastRecencyCheck = this.transform.zoom;
                    var e = this.prevPlacement, i = !1;
                    this.prevZoomAdjustment = e ? e.zoomAdjustment(this.transform.zoom) : 0;
                    var r = e ? e.symbolFadeChange(t) : 1, n = e ? e.opacities : {}, a = e ? e.variableOffsets : {},
                        o = e ? e.placedOrientations : {};
                    for (var s in this.placements) {
                        var l = this.placements[s], u = n[s];
                        u ? (this.opacities[s] = new Re(u, r, l.text, l.icon), i = i || l.text !== u.text.placed || l.icon !== u.icon.placed) : (this.opacities[s] = new Re(null, r, l.text, l.icon, l.skipFade), i = i || l.text || l.icon)
                    }
                    for (var h in n) {
                        var c = n[h];
                        if (!this.opacities[h]) {
                            var p = new Re(c, r, !1, !1);
                            p.isHidden() || (this.opacities[h] = p, i = i || c.text.placed || c.icon.placed)
                        }
                    }
                    for (var f in a) this.variableOffsets[f] || !this.opacities[f] || this.opacities[f].isHidden() || (this.variableOffsets[f] = a[f]);
                    for (var d in o) this.placedOrientations[d] || !this.opacities[d] || this.opacities[d].isHidden() || (this.placedOrientations[d] = o[d]);
                    i ? this.lastPlacementChangeTime = t : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = e ? e.lastPlacementChangeTime : t)
                }, s.prototype.updateLayerOpacities = function (t, e) {
                    for (var i = {}, r = 0, n = e; r < n.length; r += 1) {
                        var a = n[r], o = a.getBucket(t);
                        o && a.latestFeatureIndex && t.id === o.layerIds[0] && this.updateBucketOpacities(o, i, a.collisionBoxArray)
                    }
                }, s.prototype.updateBucketOpacities = function (b, w, t) {
                    var M = this;
                    b.hasTextData() && b.text.opacityVertexArray.clear(), b.hasIconData() && b.icon.opacityVertexArray.clear(), b.hasIconCollisionBoxData() && b.iconCollisionBox.collisionVertexArray.clear(), b.hasTextCollisionBoxData() && b.textCollisionBox.collisionVertexArray.clear();
                    var e = b.layers[0].layout, S = new Re(null, 0, !1, !1, !0), i = e.get("text-allow-overlap"),
                        r = e.get("icon-allow-overlap"), E = e.get("text-variable-anchor"),
                        I = "map" === e.get("text-rotation-alignment"), T = "map" === e.get("text-pitch-alignment"),
                        C = "none" !== e.get("icon-text-fit"),
                        P = new Re(null, 0, i && (r || !b.hasIconData() || e.get("icon-optional")), r && (i || !b.hasTextData() || e.get("text-optional")), !0);
                    !b.collisionArrays && t && (b.hasIconCollisionBoxData() || b.hasTextCollisionBoxData()) && b.deserializeCollisionBoxes(t);
                    for (var A = function (t, e, i) {
                        for (var r = 0; r < e / 4; r++) t.opacityVertexArray.emplaceBack(i)
                    }, n = function (t) {
                        var e = b.symbolInstances.get(t), i = e.numHorizontalGlyphVertices,
                            r = e.numVerticalGlyphVertices, n = e.crossTileID, a = M.opacities[n];
                        w[n] ? a = S : a || (M.opacities[n] = a = P), w[n] = !0;
                        var o = e.numIconVertices > 0, s = M.placedOrientations[e.crossTileID],
                            l = s === ot.WritingMode.vertical,
                            u = s === ot.WritingMode.horizontal || s === ot.WritingMode.horizontalOnly;
                        if (i > 0 || r > 0) {
                            var h = Ye(a.text);
                            A(b.text, i, l ? Je : h), A(b.text, r, u ? Je : h);
                            var c = a.text.isHidden();
                            [e.rightJustifiedTextSymbolIndex, e.centerJustifiedTextSymbolIndex, e.leftJustifiedTextSymbolIndex].forEach(function (t) {
                                t >= 0 && (b.text.placedSymbolArray.get(t).hidden = c || l ? 1 : 0)
                            }), e.verticalPlacedTextSymbolIndex >= 0 && (b.text.placedSymbolArray.get(e.verticalPlacedTextSymbolIndex).hidden = c || u ? 1 : 0);
                            var p = M.variableOffsets[e.crossTileID];
                            p && M.markUsedJustification(b, p.anchor, e, s);
                            var f = M.placedOrientations[e.crossTileID];
                            f && (M.markUsedJustification(b, "left", e, f), M.markUsedOrientation(b, f, e))
                        }
                        if (o) {
                            var d = Ye(a.icon), m = !(C && e.verticalPlacedIconSymbolIndex && l);
                            e.placedIconSymbolIndex >= 0 && (A(b.icon, e.numIconVertices, m ? d : Je), b.icon.placedSymbolArray.get(e.placedIconSymbolIndex).hidden = a.icon.isHidden()), e.verticalPlacedIconSymbolIndex >= 0 && (A(b.icon, e.numVerticalIconVertices, m ? Je : d), b.icon.placedSymbolArray.get(e.verticalPlacedIconSymbolIndex).hidden = a.icon.isHidden())
                        }
                        if (b.hasIconCollisionBoxData() || b.hasTextCollisionBoxData()) {
                            var y = b.collisionArrays[t];
                            if (y) {
                                var g = new ot.Point(0, 0);
                                if (y.textBox || y.verticalTextBox) {
                                    var _ = !0;
                                    if (E) {
                                        var v = M.variableOffsets[n];
                                        v ? (g = Ne(v.anchor, v.width, v.height, v.textOffset, v.textBoxScale), I && g._rotate(T ? M.transform.angle : -M.transform.angle)) : _ = !1
                                    }
                                    y.textBox && je(b.textCollisionBox.collisionVertexArray, a.text.placed, !_ || l, g.x, g.y), y.verticalTextBox && je(b.textCollisionBox.collisionVertexArray, a.text.placed, !_ || u, g.x, g.y)
                                }
                                var x = Boolean(!u && y.verticalIconBox);
                                y.iconBox && je(b.iconCollisionBox.collisionVertexArray, a.icon.placed, x, C ? g.x : 0, C ? g.y : 0), y.verticalIconBox && je(b.iconCollisionBox.collisionVertexArray, a.icon.placed, !x, C ? g.x : 0, C ? g.y : 0)
                            }
                        }
                    }, a = 0; a < b.symbolInstances.length; a++) n(a);
                    if (b.sortFeatures(this.transform.angle), this.retainedQueryData[b.bucketInstanceId] && (this.retainedQueryData[b.bucketInstanceId].featureSortOrder = b.featureSortOrder), b.hasTextData() && b.text.opacityVertexBuffer && b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray), b.hasIconData() && b.icon.opacityVertexBuffer && b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray), b.hasIconCollisionBoxData() && b.iconCollisionBox.collisionVertexBuffer && b.iconCollisionBox.collisionVertexBuffer.updateData(b.iconCollisionBox.collisionVertexArray), b.hasTextCollisionBoxData() && b.textCollisionBox.collisionVertexBuffer && b.textCollisionBox.collisionVertexBuffer.updateData(b.textCollisionBox.collisionVertexArray), b.bucketInstanceId in this.collisionCircleArrays) {
                        var o = this.collisionCircleArrays[b.bucketInstanceId];
                        b.placementInvProjMatrix = o.invProjMatrix, b.placementViewportMatrix = o.viewportMatrix, b.collisionCircleArray = o.circles, delete this.collisionCircleArrays[b.bucketInstanceId]
                    }
                }, s.prototype.symbolFadeChange = function (t) {
                    return 0 === this.fadeDuration ? 1 : (t - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment
                }, s.prototype.zoomAdjustment = function (t) {
                    return Math.max(0, (this.transform.zoom - t) / 1.5)
                }, s.prototype.hasTransitions = function (t) {
                    return this.stale || t - this.lastPlacementChangeTime < this.fadeDuration
                }, s.prototype.stillRecent = function (t, e) {
                    var i = this.zoomAtLastRecencyCheck === e ? 1 - this.zoomAdjustment(e) : 1;
                    return this.zoomAtLastRecencyCheck = e, this.commitTime + this.fadeDuration * i > t
                }, s.prototype.setStale = function () {
                    this.stale = !0
                };
                var qe = Math.pow(2, 25), Ge = Math.pow(2, 24), Ze = Math.pow(2, 17), We = Math.pow(2, 16),
                    Xe = Math.pow(2, 9), He = Math.pow(2, 8), Ke = Math.pow(2, 1);

                function Ye(t) {
                    if (0 === t.opacity && !t.placed) return 0;
                    if (1 === t.opacity && t.placed) return 4294967295;
                    var e = t.placed ? 1 : 0, i = Math.floor(127 * t.opacity);
                    return i * qe + e * Ge + i * Ze + e * We + i * Xe + e * He + i * Ke + e
                }

                var Je = 0, Qe = function (t) {
                    this._sortAcrossTiles = "viewport-y" !== t.layout.get("symbol-z-order") && void 0 !== t.layout.get("symbol-sort-key").constantOr(1), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = []
                };
                Qe.prototype.continuePlacement = function (t, e, i, r, n) {
                    for (var a = this._bucketParts; this._currentTileIndex < t.length;) if (e.getBucketParts(a, r, t[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, n()) return !0;
                    for (this._sortAcrossTiles && (this._sortAcrossTiles = !1, a.sort(function (t, e) {
                        return t.sortKey - e.sortKey
                    })); this._currentPartIndex < a.length;) if (e.placeLayerBucketPart(a[this._currentPartIndex], this._seenCrossTileIDs, i), this._currentPartIndex++, n()) return !0;
                    return !1
                };
                var $e = function (t, e, i, r, n, a, o) {
                    this.placement = new s(t, n, a, o), this._currentPlacementIndex = e.length - 1, this._forceFullPlacement = i, this._showCollisionBoxes = r, this._done = !1
                };
                $e.prototype.isDone = function () {
                    return this._done
                }, $e.prototype.continuePlacement = function (t, e, i) {
                    for (var r = this, n = ot.browser.now(), a = function () {
                        var t = ot.browser.now() - n;
                        return !r._forceFullPlacement && t > 2
                    }; this._currentPlacementIndex >= 0;) {
                        var o = e[t[this._currentPlacementIndex]], s = this.placement.collisionIndex.transform.zoom;
                        if ("symbol" === o.type && (!o.minzoom || o.minzoom <= s) && (!o.maxzoom || o.maxzoom > s)) {
                            if (this._inProgressLayer || (this._inProgressLayer = new Qe(o)), this._inProgressLayer.continuePlacement(i[o.source], this.placement, this._showCollisionBoxes, o, a)) return;
                            delete this._inProgressLayer
                        }
                        this._currentPlacementIndex--
                    }
                    this._done = !0
                }, $e.prototype.commit = function (t) {
                    return this.placement.commit(t), this.placement
                };
                var ti = 512 / ot.EXTENT / 2, ei = function (t, e, i) {
                    this.tileID = t, this.indexedSymbolInstances = {}, this.bucketInstanceId = i;
                    for (var r = 0; r < e.length; r++) {
                        var n = e.get(r), a = n.key;
                        this.indexedSymbolInstances[a] || (this.indexedSymbolInstances[a] = []), this.indexedSymbolInstances[a].push({
                            crossTileID: n.crossTileID,
                            coord: this.getScaledCoordinates(n, t)
                        })
                    }
                };
                ei.prototype.getScaledCoordinates = function (t, e) {
                    var i = ti / Math.pow(2, e.canonical.z - this.tileID.canonical.z);
                    return {
                        x: Math.floor((e.canonical.x * ot.EXTENT + t.anchorX) * i),
                        y: Math.floor((e.canonical.y * ot.EXTENT + t.anchorY) * i)
                    }
                }, ei.prototype.findMatches = function (t, e, i) {
                    for (var r = this.tileID.canonical.z < e.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - e.canonical.z), n = 0; n < t.length; n++) {
                        var a = t.get(n);
                        if (!a.crossTileID) {
                            var o = this.indexedSymbolInstances[a.key];
                            if (o) for (var s = this.getScaledCoordinates(a, e), l = 0, u = o; l < u.length; l += 1) {
                                var h = u[l];
                                if (Math.abs(h.coord.x - s.x) <= r && Math.abs(h.coord.y - s.y) <= r && !i[h.crossTileID]) {
                                    i[h.crossTileID] = !0, a.crossTileID = h.crossTileID;
                                    break
                                }
                            }
                        }
                    }
                };
                var ii = function () {
                    this.maxCrossTileID = 0
                };
                ii.prototype.generate = function () {
                    return ++this.maxCrossTileID
                };
                var ri = function () {
                    this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0
                };
                ri.prototype.handleWrapJump = function (t) {
                    var e = Math.round((t - this.lng) / 360);
                    if (0 !== e) for (var i in this.indexes) {
                        var r = this.indexes[i], n = {};
                        for (var a in r) {
                            var o = r[a];
                            o.tileID = o.tileID.unwrapTo(o.tileID.wrap + e), n[o.tileID.key] = o
                        }
                        this.indexes[i] = n
                    }
                    this.lng = t
                }, ri.prototype.addBucket = function (t, e, i) {
                    if (this.indexes[t.overscaledZ] && this.indexes[t.overscaledZ][t.key]) {
                        if (this.indexes[t.overscaledZ][t.key].bucketInstanceId === e.bucketInstanceId) return !1;
                        this.removeBucketCrossTileIDs(t.overscaledZ, this.indexes[t.overscaledZ][t.key])
                    }
                    for (var r = 0; r < e.symbolInstances.length; r++) e.symbolInstances.get(r).crossTileID = 0;
                    this.usedCrossTileIDs[t.overscaledZ] || (this.usedCrossTileIDs[t.overscaledZ] = {});
                    var n = this.usedCrossTileIDs[t.overscaledZ];
                    for (var a in this.indexes) {
                        var o = this.indexes[a];
                        if (Number(a) > t.overscaledZ) for (var s in o) {
                            var l = o[s];
                            l.tileID.isChildOf(t) && l.findMatches(e.symbolInstances, t, n)
                        } else {
                            var u = o[t.scaledTo(Number(a)).key];
                            u && u.findMatches(e.symbolInstances, t, n)
                        }
                    }
                    for (var h = 0; h < e.symbolInstances.length; h++) {
                        var c = e.symbolInstances.get(h);
                        c.crossTileID || (c.crossTileID = i.generate(), n[c.crossTileID] = !0)
                    }
                    return void 0 === this.indexes[t.overscaledZ] && (this.indexes[t.overscaledZ] = {}), this.indexes[t.overscaledZ][t.key] = new ei(t, e.symbolInstances, e.bucketInstanceId), !0
                }, ri.prototype.removeBucketCrossTileIDs = function (t, e) {
                    for (var i in e.indexedSymbolInstances) for (var r = 0, n = e.indexedSymbolInstances[i]; r < n.length; r += 1) delete this.usedCrossTileIDs[t][n[r].crossTileID]
                }, ri.prototype.removeStaleBuckets = function (t) {
                    var e = !1;
                    for (var i in this.indexes) {
                        var r = this.indexes[i];
                        for (var n in r) t[r[n].bucketInstanceId] || (this.removeBucketCrossTileIDs(i, r[n]), delete r[n], e = !0)
                    }
                    return e
                };
                var ni = function () {
                    this.layerIndexes = {}, this.crossTileIDs = new ii, this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {}
                };
                ni.prototype.addLayer = function (t, e, i) {
                    var r = this.layerIndexes[t.id];
                    void 0 === r && (r = this.layerIndexes[t.id] = new ri);
                    var n = !1, a = {};
                    r.handleWrapJump(i);
                    for (var o = 0, s = e; o < s.length; o += 1) {
                        var l = s[o], u = l.getBucket(t);
                        u && t.id === u.layerIds[0] && (u.bucketInstanceId || (u.bucketInstanceId = ++this.maxBucketInstanceId), r.addBucket(l.tileID, u, this.crossTileIDs) && (n = !0), a[u.bucketInstanceId] = !0)
                    }
                    return r.removeStaleBuckets(a) && (n = !0), n
                }, ni.prototype.pruneUnusedLayers = function (t) {
                    var e = {};
                    for (var i in t.forEach(function (t) {
                        e[t] = !0
                    }), this.layerIndexes) e[i] || delete this.layerIndexes[i]
                };
                var ai = function (t, e) {
                        return ot.emitValidationErrors(t, e && e.filter(function (t) {
                            return "source.canvas" !== t.identifier
                        }))
                    },
                    oi = ot.pick(y, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData", "setGlyphs", "setSprite"]),
                    si = ot.pick(y, ["setCenter", "setZoom", "setBearing", "setPitch"]), li = function () {
                        var t = {}, e = ot.styleSpec.$version;
                        for (var i in ot.styleSpec.$root) {
                            var r, n = ot.styleSpec.$root[i];
                            if (n.required) null != (r = "version" === i ? e : "array" === n.type ? [] : {}) && (t[i] = r)
                        }
                        return t
                    }(), ui = function (i) {
                        function n(t, e) {
                            var a = this;
                            void 0 === e && (e = {}), i.call(this), this.map = t, this.dispatcher = new tt(he(), this), this._spriteRequests = {}, this.imageManagerFactory = new o, this.imageManagerFactory.setEventedParent(this), this.glyphManagerFactory = new H(t._requestManager, e.localIdeographFontFamily), this._sprites = {}, this._glyphs = {}, this.lineAtlas = new $(256, 512), this.crossTileSymbolIndex = new ni, this._layers = {}, this._serializedLayers = {}, this._order = [], this.sourceCaches = {}, this.zoomHistory = new ot.ZoomHistory, this._loaded = !1, this._availableImages = [], this._resetUpdates(), this.dispatcher.broadcast("setReferrer", ot.getReferrer());
                            var r = this;
                            this._rtlTextPluginCallback = n.registerForPluginStateChange(function (t) {
                                r.dispatcher.broadcast("syncRTLPluginState", {
                                    pluginStatus: t.pluginStatus,
                                    pluginURL: t.pluginURL
                                }, function (t, e) {
                                    if (ot.triggerPluginCompletionEvent(t), e && e.every(function (t) {
                                        return t
                                    })) for (var i in r.sourceCaches) r.sourceCaches[i].reload()
                                })
                            }), this.on("data", function (t) {
                                if ("source" === t.dataType && "metadata" === t.sourceDataType) {
                                    var e = a.sourceCaches[t.sourceId];
                                    if (e) {
                                        var i = e.getSource();
                                        if (i && i.vectorLayerIds) for (var r in a._layers) {
                                            var n = a._layers[r];
                                            n.source === i.id && a._validateLayer(n)
                                        }
                                    }
                                }
                            })
                        }

                        return i && (n.__proto__ = i), (n.prototype = Object.create(i && i.prototype)).constructor = n, n.prototype.loadURL = function (t, e) {
                            var i = this;
                            void 0 === e && (e = {}), this.fire(new ot.Event("dataloading", {dataType: "style"}));
                            var r = "boolean" == typeof e.validate ? e.validate : !ot.isMapboxURL(t);
                            t = this.map._requestManager.normalizeStyleURL(t, e.accessToken);
                            var n = this.map._requestManager.transformRequest(t, ot.ResourceType.Style);
                            this._request = ot.getJSON(n, function (t, e) {
                                i._request = null, t ? i.fire(new ot.ErrorEvent(t)) : e && i._load(e, r)
                            })
                        }, n.prototype.loadJSON = function (t, e) {
                            var i = this;
                            void 0 === e && (e = {}), this.fire(new ot.Event("dataloading", {dataType: "style"})), this._request = ot.browser.frame(function () {
                                i._request = null, i._load(JSON.parse(JSON.stringify(t)), !1 !== e.validate)
                            })
                        }, n.prototype.loadEmpty = function () {
                            this.fire(new ot.Event("dataloading", {dataType: "style"})), this._load(li, !1)
                        }, n.prototype._load = function (t, e) {
                            if (!e || !ai(this, ot.validateStyle(t))) {
                                for (var i in this._loaded = !0, this.stylesheet = t, t.sources) this.addSource(i, t.sources[i], {validate: !1});
                                if (t.sprite ? this._loadSprite(t) : this.imageManagerFactory.setLoaded(!0), "string" == typeof t.glyphs) {
                                    var r = {};
                                    for (var n in t.sources) r[n] = t.glyphs;
                                    r.image_manager_default = t.glyphs, t.glyphs = r
                                }
                                for (var a in t.glyphs) this.glyphManagerFactory.setURL(t.glyphs[a], a), this._glyphs[a] = t.glyphs[a];
                                var o = pe(this.stylesheet.layers);
                                this._order = o.map(function (t) {
                                    return t.id
                                }), this._layers = {}, this._serializedLayers = {};
                                for (var s = 0, l = o; s < l.length; s += 1) {
                                    var u = l[s];
                                    (u = ot.createStyleLayer(u)).setEventedParent(this, {layer: {id: u.id}}), this._layers[u.id] = u, this._serializedLayers[u.id] = u.serialize()
                                }
                                this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this.light = new Q(this.stylesheet.light), this.fire(new ot.Event("data", {dataType: "style"})), this.fire(new ot.Event("style.load"))
                            }
                        }, n.prototype._loadSprite = function (n) {
                            var a = this, o = function (t, e, i) {
                                if (a._sprites[t] = "string" == typeof n.sprite ? n.sprite : n.sprite[t], a._spriteRequests[t] = null, delete a._spriteRequests[t], i) a.fire(new ot.ErrorEvent(i)); else if (e) for (var r in e) a.imageManagerFactory.addImage(r, e[r], t);
                                a.imageManagerFactory.setLoaded(!0, t), a._availableImages = a.imageManagerFactory.listImages(), a.dispatcher.broadcast("setImages", a._availableImages), a.fire(new ot.Event("data", {dataType: "style"}))
                            };
                            if ("string" != typeof n.sprite) {
                                var t = function (i) {
                                    var t = U(n.sprite[i], a.map._requestManager, function (t, e) {
                                        o(i, e, t)
                                    });
                                    a._spriteRequests[i] = t
                                };
                                for (var e in n.sprite) t(e)
                            } else {
                                var s = n.sprite, i = U(n.sprite, this.map._requestManager, function (t, e) {
                                    var i = {image_manager_default: n.sprite};
                                    for (var r in o("image_manager_default", e, t), n.sources) i[r] = s, o(r, e, t);
                                    n.sprite = i
                                });
                                this._spriteRequests.image_manager_default = i
                            }
                        }, n.prototype.setSprite = function (t) {
                            for (var e in t) this.addSprite(e, t[e])
                        }, n.prototype.addSpriteObject = function (t, e, i) {
                            var r = ot.browser.getImageData(e), n = {};
                            for (var a in i) {
                                var o = i[a], s = o.width, l = o.height, u = o.x, h = o.y, c = o.sdf, p = o.pixelRatio,
                                    f = new ot.RGBAImage({width: s, height: l});
                                ot.RGBAImage.copy(r, f, {x: u, y: h}, {x: 0, y: 0}, {width: s, height: l}), n[a] = {
                                    data: f,
                                    pixelRatio: p,
                                    sdf: c
                                }
                            }
                            for (var d in n) this.imageManagerFactory.addImage(d, n[d], t)
                        }, n.prototype.addSprite = function (r, n) {
                            var a = this;
                            this.imageManagerFactory.imageManagers[r] || (this.imageManagerFactory.imageManagers[r] = new q, "image_manager_default" !== r && (this.imageManagerFactory.imageManagers[r].defaultImageManger = this.imageManagerFactory.imageManagers.image_manager_default));
                            var t = U(n, this.map._requestManager, function (t, e) {
                                if (a._sprites[r] = n, a._spriteRequests[r] = null, delete a._spriteRequests[r], t) a.fire(new ot.ErrorEvent(t)); else if (e) for (var i in e) a.imageManagerFactory.addImage(i, e[i], r);
                                a.imageManagerFactory.setLoaded(!0, r), a.fire(new ot.Event("data", {dataType: "style"}))
                            });
                            this._spriteRequests[r] = t
                        }, n.prototype.setGlyphs = function (t) {
                            for (var e in t) this.addGlyphs(e, t[e])
                        }, n.prototype.addGlyphs = function (t, e) {
                            this._glyphs[t] = e, this.glyphManagerFactory.setURL(e, t)
                        }, n.prototype._validateLayer = function (t) {
                            var e = this.sourceCaches[t.source];
                            if (e) {
                                var i = t.sourceLayer;
                                if (i) {
                                    var r = e.getSource();
                                    ("geojson" === r.type || r.vectorLayerIds && -1 === r.vectorLayerIds.indexOf(i)) && this.fire(new ot.ErrorEvent(new Error('Source layer "' + i + '" does not exist on source "' + r.id + '" as specified by style layer "' + t.id + '"')))
                                }
                            }
                        }, n.prototype.loaded = function () {
                            if (!this._loaded) return !1;
                            if (Object.keys(this._updatedSources).length) return !1;
                            for (var t in this.sourceCaches) if (!this.sourceCaches[t].loaded()) return !1;
                            return !!this.imageManagerFactory.isAllLoaded()
                        }, n.prototype._serializeLayers = function (t) {
                            for (var e = [], i = 0, r = t; i < r.length; i += 1) {
                                var n = this._layers[r[i]];
                                "custom" !== n.type && e.push(n.serialize())
                            }
                            return e
                        }, n.prototype.hasTransitions = function () {
                            if (this.light && this.light.hasTransition()) return !0;
                            for (var t in this.sourceCaches) if (this.sourceCaches[t].hasTransition()) return !0;
                            for (var e in this._layers) if (this._layers[e].hasTransition()) return !0;
                            return !1
                        }, n.prototype._checkLoaded = function () {
                            if (!this._loaded) throw new Error("Style is not done loading")
                        }, n.prototype.update = function (t) {
                            if (this._loaded) {
                                var e = this._changed;
                                if (this._changed) {
                                    var i = Object.keys(this._updatedLayers), r = Object.keys(this._removedLayers);
                                    for (var n in (i.length || r.length) && this._updateWorkerLayers(i, r), this._updatedSources) {
                                        var a = this._updatedSources[n];
                                        "reload" === a ? this._reloadSource(n) : "clear" === a && this._clearSource(n)
                                    }
                                    for (var o in this._updateTilesForChangedImages(), this._updatedPaintProps) this._layers[o].updateTransitions(t);
                                    this.light.updateTransitions(t), this._resetUpdates()
                                }
                                for (var s in this.sourceCaches) this.sourceCaches[s].used = !1;
                                for (var l = 0, u = this._order; l < u.length; l += 1) {
                                    var h = this._layers[u[l]];
                                    h.recalculate(t, this._availableImages), !h.isHidden(t.zoom) && h.source && (this.sourceCaches[h.source].used = !0)
                                }
                                this.light.recalculate(t), this.z = t.zoom, e && this.fire(new ot.Event("data", {dataType: "style"}))
                            }
                        }, n.prototype._updateTilesForChangedImages = function () {
                            var t = Object.keys(this._changedImages);
                            if (t.length) {
                                for (var e in this.sourceCaches) this.sourceCaches[e].reloadTilesForDependencies(["icons", "patterns"], t);
                                this._changedImages = {}
                            }
                        }, n.prototype._updateWorkerLayers = function (t, e) {
                            this.dispatcher.broadcast("updateLayers", {layers: this._serializeLayers(t), removedIds: e})
                        }, n.prototype._resetUpdates = function () {
                            this._changed = !1, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {}
                        }, n.prototype.setState = function (t) {
                            var e = this;
                            if (this._checkLoaded(), ai(this, ot.validateStyle(t))) return !1;
                            (t = ot.clone$1(t)).layers = pe(t.layers);
                            var i = function (t, e) {
                                if (!t) return [{command: y.setStyle, args: [e]}];
                                var i = [];
                                try {
                                    if (!ot.deepEqual(t.version, e.version)) return [{command: y.setStyle, args: [e]}];
                                    ot.deepEqual(t.center, e.center) || i.push({
                                        command: y.setCenter,
                                        args: [e.center]
                                    }), ot.deepEqual(t.zoom, e.zoom) || i.push({
                                        command: y.setZoom,
                                        args: [e.zoom]
                                    }), ot.deepEqual(t.bearing, e.bearing) || i.push({
                                        command: y.setBearing,
                                        args: [e.bearing]
                                    }), ot.deepEqual(t.pitch, e.pitch) || i.push({
                                        command: y.setPitch,
                                        args: [e.pitch]
                                    }), ot.deepEqual(t.sprite, e.sprite) || i.push({
                                        command: y.setSprite,
                                        args: [e.sprite]
                                    }), ot.deepEqual(t.glyphs, e.glyphs) || i.push({
                                        command: y.setGlyphs,
                                        args: [e.glyphs]
                                    }), ot.deepEqual(t.transition, e.transition) || i.push({
                                        command: y.setTransition,
                                        args: [e.transition]
                                    }), ot.deepEqual(t.light, e.light) || i.push({command: y.setLight, args: [e.light]});
                                    var r = {}, n = [];
                                    !function (t, e, i, r) {
                                        var n;
                                        for (n in e = e || {}, t = t || {}) t.hasOwnProperty(n) && (e.hasOwnProperty(n) || de(n, i, r));
                                        for (n in e) e.hasOwnProperty(n) && (t.hasOwnProperty(n) ? ot.deepEqual(t[n], e[n]) || ("geojson" === t[n].type && "geojson" === e[n].type && ye(t, e, n) ? i.push({
                                            command: y.setGeoJSONSourceData,
                                            args: [n, e[n].data]
                                        }) : me(n, e, i, r)) : fe(n, e, i))
                                    }(t.sources, e.sources, n, r);
                                    var a = [];
                                    t.layers && t.layers.forEach(function (t) {
                                        r[t.source] ? i.push({command: y.removeLayer, args: [t.id]}) : a.push(t)
                                    }), i = i.concat(n), function (t, e, i) {
                                        e = e || [];
                                        var r, n, a, o, s, l, u, h = (t = t || []).map(_e), c = e.map(_e),
                                            p = t.reduce(ve, {}), f = e.reduce(ve, {}), d = h.slice(),
                                            m = Object.create(null);
                                        for (r = 0, n = 0; r < h.length; r++) f.hasOwnProperty(a = h[r]) ? n++ : (i.push({
                                            command: y.removeLayer,
                                            args: [a]
                                        }), d.splice(d.indexOf(a, n), 1));
                                        for (r = 0, n = 0; r < c.length; r++) d[d.length - 1 - r] !== (a = c[c.length - 1 - r]) && (p.hasOwnProperty(a) ? (i.push({
                                            command: y.removeLayer,
                                            args: [a]
                                        }), d.splice(d.lastIndexOf(a, d.length - n), 1)) : n++, i.push({
                                            command: y.addLayer,
                                            args: [f[a], l = d[d.length - r]]
                                        }), d.splice(d.length - r, 0, a), m[a] = !0);
                                        for (r = 0; r < c.length; r++) if (o = p[a = c[r]], s = f[a], !m[a] && !ot.deepEqual(o, s)) if (ot.deepEqual(o.source, s.source) && ot.deepEqual(o["source-layer"], s["source-layer"]) && ot.deepEqual(o.type, s.type)) {
                                            for (u in ge(o.layout, s.layout, i, a, null, y.setLayoutProperty), ge(o.paint, s.paint, i, a, null, y.setPaintProperty), ot.deepEqual(o.filter, s.filter) || i.push({
                                                command: y.setFilter,
                                                args: [a, s.filter]
                                            }), ot.deepEqual(o.minzoom, s.minzoom) && ot.deepEqual(o.maxzoom, s.maxzoom) || i.push({
                                                command: y.setLayerZoomRange,
                                                args: [a, s.minzoom, s.maxzoom]
                                            }), o) o.hasOwnProperty(u) && "layout" !== u && "paint" !== u && "filter" !== u && "metadata" !== u && "minzoom" !== u && "maxzoom" !== u && (0 === u.indexOf("paint.") ? ge(o[u], s[u], i, a, u.slice(6), y.setPaintProperty) : ot.deepEqual(o[u], s[u]) || i.push({
                                                command: y.setLayerProperty,
                                                args: [a, u, s[u]]
                                            }));
                                            for (u in s) s.hasOwnProperty(u) && !o.hasOwnProperty(u) && "layout" !== u && "paint" !== u && "filter" !== u && "metadata" !== u && "minzoom" !== u && "maxzoom" !== u && (0 === u.indexOf("paint.") ? ge(o[u], s[u], i, a, u.slice(6), y.setPaintProperty) : ot.deepEqual(o[u], s[u]) || i.push({
                                                command: y.setLayerProperty,
                                                args: [a, u, s[u]]
                                            }))
                                        } else i.push({
                                            command: y.removeLayer,
                                            args: [a]
                                        }), l = d[d.lastIndexOf(a) + 1], i.push({command: y.addLayer, args: [s, l]})
                                    }(a, e.layers, i)
                                } catch (t) {
                                    console.warn("Unable to compute style diff:", t), i = [{command: y.setStyle, args: [e]}]
                                }
                                return i
                            }(this.serialize(), t).filter(function (t) {
                                return !(t.command in si)
                            });
                            if (0 === i.length) return !1;
                            var r = i.filter(function (t) {
                                return !(t.command in oi)
                            });
                            if (r.length > 0) throw new Error("Unimplemented: " + r.map(function (t) {
                                return t.command
                            }).join(", ") + ".");
                            return i.forEach(function (t) {
                                "setTransition" !== t.command && e[t.command].apply(e, t.args)
                            }), this.stylesheet = t, !0
                        }, n.prototype.addImage = function (t, e, i) {
                            if (this.getImage(t)) return this.fire(new ot.ErrorEvent(new Error("An image with this name already exists.")));
                            this.imageManagerFactory.addImage(t, e, i), this._afterImageUpdated(t)
                        }, n.prototype.updateImage = function (t, e, i) {
                            this.imageManagerFactory.updateImage(t, e, i)
                        }, n.prototype.getImage = function (t, e) {
                            return this.imageManagerFactory.getImage(t, e)
                        }, n.prototype.removeImage = function (t, e) {
                            if (!this.getImage(t)) return this.fire(new ot.ErrorEvent(new Error("No image with this name exists.")));
                            this.imageManagerFactory.removeImage(t, e), this._afterImageUpdated(t)
                        }, n.prototype._afterImageUpdated = function (t) {
                            this._availableImages = this.imageManagerFactory.listImages(), this._changedImages[t] = !0, this._changed = !0, this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new ot.Event("data", {dataType: "style"}))
                        }, n.prototype.listImages = function (t) {
                            return this._checkLoaded(), this.imageManagerFactory.listImages(t)
                        }, n.prototype.addSource = function (t, e, i) {
                            var r = this;
                            if (void 0 === i && (i = {}), this._checkLoaded(), void 0 !== this.sourceCaches[t]) throw new Error("There is already a source with this ID");
                            if (!e.type) throw new Error("The type property must be defined, but only the following properties were given: " + Object.keys(e).join(", ") + ".");
                            if (this.map._mapCRS && "geojson" === e.type && e.data && !e.data.customprj && !e.customprj && (e.customprj = this.map.customConvertPoint), !(["vector", "raster", "geojson", "video", "image"].indexOf(e.type) >= 0 && this._validate(ot.validateStyle.source, "sources." + t, e, null, i))) {
                                this.map && this.map._collectResourceTiming && (e.collectResourceTiming = !0);
                                var n = this.sourceCaches[t] = new ie(t, e, this.dispatcher);
                                n.style = this, n.setEventedParent(this, function () {
                                    return {isSourceLoaded: r.loaded(), source: n.serialize(), sourceId: t}
                                }), n.onAdd(this.map), this._changed = !0
                            }
                        }, n.prototype.removeSource = function (t) {
                            if (this._checkLoaded(), void 0 === this.sourceCaches[t]) throw new Error("There is no source with this ID");
                            for (var e in this._layers) if (this._layers[e].source === t) return this.fire(new ot.ErrorEvent(new Error('Source "' + t + '" cannot be removed while layer "' + e + '" is using it.')));
                            var i = this.sourceCaches[t];
                            delete this.sourceCaches[t], delete this._updatedSources[t], i.fire(new ot.Event("data", {
                                sourceDataType: "metadata",
                                dataType: "source",
                                sourceId: t
                            })), i.setEventedParent(null), i.clearTiles(), i.onRemove && i.onRemove(this.map), this._changed = !0
                        }, n.prototype.setGeoJSONSourceData = function (t, e) {
                            this._checkLoaded(), this.sourceCaches[t].getSource().setData(e), this._changed = !0
                        }, n.prototype.getSource = function (t) {
                            return this.sourceCaches[t] && this.sourceCaches[t].getSource()
                        }, n.prototype.addLayer = function (t, e, i) {
                            void 0 === i && (i = {}), this._checkLoaded();
                            var r = t.id;
                            if (this.getLayer(r)) this.fire(new ot.ErrorEvent(new Error('Layer with id "' + r + '" already exists on this map'))); else {
                                var n;
                                if ("custom" === t.type) {
                                    if (ai(this, ot.validateCustomStyleLayer(t))) return;
                                    n = ot.createStyleLayer(t)
                                } else {
                                    if ("object" == typeof t.source && (this.addSource(r, t.source), t = ot.clone$1(t), t = ot.extend(t, {source: r})), this._validate(ot.validateStyle.layer, "layers." + r, t, {arrayIndex: -1}, i)) return;
                                    n = ot.createStyleLayer(t), this._validateLayer(n), n.setEventedParent(this, {layer: {id: r}}), this._serializedLayers[n.id] = n.serialize()
                                }
                                var a = e ? this._order.indexOf(e) : this._order.length;
                                if (e && -1 === a) this.fire(new ot.ErrorEvent(new Error('Layer with id "' + e + '" does not exist on this map.'))); else {
                                    if (this._order.splice(a, 0, r), this._layerOrderChanged = !0, this._layers[r] = n, this._removedLayers[r] && n.source && "custom" !== n.type) {
                                        var o = this._removedLayers[r];
                                        delete this._removedLayers[r], o.type !== n.type ? this._updatedSources[n.source] = "clear" : (this._updatedSources[n.source] = "reload", this.sourceCaches[n.source].pause())
                                    }
                                    this._updateLayer(n), n.onAdd && n.onAdd(this.map)
                                }
                            }
                        }, n.prototype.moveLayer = function (t, e) {
                            if (this._checkLoaded(), this._changed = !0, this._layers[t]) {
                                if (t !== e) {
                                    var i = this._order.indexOf(t);
                                    this._order.splice(i, 1);
                                    var r = e ? this._order.indexOf(e) : this._order.length;
                                    e && -1 === r ? this.fire(new ot.ErrorEvent(new Error('Layer with id "' + e + '" does not exist on this map.'))) : (this._order.splice(r, 0, t), this._layerOrderChanged = !0)
                                }
                            } else this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be moved.")))
                        }, n.prototype.removeLayer = function (t) {
                            this._checkLoaded();
                            var e = this._layers[t];
                            if (e) {
                                e.setEventedParent(null);
                                var i = this._order.indexOf(t);
                                this._order.splice(i, 1), this._layerOrderChanged = !0, this._changed = !0, this._removedLayers[t] = e, delete this._layers[t], delete this._serializedLayers[t], delete this._updatedLayers[t], delete this._updatedPaintProps[t], e.onRemove && e.onRemove(this.map)
                            } else this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be removed.")))
                        }, n.prototype.getLayer = function (t) {
                            return this._layers[t]
                        }, n.prototype.hasLayer = function (t) {
                            return t in this._layers
                        }, n.prototype.setLayerZoomRange = function (t, e, i) {
                            this._checkLoaded();
                            var r = this.getLayer(t);
                            r ? r.minzoom === e && r.maxzoom === i || (null != e && (r.minzoom = e), null != i && (r.maxzoom = i), this._updateLayer(r)) : this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot have zoom extent.")))
                        }, n.prototype.setFilter = function (t, e, i) {
                            void 0 === i && (i = {}), this._checkLoaded();
                            var r = this.getLayer(t);
                            if (r) {
                                if (!ot.deepEqual(r.filter, e)) return null == e ? (r.filter = void 0, void this._updateLayer(r)) : void (this._validate(ot.validateStyle.filter, "layers." + r.id + ".filter", e, null, i) || (r.filter = ot.clone$1(e), this._updateLayer(r)))
                            } else this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be filtered.")))
                        }, n.prototype.getFilter = function (t) {
                            return ot.clone$1(this.getLayer(t).filter)
                        }, n.prototype.setLayoutProperty = function (t, e, i, r) {
                            void 0 === r && (r = {}), this._checkLoaded();
                            var n = this.getLayer(t);
                            n ? ot.deepEqual(n.getLayoutProperty(e), i) || (n.setLayoutProperty(e, i, r), this._updateLayer(n)) : this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be styled.")))
                        }, n.prototype.getLayoutProperty = function (t, e) {
                            var i = this.getLayer(t);
                            if (i) return i.getLayoutProperty(e);
                            this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style.")))
                        }, n.prototype.setPaintProperty = function (t, e, i, r) {
                            void 0 === r && (r = {}), this._checkLoaded();
                            var n = this.getLayer(t);
                            n ? ot.deepEqual(n.getPaintProperty(e), i) || (n.setPaintProperty(e, i, r) && this._updateLayer(n), this._changed = !0, this._updatedPaintProps[t] = !0) : this.fire(new ot.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be styled.")))
                        }, n.prototype.getPaintProperty = function (t, e) {
                            return this.getLayer(t).getPaintProperty(e)
                        }, n.prototype.setFeatureState = function (t, e) {
                            this._checkLoaded();
                            var i = t.source, r = t.sourceLayer, n = this.sourceCaches[i];
                            if (void 0 !== n) {
                                var a = n.getSource().type;
                                "geojson" === a && r ? this.fire(new ot.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))) : "vector" !== a || r ? (void 0 === t.id && this.fire(new ot.ErrorEvent(new Error("The feature id parameter must be provided."))), n.setFeatureState(r, t.id, e)) : this.fire(new ot.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else this.fire(new ot.ErrorEvent(new Error("The source '" + i + "' does not exist in the map's style.")))
                        }, n.prototype.removeFeatureState = function (t, e) {
                            this._checkLoaded();
                            var i = t.source, r = this.sourceCaches[i];
                            if (void 0 !== r) {
                                var n = r.getSource().type, a = "vector" === n ? t.sourceLayer : void 0;
                                "vector" !== n || a ? e && "string" != typeof t.id && "number" != typeof t.id ? this.fire(new ot.ErrorEvent(new Error("A feature id is required to remove its specific state property."))) : r.removeFeatureState(a, t.id, e) : this.fire(new ot.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else this.fire(new ot.ErrorEvent(new Error("The source '" + i + "' does not exist in the map's style.")))
                        }, n.prototype.getFeatureState = function (t) {
                            this._checkLoaded();
                            var e = t.source, i = t.sourceLayer, r = this.sourceCaches[e];
                            if (void 0 !== r) {
                                if ("vector" !== r.getSource().type || i) return void 0 === t.id && this.fire(new ot.ErrorEvent(new Error("The feature id parameter must be provided."))), r.getFeatureState(i, t.id);
                                this.fire(new ot.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else this.fire(new ot.ErrorEvent(new Error("The source '" + e + "' does not exist in the map's style.")))
                        }, n.prototype.getTransition = function () {
                            return ot.extend({duration: 300, delay: 0}, this.stylesheet && this.stylesheet.transition)
                        }, n.prototype.serialize = function () {
                            return ot.filterObject({
                                version: this.stylesheet.version,
                                name: this.stylesheet.name,
                                metadata: this.stylesheet.metadata,
                                light: this.stylesheet.light,
                                center: this.stylesheet.center,
                                zoom: this.stylesheet.zoom,
                                bearing: this.stylesheet.bearing,
                                pitch: this.stylesheet.pitch,
                                sprite: this._sprites,
                                glyphs: this._glyphs,
                                transition: this.stylesheet.transition,
                                sources: ot.mapObject(this.sourceCaches, function (t) {
                                    return t.serialize()
                                }),
                                layers: this._serializeLayers(this._order)
                            }, function (t) {
                                return void 0 !== t
                            })
                        }, n.prototype._updateLayer = function (t) {
                            this._updatedLayers[t.id] = !0, t.source && !this._updatedSources[t.source] && "raster" !== this.sourceCaches[t.source].getSource().type && (this._updatedSources[t.source] = "reload", this.sourceCaches[t.source].pause()), this._changed = !0
                        }, n.prototype._flattenAndSortRenderedFeatures = function (t) {
                            for (var e = this, i = function (t) {
                                return "fill-extrusion" === e._layers[t].type
                            }, r = {}, n = [], a = this._order.length - 1; a >= 0; a--) {
                                var o = this._order[a];
                                if (i(o)) {
                                    r[o] = a;
                                    for (var s = 0, l = t; s < l.length; s += 1) {
                                        var u = l[s][o];
                                        if (u) for (var h = 0, c = u; h < c.length; h += 1) n.push(c[h])
                                    }
                                }
                            }
                            n.sort(function (t, e) {
                                return e.intersectionZ - t.intersectionZ
                            });
                            for (var p = [], f = this._order.length - 1; f >= 0; f--) {
                                var d = this._order[f];
                                if (i(d)) for (var m = n.length - 1; m >= 0; m--) {
                                    var y = n[m].feature;
                                    if (r[y.layer.id] < f) break;
                                    p.push(y), n.pop()
                                } else for (var g = 0, _ = t; g < _.length; g += 1) {
                                    var v = _[g][d];
                                    if (v) for (var x = 0, b = v; x < b.length; x += 1) p.push(b[x].feature)
                                }
                            }
                            return p
                        }, n.prototype.queryRenderedFeatures = function (t, e, i) {
                            e && e.filter && this._validate(ot.validateStyle.filter, "queryRenderedFeatures.filter", e.filter, null, e);
                            var r = {};
                            if (e && e.layers) {
                                if (!Array.isArray(e.layers)) return this.fire(new ot.ErrorEvent(new Error("parameters.layers must be an Array."))), [];
                                for (var n = 0, a = e.layers; n < a.length; n += 1) {
                                    var o = a[n], s = this._layers[o];
                                    if (!s) return this.fire(new ot.ErrorEvent(new Error("The layer '" + o + "' does not exist in the map's style and cannot be queried for features."))), [];
                                    r[s.source] = !0
                                }
                            }
                            var l = [];
                            for (var u in e.availableImages = this._availableImages, this.sourceCaches) e.layers && !r[u] || l.push(yt(this.sourceCaches[u], this._layers, this._serializedLayers, t, e, i));
                            return this.placement && l.push(function (s, l, n, t, u, e, i) {
                                for (var h = {}, c = e.queryRenderedSymbols(t), r = [], a = 0, o = Object.keys(c).map(Number); a < o.length; a += 1) r.push(i[o[a]]);
                                r.sort(gt);
                                for (var p = function () {
                                    var n = d[f],
                                        t = n.featureIndex.lookupSymbolFeatures(c[n.bucketInstanceId], l, n.bucketIndex, n.sourceLayerIndex, u.filter, u.layers, u.availableImages, s);
                                    for (var e in t) {
                                        var i = h[e] = h[e] || [], r = t[e];
                                        r.sort(function (t, e) {
                                            var i = n.featureSortOrder;
                                            if (i) {
                                                var r = i.indexOf(t.featureIndex);
                                                return i.indexOf(e.featureIndex) - r
                                            }
                                            return e.featureIndex - t.featureIndex
                                        });
                                        for (var a = 0, o = r; a < o.length; a += 1) i.push(o[a])
                                    }
                                }, f = 0, d = r; f < d.length; f += 1) p();
                                var m = function (r) {
                                    h[r].forEach(function (t) {
                                        var e = t.feature,
                                            i = n[s[r].source].getFeatureState(e.layer["source-layer"], e.id);
                                        e.source = e.layer.source, e.layer["source-layer"] && (e.sourceLayer = e.layer["source-layer"]), e.state = i
                                    })
                                };
                                for (var y in h) m(y);
                                return h
                            }(this._layers, this._serializedLayers, this.sourceCaches, t, e, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(l)
                        }, n.prototype.querySourceFeatures = function (t, e) {
                            e && e.filter && this._validate(ot.validateStyle.filter, "querySourceFeatures.filter", e.filter, null, e);
                            var i = this.sourceCaches[t];
                            return i ? function (e, t) {
                                for (var i = e.getRenderableIds().map(function (t) {
                                    return e.getTileByID(t)
                                }), r = [], n = {}, a = 0; a < i.length; a++) {
                                    var o = i[a], s = o.tileID.canonical.key;
                                    n[s] || (n[s] = !0, o.querySourceFeatures(r, t))
                                }
                                return r
                            }(i, e) : []
                        }, n.prototype.addSourceType = function (t, e, i) {
                            return n.getSourceType(t) ? i(new Error('A source type called "' + t + '" already exists.')) : (n.setSourceType(t, e), e.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {
                                name: t,
                                url: e.workerSourceURL
                            }, i) : i(null, null))
                        }, n.prototype.getLight = function () {
                            return this.light.getLight()
                        }, n.prototype.setLight = function (t, e) {
                            void 0 === e && (e = {}), this._checkLoaded();
                            var i = this.light.getLight(), r = !1;
                            for (var n in t) if (!ot.deepEqual(t[n], i[n])) {
                                r = !0;
                                break
                            }
                            if (r) {
                                var a = {
                                    now: ot.browser.now(),
                                    transition: ot.extend({duration: 300, delay: 0}, this.stylesheet.transition)
                                };
                                this.light.setLight(t, e), this.light.updateTransitions(a)
                            }
                        }, n.prototype._validate = function (t, e, i, r, n) {
                            return void 0 === n && (n = {}), (!n || !1 !== n.validate) && ai(this, t.call(ot.validateStyle, ot.extend({
                                key: e,
                                style: this.serialize(),
                                value: i,
                                styleSpec: ot.styleSpec
                            }, r)))
                        }, n.prototype._remove = function () {
                            for (var t in this._request && (this._request.cancel(), this._request = null), this._spriteRequests) this._spriteRequests[t].cancel(), delete this._spriteRequests[t];
                            for (var e in this._spriteRequests = {}, ot.evented.off("pluginStateChange", this._rtlTextPluginCallback), this._layers) this._layers[e].setEventedParent(null);
                            for (var i in this.sourceCaches) this.sourceCaches[i].clearTiles(), this.sourceCaches[i].setEventedParent(null);
                            this.imageManagerFactory.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove()
                        }, n.prototype._clearSource = function (t) {
                            this.sourceCaches[t].clearTiles()
                        }, n.prototype._reloadSource = function (t) {
                            this.sourceCaches[t].resume(), this.sourceCaches[t].reload()
                        }, n.prototype._updateSources = function (t) {
                            for (var e in this.sourceCaches) this.sourceCaches[e].update(t)
                        }, n.prototype._generateCollisionBoxes = function () {
                            for (var t in this.sourceCaches) this._reloadSource(t)
                        }, n.prototype._updatePlacement = function (t, e, i, r, n) {
                            void 0 === n && (n = !1);
                            for (var a = !1, o = !1, s = {}, l = 0, u = this._order; l < u.length; l += 1) {
                                var h = this._layers[u[l]];
                                if ("symbol" === h.type) {
                                    if (!s[h.source]) {
                                        var c = this.sourceCaches[h.source];
                                        s[h.source] = c.getRenderableIds(!0).map(function (t) {
                                            return c.getTileByID(t)
                                        }).sort(function (t, e) {
                                            return e.tileID.overscaledZ - t.tileID.overscaledZ || (t.tileID.isLessThan(e.tileID) ? -1 : 1)
                                        })
                                    }
                                    var p = this.crossTileSymbolIndex.addLayer(h, s[h.source], t.center.lng);
                                    a = a || p
                                }
                            }
                            if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), ((n = n || this._layerOrderChanged || 0 === i) || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(ot.browser.now(), t.zoom)) && (this.pauseablePlacement = new $e(t, this._order, n, e, i, r, this.placement), this._layerOrderChanged = !1), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, s), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(ot.browser.now()), o = !0), a && this.pauseablePlacement.placement.setStale()), o || a) for (var f = 0, d = this._order; f < d.length; f += 1) {
                                var m = this._layers[d[f]];
                                "symbol" === m.type && this.placement.updateLayerOpacities(m, s[m.source])
                            }
                            return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(ot.browser.now())
                        }, n.prototype._releaseSymbolFadeTiles = function () {
                            for (var t in this.sourceCaches) this.sourceCaches[t].releaseSymbolFadeTiles()
                        }, n.prototype.getImages = function (t, e, i, r) {
                            this.imageManagerFactory.getImages(e.icons, i, r), this._updateTilesForChangedImages();
                            var n = this.sourceCaches[e.source];
                            n && n.setDependencies(e.tileID.key, e.type, e.icons)
                        }, n.prototype.getGlyphs = function (t, e, i, r) {
                            this.glyphManagerFactory.getGlyphs(e.stacks, i, r)
                        }, n.prototype.getResource = function (t, e, i) {
                            return ot.makeRequest(e, i)
                        }, n
                    }(ot.Evented);
                ui.getSourceType = function (t) {
                    return dt[t]
                }, ui.setSourceType = function (t, e) {
                    dt[t] = e
                }, ui.registerForPluginStateChange = ot.registerForPluginStateChange;
                var hi = ot.createLayout([{name: "a_pos", type: "Int16", components: 2}]),
                    ci = e("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),
                    pi = e("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
                    fi = e("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),
                    di = e("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),
                    mi = e("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
                    yi = e("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),
                    gi = e("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),
                    _i = e("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),
                    vi = e("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),
                    xi = e("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),
                    bi = e("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),
                    wi = e("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
                    Mi = e("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
                    Si = e("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),
                    Ei = e("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),
                    Ii = e("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),
                    Ti = e("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),
                    Ci = e("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),
                    Pi = e("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
                    Ai = e("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
                    zi = e("uniform lowp float u_device_pixel_ratio;\r\nuniform vec2 u_texsize;\r\nuniform float u_fade;\r\nuniform mediump vec3 u_scale;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\nvarying float v_width;\r\n#pragma mapbox: define lowp vec4 pattern_from\r\n#pragma mapbox: define lowp vec4 pattern_to\r\n#pragma mapbox: define lowp float pixel_ratio_from\r\n#pragma mapbox: define lowp float pixel_ratio_to\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\nvoid main() {\r\n#pragma mapbox: initialize mediump vec4 pattern_from\r\n#pragma mapbox: initialize mediump vec4 pattern_to\r\n#pragma mapbox: initialize lowp float pixel_ratio_from\r\n#pragma mapbox: initialize lowp float pixel_ratio_to\r\n#pragma mapbox: initialize lowp float blur\r\n#pragma mapbox: initialize lowp float opacity\r\nvec2 pattern_tl_a=pattern_from.xy;\r\nvec2 pattern_br_a=pattern_from.zw;\r\nvec2 pattern_tl_b=pattern_to.xy;\r\nvec2 pattern_br_b=pattern_to.zw;\r\nfloat tileZoomRatio=u_scale.x;\r\nfloat fromScale=u_scale.y;\r\nfloat toScale=u_scale.z;\r\nvec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;\r\nvec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\r\nvec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);\r\nvec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);\r\nfloat aspect_a=display_size_a.y/v_width;\r\nfloat aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;\r\nfloat alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\r\nfloat x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);\r\nfloat x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);\r\nfloat y=0.5*v_normal.y+0.5;\r\nvec2 texel_size=1.0/u_texsize;\r\nvec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));\r\nvec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));\r\nvec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\r\ngl_FragColor=color*alpha*opacity;\r\n#ifdef OVERDRAW_INSPECTOR\r\ngl_FragColor=vec4(1.0);\r\n#endif\r\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),
                    ki = e("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),
                    Li = e("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),
                    Di = e("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),
                    Ri = e("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),
                    Bi = e("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");

                function e(t, e) {
                    var i = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,
                        r = e.match(/attribute ([\w]+) ([\w]+)/g),
                        n = t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),
                        a = e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g), o = a ? a.concat(n) : n, s = {};
                    return {
                        fragmentSource: t = t.replace(i, function (t, e, i, r, n) {
                            return s[n] = !0, "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nvarying " + i + " " + r + " " + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "\n#ifdef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n"
                        }), vertexSource: e = e.replace(i, function (t, e, i, r, n) {
                            var a = "float" === r ? "vec2" : "vec4", o = n.match(/color/) ? "color" : a;
                            return s[n] ? "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nuniform lowp float u_" + n + "_t;\nattribute " + i + " " + a + " a_" + n + ";\nvarying " + i + " " + r + " " + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "vec4" === o ? "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + n + " = a_" + n + ";\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + n + " = unpack_mix_" + o + "(a_" + n + ", u_" + n + "_t);\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nuniform lowp float u_" + n + "_t;\nattribute " + i + " " + a + " a_" + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "vec4" === o ? "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = a_" + n + ";\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = unpack_mix_" + o + "(a_" + n + ", u_" + n + "_t);\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n"
                        }), staticAttributes: r, staticUniforms: o
                    }
                }

                var Oi = Object.freeze({
                    __proto__: null,
                    prelude: ci,
                    background: pi,
                    backgroundPattern: fi,
                    circle: di,
                    clippingMask: mi,
                    heatmap: yi,
                    heatmapTexture: gi,
                    collisionBox: _i,
                    collisionCircle: vi,
                    debug: xi,
                    fill: bi,
                    fillOutline: wi,
                    fillOutlinePattern: Mi,
                    fillPattern: Si,
                    fillExtrusion: Ei,
                    fillExtrusionPattern: Ii,
                    hillshadePrepare: Ti,
                    hillshade: Ci,
                    line: Pi,
                    lineGradient: Ai,
                    linePattern: zi,
                    lineSDF: ki,
                    raster: Li,
                    symbolIcon: Di,
                    symbolSDF: Ri,
                    symbolTextAndIcon: Bi
                }), Fi = function () {
                    this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null
                };

                function Ui(t) {
                    for (var e = [], i = 0; i < t.length; i++) if (null !== t[i]) {
                        var r = t[i].split(" ");
                        e.push(r.pop())
                    }
                    return e
                }

                Fi.prototype.bind = function (t, e, i, r, n, a, o, s) {
                    this.context = t;
                    for (var l = this.boundPaintVertexBuffers.length !== r.length, u = 0; !l && u < r.length; u++) this.boundPaintVertexBuffers[u] !== r[u] && (l = !0);
                    t.extVertexArrayObject && this.vao && this.boundProgram === e && this.boundLayoutVertexBuffer === i && !l && this.boundIndexBuffer === n && this.boundVertexOffset === a && this.boundDynamicVertexBuffer === o && this.boundDynamicVertexBuffer2 === s ? (t.bindVertexArrayOES.set(this.vao), o && o.bind(), n && n.dynamicDraw && n.bind(), s && s.bind()) : this.freshBind(e, i, r, n, a, o, s)
                }, Fi.prototype.freshBind = function (t, e, i, r, n, a, o) {
                    var s, l = t.numAttributes, u = this.context, h = u.gl;
                    if (u.extVertexArrayObject) this.vao && this.destroy(), this.vao = u.extVertexArrayObject.createVertexArrayOES(), u.bindVertexArrayOES.set(this.vao), s = 0, this.boundProgram = t, this.boundLayoutVertexBuffer = e, this.boundPaintVertexBuffers = i, this.boundIndexBuffer = r, this.boundVertexOffset = n, this.boundDynamicVertexBuffer = a, this.boundDynamicVertexBuffer2 = o; else {
                        s = u.currentNumAttributes || 0;
                        for (var c = l; c < s; c++) h.disableVertexAttribArray(c)
                    }
                    e.enableAttributes(h, t);
                    for (var p = 0, f = i; p < f.length; p += 1) f[p].enableAttributes(h, t);
                    a && a.enableAttributes(h, t), o && o.enableAttributes(h, t), e.bind(), e.setVertexAttribPointers(h, t, n);
                    for (var d = 0, m = i; d < m.length; d += 1) {
                        var y = m[d];
                        y.bind(), y.setVertexAttribPointers(h, t, n)
                    }
                    a && (a.bind(), a.setVertexAttribPointers(h, t, n)), r && r.bind(), o && (o.bind(), o.setVertexAttribPointers(h, t, n)), u.currentNumAttributes = l
                }, Fi.prototype.destroy = function () {
                    this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null)
                };
                var Ni = function (t, e, i, r, n, a) {
                    var o = t.gl;
                    this.program = o.createProgram();
                    for (var s = Ui(i.staticAttributes), l = r ? r.getBinderAttributes() : [], u = s.concat(l), h = i.staticUniforms ? Ui(i.staticUniforms) : [], c = r ? r.getBinderUniforms() : [], p = [], f = 0, d = h.concat(c); f < d.length; f += 1) {
                        var m = d[f];
                        p.indexOf(m) < 0 && p.push(m)
                    }
                    var y = r ? r.defines() : [];
                    a && y.push("#define OVERDRAW_INSPECTOR;");
                    var g = y.concat(ci.fragmentSource, i.fragmentSource).join("\n"),
                        _ = y.concat(ci.vertexSource, i.vertexSource).join("\n"), v = o.createShader(o.FRAGMENT_SHADER);
                    if (o.isContextLost()) this.failedToCreate = !0; else {
                        o.shaderSource(v, g), o.compileShader(v), o.attachShader(this.program, v);
                        var x = o.createShader(o.VERTEX_SHADER);
                        if (o.isContextLost()) this.failedToCreate = !0; else {
                            o.shaderSource(x, _), o.compileShader(x), o.attachShader(this.program, x), this.attributes = {};
                            var b = {};
                            this.numAttributes = u.length;
                            for (var w = 0; w < this.numAttributes; w++) u[w] && (o.bindAttribLocation(this.program, w, u[w]), this.attributes[u[w]] = w);
                            o.linkProgram(this.program), o.deleteShader(x), o.deleteShader(v);
                            for (var M = 0; M < p.length; M++) {
                                var S = p[M];
                                if (S && !b[S]) {
                                    var E = o.getUniformLocation(this.program, S);
                                    E && (b[S] = E)
                                }
                            }
                            this.fixedUniforms = n(t, b), this.binderUniforms = r ? r.getUniforms(t, b) : []
                        }
                    }
                };

                function Vi(t, e, i) {
                    var r = 1 / lt(i, 1, e.transform.tileZoom), n = Math.pow(2, i.tileID.overscaledZ),
                        a = i.tileSize * Math.pow(2, e.transform.tileZoom) / n,
                        o = a * (i.tileID.canonical.x + i.tileID.wrap * n), s = a * i.tileID.canonical.y;
                    return {
                        u_image: 0,
                        u_texsize: i.imageAtlasTexture.size,
                        u_scale: [r, t.fromScale, t.toScale],
                        u_fade: t.t,
                        u_pixel_coord_upper: [o >> 16, s >> 16],
                        u_pixel_coord_lower: [65535 & o, 65535 & s]
                    }
                }

                Ni.prototype.draw = function (t, e, i, r, n, a, o, s, l, u, h, c, p, f, d, m) {
                    var y, g = t.gl;
                    if (!this.failedToCreate) {
                        for (var _ in t.program.set(this.program), t.setDepthMode(i), t.setStencilMode(r), t.setColorMode(n), t.setCullFace(a), this.fixedUniforms) this.fixedUniforms[_].set(o[_]);
                        f && f.setUniforms(t, this.binderUniforms, c, {zoom: p});
                        for (var v = (y = {}, y[g.LINES] = 2, y[g.TRIANGLES] = 3, y[g.LINE_STRIP] = 1, y)[e], x = 0, b = h.get(); x < b.length; x += 1) {
                            var w = b[x], M = w.vaos || (w.vaos = {});
                            (M[s] || (M[s] = new Fi)).bind(t, this, l, f ? f.getPaintVertexBuffers() : [], u, w.vertexOffset, d, m), g.drawElements(e, w.primitiveLength * v, g.UNSIGNED_SHORT, w.primitiveOffset * v * 2)
                        }
                    }
                };
                var ji = function (t, e, i, r) {
                    var n = e.style.light, a = n.properties.get("position"), o = [a.x, a.y, a.z], s = ot.create$1();
                    "viewport" === n.properties.get("anchor") && ot.fromRotation(s, -e.transform.angle), ot.transformMat3(o, o, s);
                    var l = n.properties.get("color");
                    return {
                        u_matrix: t,
                        u_lightpos: o,
                        u_lightintensity: n.properties.get("intensity"),
                        u_lightcolor: [l.r, l.g, l.b],
                        u_vertical_gradient: +i,
                        u_opacity: r
                    }
                }, qi = function (t, e, i, r, n, a, o) {
                    return ot.extend(ji(t, e, i, r), Vi(a, e, o), {u_height_factor: -Math.pow(2, n.overscaledZ) / o.tileSize / 8})
                }, Gi = function (t) {
                    return {u_matrix: t}
                }, Zi = function (t, e, i, r) {
                    return ot.extend(Gi(t), Vi(i, e, r))
                }, Wi = function (t, e) {
                    return {u_matrix: t, u_world: e}
                }, Xi = function (t, e, i, r, n) {
                    return ot.extend(Zi(t, e, i, r), {u_world: n})
                }, Hi = function (t, e, i, r) {
                    var n, a, o = t.transform;
                    if ("map" === r.paint.get("circle-pitch-alignment")) {
                        var s = lt(i, 1, o.zoom);
                        n = !0, a = [s, s]
                    } else n = !1, a = o.pixelsToGLUnits;
                    return {
                        u_camera_to_center_distance: o.cameraToCenterDistance,
                        u_scale_with_map: +("map" === r.paint.get("circle-pitch-scale")),
                        u_matrix: t.translatePosMatrix(e.posMatrix, i, r.paint.get("circle-translate"), r.paint.get("circle-translate-anchor")),
                        u_pitch_with_map: +n,
                        u_device_pixel_ratio: ot.browser.devicePixelRatio,
                        u_extrude_scale: a
                    }
                }, Ki = function (t, e, i) {
                    var r = lt(i, 1, e.zoom), n = Math.pow(2, e.zoom - i.tileID.overscaledZ),
                        a = i.tileID.overscaleFactor();
                    return {
                        u_matrix: t,
                        u_camera_to_center_distance: e.cameraToCenterDistance,
                        u_pixels_to_tile_units: r,
                        u_extrude_scale: [e.pixelsToGLUnits[0] / (r * n), e.pixelsToGLUnits[1] / (r * n)],
                        u_overscale_factor: a
                    }
                }, Yi = function (t, e, i) {
                    return {
                        u_matrix: t,
                        u_inv_matrix: e,
                        u_camera_to_center_distance: i.cameraToCenterDistance,
                        u_viewport_size: [i.width, i.height]
                    }
                }, Ji = function (t, e, i) {
                    return void 0 === i && (i = 1), {u_matrix: t, u_color: e, u_overlay: 0, u_overlay_scale: i}
                }, Qi = function (t) {
                    return {u_matrix: t}
                }, $i = function (t, e, i, r) {
                    return {u_matrix: t, u_extrude_scale: lt(e, 1, i), u_intensity: r}
                }, tr = function (t, e, i) {
                    var r = t.transform;
                    return {
                        u_matrix: ar(t, e, i),
                        u_ratio: 1 / lt(e, 1, r.zoom),
                        u_device_pixel_ratio: ot.browser.devicePixelRatio,
                        u_units_to_pixels: [1 / r.pixelsToGLUnits[0], 1 / r.pixelsToGLUnits[1]]
                    }
                }, er = function (t, e, i, r) {
                    return ot.extend(tr(t, e, i), {u_image: 0, u_image_height: r})
                }, ir = function (t, e, i, r) {
                    var n = t.transform, a = nr(e, n);
                    return {
                        u_matrix: ar(t, e, i),
                        u_texsize: e.imageAtlasTexture.size,
                        u_ratio: 1 / lt(e, 1, n.zoom),
                        u_device_pixel_ratio: ot.browser.devicePixelRatio,
                        u_image: 0,
                        u_scale: [a, r.fromScale, r.toScale],
                        u_fade: r.t,
                        u_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]]
                    }
                }, rr = function (t, e, i, r, n) {
                    var a = t.lineAtlas, o = nr(e, t.transform), s = "round" === i.layout.get("line-cap"),
                        l = a.getDash(r.from, s), u = a.getDash(r.to, s), h = l.width * n.fromScale,
                        c = u.width * n.toScale;
                    return ot.extend(tr(t, e, i), {
                        u_patternscale_a: [o / h, -l.height / 2],
                        u_patternscale_b: [o / c, -u.height / 2],
                        u_sdfgamma: a.width / (256 * Math.min(h, c) * ot.browser.devicePixelRatio) / 2,
                        u_image: 0,
                        u_tex_y_a: l.y,
                        u_tex_y_b: u.y,
                        u_mix: n.t
                    })
                };

                function nr(t, e) {
                    return 1 / lt(t, 1, e.tileZoom)
                }

                function ar(t, e, i) {
                    return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("line-translate"), i.paint.get("line-translate-anchor"))
                }

                var or = function (t, e, i, r, n) {
                    return {
                        u_matrix: t,
                        u_tl_parent: e,
                        u_scale_parent: i,
                        u_buffer_scale: 1,
                        u_fade_t: r.mix,
                        u_opacity: r.opacity * n.paint.get("raster-opacity"),
                        u_image0: 0,
                        u_image1: 1,
                        u_brightness_low: n.paint.get("raster-brightness-min"),
                        u_brightness_high: n.paint.get("raster-brightness-max"),
                        u_saturation_factor: (o = n.paint.get("raster-saturation"), o > 0 ? 1 - 1 / (1.001 - o) : -o),
                        u_contrast_factor: (a = n.paint.get("raster-contrast"), a > 0 ? 1 / (1 - a) : 1 + a),
                        u_spin_weights: sr(n.paint.get("raster-hue-rotate"))
                    };
                    var a, o
                };

                function sr(t) {
                    t *= Math.PI / 180;
                    var e = Math.sin(t), i = Math.cos(t);
                    return [(2 * i + 1) / 3, (-Math.sqrt(3) * e - i + 1) / 3, (Math.sqrt(3) * e - i + 1) / 3]
                }

                var lr, ur = function (t, e, i, r, n, a, o, s, l, u) {
                    var h = n.transform;
                    return {
                        u_is_size_zoom_constant: +("constant" === t || "source" === t),
                        u_is_size_feature_constant: +("constant" === t || "camera" === t),
                        u_size_t: e ? e.uSizeT : 0,
                        u_size: e ? e.uSize : 0,
                        u_camera_to_center_distance: h.cameraToCenterDistance,
                        u_pitch: h.pitch / 360 * 2 * Math.PI,
                        u_rotate_symbol: +i,
                        u_aspect_ratio: h.width / h.height,
                        u_fade_change: n.options.fadeDuration ? n.symbolFadeChange : 1,
                        u_matrix: a,
                        u_label_plane_matrix: o,
                        u_coord_matrix: s,
                        u_is_text: +l,
                        u_pitch_with_map: +r,
                        u_texsize: u,
                        u_texture: 0
                    }
                }, hr = function (t, e, i, r, n, a, o, s, l, u, h) {
                    var c = n.transform;
                    return ot.extend(ur(t, e, i, r, n, a, o, s, l, u), {
                        u_gamma_scale: r ? Math.cos(c._pitch) * c.cameraToCenterDistance : 1,
                        u_device_pixel_ratio: ot.browser.devicePixelRatio,
                        u_is_halo: +h
                    })
                }, cr = function (t, e, i, r, n, a, o, s, l, u) {
                    return ot.extend(hr(t, e, i, r, n, a, o, s, !0, l, !0), {u_texsize_icon: u, u_texture_icon: 1})
                }, pr = function (t, e, i) {
                    return {u_matrix: t, u_opacity: e, u_color: i}
                }, fr = function (t, e, i, r, n, a) {
                    return ot.extend(function (t, e, i, r) {
                        var n = i.imageManagerFactory.getPattern(t.from.toString()),
                            a = i.imageManagerFactory.getPattern(t.to.toString()),
                            o = i.imageManagerFactory.getPixelSize(), s = o.width, l = o.height,
                            u = Math.pow(2, r.tileID.overscaledZ),
                            h = r.tileSize * Math.pow(2, i.transform.tileZoom) / u,
                            c = h * (r.tileID.canonical.x + r.tileID.wrap * u), p = h * r.tileID.canonical.y;
                        return {
                            u_image: 0,
                            u_pattern_tl_a: n.tl,
                            u_pattern_br_a: n.br,
                            u_pattern_tl_b: a.tl,
                            u_pattern_br_b: a.br,
                            u_texsize: [s, l],
                            u_mix: e.t,
                            u_pattern_size_a: n.displaySize,
                            u_pattern_size_b: a.displaySize,
                            u_scale_a: e.fromScale,
                            u_scale_b: e.toScale,
                            u_tile_units_to_pixels: 1 / lt(r, 1, i.transform.tileZoom),
                            u_pixel_coord_upper: [c >> 16, p >> 16],
                            u_pixel_coord_lower: [65535 & c, 65535 & p]
                        }
                    }(r, a, i, n), {u_matrix: t, u_opacity: e})
                }, dr = {
                    fillExtrusion: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_lightpos: new ot.Uniform3f(t, e.u_lightpos),
                            u_lightintensity: new ot.Uniform1f(t, e.u_lightintensity),
                            u_lightcolor: new ot.Uniform3f(t, e.u_lightcolor),
                            u_vertical_gradient: new ot.Uniform1f(t, e.u_vertical_gradient),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity)
                        }
                    }, fillExtrusionPattern: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_lightpos: new ot.Uniform3f(t, e.u_lightpos),
                            u_lightintensity: new ot.Uniform1f(t, e.u_lightintensity),
                            u_lightcolor: new ot.Uniform3f(t, e.u_lightcolor),
                            u_vertical_gradient: new ot.Uniform1f(t, e.u_vertical_gradient),
                            u_height_factor: new ot.Uniform1f(t, e.u_height_factor),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_pixel_coord_upper: new ot.Uniform2f(t, e.u_pixel_coord_upper),
                            u_pixel_coord_lower: new ot.Uniform2f(t, e.u_pixel_coord_lower),
                            u_scale: new ot.Uniform3f(t, e.u_scale),
                            u_fade: new ot.Uniform1f(t, e.u_fade),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity)
                        }
                    }, fill: function (t, e) {
                        return {u_matrix: new ot.UniformMatrix4f(t, e.u_matrix)}
                    }, fillPattern: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_pixel_coord_upper: new ot.Uniform2f(t, e.u_pixel_coord_upper),
                            u_pixel_coord_lower: new ot.Uniform2f(t, e.u_pixel_coord_lower),
                            u_scale: new ot.Uniform3f(t, e.u_scale),
                            u_fade: new ot.Uniform1f(t, e.u_fade)
                        }
                    }, fillOutline: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_world: new ot.Uniform2f(t, e.u_world)
                        }
                    }, fillOutlinePattern: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_world: new ot.Uniform2f(t, e.u_world),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_pixel_coord_upper: new ot.Uniform2f(t, e.u_pixel_coord_upper),
                            u_pixel_coord_lower: new ot.Uniform2f(t, e.u_pixel_coord_lower),
                            u_scale: new ot.Uniform3f(t, e.u_scale),
                            u_fade: new ot.Uniform1f(t, e.u_fade)
                        }
                    }, circle: function (t, e) {
                        return {
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_scale_with_map: new ot.Uniform1i(t, e.u_scale_with_map),
                            u_pitch_with_map: new ot.Uniform1i(t, e.u_pitch_with_map),
                            u_extrude_scale: new ot.Uniform2f(t, e.u_extrude_scale),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix)
                        }
                    }, collisionBox: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_pixels_to_tile_units: new ot.Uniform1f(t, e.u_pixels_to_tile_units),
                            u_extrude_scale: new ot.Uniform2f(t, e.u_extrude_scale),
                            u_overscale_factor: new ot.Uniform1f(t, e.u_overscale_factor)
                        }
                    }, collisionCircle: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_inv_matrix: new ot.UniformMatrix4f(t, e.u_inv_matrix),
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_viewport_size: new ot.Uniform2f(t, e.u_viewport_size)
                        }
                    }, debug: function (t, e) {
                        return {
                            u_color: new ot.UniformColor(t, e.u_color),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_overlay: new ot.Uniform1i(t, e.u_overlay),
                            u_overlay_scale: new ot.Uniform1f(t, e.u_overlay_scale)
                        }
                    }, clippingMask: function (t, e) {
                        return {u_matrix: new ot.UniformMatrix4f(t, e.u_matrix)}
                    }, heatmap: function (t, e) {
                        return {
                            u_extrude_scale: new ot.Uniform1f(t, e.u_extrude_scale),
                            u_intensity: new ot.Uniform1f(t, e.u_intensity),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix)
                        }
                    }, heatmapTexture: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_world: new ot.Uniform2f(t, e.u_world),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_color_ramp: new ot.Uniform1i(t, e.u_color_ramp),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity)
                        }
                    }, hillshade: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_latrange: new ot.Uniform2f(t, e.u_latrange),
                            u_light: new ot.Uniform2f(t, e.u_light),
                            u_shadow: new ot.UniformColor(t, e.u_shadow),
                            u_highlight: new ot.UniformColor(t, e.u_highlight),
                            u_accent: new ot.UniformColor(t, e.u_accent)
                        }
                    }, hillshadePrepare: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_dimension: new ot.Uniform2f(t, e.u_dimension),
                            u_zoom: new ot.Uniform1f(t, e.u_zoom),
                            u_unpack: new ot.Uniform4f(t, e.u_unpack)
                        }
                    }, line: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_ratio: new ot.Uniform1f(t, e.u_ratio),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_units_to_pixels: new ot.Uniform2f(t, e.u_units_to_pixels)
                        }
                    }, lineGradient: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_ratio: new ot.Uniform1f(t, e.u_ratio),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_units_to_pixels: new ot.Uniform2f(t, e.u_units_to_pixels),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_image_height: new ot.Uniform1f(t, e.u_image_height)
                        }
                    }, linePattern: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_ratio: new ot.Uniform1f(t, e.u_ratio),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_units_to_pixels: new ot.Uniform2f(t, e.u_units_to_pixels),
                            u_scale: new ot.Uniform3f(t, e.u_scale),
                            u_fade: new ot.Uniform1f(t, e.u_fade)
                        }
                    }, lineSDF: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_ratio: new ot.Uniform1f(t, e.u_ratio),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_units_to_pixels: new ot.Uniform2f(t, e.u_units_to_pixels),
                            u_patternscale_a: new ot.Uniform2f(t, e.u_patternscale_a),
                            u_patternscale_b: new ot.Uniform2f(t, e.u_patternscale_b),
                            u_sdfgamma: new ot.Uniform1f(t, e.u_sdfgamma),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_tex_y_a: new ot.Uniform1f(t, e.u_tex_y_a),
                            u_tex_y_b: new ot.Uniform1f(t, e.u_tex_y_b),
                            u_mix: new ot.Uniform1f(t, e.u_mix)
                        }
                    }, raster: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_tl_parent: new ot.Uniform2f(t, e.u_tl_parent),
                            u_scale_parent: new ot.Uniform1f(t, e.u_scale_parent),
                            u_buffer_scale: new ot.Uniform1f(t, e.u_buffer_scale),
                            u_fade_t: new ot.Uniform1f(t, e.u_fade_t),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity),
                            u_image0: new ot.Uniform1i(t, e.u_image0),
                            u_image1: new ot.Uniform1i(t, e.u_image1),
                            u_brightness_low: new ot.Uniform1f(t, e.u_brightness_low),
                            u_brightness_high: new ot.Uniform1f(t, e.u_brightness_high),
                            u_saturation_factor: new ot.Uniform1f(t, e.u_saturation_factor),
                            u_contrast_factor: new ot.Uniform1f(t, e.u_contrast_factor),
                            u_spin_weights: new ot.Uniform3f(t, e.u_spin_weights)
                        }
                    }, symbolIcon: function (t, e) {
                        return {
                            u_is_size_zoom_constant: new ot.Uniform1i(t, e.u_is_size_zoom_constant),
                            u_is_size_feature_constant: new ot.Uniform1i(t, e.u_is_size_feature_constant),
                            u_size_t: new ot.Uniform1f(t, e.u_size_t),
                            u_size: new ot.Uniform1f(t, e.u_size),
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_pitch: new ot.Uniform1f(t, e.u_pitch),
                            u_rotate_symbol: new ot.Uniform1i(t, e.u_rotate_symbol),
                            u_aspect_ratio: new ot.Uniform1f(t, e.u_aspect_ratio),
                            u_fade_change: new ot.Uniform1f(t, e.u_fade_change),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_label_plane_matrix: new ot.UniformMatrix4f(t, e.u_label_plane_matrix),
                            u_coord_matrix: new ot.UniformMatrix4f(t, e.u_coord_matrix),
                            u_is_text: new ot.Uniform1i(t, e.u_is_text),
                            u_pitch_with_map: new ot.Uniform1i(t, e.u_pitch_with_map),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_texture: new ot.Uniform1i(t, e.u_texture)
                        }
                    }, symbolSDF: function (t, e) {
                        return {
                            u_is_size_zoom_constant: new ot.Uniform1i(t, e.u_is_size_zoom_constant),
                            u_is_size_feature_constant: new ot.Uniform1i(t, e.u_is_size_feature_constant),
                            u_size_t: new ot.Uniform1f(t, e.u_size_t),
                            u_size: new ot.Uniform1f(t, e.u_size),
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_pitch: new ot.Uniform1f(t, e.u_pitch),
                            u_rotate_symbol: new ot.Uniform1i(t, e.u_rotate_symbol),
                            u_aspect_ratio: new ot.Uniform1f(t, e.u_aspect_ratio),
                            u_fade_change: new ot.Uniform1f(t, e.u_fade_change),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_label_plane_matrix: new ot.UniformMatrix4f(t, e.u_label_plane_matrix),
                            u_coord_matrix: new ot.UniformMatrix4f(t, e.u_coord_matrix),
                            u_is_text: new ot.Uniform1i(t, e.u_is_text),
                            u_pitch_with_map: new ot.Uniform1i(t, e.u_pitch_with_map),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_texture: new ot.Uniform1i(t, e.u_texture),
                            u_gamma_scale: new ot.Uniform1f(t, e.u_gamma_scale),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_is_halo: new ot.Uniform1i(t, e.u_is_halo)
                        }
                    }, symbolTextAndIcon: function (t, e) {
                        return {
                            u_is_size_zoom_constant: new ot.Uniform1i(t, e.u_is_size_zoom_constant),
                            u_is_size_feature_constant: new ot.Uniform1i(t, e.u_is_size_feature_constant),
                            u_size_t: new ot.Uniform1f(t, e.u_size_t),
                            u_size: new ot.Uniform1f(t, e.u_size),
                            u_camera_to_center_distance: new ot.Uniform1f(t, e.u_camera_to_center_distance),
                            u_pitch: new ot.Uniform1f(t, e.u_pitch),
                            u_rotate_symbol: new ot.Uniform1i(t, e.u_rotate_symbol),
                            u_aspect_ratio: new ot.Uniform1f(t, e.u_aspect_ratio),
                            u_fade_change: new ot.Uniform1f(t, e.u_fade_change),
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_label_plane_matrix: new ot.UniformMatrix4f(t, e.u_label_plane_matrix),
                            u_coord_matrix: new ot.UniformMatrix4f(t, e.u_coord_matrix),
                            u_is_text: new ot.Uniform1i(t, e.u_is_text),
                            u_pitch_with_map: new ot.Uniform1i(t, e.u_pitch_with_map),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_texsize_icon: new ot.Uniform2f(t, e.u_texsize_icon),
                            u_texture: new ot.Uniform1i(t, e.u_texture),
                            u_texture_icon: new ot.Uniform1i(t, e.u_texture_icon),
                            u_gamma_scale: new ot.Uniform1f(t, e.u_gamma_scale),
                            u_device_pixel_ratio: new ot.Uniform1f(t, e.u_device_pixel_ratio),
                            u_is_halo: new ot.Uniform1i(t, e.u_is_halo)
                        }
                    }, background: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity),
                            u_color: new ot.UniformColor(t, e.u_color)
                        }
                    }, backgroundPattern: function (t, e) {
                        return {
                            u_matrix: new ot.UniformMatrix4f(t, e.u_matrix),
                            u_opacity: new ot.Uniform1f(t, e.u_opacity),
                            u_image: new ot.Uniform1i(t, e.u_image),
                            u_pattern_tl_a: new ot.Uniform2f(t, e.u_pattern_tl_a),
                            u_pattern_br_a: new ot.Uniform2f(t, e.u_pattern_br_a),
                            u_pattern_tl_b: new ot.Uniform2f(t, e.u_pattern_tl_b),
                            u_pattern_br_b: new ot.Uniform2f(t, e.u_pattern_br_b),
                            u_texsize: new ot.Uniform2f(t, e.u_texsize),
                            u_mix: new ot.Uniform1f(t, e.u_mix),
                            u_pattern_size_a: new ot.Uniform2f(t, e.u_pattern_size_a),
                            u_pattern_size_b: new ot.Uniform2f(t, e.u_pattern_size_b),
                            u_scale_a: new ot.Uniform1f(t, e.u_scale_a),
                            u_scale_b: new ot.Uniform1f(t, e.u_scale_b),
                            u_pixel_coord_upper: new ot.Uniform2f(t, e.u_pixel_coord_upper),
                            u_pixel_coord_lower: new ot.Uniform2f(t, e.u_pixel_coord_lower),
                            u_tile_units_to_pixels: new ot.Uniform1f(t, e.u_tile_units_to_pixels)
                        }
                    }
                };

                function mr(t, e, i, r, n, a, o) {
                    for (var s = t.context, l = s.gl, B = t.useProgram("collisionBox"), u = [], h = 0, c = 0, p = 0; p < r.length; p++) {
                        var f = r[p], d = e.getTile(f), m = d.getBucket(i);
                        if (m) {
                            var y = f.posMatrix;
                            0 === n[0] && 0 === n[1] || (y = t.translatePosMatrix(f.posMatrix, d, n, a));
                            var g = o ? m.textCollisionBox : m.iconCollisionBox, _ = m.collisionCircleArray;
                            if (_.length > 0) {
                                var v = ot.create(), O = y;
                                ot.mul(v, m.placementInvProjMatrix, t.transform.glCoordMatrix), ot.mul(v, v, m.placementViewportMatrix), u.push({
                                    circleArray: _,
                                    circleOffset: c,
                                    transform: O,
                                    invTransform: v
                                }), c = h += _.length / 4
                            }
                            g && B.draw(s, l.LINES, st.disabled, N.disabled, t.colorModeForRenderPass(), V.disabled, Ki(y, t.transform, d), i.id, g.layoutVertexBuffer, g.indexBuffer, g.segments, null, t.transform.zoom, null, null, g.collisionVertexBuffer)
                        }
                    }
                    if (o && u.length) {
                        var F = t.useProgram("collisionCircle"), x = new ot.StructArrayLayout2f1f2i16;
                        x.resize(4 * h), x._trim();
                        for (var b = 0, w = 0, M = u; w < M.length; w += 1) for (var S = M[w], E = 0; E < S.circleArray.length / 4; E++) {
                            var I = 4 * E, T = S.circleArray[I + 0], C = S.circleArray[I + 1], P = S.circleArray[I + 2],
                                A = S.circleArray[I + 3];
                            x.emplace(b++, T, C, P, A, 0), x.emplace(b++, T, C, P, A, 1), x.emplace(b++, T, C, P, A, 2), x.emplace(b++, T, C, P, A, 3)
                        }
                        (!lr || lr.length < 2 * h) && (lr = function (t) {
                            var e = 2 * t, i = new ot.StructArrayLayout3ui6;
                            i.resize(e), i._trim();
                            for (var r = 0; r < e; r++) {
                                var n = 6 * r;
                                i.uint16[n + 0] = 4 * r + 0, i.uint16[n + 1] = 4 * r + 1, i.uint16[n + 2] = 4 * r + 2, i.uint16[n + 3] = 4 * r + 2, i.uint16[n + 4] = 4 * r + 3, i.uint16[n + 5] = 4 * r + 0
                            }
                            return i
                        }(h));
                        for (var z = s.createIndexBuffer(lr, !0), k = s.createVertexBuffer(x, ot.collisionCircleLayout.members, !0), L = 0, D = u; L < D.length; L += 1) {
                            var R = D[L], U = Yi(R.transform, R.invTransform, t.transform);
                            F.draw(s, l.TRIANGLES, st.disabled, N.disabled, t.colorModeForRenderPass(), V.disabled, U, i.id, k, z, ot.SegmentVector.simpleSegment(0, 2 * R.circleOffset, R.circleArray.length, R.circleArray.length / 2), null, t.transform.zoom, null, null, null)
                        }
                        k.destroy(), z.destroy()
                    }
                }

                var yr = ot.identity(new Float32Array(16));

                function gr(t, e, i, r, n, a) {
                    var o = ot.getAnchorAlignment(t), s = -(o.horizontalAlign - .5) * e,
                        l = -(o.verticalAlign - .5) * i, u = ot.evaluateVariableOffset(t, r);
                    return new ot.Point((s / n + u[0]) * a, (l / n + u[1]) * a)
                }

                function _r(t, e, i, r, n, a, o, s, l, u, h) {
                    var c = t.text.placedSymbolArray, p = t.text.dynamicLayoutVertexArray,
                        f = t.icon.dynamicLayoutVertexArray, d = {};
                    p.clear();
                    for (var m = 0; m < c.length; m++) {
                        var y = c.get(m),
                            g = y.hidden || !y.crossTileID || t.allowVerticalPlacement && !y.placedOrientation ? null : r[y.crossTileID];
                        if (g) {
                            var _ = new ot.Point(y.anchorX, y.anchorY), v = Y(_, i ? s : o),
                                x = Me(a.cameraToCenterDistance, v.signedDistanceFromCamera),
                                b = n.evaluateSizeForFeature(t.textSizeData, u, y) * x / ot.ONE_EM;
                            i && (b *= t.tilePixelRatio / l);
                            for (var w = gr(g.anchor, g.width, g.height, g.textOffset, g.textBoxScale, b), M = i ? Y(_.add(w), o).point : v.point.add(e ? w.rotate(-a.angle) : w), S = t.allowVerticalPlacement && y.placedOrientation === ot.WritingMode.vertical ? Math.PI / 2 : 0, E = 0; E < y.numGlyphs; E++) ot.addDynamicAttributes(p, M, S);
                            h && y.associatedIconIndex >= 0 && (d[y.associatedIconIndex] = {shiftedAnchor: M, angle: S})
                        } else ke(y.numGlyphs, p)
                    }
                    if (h) {
                        f.clear();
                        for (var I = t.icon.placedSymbolArray, T = 0; T < I.length; T++) {
                            var C = I.get(T);
                            if (C.hidden) ke(C.numGlyphs, f); else {
                                var P = d[T];
                                if (P) for (var A = 0; A < C.numGlyphs; A++) ot.addDynamicAttributes(f, P.shiftedAnchor, P.angle); else ke(C.numGlyphs, f)
                            }
                        }
                        t.icon.dynamicLayoutVertexBuffer.updateData(f)
                    }
                    t.text.dynamicLayoutVertexBuffer.updateData(p)
                }

                function vr(t, e, i) {
                    return i.iconsInText && e ? "symbolTextAndIcon" : t ? "symbolSDF" : "symbolIcon"
                }

                function xr(t, B, e, O, i, r, n, F, U, N, a, o) {
                    for (var s = t.context, l = s.gl, u = t.transform, h = "map" === F, c = "map" === U, p = h && "point" !== e.layout.get("symbol-placement"), f = h && !c && !p, d = void 0 !== e.layout.get("symbol-sort-key").constantOr(1), m = t.depthModeForSublayer(0, st.ReadOnly), V = e.layout.get("text-variable-anchor"), y = [], g = 0, j = O; g < j.length; g += 1) {
                        var _ = j[g], v = B.getTile(_), x = v.getBucket(e);
                        if (x) {
                            var b = i ? x.text : x.icon;
                            if (b && b.segments.get().length) {
                                var q = b.programConfigurations.get(e.id), w = i || x.sdfIcons,
                                    M = i ? x.textSizeData : x.iconSizeData, G = c || 0 !== u.pitch,
                                    Z = t.useProgram(vr(w, i, x), q), S = ot.evaluateSizeForZoom(M, u.zoom), E = void 0,
                                    W = [0, 0], I = void 0, T = void 0, X = null, H = void 0;
                                if (i) I = v.glyphAtlasTexture, T = l.LINEAR, E = v.glyphAtlasTexture.size, x.iconsInText && (W = v.imageAtlasTexture.size, X = v.imageAtlasTexture, H = G || t.options.rotating || t.options.zooming || "composite" === M.kind || "camera" === M.kind ? l.LINEAR : l.NEAREST); else {
                                    var K = 1 !== e.layout.get("icon-size").constantOr(0) || x.iconsNeedLinear;
                                    I = v.imageAtlasTexture, T = w || t.options.rotating || t.options.zooming || K || G ? l.LINEAR : l.NEAREST, E = v.imageAtlasTexture.size
                                }
                                var Y = lt(v, 1, t.transform.zoom), J = be(_.posMatrix, c, h, t.transform, Y),
                                    Q = we(_.posMatrix, c, h, t.transform, Y), $ = V && x.hasTextData(),
                                    tt = "none" !== e.layout.get("icon-text-fit") && $ && x.hasIconData();
                                p && Ee(x, _.posMatrix, t, i, J, Q, c, N);
                                var C = t.translatePosMatrix(_.posMatrix, v, r, n), P = p || i && V || tt ? yr : J,
                                    A = t.translatePosMatrix(Q, v, r, n, !0),
                                    et = w && 0 !== e.paint.get(i ? "text-halo-width" : "icon-halo-width").constantOr(1),
                                    it = {
                                        program: Z,
                                        buffers: b,
                                        uniformValues: w ? x.iconsInText ? cr(M.kind, S, f, c, t, C, P, A, E, W) : hr(M.kind, S, f, c, t, C, P, A, i, E, !0) : ur(M.kind, S, f, c, t, C, P, A, i, E),
                                        atlasTexture: I,
                                        atlasTextureIcon: X,
                                        atlasInterpolation: T,
                                        atlasInterpolationIcon: H,
                                        isSDF: w,
                                        hasHalo: et
                                    };
                                if (d) for (var z = 0, rt = b.segments.get(); z < rt.length; z += 1) {
                                    var nt = rt[z];
                                    y.push({segments: new ot.SegmentVector([nt]), sortKey: nt.sortKey, state: it})
                                } else y.push({segments: b.segments, sortKey: 0, state: it})
                            }
                        }
                    }
                    d && y.sort(function (t, e) {
                        return t.sortKey - e.sortKey
                    });
                    for (var k = 0, at = y; k < at.length; k += 1) {
                        var L = at[k], D = L.state;
                        if (s.activeTexture.set(l.TEXTURE0), D.atlasTexture.bind(D.atlasInterpolation, l.CLAMP_TO_EDGE), D.atlasTextureIcon && (s.activeTexture.set(l.TEXTURE1), D.atlasTextureIcon && D.atlasTextureIcon.bind(D.atlasInterpolationIcon, l.CLAMP_TO_EDGE)), D.isSDF) {
                            var R = D.uniformValues;
                            D.hasHalo && (R.u_is_halo = 1, br(D.buffers, L.segments, e, t, D.program, m, a, o, R)), R.u_is_halo = 0
                        }
                        br(D.buffers, L.segments, e, t, D.program, m, a, o, D.uniformValues)
                    }
                }

                function br(t, e, i, r, n, a, o, s, l) {
                    var u = r.context;
                    n.draw(u, u.gl.TRIANGLES, a, o, s, V.disabled, l, i.id, t.layoutVertexBuffer, t.indexBuffer, e, i.paint, r.transform.zoom, t.programConfigurations.get(i.id), t.dynamicLayoutVertexBuffer, t.opacityVertexBuffer)
                }

                function wr(t, e, i, r, n, a, o) {
                    var s, l, u, h, c, p = t.context.gl, f = i.paint.get("fill-pattern"), d = f && f.constantOr(1),
                        m = i.getCrossfadeParameters();
                    o ? (l = d && !i.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", s = p.LINES) : (l = d ? "fillPattern" : "fill", s = p.TRIANGLES);
                    for (var y = 0, g = r; y < g.length; y += 1) {
                        var _ = g[y], v = e.getTile(_);
                        if (!d || v.patternsLoaded()) {
                            var x = v.getBucket(i);
                            if (x) {
                                var b = x.programConfigurations.get(i.id), w = t.useProgram(l, b);
                                d && (t.context.activeTexture.set(p.TEXTURE0), v.imageAtlasTexture.bind(p.LINEAR, p.CLAMP_TO_EDGE), b.updatePaintBuffers(m));
                                var M = f.constantOr(null);
                                if (M && v.imageAtlas) {
                                    var S = v.imageAtlas, E = S.patternPositions[M.to.toString()],
                                        I = S.patternPositions[M.from.toString()];
                                    E && I && b.setConstantPatternPositions(E, I)
                                }
                                var T = t.translatePosMatrix(_.posMatrix, v, i.paint.get("fill-translate"), i.paint.get("fill-translate-anchor"));
                                if (o) {
                                    h = x.indexBuffer2, c = x.segments2;
                                    var C = [p.drawingBufferWidth, p.drawingBufferHeight];
                                    u = "fillOutlinePattern" === l && d ? Xi(T, t, m, v, C) : Wi(T, C)
                                } else h = x.indexBuffer, c = x.segments, u = d ? Zi(T, t, m, v) : Gi(T);
                                w.draw(t.context, s, n, t.stencilModeForClipping(_), a, V.disabled, u, i.id, x.layoutVertexBuffer, h, c, i.paint, t.transform.zoom, b)
                            }
                        }
                    }
                }

                function Mr(t, e, i, r, n, a, o) {
                    for (var s = t.context, l = s.gl, u = i.paint.get("fill-extrusion-pattern"), h = u.constantOr(1), c = i.getCrossfadeParameters(), p = i.paint.get("fill-extrusion-opacity"), f = 0, d = r; f < d.length; f += 1) {
                        var m = d[f], y = e.getTile(m), g = y.getBucket(i);
                        if (g) {
                            var _ = g.programConfigurations.get(i.id),
                                v = t.useProgram(h ? "fillExtrusionPattern" : "fillExtrusion", _);
                            h && (t.context.activeTexture.set(l.TEXTURE0), y.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE), _.updatePaintBuffers(c));
                            var x = u.constantOr(null);
                            if (x && y.imageAtlas) {
                                var b = y.imageAtlas, w = b.patternPositions[x.to.toString()],
                                    M = b.patternPositions[x.from.toString()];
                                w && M && _.setConstantPatternPositions(w, M)
                            }
                            var S = t.translatePosMatrix(m.posMatrix, y, i.paint.get("fill-extrusion-translate"), i.paint.get("fill-extrusion-translate-anchor")),
                                E = i.paint.get("fill-extrusion-vertical-gradient"),
                                I = h ? qi(S, t, E, p, m, c, y) : ji(S, t, E, p);
                            v.draw(s, s.gl.TRIANGLES, n, a, o, V.backCCW, I, i.id, g.layoutVertexBuffer, g.indexBuffer, g.segments, i.paint, t.transform.zoom, _)
                        }
                    }
                }

                function Sr(t, e, i, r, n, a) {
                    var o = t.context, s = o.gl, l = e.fbo;
                    if (l) {
                        var u = t.useProgram("hillshade");
                        o.activeTexture.set(s.TEXTURE0), s.bindTexture(s.TEXTURE_2D, l.colorAttachment.get());
                        var h = function (t, e, i) {
                            var r = i.paint.get("hillshade-shadow-color"), n = i.paint.get("hillshade-highlight-color"),
                                a = i.paint.get("hillshade-accent-color"),
                                o = i.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
                            "viewport" === i.paint.get("hillshade-illumination-anchor") && (o -= t.transform.angle);
                            var s, l, u, h = !t.options.moving;
                            return {
                                u_matrix: t.transform.calculatePosMatrix(e.tileID.toUnwrapped(), h),
                                u_image: 0,
                                u_latrange: (s = e.tileID, l = Math.pow(2, s.canonical.z), u = s.canonical.y, [new ot.MercatorCoordinate(0, u / l).toLngLat().lat, new ot.MercatorCoordinate(0, (u + 1) / l).toLngLat().lat]),
                                u_light: [i.paint.get("hillshade-exaggeration"), o],
                                u_shadow: r,
                                u_highlight: n,
                                u_accent: a
                            }
                        }(t, e, i);
                        u.draw(o, s.TRIANGLES, r, n, a, V.disabled, h, i.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments)
                    }
                }

                function Er(t, e, i, r, n, a) {
                    var o = t.context, s = o.gl, l = e.dem;
                    if (l && l.data) {
                        var u = l.dim, h = l.stride, c = l.getPixels();
                        if (o.activeTexture.set(s.TEXTURE1), o.pixelStoreUnpackPremultiplyAlpha.set(!1), e.demTexture = e.demTexture || t.getTileTexture(h), e.demTexture) {
                            var p = e.demTexture;
                            p.update(c, {premultiply: !1}), p.bind(s.NEAREST, s.CLAMP_TO_EDGE)
                        } else e.demTexture = new ot.Texture(o, c, s.RGBA, {premultiply: !1}), e.demTexture.bind(s.NEAREST, s.CLAMP_TO_EDGE);
                        o.activeTexture.set(s.TEXTURE0);
                        var f = e.fbo;
                        if (!f) {
                            var d = new ot.Texture(o, {width: u, height: u, data: null}, s.RGBA);
                            d.bind(s.LINEAR, s.CLAMP_TO_EDGE), (f = e.fbo = o.createFramebuffer(u, u, !0)).colorAttachment.set(d.texture)
                        }
                        o.bindFramebuffer.set(f.framebuffer), o.viewport.set([0, 0, u, u]), t.useProgram("hillshadePrepare").draw(o, s.TRIANGLES, r, n, a, V.disabled, function (t, e) {
                            var i = e.stride, r = ot.create();
                            return ot.ortho(r, 0, ot.EXTENT, -ot.EXTENT, 0, 0, 1), ot.translate(r, r, [0, -ot.EXTENT, 0]), {
                                u_matrix: r,
                                u_image: 1,
                                u_dimension: [i, i],
                                u_zoom: t.overscaledZ,
                                u_unpack: e.getUnpackVector()
                            }
                        }(e.tileID, l), i.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments), e.needsHillshadePrepare = !1
                    }
                }

                function Ir(t, e, i, r, n) {
                    var a = r.paint.get("raster-fade-duration");
                    if (a > 0) {
                        var o = ot.browser.now(), s = (o - t.timeAdded) / a, l = e ? (o - e.timeAdded) / a : -1,
                            u = i.getSource(), h = n.coveringZoomLevel({tileSize: u.tileSize, roundZoom: u.roundZoom}),
                            c = !e || Math.abs(e.tileID.overscaledZ - h) > Math.abs(t.tileID.overscaledZ - h),
                            p = c && t.refreshedUponExpiration ? 1 : ot.clamp(c ? s : 1 - l, 0, 1);
                        return t.refreshedUponExpiration && s >= 1 && (t.refreshedUponExpiration = !1), e ? {
                            opacity: 1,
                            mix: 1 - p
                        } : {opacity: p, mix: 0}
                    }
                    return {opacity: 1, mix: 0}
                }

                var Tr = new ot.Color(1, 0, 0, 1), Cr = new ot.Color(0, 1, 0, 1), Pr = new ot.Color(0, 0, 1, 1),
                    Ar = new ot.Color(1, 0, 1, 1), zr = new ot.Color(0, 1, 1, 1);

                function kr(t, e, i, r) {
                    Dr(t, 0, e + i / 2, t.transform.width, i, r)
                }

                function Lr(t, e, i, r) {
                    Dr(t, e - i / 2, 0, i, t.transform.height, r)
                }

                function Dr(t, e, i, r, n, a) {
                    var o = t.context, s = o.gl;
                    s.enable(s.SCISSOR_TEST), s.scissor(e * ot.browser.devicePixelRatio, i * ot.browser.devicePixelRatio, r * ot.browser.devicePixelRatio, n * ot.browser.devicePixelRatio), o.clear({color: a}), s.disable(s.SCISSOR_TEST)
                }

                function Rr(t, e, i) {
                    var r = t.context, n = r.gl, a = i.posMatrix, o = t.useProgram("debug"), s = st.disabled,
                        l = N.disabled, u = t.colorModeForRenderPass();
                    r.activeTexture.set(n.TEXTURE0), t.emptyTexture.bind(n.LINEAR, n.CLAMP_TO_EDGE), o.draw(r, n.LINE_STRIP, s, l, u, V.disabled, Ji(a, ot.Color.red), "$debug", t.debugBuffer, t.tileBorderIndexBuffer, t.debugSegments);
                    var h = e.getTileByID(i.key).latestRawTileData, c = Math.floor((h && h.byteLength || 0) / 1024),
                        p = e.getTile(i).tileSize, f = 512 / Math.min(p, 512) * (i.overscaledZ / t.transform.zoom) * .5,
                        d = i.canonical.toString();
                    i.overscaledZ !== i.canonical.z && (d += " => " + i.overscaledZ), function (t, e) {
                        t.initDebugOverlayCanvas();
                        var i = t.debugOverlayCanvas, r = t.context.gl, n = t.debugOverlayCanvas.getContext("2d");
                        n.clearRect(0, 0, i.width, i.height), n.shadowColor = "white", n.shadowBlur = 2, n.lineWidth = 1.5, n.strokeStyle = "white", n.textBaseline = "top", n.font = "bold 36px Open Sans, sans-serif", n.fillText(e, 5, 5), n.strokeText(e, 5, 5), t.debugOverlayTexture.update(i), t.debugOverlayTexture.bind(r.LINEAR, r.CLAMP_TO_EDGE)
                    }(t, d + " " + c + "kb"), o.draw(r, n.TRIANGLES, s, l, m.alphaBlended, V.disabled, Ji(a, ot.Color.transparent, f), "$debug", t.debugBuffer, t.quadTriangleIndexBuffer, t.debugSegments)
                }

                var Br = {
                    symbol: function (t, e, i, r, n) {
                        if ("translucent" === t.renderPass) {
                            var a = N.disabled, o = t.colorModeForRenderPass();
                            i.layout.get("text-variable-anchor") && function (t, e, i, r, n, a, o) {
                                for (var s = e.transform, l = "map" === n, u = "map" === a, h = 0, c = t; h < c.length; h += 1) {
                                    var p = c[h], f = r.getTile(p), d = f.getBucket(i);
                                    if (d && d.text && d.text.segments.get().length) {
                                        var m = ot.evaluateSizeForZoom(d.textSizeData, s.zoom),
                                            y = lt(f, 1, e.transform.zoom), g = be(p.posMatrix, u, l, e.transform, y),
                                            _ = "none" !== i.layout.get("icon-text-fit") && d.hasIconData();
                                        if (m) {
                                            var v = Math.pow(2, s.zoom - f.tileID.overscaledZ);
                                            _r(d, l, u, o, ot.symbolSize, s, g, p.posMatrix, v, m, _)
                                        }
                                    }
                                }
                            }(r, t, i, e, i.layout.get("text-rotation-alignment"), i.layout.get("text-pitch-alignment"), n), 0 !== i.paint.get("icon-opacity").constantOr(1) && xr(t, e, i, r, !1, i.paint.get("icon-translate"), i.paint.get("icon-translate-anchor"), i.layout.get("icon-rotation-alignment"), i.layout.get("icon-pitch-alignment"), i.layout.get("icon-keep-upright"), a, o), 0 !== i.paint.get("text-opacity").constantOr(1) && xr(t, e, i, r, !0, i.paint.get("text-translate"), i.paint.get("text-translate-anchor"), i.layout.get("text-rotation-alignment"), i.layout.get("text-pitch-alignment"), i.layout.get("text-keep-upright"), a, o), e.map.showCollisionBoxes && (mr(t, e, i, r, i.paint.get("text-translate"), i.paint.get("text-translate-anchor"), !0), mr(t, e, i, r, i.paint.get("icon-translate"), i.paint.get("icon-translate-anchor"), !1))
                        }
                    }, circle: function (t, e, i, r) {
                        if ("translucent" === t.renderPass) {
                            var n = i.paint.get("circle-opacity"), a = i.paint.get("circle-stroke-width"),
                                o = i.paint.get("circle-stroke-opacity"),
                                s = void 0 !== i.layout.get("circle-sort-key").constantOr(1);
                            if (0 !== n.constantOr(1) || 0 !== a.constantOr(1) && 0 !== o.constantOr(1)) {
                                for (var l = t.context, u = l.gl, h = t.depthModeForSublayer(0, st.ReadOnly), c = N.disabled, p = t.colorModeForRenderPass(), f = [], d = 0; d < r.length; d++) {
                                    var m = r[d], y = e.getTile(m), g = y.getBucket(i);
                                    if (g) {
                                        var _ = g.programConfigurations.get(i.id), v = {
                                            programConfiguration: _,
                                            program: t.useProgram("circle", _),
                                            layoutVertexBuffer: g.layoutVertexBuffer,
                                            indexBuffer: g.indexBuffer,
                                            uniformValues: Hi(t, m, y, i)
                                        };
                                        if (s) for (var x = 0, b = g.segments.get(); x < b.length; x += 1) {
                                            var w = b[x];
                                            f.push({segments: new ot.SegmentVector([w]), sortKey: w.sortKey, state: v})
                                        } else f.push({segments: g.segments, sortKey: 0, state: v})
                                    }
                                }
                                s && f.sort(function (t, e) {
                                    return t.sortKey - e.sortKey
                                });
                                for (var M = 0, S = f; M < S.length; M += 1) {
                                    var E = S[M], I = E.state;
                                    I.program.draw(l, u.TRIANGLES, h, c, p, V.disabled, I.uniformValues, i.id, I.layoutVertexBuffer, I.indexBuffer, E.segments, i.paint, t.transform.zoom, I.programConfiguration)
                                }
                            }
                        }
                    }, heatmap: function (t, e, i, r) {
                        if (0 !== i.paint.get("heatmap-opacity")) if ("offscreen" === t.renderPass) {
                            var n = t.context, a = n.gl, o = N.disabled,
                                s = new m([a.ONE, a.ONE], ot.Color.transparent, [!0, !0, !0, !0]);
                            !function (t, e, i) {
                                var r = t.gl;
                                t.activeTexture.set(r.TEXTURE1), t.viewport.set([0, 0, e.width / 4, e.height / 4]);
                                var n = i.heatmapFbo;
                                if (n) r.bindTexture(r.TEXTURE_2D, n.colorAttachment.get()), t.bindFramebuffer.set(n.framebuffer); else {
                                    var a = r.createTexture();
                                    r.bindTexture(r.TEXTURE_2D, a), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.LINEAR), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.LINEAR), n = i.heatmapFbo = t.createFramebuffer(e.width / 4, e.height / 4, !1), function (t, e, i, r) {
                                        var n = t.gl;
                                        n.texImage2D(n.TEXTURE_2D, 0, n.RGBA, e.width / 4, e.height / 4, 0, n.RGBA, t.extRenderToTextureHalfFloat ? t.extTextureHalfFloat.HALF_FLOAT_OES : n.UNSIGNED_BYTE, null), r.colorAttachment.set(i)
                                    }(t, e, a, n)
                                }
                            }(n, t, i), n.clear({color: ot.Color.transparent});
                            for (var l = 0; l < r.length; l++) {
                                var u = r[l];
                                if (!e.hasRenderableParent(u)) {
                                    var h = e.getTile(u), c = h.getBucket(i);
                                    if (c) {
                                        var p = c.programConfigurations.get(i.id);
                                        t.useProgram("heatmap", p).draw(n, a.TRIANGLES, st.disabled, o, s, V.disabled, $i(u.posMatrix, h, t.transform.zoom, i.paint.get("heatmap-intensity")), i.id, c.layoutVertexBuffer, c.indexBuffer, c.segments, i.paint, t.transform.zoom, p)
                                    }
                                }
                            }
                            n.viewport.set([0, 0, t.width, t.height])
                        } else "translucent" === t.renderPass && (t.context.setColorMode(t.colorModeForRenderPass()), function (t, e) {
                            var i = t.context, r = i.gl, n = e.heatmapFbo;
                            if (n) {
                                i.activeTexture.set(r.TEXTURE0), r.bindTexture(r.TEXTURE_2D, n.colorAttachment.get()), i.activeTexture.set(r.TEXTURE1);
                                var a = e.colorRampTexture;
                                a || (a = e.colorRampTexture = new ot.Texture(i, e.colorRamp, r.RGBA)), a.bind(r.LINEAR, r.CLAMP_TO_EDGE), t.useProgram("heatmapTexture").draw(i, r.TRIANGLES, st.disabled, N.disabled, t.colorModeForRenderPass(), V.disabled, function (t, e, i, r) {
                                    var n = ot.create();
                                    ot.ortho(n, 0, t.width, t.height, 0, 0, 1);
                                    var a = t.context.gl;
                                    return {
                                        u_matrix: n,
                                        u_world: [a.drawingBufferWidth, a.drawingBufferHeight],
                                        u_image: 0,
                                        u_color_ramp: 1,
                                        u_opacity: e.paint.get("heatmap-opacity")
                                    }
                                }(t, e), e.id, t.viewportBuffer, t.quadTriangleIndexBuffer, t.viewportSegments, e.paint, t.transform.zoom)
                            }
                        }(t, i))
                    }, line: function (t, e, i, r) {
                        if ("translucent" === t.renderPass) {
                            var n = i.paint.get("line-opacity"), a = i.paint.get("line-width");
                            if (0 !== n.constantOr(1) && 0 !== a.constantOr(1)) for (var o = t.depthModeForSublayer(0, st.ReadOnly), s = t.colorModeForRenderPass(), l = i.paint.get("line-dasharray"), u = i.paint.get("line-pattern"), h = u.constantOr(1), c = i.paint.get("line-gradient"), p = i.getCrossfadeParameters(), f = h ? "linePattern" : l ? "lineSDF" : c ? "lineGradient" : "line", d = t.context, m = d.gl, y = !0, g = 0, _ = r; g < _.length; g += 1) {
                                var v = _[g], x = e.getTile(v);
                                if (!h || x.patternsLoaded()) {
                                    var b = x.getBucket(i);
                                    if (b) {
                                        var w = b.programConfigurations.get(i.id), M = t.context.program.get(),
                                            S = t.useProgram(f, w), E = y || S.program !== M, I = u.constantOr(null);
                                        if (I && x.imageAtlas) {
                                            var T = x.imageAtlas, C = T.patternPositions[I.to.toString()],
                                                P = T.patternPositions[I.from.toString()];
                                            C && P && w.setConstantPatternPositions(C, P)
                                        }
                                        var A = h ? ir(t, x, i, p) : l ? rr(t, x, i, l, p) : c ? er(t, x, i, b.lineClipsArray.length) : tr(t, x, i);
                                        if (h) d.activeTexture.set(m.TEXTURE0), x.imageAtlasTexture.bind(m.LINEAR, m.CLAMP_TO_EDGE), w.updatePaintBuffers(p); else if (l && (E || t.lineAtlas.dirty)) d.activeTexture.set(m.TEXTURE0), t.lineAtlas.bind(d); else if (c) {
                                            var z = b.gradients[i.id], k = z.texture;
                                            if (i.gradientVersion !== z.version) {
                                                var L = 256;
                                                if (i.stepInterpolant) {
                                                    var D = e.getSource().maxzoom,
                                                        R = v.canonical.z === D ? Math.ceil(1 << t.transform.maxZoom - v.canonical.z) : 1;
                                                    L = ot.clamp(ot.nextPowerOfTwo(b.maxLineLength / ot.EXTENT * 1024 * R), 256, d.maxTextureSize)
                                                }
                                                z.gradient = ot.renderColorRamp({
                                                    expression: i.gradientExpression(),
                                                    evaluationKey: "lineProgress",
                                                    resolution: L,
                                                    image: z.gradient || void 0,
                                                    clips: b.lineClipsArray
                                                }), z.texture ? z.texture.update(z.gradient) : z.texture = new ot.Texture(d, z.gradient, m.RGBA), z.version = i.gradientVersion, k = z.texture
                                            }
                                            d.activeTexture.set(m.TEXTURE0), k.bind(i.stepInterpolant ? m.NEAREST : m.LINEAR, m.CLAMP_TO_EDGE)
                                        }
                                        S.draw(d, m.TRIANGLES, o, t.stencilModeForClipping(v), s, V.disabled, A, i.id, b.layoutVertexBuffer, b.indexBuffer, b.segments, i.paint, t.transform.zoom, w, b.layoutVertexBuffer2), y = !1
                                    }
                                }
                            }
                        }
                    }, fill: function (t, e, i, r) {
                        var n = i.paint.get("fill-color"), a = i.paint.get("fill-opacity");
                        if (0 !== a.constantOr(1)) {
                            var o = t.colorModeForRenderPass(), s = i.paint.get("fill-pattern"),
                                l = t.opaquePassEnabledForLayer() && !s.constantOr(1) && 1 === n.constantOr(ot.Color.transparent).a && 1 === a.constantOr(0) ? "opaque" : "translucent";
                            if (t.renderPass === l) {
                                var u = t.depthModeForSublayer(1, "opaque" === t.renderPass ? st.ReadWrite : st.ReadOnly);
                                wr(t, e, i, r, u, o, !1)
                            }
                            if ("translucent" === t.renderPass && i.paint.get("fill-antialias")) {
                                var h = t.depthModeForSublayer(i.getPaintProperty("fill-outline-color") ? 2 : 0, st.ReadOnly);
                                wr(t, e, i, r, h, o, !0)
                            }
                        }
                    }, "fill-extrusion": function (t, e, i, r) {
                        var n = i.paint.get("fill-extrusion-opacity");
                        if (0 !== n && "translucent" === t.renderPass) {
                            var a = new st(t.context.gl.LEQUAL, st.ReadWrite, t.depthRangeFor3D);
                            if (1 !== n || i.paint.get("fill-extrusion-pattern").constantOr(1)) Mr(t, e, i, r, a, N.disabled, m.disabled), Mr(t, e, i, r, a, t.stencilModeFor3D(), t.colorModeForRenderPass()); else {
                                var o = t.colorModeForRenderPass();
                                Mr(t, e, i, r, a, N.disabled, o)
                            }
                        }
                    }, hillshade: function (t, e, i, r) {
                        if ("offscreen" === t.renderPass || "translucent" === t.renderPass) {
                            for (var n = t.context, a = t.depthModeForSublayer(0, st.ReadOnly), o = t.colorModeForRenderPass(), s = "translucent" === t.renderPass ? t.stencilConfigForOverlap(r) : [{}, r], l = s[0], u = 0, h = s[1]; u < h.length; u += 1) {
                                var c = h[u], p = e.getTile(c);
                                p.needsHillshadePrepare && "offscreen" === t.renderPass ? Er(t, p, i, a, N.disabled, o) : "translucent" === t.renderPass && Sr(t, p, i, a, l[c.overscaledZ], o)
                            }
                            n.viewport.set([0, 0, t.width, t.height])
                        }
                    }, raster: function (t, e, i, r) {
                        if ("translucent" === t.renderPass && 0 !== i.paint.get("raster-opacity") && r.length) for (var n = t.context, a = n.gl, o = e.getSource(), s = t.useProgram("raster"), l = t.colorModeForRenderPass(), u = o instanceof ct ? [{}, r] : t.stencilConfigForOverlap(r), h = u[0], c = u[1], p = c[c.length - 1].overscaledZ, f = !t.options.moving, d = 0, m = c; d < m.length; d += 1) {
                            var y = m[d],
                                g = t.depthModeForSublayer(y.overscaledZ - p, 1 === i.paint.get("raster-opacity") ? st.ReadWrite : st.ReadOnly, a.LESS),
                                _ = e.getTile(y), v = t.transform.calculatePosMatrix(y.toUnwrapped(), f);
                            _.registerFadeDuration(i.paint.get("raster-fade-duration"));
                            var x = e.findLoadedParent(y, 0), b = Ir(_, x, e, i, t.transform), w = void 0, M = void 0,
                                S = "nearest" === i.paint.get("raster-resampling") ? a.NEAREST : a.LINEAR;
                            n.activeTexture.set(a.TEXTURE0), _.texture.bind(S, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST), n.activeTexture.set(a.TEXTURE1), x ? (x.texture.bind(S, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST), w = Math.pow(2, x.tileID.overscaledZ - _.tileID.overscaledZ), M = [_.tileID.canonical.x * w % 1, _.tileID.canonical.y * w % 1]) : _.texture.bind(S, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST);
                            var E = or(v, M || [0, 0], w || 1, b, i);
                            o instanceof ct ? s.draw(n, a.TRIANGLES, g, N.disabled, l, V.disabled, E, i.id, o.boundsBuffer, t.quadTriangleIndexBuffer, o.boundsSegments) : s.draw(n, a.TRIANGLES, g, h[y.overscaledZ], l, V.disabled, E, i.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments)
                        }
                    }, background: function (t, e, i) {
                        var r = i.paint.get("background-color"), n = i.paint.get("background-opacity");
                        if (0 !== n) {
                            var a = t.context, o = a.gl, s = t.transform, l = s.tileSize,
                                u = i.paint.get("background-pattern");
                            if (!t.isPatternMissing(u)) {
                                var h = !u && 1 === r.a && 1 === n && t.opaquePassEnabledForLayer() ? "opaque" : "translucent";
                                if (t.renderPass === h) {
                                    var c = N.disabled,
                                        p = t.depthModeForSublayer(0, "opaque" === h ? st.ReadWrite : st.ReadOnly),
                                        f = t.colorModeForRenderPass(),
                                        d = t.useProgram(u ? "backgroundPattern" : "background"),
                                        m = s.coveringTiles({tileSize: l});
                                    u && (a.activeTexture.set(o.TEXTURE0), t.imageManagerFactory.bind(t.context));
                                    for (var y = i.getCrossfadeParameters(), g = 0, _ = m; g < _.length; g += 1) {
                                        var v = _[g], x = t.transform.calculatePosMatrix(v.toUnwrapped()),
                                            b = u ? fr(x, n, t, u, {tileID: v, tileSize: l}, y) : pr(x, n, r);
                                        d.draw(a, o.TRIANGLES, p, c, f, V.disabled, b, i.id, t.tileExtentBuffer, t.quadTriangleIndexBuffer, t.tileExtentSegments)
                                    }
                                }
                            }
                        }
                    }, debug: function (t, e, i) {
                        for (var r = 0; r < i.length; r++) Rr(t, e, i[r])
                    }, custom: function (t, e, i) {
                        var r = t.context, n = i.implementation;
                        if ("offscreen" === t.renderPass) {
                            var a = n.prerender;
                            a && (t.setCustomLayerDefaults(), r.setColorMode(t.colorModeForRenderPass()), a.call(n, r.gl, t.transform.customLayerMatrix()), r.setDirty(), t.setBaseState())
                        } else if ("translucent" === t.renderPass) {
                            t.setCustomLayerDefaults(), r.setColorMode(t.colorModeForRenderPass()), r.setStencilMode(N.disabled);
                            var o = "3d" === n.renderingMode ? new st(t.context.gl.LEQUAL, st.ReadWrite, t.depthRangeFor3D) : t.depthModeForSublayer(0, st.ReadOnly);
                            r.setDepthMode(o), n.render(r.gl, t.transform.customLayerMatrix()), r.setDirty(), t.setBaseState(), r.bindFramebuffer.set(null)
                        }
                    }
                }, l = function (t, e) {
                    this.context = new i(t), this.transform = e, this._tileTextures = {}, this.setup(), this.numSublayers = ie.maxUnderzooming + ie.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new ni, this.gpuTimers = {}
                };
                l.prototype.resize = function (t, e) {
                    if (this.width = t * ot.browser.devicePixelRatio, this.height = e * ot.browser.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style) for (var i = 0, r = this.style._order; i < r.length; i += 1) this.style._layers[r[i]].resize()
                }, l.prototype.setup = function () {
                    var t = this.context, e = new ot.StructArrayLayout2i4;
                    e.emplaceBack(0, 0), e.emplaceBack(ot.EXTENT, 0), e.emplaceBack(0, ot.EXTENT), e.emplaceBack(ot.EXTENT, ot.EXTENT), this.tileExtentBuffer = t.createVertexBuffer(e, hi.members), this.tileExtentSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2);
                    var i = new ot.StructArrayLayout2i4;
                    i.emplaceBack(0, 0), i.emplaceBack(ot.EXTENT, 0), i.emplaceBack(0, ot.EXTENT), i.emplaceBack(ot.EXTENT, ot.EXTENT), this.debugBuffer = t.createVertexBuffer(i, hi.members), this.debugSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 5);
                    var r = new ot.StructArrayLayout4i8;
                    r.emplaceBack(0, 0, 0, 0), r.emplaceBack(ot.EXTENT, 0, ot.EXTENT, 0), r.emplaceBack(0, ot.EXTENT, 0, ot.EXTENT), r.emplaceBack(ot.EXTENT, ot.EXTENT, ot.EXTENT, ot.EXTENT), this.rasterBoundsBuffer = t.createVertexBuffer(r, ht.members), this.rasterBoundsSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2);
                    var n = new ot.StructArrayLayout2i4;
                    n.emplaceBack(0, 0), n.emplaceBack(1, 0), n.emplaceBack(0, 1), n.emplaceBack(1, 1), this.viewportBuffer = t.createVertexBuffer(n, hi.members), this.viewportSegments = ot.SegmentVector.simpleSegment(0, 0, 4, 2);
                    var a = new ot.StructArrayLayout1ui2;
                    a.emplaceBack(0), a.emplaceBack(1), a.emplaceBack(3), a.emplaceBack(2), a.emplaceBack(0), this.tileBorderIndexBuffer = t.createIndexBuffer(a);
                    var o = new ot.StructArrayLayout3ui6;
                    o.emplaceBack(0, 1, 2), o.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = t.createIndexBuffer(o), this.emptyTexture = new ot.Texture(t, {
                        width: 1,
                        height: 1,
                        data: new Uint8Array([0, 0, 0, 0])
                    }, t.gl.RGBA);
                    var s = this.context.gl;
                    this.stencilClearMode = new N({func: s.ALWAYS, mask: 0}, 0, 255, s.ZERO, s.ZERO, s.ZERO)
                }, l.prototype.clearStencil = function () {
                    var t = this.context, e = t.gl;
                    this.nextStencilID = 1, this.currentStencilSource = void 0;
                    var i = ot.create();
                    ot.ortho(i, 0, this.width, this.height, 0, 0, 1), ot.scale(i, i, [e.drawingBufferWidth, e.drawingBufferHeight, 0]), this.useProgram("clippingMask").draw(t, e.TRIANGLES, st.disabled, this.stencilClearMode, m.disabled, V.disabled, Qi(i), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments)
                }, l.prototype._renderTileClippingMasks = function (t, e) {
                    if (this.currentStencilSource !== t.source && t.isTileClipped() && e && e.length) {
                        this.currentStencilSource = t.source;
                        var i = this.context, r = i.gl;
                        this.nextStencilID + e.length > 256 && this.clearStencil(), i.setColorMode(m.disabled), i.setDepthMode(st.disabled);
                        var n = this.useProgram("clippingMask");
                        this._tileClippingMaskIDs = {};
                        for (var a = 0, o = e; a < o.length; a += 1) {
                            var s = o[a], l = this._tileClippingMaskIDs[s.key] = this.nextStencilID++;
                            n.draw(i, r.TRIANGLES, st.disabled, new N({
                                func: r.ALWAYS,
                                mask: 0
                            }, l, 255, r.KEEP, r.KEEP, r.REPLACE), m.disabled, V.disabled, Qi(s.posMatrix), "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments)
                        }
                    }
                }, l.prototype.stencilModeFor3D = function () {
                    this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
                    var t = this.nextStencilID++, e = this.context.gl;
                    return new N({func: e.NOTEQUAL, mask: 255}, t, 255, e.KEEP, e.KEEP, e.REPLACE)
                }, l.prototype.stencilModeForClipping = function (t) {
                    var e = this.context.gl;
                    return new N({
                        func: e.EQUAL,
                        mask: 255
                    }, this._tileClippingMaskIDs[t.key], 0, e.KEEP, e.KEEP, e.REPLACE)
                }, l.prototype.stencilConfigForOverlap = function (t) {
                    var e, i = this.context.gl, r = t.sort(function (t, e) {
                        return e.overscaledZ - t.overscaledZ
                    }), n = r[r.length - 1].overscaledZ, a = r[0].overscaledZ - n + 1;
                    if (a > 1) {
                        this.currentStencilSource = void 0, this.nextStencilID + a > 256 && this.clearStencil();
                        for (var o = {}, s = 0; s < a; s++) o[s + n] = new N({
                            func: i.GEQUAL,
                            mask: 255
                        }, s + this.nextStencilID, 255, i.KEEP, i.KEEP, i.REPLACE);
                        return this.nextStencilID += a, [o, r]
                    }
                    return [(e = {}, e[n] = N.disabled, e), r]
                }, l.prototype.colorModeForRenderPass = function () {
                    var t = this.context.gl;
                    return this._showOverdrawInspector ? new m([t.CONSTANT_COLOR, t.ONE], new ot.Color(1 / 8, 1 / 8, 1 / 8, 0), [!0, !0, !0, !0]) : "opaque" === this.renderPass ? m.unblended : m.alphaBlended
                }, l.prototype.depthModeForSublayer = function (t, e, i) {
                    if (!this.opaquePassEnabledForLayer()) return st.disabled;
                    var r = 1 - ((1 + this.currentLayer) * this.numSublayers + t) * this.depthEpsilon;
                    return new st(i || this.context.gl.LEQUAL, e, [r, r])
                }, l.prototype.opaquePassEnabledForLayer = function () {
                    return this.currentLayer < this.opaquePassCutoff
                }, l.prototype.render = function (t, e) {
                    var i = this;
                    this.style = t, this.options = e, this.lineAtlas = t.lineAtlas, this.imageManagerFactory = t.imageManagerFactory, this.glyphManager = t.glyphManager, this.symbolFadeChange = t.placement.symbolFadeChange(ot.browser.now()), this.imageManagerFactory.beginFrame();
                    var r = this.style._order, n = this.style.sourceCaches;
                    for (var a in n) {
                        var o = n[a];
                        o.used && o.prepare(this.context)
                    }
                    var s, l, u = {}, h = {}, c = {};
                    for (var p in n) {
                        var f = n[p];
                        u[p] = f.getVisibleCoordinates(), h[p] = u[p].slice().reverse(), c[p] = f.getVisibleCoordinates(!0).reverse()
                    }
                    this.opaquePassCutoff = 1 / 0;
                    for (var d = 0; d < r.length; d++) if (this.style._layers[r[d]].is3D()) {
                        this.opaquePassCutoff = d;
                        break
                    }
                    this.renderPass = "offscreen";
                    for (var m = 0, y = r; m < y.length; m += 1) {
                        var g = this.style._layers[y[m]];
                        if (g.hasOffscreenPass() && !g.isHidden(this.transform.zoom)) {
                            var _ = h[g.source];
                            ("custom" === g.type || _.length) && this.renderLayer(this, n[g.source], g, _)
                        }
                    }
                    for (this.context.bindFramebuffer.set(null), this.context.clear({
                        color: e.showOverdrawInspector ? ot.Color.black : ot.Color.transparent,
                        depth: 1
                    }), this.clearStencil(), this._showOverdrawInspector = e.showOverdrawInspector, this.depthRangeFor3D = [0, 1 - (t._order.length + 2) * this.numSublayers * this.depthEpsilon], this.renderPass = "opaque", this.currentLayer = r.length - 1; this.currentLayer >= 0; this.currentLayer--) {
                        var v = this.style._layers[r[this.currentLayer]], x = n[v.source], b = u[v.source];
                        this._renderTileClippingMasks(v, b), this.renderLayer(this, x, v, b)
                    }
                    for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < r.length; this.currentLayer++) {
                        var w = this.style._layers[r[this.currentLayer]], M = n[w.source],
                            S = ("symbol" === w.type ? c : h)[w.source];
                        this._renderTileClippingMasks(w, u[w.source]), this.renderLayer(this, M, w, S)
                    }
                    this.options.showTileBoundaries && (ot.values(this.style._layers).forEach(function (t) {
                        t.source && !t.isHidden(i.transform.zoom) && (t.source !== (l && l.id) && (l = i.style.sourceCaches[t.source]), (!s || s.getSource().maxzoom < l.getSource().maxzoom) && (s = l))
                    }), s && Br.debug(this, s, s.getVisibleCoordinates())), this.options.showPadding && function (t) {
                        var e = t.transform.padding;
                        kr(t, t.transform.height - (e.top || 0), 3, Tr), kr(t, e.bottom || 0, 3, Cr), Lr(t, e.left || 0, 3, Pr), Lr(t, t.transform.width - (e.right || 0), 3, Ar);
                        var i = t.transform.centerPoint;
                        !function (t, e, i, r) {
                            Dr(t, e - 1, i - 10, 2, 20, r), Dr(t, e - 10, i - 1, 20, 2, r)
                        }(t, i.x, t.transform.height - i.y, zr)
                    }(this), this.context.setDefault()
                }, l.prototype.renderLayer = function (t, e, i, r) {
                    i.isHidden(this.transform.zoom) || ("background" === i.type || "custom" === i.type || r.length) && (this.id = i.id, this.gpuTimingStart(i), Br[i.type](t, e, i, r, this.style.placement.variableOffsets), this.gpuTimingEnd())
                }, l.prototype.gpuTimingStart = function (t) {
                    if (this.options.gpuTiming) {
                        var e = this.context.extTimerQuery, i = this.gpuTimers[t.id];
                        i || (i = this.gpuTimers[t.id] = {
                            calls: 0,
                            cpuTime: 0,
                            query: e.createQueryEXT()
                        }), i.calls++, e.beginQueryEXT(e.TIME_ELAPSED_EXT, i.query)
                    }
                }, l.prototype.gpuTimingEnd = function () {
                    if (this.options.gpuTiming) {
                        var t = this.context.extTimerQuery;
                        t.endQueryEXT(t.TIME_ELAPSED_EXT)
                    }
                }, l.prototype.collectGpuTimers = function () {
                    var t = this.gpuTimers;
                    return this.gpuTimers = {}, t
                }, l.prototype.queryGpuTimers = function (t) {
                    var e = {};
                    for (var i in t) {
                        var r = t[i], n = this.context.extTimerQuery,
                            a = n.getQueryObjectEXT(r.query, n.QUERY_RESULT_EXT) / 1e6;
                        n.deleteQueryEXT(r.query), e[i] = a
                    }
                    return e
                }, l.prototype.translatePosMatrix = function (t, e, i, r, n) {
                    if (!i[0] && !i[1]) return t;
                    var a = n ? "map" === r ? this.transform.angle : 0 : "viewport" === r ? -this.transform.angle : 0;
                    if (a) {
                        var o = Math.sin(a), s = Math.cos(a);
                        i = [i[0] * s - i[1] * o, i[0] * o + i[1] * s]
                    }
                    var l = [n ? i[0] : lt(e, i[0], this.transform.zoom), n ? i[1] : lt(e, i[1], this.transform.zoom), 0],
                        u = new Float32Array(16);
                    return ot.translate(u, t, l), u
                }, l.prototype.saveTileTexture = function (t) {
                    var e = this._tileTextures[t.size[0]];
                    e ? e.push(t) : this._tileTextures[t.size[0]] = [t]
                }, l.prototype.getTileTexture = function (t) {
                    var e = this._tileTextures[t];
                    return e && e.length > 0 ? e.pop() : null
                }, l.prototype.isPatternMissing = function (t) {
                    if (!t) return !1;
                    if (!t.from || !t.to) return !0;
                    var e = this.imageManagerFactory.getPattern(t.from.toString()),
                        i = this.imageManagerFactory.getPattern(t.to.toString());
                    return !e || !i
                }, l.prototype.useProgram = function (t, e) {
                    this.cache = this.cache || {};
                    var i = "" + t + (e ? e.cacheKey : "") + (this._showOverdrawInspector ? "/overdraw" : "");
                    return this.cache[i] || (this.cache[i] = new Ni(this.context, t, Oi[t], e, dr[t], this._showOverdrawInspector)), this.cache[i]
                }, l.prototype.setCustomLayerDefaults = function () {
                    this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault()
                }, l.prototype.setBaseState = function () {
                    var t = this.context.gl;
                    this.context.cullFace.set(!1), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(t.FUNC_ADD)
                }, l.prototype.initDebugOverlayCanvas = function () {
                    null == this.debugOverlayCanvas && (this.debugOverlayCanvas = ot.window.document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new ot.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA))
                }, l.prototype.destroy = function () {
                    this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy()
                };
                var Or = function (t, e) {
                    this.points = t, this.planes = e
                };
                Or.fromInvProjectionMatrix = function (e, i, t) {
                    var r = Math.pow(2, t),
                        a = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map(function (t) {
                            return ot.transformMat4([], t, e)
                        }).map(function (t) {
                            return ot.scale$1([], t, 1 / t[3] / i * r)
                        }), n = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map(function (t) {
                            var e = ot.sub([], a[t[0]], a[t[1]]), i = ot.sub([], a[t[2]], a[t[1]]),
                                r = ot.normalize([], ot.cross([], e, i)), n = -ot.dot(r, a[t[1]]);
                            return r.concat(n)
                        });
                    return new Or(a, n)
                };
                var Fr = function (t, e) {
                    this.min = t, this.max = e, this.center = ot.scale$2([], ot.add([], this.min, this.max), .5)
                };
                Fr.prototype.quadrant = function (t) {
                    for (var e = [t % 2 == 0, t < 2], i = ot.clone$2(this.min), r = ot.clone$2(this.max), n = 0; n < e.length; n++) i[n] = e[n] ? this.min[n] : this.center[n], r[n] = e[n] ? this.center[n] : this.max[n];
                    return r[2] = this.max[2], new Fr(i, r)
                }, Fr.prototype.distanceX = function (t) {
                    return Math.max(Math.min(this.max[0], t[0]), this.min[0]) - t[0]
                }, Fr.prototype.distanceY = function (t) {
                    return Math.max(Math.min(this.max[1], t[1]), this.min[1]) - t[1]
                }, Fr.prototype.intersects = function (t) {
                    for (var e = [[this.min[0], this.min[1], 0, 1], [this.max[0], this.min[1], 0, 1], [this.max[0], this.max[1], 0, 1], [this.min[0], this.max[1], 0, 1]], i = !0, r = 0; r < t.planes.length; r++) {
                        for (var n = t.planes[r], a = 0, o = 0; o < e.length; o++) a += ot.dot$1(n, e[o]) >= 0;
                        if (0 === a) return 0;
                        a !== e.length && (i = !1)
                    }
                    if (i) return 2;
                    for (var s = 0; s < 3; s++) {
                        for (var l = Number.MAX_VALUE, u = -Number.MAX_VALUE, h = 0; h < t.points.length; h++) {
                            var c = t.points[h][s] - this.min[s];
                            l = Math.min(l, c), u = Math.max(u, c)
                        }
                        if (u < 0 || l > this.max[s] - this.min[s]) return 0
                    }
                    return 1
                };
                var Ur = function (t, e, i, r) {
                    if (void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === r && (r = 0), isNaN(t) || t < 0 || isNaN(e) || e < 0 || isNaN(i) || i < 0 || isNaN(r) || r < 0) throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
                    this.top = t, this.bottom = e, this.left = i, this.right = r
                };
                Ur.prototype.interpolate = function (t, e, i) {
                    return null != e.top && null != t.top && (this.top = ot.number(t.top, e.top, i)), null != e.bottom && null != t.bottom && (this.bottom = ot.number(t.bottom, e.bottom, i)), null != e.left && null != t.left && (this.left = ot.number(t.left, e.left, i)), null != e.right && null != t.right && (this.right = ot.number(t.right, e.right, i)), this
                }, Ur.prototype.getCenter = function (t, e) {
                    var i = ot.clamp((this.left + t - this.right) / 2, 0, t),
                        r = ot.clamp((this.top + e - this.bottom) / 2, 0, e);
                    return new ot.Point(i, r)
                }, Ur.prototype.equals = function (t) {
                    return this.top === t.top && this.bottom === t.bottom && this.left === t.left && this.right === t.right
                }, Ur.prototype.clone = function () {
                    return new Ur(this.top, this.bottom, this.left, this.right)
                }, Ur.prototype.toJSON = function () {
                    return {top: this.top, bottom: this.bottom, left: this.left, right: this.right}
                };
                var h = function (t, e, i, r, n, a, o) {
                    this.tileSize = 512, this.maxValidLatitude = 85.051129, this._renderWorldCopies = void 0 === n || n, this._minZoom = t || 0, this._maxZoom = e || 22, this._minPitch = null == i ? 0 : i, this._maxPitch = null == r ? 60 : r, this.setMaxBounds(), o && this.setCRS(o), this.width = 0, this.height = 0, this._center = new ot.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = .6435011087932844, this._pitch = 0, this._unmodified = !0, this._edgeInsets = new Ur, this._posMatrixCache = {}, this._alignedPosMatrixCache = {}
                }, u = {
                    minZoom: {configurable: !0},
                    maxZoom: {configurable: !0},
                    minPitch: {configurable: !0},
                    maxPitch: {configurable: !0},
                    renderWorldCopies: {configurable: !0},
                    worldSize: {configurable: !0},
                    centerOffset: {configurable: !0},
                    size: {configurable: !0},
                    bearing: {configurable: !0},
                    pitch: {configurable: !0},
                    fov: {configurable: !0},
                    zoom: {configurable: !0},
                    center: {configurable: !0},
                    padding: {configurable: !0},
                    centerPoint: {configurable: !0},
                    unmodified: {configurable: !0},
                    point: {configurable: !0}
                };
                h.prototype.clone = function () {
                    var t = new h(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies, null, this.crs);
                    return t.tileSize = this.tileSize, t.latRange = this.latRange, t.width = this.width, t.height = this.height, t._center = this._center, t.zoom = this.zoom, t.angle = this.angle, t._fov = this._fov, t._pitch = this._pitch, t._unmodified = this._unmodified, t._edgeInsets = this._edgeInsets.clone(), t._calcMatrices(), t
                }, h.prototype.getCRS = function () {
                    return this.crs
                }, h.prototype.setCRS = function (t) {
                    this.crs = t, this.indexExtent = t.getExtent(), this.worldWidth = this.indexExtent[2] - this.indexExtent[0], this.worldHeight = this.indexExtent[3] - this.indexExtent[1], this.centerX = (this.indexExtent[2] + this.indexExtent[0]) / 2, this.centerY = (this.indexExtent[3] + this.indexExtent[1]) / 2, this.originX = this.indexExtent[0], this.originY = this.indexExtent[3], this.crs.renderWorldCopies = this.renderWorldCopies
                }, u.minZoom.get = function () {
                    return this._minZoom
                }, u.minZoom.set = function (t) {
                    this._minZoom !== t && (this._minZoom = t, this.zoom = Math.max(this.zoom, t))
                }, u.maxZoom.get = function () {
                    return this._maxZoom
                }, u.maxZoom.set = function (t) {
                    this._maxZoom !== t && (this._maxZoom = t, this.zoom = Math.min(this.zoom, t))
                }, u.minPitch.get = function () {
                    return this._minPitch
                }, u.minPitch.set = function (t) {
                    this._minPitch !== t && (this._minPitch = t, this.pitch = Math.max(this.pitch, t))
                }, u.maxPitch.get = function () {
                    return this._maxPitch
                }, u.maxPitch.set = function (t) {
                    this._maxPitch !== t && (this._maxPitch = t, this.pitch = Math.min(this.pitch, t))
                }, u.renderWorldCopies.get = function () {
                    return this._renderWorldCopies
                }, u.renderWorldCopies.set = function (t) {
                    void 0 === t ? t = !0 : null === t && (t = !1), this._renderWorldCopies = t
                }, u.worldSize.get = function () {
                    return this.tileSize * this.scale
                }, u.centerOffset.get = function () {
                    return this.centerPoint._sub(this.size._div(2))
                }, u.size.get = function () {
                    return new ot.Point(this.width, this.height)
                }, u.bearing.get = function () {
                    return -this.angle / Math.PI * 180
                }, u.bearing.set = function (t) {
                    var e = -ot.wrap(t, -180, 180) * Math.PI / 180;
                    this.angle !== e && (this._unmodified = !1, this.angle = e, this._calcMatrices(), this.rotationMatrix = ot.create$2(), ot.rotate(this.rotationMatrix, this.rotationMatrix, this.angle))
                }, u.pitch.get = function () {
                    return this._pitch / Math.PI * 180
                }, u.pitch.set = function (t) {
                    var e = ot.clamp(t, this.minPitch, this.maxPitch) / 180 * Math.PI;
                    this._pitch !== e && (this._unmodified = !1, this._pitch = e, this._calcMatrices())
                }, u.fov.get = function () {
                    return this._fov / Math.PI * 180
                }, u.fov.set = function (t) {
                    t = Math.max(.01, Math.min(60, t)), this._fov !== t && (this._unmodified = !1, this._fov = t / 180 * Math.PI, this._calcMatrices())
                }, u.zoom.get = function () {
                    return this._zoom
                }, u.zoom.set = function (t) {
                    var e = Math.min(Math.max(t, this.minZoom), this.maxZoom);
                    this._zoom !== e && (this._unmodified = !1, this._zoom = e, this.scale = this.zoomScale(e), this.tileZoom = Math.floor(e), this.zoomFraction = e - this.tileZoom, this._constrain(), this._calcMatrices())
                }, u.center.get = function () {
                    return this._center
                }, u.center.set = function (t) {
                    t.lat === this._center.lat && t.lng === this._center.lng || (this._unmodified = !1, this._center = t, this._constrain(), this._calcMatrices())
                }, u.padding.get = function () {
                    return this._edgeInsets.toJSON()
                }, u.padding.set = function (t) {
                    this._edgeInsets.equals(t) || (this._unmodified = !1, this._edgeInsets.interpolate(this._edgeInsets, t, 1), this._calcMatrices())
                }, u.centerPoint.get = function () {
                    return this._edgeInsets.getCenter(this.width, this.height)
                }, h.prototype.isPaddingEqual = function (t) {
                    return this._edgeInsets.equals(t)
                }, h.prototype.interpolatePadding = function (t, e, i) {
                    this._unmodified = !1, this._edgeInsets.interpolate(t, e, i), this._constrain(), this._calcMatrices()
                }, h.prototype.coveringZoomLevel = function (t) {
                    var e = (t.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / t.tileSize));
                    return Math.max(0, e)
                }, h.prototype.getVisibleUnwrappedCoordinates = function (t) {
                    var e = [new ot.UnwrappedTileID(0, t)];
                    if (this._renderWorldCopies) for (var i = this.pointCoordinate(new ot.Point(0, 0)), r = this.pointCoordinate(new ot.Point(this.width, 0)), n = this.pointCoordinate(new ot.Point(this.width, this.height)), a = this.pointCoordinate(new ot.Point(0, this.height)), o = Math.floor(Math.min(i.x, r.x, n.x, a.x)), s = Math.floor(Math.max(i.x, r.x, n.x, a.x)), l = o - 1; l <= s + 1; l++) 0 !== l && e.push(new ot.UnwrappedTileID(l, t));
                    return e
                }, h.prototype.coveringTiles = function (t) {
                    var e = this.coveringZoomLevel(t), i = e;
                    if (void 0 !== t.minzoom && e < t.minzoom) return [];
                    void 0 !== t.maxzoom && e > t.maxzoom && (e = t.maxzoom);
                    var r = this.crs.fromLngLat(this.center), n = Math.pow(2, e), a = [n * r.x, n * r.y, 0],
                        o = Or.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, e), s = t.minzoom || 0;
                    this.pitch <= 60 && this._edgeInsets.top < .1 && (s = e);
                    var l = function (t) {
                        return {
                            aabb: new Fr([t * n, 0, 0], [(t + 1) * n, n, 0]),
                            zoom: 0,
                            x: 0,
                            y: 0,
                            wrap: t,
                            fullyVisible: !1
                        }
                    }, u = [], h = [], c = e, p = t.reparseOverscaled ? i : e;
                    if (this._renderWorldCopies) for (var f = 1; f <= 3; f++) u.push(l(-f)), u.push(l(f));
                    for (u.push(l(0)); u.length > 0;) {
                        var d = u.pop(), m = d.x, y = d.y, g = d.fullyVisible;
                        if (!g) {
                            var _ = d.aabb.intersects(o);
                            if (0 === _) continue;
                            g = 2 === _
                        }
                        var v = d.aabb.distanceX(a), x = d.aabb.distanceY(a), b = Math.max(Math.abs(v), Math.abs(x));
                        if (d.zoom === c || b > 3 + (1 << c - d.zoom) - 2 && d.zoom >= s) h.push({
                            tileID: new ot.OverscaledTileID(d.zoom === c ? p : d.zoom, d.wrap, d.zoom, m, y, this.indexExtent),
                            distanceSq: ot.sqrLen([a[0] - .5 - m, a[1] - .5 - y])
                        }); else for (var w = 0; w < 4; w++) {
                            var M = (m << 1) + w % 2, S = (y << 1) + (w >> 1);
                            u.push({
                                aabb: d.aabb.quadrant(w),
                                zoom: d.zoom + 1,
                                x: M,
                                y: S,
                                wrap: d.wrap,
                                fullyVisible: g
                            })
                        }
                    }
                    return h.sort(function (t, e) {
                        return t.distanceSq - e.distanceSq
                    }).map(function (t) {
                        return t.tileID
                    })
                }, h.prototype.resize = function (t, e) {
                    this.width = t, this.height = e, this.pixelsToGLUnits = [2 / t, -2 / e], this._constrain(), this._calcMatrices()
                }, u.unmodified.get = function () {
                    return this._unmodified
                }, h.prototype.zoomScale = function (t) {
                    return Math.pow(2, t)
                }, h.prototype.scaleZoom = function (t) {
                    return Math.log(t) / Math.LN2
                }, h.prototype.project = function (t) {
                    var e = this.latRange ? ot.clamp(t.lat, -this.maxValidLatitude, this.maxValidLatitude) : t.lat,
                        i = this.lngLatXY(t.lng, e);
                    return new ot.Point(i[0], i[1])
                }, h.prototype.unproject = function (t) {
                    var e = this.xYLngLat(t.x, t.y);
                    return new ot.LngLat(e[0], e[1])
                }, u.point.get = function () {
                    return this.project(this.center)
                }, h.prototype.lngLatXY = function (t, e) {
                    var i = this.crs.fromWGS84([t, e]);
                    return [(i[0] - this.originX) * this.worldSize / this.worldWidth, (this.originY - i[1]) * this.worldSize / this.worldHeight]
                }, h.prototype.lngX = function (t) {
                    return this.lngLatXY(t, this.center.lat)[0]
                }, h.prototype.latY = function (t) {
                    return this.lngLatXY(this.center.lng, t)[1]
                }, h.prototype.xYLngLat = function (t, e) {
                    return this.crs.toWGS84([t * this.worldWidth / this.worldSize + this.originX, this.originY - e * this.worldHeight / this.worldSize])
                }, h.prototype.xLng = function (t) {
                    var e = this.center, i = this.lngLatXY(e.lng, e.lat);
                    return this.xYLngLat(t, i[1])[0]
                }, h.prototype.yLat = function (t) {
                    var e = this.center, i = this.lngLatXY(e.lng, e.lat);
                    return this.xYLngLat(i[0], t)[1]
                }, h.prototype.setLocationAtPoint = function (t, e) {
                    var i = this.pointCoordinate(e), r = this.pointCoordinate(this.centerPoint),
                        n = this.locationCoordinate(t),
                        a = new ot.MercatorCoordinate(n.x - (i.x - r.x), n.y - (i.y - r.y));
                    this.center = this.coordinateLocation(a), this._renderWorldCopies && (this.center = this.center.wrap())
                }, h.prototype.locationPoint = function (t) {
                    return this.coordinatePoint(this.locationCoordinate(t))
                }, h.prototype.pointLocation = function (t) {
                    return this.coordinateLocation(this.pointCoordinate(t))
                }, h.prototype.locationCoordinate = function (t) {
                    return this.crs.fromLngLat(t)
                }, h.prototype.coordinateLocation = function (t) {
                    return this.crs.toLngLat(t.x, t.y)
                }, h.prototype.pointCoordinate = function (t) {
                    var e = [t.x, t.y, 0, 1], i = [t.x, t.y, 1, 1];
                    ot.transformMat4(e, e, this.pixelMatrixInverse), ot.transformMat4(i, i, this.pixelMatrixInverse);
                    var r = e[3], n = i[3], a = e[1] / r, o = i[1] / n, s = e[2] / r, l = i[2] / n,
                        u = s === l ? 0 : (0 - s) / (l - s);
                    return new ot.MercatorCoordinate(ot.number(e[0] / r, i[0] / n, u) / this.worldSize, ot.number(a, o, u) / this.worldSize)
                }, h.prototype.coordinatePoint = function (t) {
                    var e = [t.x * this.worldSize, t.y * this.worldSize, 0, 1];
                    return ot.transformMat4(e, e, this.pixelMatrix), new ot.Point(e[0] / e[3], e[1] / e[3])
                }, h.prototype.getBounds = function () {
                    return (new ot.LngLatBounds).extend(this.pointLocation(new ot.Point(0, 0))).extend(this.pointLocation(new ot.Point(this.width, 0))).extend(this.pointLocation(new ot.Point(this.width, this.height))).extend(this.pointLocation(new ot.Point(0, this.height)))
                }, h.prototype.getMaxBounds = function () {
                    return this.latRange && 2 === this.latRange.length && this.lngRange && 2 === this.lngRange.length ? new ot.LngLatBounds([this.lngRange[0], this.latRange[0]], [this.lngRange[1], this.latRange[1]]) : null
                }, h.prototype.setMaxBounds = function (t) {
                    t ? (this.lngRange = [t.getWest(), t.getEast()], this.latRange = [t.getSouth(), t.getNorth()], this._constrain()) : (this.lngRange = null, this.latRange = [-this.maxValidLatitude, this.maxValidLatitude])
                }, h.prototype.calculatePosMatrix = function (t, e) {
                    void 0 === e && (e = !1);
                    var i = t.key, r = e ? this._alignedPosMatrixCache : this._posMatrixCache;
                    if (r[i]) return r[i];
                    var n = t.canonical, a = this.worldSize / this.zoomScale(n.z), o = n.x + Math.pow(2, n.z) * t.wrap,
                        s = ot.identity(new Float64Array(16));
                    return ot.translate(s, s, [o * a, n.y * a, 0]), ot.scale(s, s, [a / ot.EXTENT, a / ot.EXTENT, 1]), ot.multiply(s, e ? this.alignedProjMatrix : this.projMatrix, s), r[i] = new Float32Array(s), r[i]
                }, h.prototype.customLayerMatrix = function () {
                    return this.mercatorMatrix.slice()
                }, h.prototype._constrain = function () {
                    if (this.center && this.width && this.height && !this._constraining) {
                        this._constraining = !0;
                        var t, e, i, r, n = -90, a = 90, o = -180, s = 180, l = this.size, u = this._unmodified;
                        if (this.latRange) {
                            var h = this.latRange;
                            n = this.latY(h[1]), t = (a = this.latY(h[0])) - n < l.y ? l.y / (a - n) : 0
                        }
                        if (this.lngRange) {
                            var c = this.lngRange;
                            o = this.lngX(c[0]), e = (s = this.lngX(c[1])) - o < l.x ? l.x / (s - o) : 0
                        }
                        var p = this.point, f = Math.max(e || 0, t || 0);
                        if (f) return this.center = this.unproject(new ot.Point(e ? (s + o) / 2 : p.x, t ? (a + n) / 2 : p.y)), this.zoom += this.scaleZoom(f), this._unmodified = u, void (this._constraining = !1);
                        if (this.latRange) {
                            var d = p.y, m = l.y / 2;
                            d - m < n && (r = n + m), d + m > a && (r = a - m)
                        }
                        if (this.lngRange) {
                            var y = p.x, g = l.x / 2;
                            y - g < o && (i = o + g), y + g > s && (i = s - g)
                        }
                        void 0 === i && void 0 === r || (this.center = this.unproject(new ot.Point(void 0 !== i ? i : p.x, void 0 !== r ? r : p.y))), this._unmodified = u, this._constraining = !1
                    }
                }, h.prototype._calcMatrices = function () {
                    if (this.height) {
                        var t = this.centerOffset;
                        this.cameraToCenterDistance = .5 / Math.tan(this._fov / 2) * this.height;
                        var e = Math.PI / 2 + this._pitch, i = this._fov * (.5 + t.y / this.height),
                            r = Math.sin(i) * this.cameraToCenterDistance / Math.sin(ot.clamp(Math.PI - e - i, .01, Math.PI - .01)),
                            n = this.point, a = n.x, o = n.y,
                            s = 1.01 * (Math.cos(Math.PI / 2 - this._pitch) * r + this.cameraToCenterDistance),
                            l = this.height / 50, u = new Float64Array(16);
                        ot.perspective(u, this._fov, this.width / this.height, l, s), u[8] = 2 * -t.x / this.width, u[9] = 2 * t.y / this.height, ot.scale(u, u, [1, -1, 1]), ot.translate(u, u, [0, 0, -this.cameraToCenterDistance]), ot.rotateX(u, u, this._pitch), ot.rotateZ(u, u, this.angle), ot.translate(u, u, [-a, -o, 0]), this.mercatorMatrix = ot.scale([], u, [this.worldSize, this.worldSize, this.worldSize]);
                        var h = this.worldSize / (2 * Math.PI * 6378137 * Math.abs(Math.cos(this.center.lat * (Math.PI / 180))));
                        "m" !== this.units && "meter" !== this.units || (h = this.crs ? this.worldSize / (this.crs.extent[3] - this.crs.extent[1]) : this.worldSize / (this.latRange[1] - this.latRange[0])), ot.scale(u, u, [1, 1, h, 1]), this.projMatrix = u, this.invProjMatrix = ot.invert([], this.projMatrix);
                        var c = this.width % 2 / 2, p = this.height % 2 / 2, f = Math.cos(this.angle),
                            d = Math.sin(this.angle), m = a - Math.round(a) + f * c + d * p,
                            y = o - Math.round(o) + f * p + d * c, g = new Float64Array(u);
                        if (ot.translate(g, g, [m > .5 ? m - 1 : m, y > .5 ? y - 1 : y, 0]), this.alignedProjMatrix = g, u = ot.create(), ot.scale(u, u, [this.width / 2, -this.height / 2, 1]), ot.translate(u, u, [1, -1, 0]), this.labelPlaneMatrix = u, u = ot.create(), ot.scale(u, u, [1, -1, 1]), ot.translate(u, u, [-1, -1, 0]), ot.scale(u, u, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = u, this.pixelMatrix = ot.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), !(u = ot.invert(new Float64Array(16), this.pixelMatrix))) throw new Error("failed to invert matrix");
                        this.pixelMatrixInverse = u, this._posMatrixCache = {}, this._alignedPosMatrixCache = {}
                    }
                }, h.prototype.maxPitchScaleFactor = function () {
                    if (!this.pixelMatrixInverse) return 1;
                    var t = this.pointCoordinate(new ot.Point(0, 0)),
                        e = [t.x * this.worldSize, t.y * this.worldSize, 0, 1];
                    return ot.transformMat4(e, e, this.pixelMatrix)[3] / this.cameraToCenterDistance
                }, h.prototype.getCameraPoint = function () {
                    var t = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
                    return this.centerPoint.add(new ot.Point(0, t))
                }, h.prototype.getCameraQueryGeometry = function (t) {
                    var e = this.getCameraPoint();
                    if (1 === t.length) return [t[0], e];
                    for (var i = e.x, r = e.y, n = e.x, a = e.y, o = 0, s = t; o < s.length; o += 1) {
                        var l = s[o];
                        i = Math.min(i, l.x), r = Math.min(r, l.y), n = Math.max(n, l.x), a = Math.max(a, l.y)
                    }
                    return [new ot.Point(i, r), new ot.Point(n, r), new ot.Point(n, a), new ot.Point(i, a), new ot.Point(i, r)]
                }, Object.defineProperties(h.prototype, u);
                var Nr = function (t) {
                    var e, i, r, n;
                    this._hashName = t && encodeURIComponent(t), ot.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = (e = this._updateHashUnthrottled.bind(this), i = !1, r = null, n = function () {
                        r = null, i && (e(), r = setTimeout(n, 300), i = !1)
                    }, function () {
                        return i = !0, r || n(), r
                    })
                };
                Nr.prototype.addTo = function (t) {
                    return this._map = t, ot.window.addEventListener("hashchange", this._onHashChange, !1), this._map.on("moveend", this._updateHash), this
                }, Nr.prototype.remove = function () {
                    return ot.window.removeEventListener("hashchange", this._onHashChange, !1), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this
                }, Nr.prototype.getHashString = function (t) {
                    var e = this._map.getCenter(), i = Math.round(100 * this._map.getZoom()) / 100,
                        r = Math.ceil((i * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10), n = Math.pow(10, r),
                        a = Math.round(e.lng * n) / n, o = Math.round(e.lat * n) / n, s = this._map.getBearing(),
                        l = this._map.getPitch(), u = "";
                    if (u += t ? "/" + a + "/" + o + "/" + i : i + "/" + o + "/" + a, (s || l) && (u += "/" + Math.round(10 * s) / 10), l && (u += "/" + Math.round(l)), this._hashName) {
                        var h = this._hashName, c = !1,
                            p = ot.window.location.hash.slice(1).split("&").map(function (t) {
                                var e = t.split("=")[0];
                                return e === h ? (c = !0, e + "=" + u) : t
                            }).filter(function (t) {
                                return t
                            });
                        return c || p.push(h + "=" + u), "#" + p.join("&")
                    }
                    return "#" + u
                }, Nr.prototype._getCurrentHash = function () {
                    var e, i = this, t = ot.window.location.hash.replace("#", "");
                    return this._hashName ? (t.split("&").map(function (t) {
                        return t.split("=")
                    }).forEach(function (t) {
                        t[0] === i._hashName && (e = t)
                    }), (e && e[1] || "").split("/")) : t.split("/")
                }, Nr.prototype._onHashChange = function () {
                    var t = this._getCurrentHash();
                    if (t.length >= 3 && !t.some(function (t) {
                        return isNaN(t)
                    })) {
                        var e = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(t[3] || 0) : this._map.getBearing();
                        return this._map.jumpTo({
                            center: [+t[2], +t[1]],
                            zoom: +t[0],
                            bearing: e,
                            pitch: +(t[4] || 0)
                        }), !0
                    }
                    return !1
                }, Nr.prototype._updateHashUnthrottled = function () {
                    var t = this.getHashString();
                    try {
                        ot.window.history.replaceState(ot.window.history.state, "", t)
                    } catch (t) {
                    }
                };
                var Vr = {linearity: .3, easing: ot.bezier(0, 0, .3, 1)},
                    jr = ot.extend({deceleration: 2500, maxSpeed: 1400}, Vr),
                    qr = ot.extend({deceleration: 20, maxSpeed: 1400}, Vr),
                    Gr = ot.extend({deceleration: 1e3, maxSpeed: 360}, Vr),
                    Zr = ot.extend({deceleration: 1e3, maxSpeed: 90}, Vr), Wr = function (t) {
                        this._map = t, this.clear()
                    };

                function Xr(t, e) {
                    (!t.duration || t.duration < e.duration) && (t.duration = e.duration, t.easing = e.easing)
                }

                function Hr(t, e, i) {
                    var r = i.maxSpeed, n = i.linearity, a = i.deceleration, o = ot.clamp(t * n / (e / 1e3), -r, r),
                        s = Math.abs(o) / (a * n);
                    return {easing: i.easing, duration: 1e3 * s, amount: o * (s / 2)}
                }

                Wr.prototype.clear = function () {
                    this._inertiaBuffer = []
                }, Wr.prototype.record = function (t) {
                    this._drainInertiaBuffer(), this._inertiaBuffer.push({time: ot.browser.now(), settings: t})
                }, Wr.prototype._drainInertiaBuffer = function () {
                    for (var t = this._inertiaBuffer, e = ot.browser.now(); t.length > 0 && e - t[0].time > 160;) t.shift()
                }, Wr.prototype._onMoveEnd = function (t) {
                    if (this._drainInertiaBuffer(), !(this._inertiaBuffer.length < 2)) {
                        for (var e = {
                            zoom: 0,
                            bearing: 0,
                            pitch: 0,
                            pan: new ot.Point(0, 0),
                            pinchAround: void 0,
                            around: void 0
                        }, i = 0, r = this._inertiaBuffer; i < r.length; i += 1) {
                            var n = r[i].settings;
                            e.zoom += n.zoomDelta || 0, e.bearing += n.bearingDelta || 0, e.pitch += n.pitchDelta || 0, n.panDelta && e.pan._add(n.panDelta), n.around && (e.around = n.around), n.pinchAround && (e.pinchAround = n.pinchAround)
                        }
                        var a = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time,
                            o = {};
                        if (e.pan.mag()) {
                            var s = Hr(e.pan.mag(), a, ot.extend({}, jr, t || {}));
                            o.offset = e.pan.mult(s.amount / e.pan.mag()), o.center = this._map.transform.center, Xr(o, s)
                        }
                        if (e.zoom) {
                            var l = Hr(e.zoom, a, qr);
                            o.zoom = this._map.transform.zoom + l.amount, Xr(o, l)
                        }
                        if (e.bearing) {
                            var u = Hr(e.bearing, a, Gr);
                            o.bearing = this._map.transform.bearing + ot.clamp(u.amount, -179, 179), Xr(o, u)
                        }
                        if (e.pitch) {
                            var h = Hr(e.pitch, a, Zr);
                            o.pitch = this._map.transform.pitch + h.amount, Xr(o, h)
                        }
                        if (o.zoom || o.bearing) {
                            var c = void 0 === e.pinchAround ? e.around : e.pinchAround;
                            o.around = c ? this._map.unproject(c) : this._map.getCenter()
                        }
                        return this.clear(), ot.extend(o, {noMoveStart: !0})
                    }
                };
                var c = function (o) {
                    function t(t, e, i, r) {
                        void 0 === r && (r = {});
                        var n = x.mousePos(e.getCanvasContainer(), i), a = e.unproject(n);
                        o.call(this, t, ot.extend({
                            point: n,
                            lngLat: a,
                            originalEvent: i
                        }, r)), this._defaultPrevented = !1, this.target = e
                    }

                    o && (t.__proto__ = o), (t.prototype = Object.create(o && o.prototype)).constructor = t;
                    var e = {defaultPrevented: {configurable: !0}};
                    return t.prototype.preventDefault = function () {
                        this._defaultPrevented = !0
                    }, e.defaultPrevented.get = function () {
                        return this._defaultPrevented
                    }, Object.defineProperties(t.prototype, e), t
                }(ot.Event), Kr = function (l) {
                    function t(t, e, i) {
                        var r = "touchend" === t ? i.changedTouches : i.touches,
                            n = x.touchPos(e.getCanvasContainer(), r), a = n.map(function (t) {
                                return e.unproject(t)
                            }), o = n.reduce(function (t, e, i, r) {
                                return t.add(e.div(r.length))
                            }, new ot.Point(0, 0)), s = e.unproject(o);
                        l.call(this, t, {
                            points: n,
                            point: o,
                            lngLats: a,
                            lngLat: s,
                            originalEvent: i
                        }), this._defaultPrevented = !1
                    }

                    l && (t.__proto__ = l), (t.prototype = Object.create(l && l.prototype)).constructor = t;
                    var e = {defaultPrevented: {configurable: !0}};
                    return t.prototype.preventDefault = function () {
                        this._defaultPrevented = !0
                    }, e.defaultPrevented.get = function () {
                        return this._defaultPrevented
                    }, Object.defineProperties(t.prototype, e), t
                }(ot.Event), Yr = function (r) {
                    function t(t, e, i) {
                        r.call(this, t, {originalEvent: i}), this._defaultPrevented = !1
                    }

                    r && (t.__proto__ = r), (t.prototype = Object.create(r && r.prototype)).constructor = t;
                    var e = {defaultPrevented: {configurable: !0}};
                    return t.prototype.preventDefault = function () {
                        this._defaultPrevented = !0
                    }, e.defaultPrevented.get = function () {
                        return this._defaultPrevented
                    }, Object.defineProperties(t.prototype, e), t
                }(ot.Event), v = function (t, e) {
                    this._map = t, this._clickTolerance = e.clickTolerance
                };
                v.prototype.reset = function () {
                    delete this._mousedownPos
                }, v.prototype.wheel = function (t) {
                    return this._firePreventable(new Yr(t.type, this._map, t))
                }, v.prototype.mousedown = function (t, e) {
                    return this._mousedownPos = e, this._firePreventable(new c(t.type, this._map, t))
                }, v.prototype.mouseup = function (t) {
                    this._map.fire(new c(t.type, this._map, t))
                }, v.prototype.click = function (t, e) {
                    this._mousedownPos && this._mousedownPos.dist(e) >= this._clickTolerance || this._map.fire(new c(t.type, this._map, t))
                }, v.prototype.dblclick = function (t) {
                    return this._firePreventable(new c(t.type, this._map, t))
                }, v.prototype.mouseover = function (t) {
                    this._map.fire(new c(t.type, this._map, t))
                }, v.prototype.mouseout = function (t) {
                    this._map.fire(new c(t.type, this._map, t))
                }, v.prototype.touchstart = function (t) {
                    return this._firePreventable(new Kr(t.type, this._map, t))
                }, v.prototype.touchmove = function (t) {
                    this._map.fire(new Kr(t.type, this._map, t))
                }, v.prototype.touchend = function (t) {
                    this._map.fire(new Kr(t.type, this._map, t))
                }, v.prototype.touchcancel = function (t) {
                    this._map.fire(new Kr(t.type, this._map, t))
                }, v.prototype._firePreventable = function (t) {
                    if (this._map.fire(t), t.defaultPrevented) return {}
                }, v.prototype.isEnabled = function () {
                    return !0
                }, v.prototype.isActive = function () {
                    return !1
                }, v.prototype.enable = function () {
                }, v.prototype.disable = function () {
                };
                var b = function (t) {
                    this._map = t
                };
                b.prototype.reset = function () {
                    this._delayContextMenu = !1, delete this._contextMenuEvent
                }, b.prototype.mousemove = function (t) {
                    this._map.fire(new c(t.type, this._map, t))
                }, b.prototype.mousedown = function () {
                    this._delayContextMenu = !0
                }, b.prototype.mouseup = function () {
                    this._delayContextMenu = !1, this._contextMenuEvent && (this._map.fire(new c("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent)
                }, b.prototype.contextmenu = function (t) {
                    this._delayContextMenu ? this._contextMenuEvent = t : this._map.fire(new c(t.type, this._map, t)), this._map.listens("contextmenu") && t.preventDefault()
                }, b.prototype.isEnabled = function () {
                    return !0
                }, b.prototype.isActive = function () {
                    return !1
                }, b.prototype.enable = function () {
                }, b.prototype.disable = function () {
                };
                var w = function (t, e) {
                    this._map = t, this._el = t.getCanvasContainer(), this._container = t.getContainer(), this._clickTolerance = e.clickTolerance || 1
                };

                function Jr(t, e) {
                    for (var i = {}, r = 0; r < t.length; r++) i[t[r].identifier] = e[r];
                    return i
                }

                w.prototype.isEnabled = function () {
                    return !!this._enabled
                }, w.prototype.isActive = function () {
                    return !!this._active
                }, w.prototype.enable = function () {
                    this.isEnabled() || (this._enabled = !0)
                }, w.prototype.disable = function () {
                    this.isEnabled() && (this._enabled = !1)
                }, w.prototype.mousedown = function (t, e) {
                    this.isEnabled() && t.shiftKey && 0 === t.button && (x.disableDrag(), this._startPos = this._lastPos = e, this._active = !0)
                }, w.prototype.mousemoveWindow = function (t, e) {
                    if (this._active) {
                        var i = e;
                        if (!(this._lastPos.equals(i) || !this._box && i.dist(this._startPos) < this._clickTolerance)) {
                            var r = this._startPos;
                            this._lastPos = i, this._box || (this._box = x.create("div", "mapboxgl-boxzoom", this._container), this._container.classList.add("mapboxgl-crosshair"), this._fireEvent("boxzoomstart", t));
                            var n = Math.min(r.x, i.x), a = Math.max(r.x, i.x), o = Math.min(r.y, i.y),
                                s = Math.max(r.y, i.y);
                            x.setTransform(this._box, "translate(" + n + "px," + o + "px)"), this._box.style.width = a - n + "px", this._box.style.height = s - o + "px"
                        }
                    }
                }, w.prototype.mouseupWindow = function (t, e) {
                    var i = this;
                    if (this._active && 0 === t.button) {
                        var r = this._startPos, n = e;
                        if (this.reset(), x.suppressClick(), r.x !== n.x || r.y !== n.y) return this._map.fire(new ot.Event("boxzoomend", {originalEvent: t})), {
                            cameraAnimation: function (t) {
                                return t.fitScreenCoordinates(r, n, i._map.getBearing(), {linear: !0})
                            }
                        };
                        this._fireEvent("boxzoomcancel", t)
                    }
                }, w.prototype.keydown = function (t) {
                    this._active && 27 === t.keyCode && (this.reset(), this._fireEvent("boxzoomcancel", t))
                }, w.prototype.reset = function () {
                    this._active = !1, this._container.classList.remove("mapboxgl-crosshair"), this._box && (x.remove(this._box), this._box = null), x.enableDrag(), delete this._startPos, delete this._lastPos
                }, w.prototype._fireEvent = function (t, e) {
                    return this._map.fire(new ot.Event(t, {originalEvent: e}))
                };
                var Qr = function (t) {
                    this.reset(), this.numTouches = t.numTouches
                };
                Qr.prototype.reset = function () {
                    delete this.centroid, delete this.startTime, delete this.touches, this.aborted = !1
                }, Qr.prototype.touchstart = function (t, e, i) {
                    (this.centroid || i.length > this.numTouches) && (this.aborted = !0), this.aborted || (void 0 === this.startTime && (this.startTime = t.timeStamp), i.length === this.numTouches && (this.centroid = function (t) {
                        for (var e = new ot.Point(0, 0), i = 0, r = t; i < r.length; i += 1) e._add(r[i]);
                        return e.div(t.length)
                    }(e), this.touches = Jr(i, e)))
                }, Qr.prototype.touchmove = function (t, e, i) {
                    if (!this.aborted && this.centroid) {
                        var r = Jr(i, e);
                        for (var n in this.touches) {
                            var a = r[n];
                            (!a || a.dist(this.touches[n]) > 30) && (this.aborted = !0)
                        }
                    }
                }, Qr.prototype.touchend = function (t, e, i) {
                    if ((!this.centroid || t.timeStamp - this.startTime > 500) && (this.aborted = !0), 0 === i.length) {
                        var r = !this.aborted && this.centroid;
                        if (this.reset(), r) return r
                    }
                };
                var $r = function (t) {
                    this.singleTap = new Qr(t), this.numTaps = t.numTaps, this.reset()
                };
                $r.prototype.reset = function () {
                    this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset()
                }, $r.prototype.touchstart = function (t, e, i) {
                    this.singleTap.touchstart(t, e, i)
                }, $r.prototype.touchmove = function (t, e, i) {
                    this.singleTap.touchmove(t, e, i)
                }, $r.prototype.touchend = function (t, e, i) {
                    var r = this.singleTap.touchend(t, e, i);
                    if (r) {
                        var n = t.timeStamp - this.lastTime < 500, a = !this.lastTap || this.lastTap.dist(r) < 30;
                        if (n && a || this.reset(), this.count++, this.lastTime = t.timeStamp, this.lastTap = r, this.count === this.numTaps) return this.reset(), r
                    }
                };
                var M = function () {
                    this._zoomIn = new $r({numTouches: 1, numTaps: 2}), this._zoomOut = new $r({
                        numTouches: 2,
                        numTaps: 1
                    }), this.reset()
                };
                M.prototype.reset = function () {
                    this._active = !1, this._zoomIn.reset(), this._zoomOut.reset()
                }, M.prototype.touchstart = function (t, e, i) {
                    this._zoomIn.touchstart(t, e, i), this._zoomOut.touchstart(t, e, i)
                }, M.prototype.touchmove = function (t, e, i) {
                    this._zoomIn.touchmove(t, e, i), this._zoomOut.touchmove(t, e, i)
                }, M.prototype.touchend = function (e, t, i) {
                    var r = this, n = this._zoomIn.touchend(e, t, i), a = this._zoomOut.touchend(e, t, i);
                    return n ? (this._active = !0, e.preventDefault(), setTimeout(function () {
                        return r.reset()
                    }, 0), {
                        cameraAnimation: function (t) {
                            return t.easeTo({
                                duration: 300,
                                zoom: t.getZoom() + 1,
                                around: t.unproject(n)
                            }, {originalEvent: e})
                        }
                    }) : a ? (this._active = !0, e.preventDefault(), setTimeout(function () {
                        return r.reset()
                    }, 0), {
                        cameraAnimation: function (t) {
                            return t.easeTo({
                                duration: 300,
                                zoom: t.getZoom() - 1,
                                around: t.unproject(a)
                            }, {originalEvent: e})
                        }
                    }) : void 0
                }, M.prototype.touchcancel = function () {
                    this.reset()
                }, M.prototype.enable = function () {
                    this._enabled = !0
                }, M.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, M.prototype.isEnabled = function () {
                    return this._enabled
                }, M.prototype.isActive = function () {
                    return this._active
                };
                var tn = {0: 1, 2: 2}, p = function (t) {
                    this.reset(), this._clickTolerance = t.clickTolerance || 1
                };
                p.prototype.reset = function () {
                    this._active = !1, this._moved = !1, delete this._lastPoint, delete this._eventButton
                }, p.prototype._correctButton = function (t, e) {
                    return !1
                }, p.prototype._move = function (t, e) {
                    return {}
                }, p.prototype.mousedown = function (t, e) {
                    if (!this._lastPoint) {
                        var i = x.mouseButton(t);
                        this._correctButton(t, i) && (this._lastPoint = e, this._eventButton = i)
                    }
                }, p.prototype.mousemoveWindow = function (t, e) {
                    var i = this._lastPoint;
                    if (i) if (t.preventDefault(), function (t, e) {
                        var i = tn[e];
                        return void 0 === t.buttons || (t.buttons & i) !== i
                    }(t, this._eventButton)) this.reset(); else if (this._moved || !(e.dist(i) < this._clickTolerance)) return this._moved = !0, this._lastPoint = e, this._move(i, e)
                }, p.prototype.mouseupWindow = function (t) {
                    this._lastPoint && x.mouseButton(t) === this._eventButton && (this._moved && x.suppressClick(), this.reset())
                }, p.prototype.enable = function () {
                    this._enabled = !0
                }, p.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, p.prototype.isEnabled = function () {
                    return this._enabled
                }, p.prototype.isActive = function () {
                    return this._active
                };
                var en = function (i) {
                    function t() {
                        i.apply(this, arguments)
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.mousedown = function (t, e) {
                        i.prototype.mousedown.call(this, t, e), this._lastPoint && (this._active = !0)
                    }, t.prototype._correctButton = function (t, e) {
                        return 0 === e && !t.ctrlKey
                    }, t.prototype._move = function (t, e) {
                        return {around: e, panDelta: e.sub(t)}
                    }, t
                }(p), rn = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._correctButton = function (t, e) {
                        return 0 === e && t.ctrlKey || 2 === e
                    }, e.prototype._move = function (t, e) {
                        var i = .8 * (e.x - t.x);
                        if (i) return this._active = !0, {bearingDelta: i}
                    }, e.prototype.contextmenu = function (t) {
                        t.preventDefault()
                    }, e
                }(p), nn = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._correctButton = function (t, e) {
                        return 0 === e && t.ctrlKey || 2 === e
                    }, e.prototype._move = function (t, e) {
                        var i = -.5 * (e.y - t.y);
                        if (i) return this._active = !0, {pitchDelta: i}
                    }, e.prototype.contextmenu = function (t) {
                        t.preventDefault()
                    }, e
                }(p), S = function (t) {
                    this._minTouches = 1, this._clickTolerance = t.clickTolerance || 1, this.reset()
                };
                S.prototype.reset = function () {
                    this._active = !1, this._touches = {}, this._sum = new ot.Point(0, 0)
                }, S.prototype.touchstart = function (t, e, i) {
                    return this._calculateTransform(t, e, i)
                }, S.prototype.touchmove = function (t, e, i) {
                    if (this._active && !(i.length < this._minTouches)) return t.preventDefault(), this._calculateTransform(t, e, i)
                }, S.prototype.touchend = function (t, e, i) {
                    this._calculateTransform(t, e, i), this._active && i.length < this._minTouches && this.reset()
                }, S.prototype.touchcancel = function () {
                    this.reset()
                }, S.prototype._calculateTransform = function (t, e, i) {
                    i.length > 0 && (this._active = !0);
                    var r = Jr(i, e), n = new ot.Point(0, 0), a = new ot.Point(0, 0), o = 0;
                    for (var s in r) {
                        var l = r[s], u = this._touches[s];
                        u && (n._add(l), a._add(l.sub(u)), o++, r[s] = l)
                    }
                    if (this._touches = r, !(o < this._minTouches) && a.mag()) {
                        var h = a.div(o);
                        if (this._sum._add(h), !(this._sum.mag() < this._clickTolerance)) return {
                            around: n.div(o),
                            panDelta: h
                        }
                    }
                }, S.prototype.enable = function () {
                    this._enabled = !0
                }, S.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, S.prototype.isEnabled = function () {
                    return this._enabled
                }, S.prototype.isActive = function () {
                    return this._active
                };
                var d = function () {
                    this.reset()
                };

                function an(t, e, i) {
                    for (var r = 0; r < t.length; r++) if (t[r].identifier === i) return e[r]
                }

                function on(t, e) {
                    return Math.log(t / e) / Math.LN2
                }

                d.prototype.reset = function () {
                    this._active = !1, delete this._firstTwoTouches
                }, d.prototype._start = function (t) {
                }, d.prototype._move = function (t, e, i) {
                    return {}
                }, d.prototype.touchstart = function (t, e, i) {
                    this._firstTwoTouches || i.length < 2 || (this._firstTwoTouches = [i[0].identifier, i[1].identifier], this._start([e[0], e[1]]))
                }, d.prototype.touchmove = function (t, e, i) {
                    if (this._firstTwoTouches) {
                        t.preventDefault();
                        var r = this._firstTwoTouches, n = r[1], a = an(i, e, r[0]), o = an(i, e, n);
                        if (a && o) {
                            var s = this._aroundCenter ? null : a.add(o).div(2);
                            return this._move([a, o], s, t)
                        }
                    }
                }, d.prototype.touchend = function (t, e, i) {
                    if (this._firstTwoTouches) {
                        var r = this._firstTwoTouches, n = r[1], a = an(i, e, r[0]), o = an(i, e, n);
                        a && o || (this._active && x.suppressClick(), this.reset())
                    }
                }, d.prototype.touchcancel = function () {
                    this.reset()
                }, d.prototype.enable = function (t) {
                    this._enabled = !0, this._aroundCenter = !!t && "center" === t.around
                }, d.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, d.prototype.isEnabled = function () {
                    return this._enabled
                }, d.prototype.isActive = function () {
                    return this._active
                };
                var sn = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                        t.prototype.reset.call(this), delete this._distance, delete this._startDistance
                    }, e.prototype._start = function (t) {
                        this._startDistance = this._distance = t[0].dist(t[1])
                    }, e.prototype._move = function (t, e) {
                        var i = this._distance;
                        if (this._distance = t[0].dist(t[1]), this._active || !(Math.abs(on(this._distance, this._startDistance)) < .1)) return this._active = !0, {
                            zoomDelta: on(this._distance, i),
                            pinchAround: e
                        }
                    }, e
                }(d);

                function ln(t, e) {
                    return 180 * t.angleWith(e) / Math.PI
                }

                var un = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                        t.prototype.reset.call(this), delete this._minDiameter, delete this._startVector, delete this._vector
                    }, e.prototype._start = function (t) {
                        this._startVector = this._vector = t[0].sub(t[1]), this._minDiameter = t[0].dist(t[1])
                    }, e.prototype._move = function (t, e) {
                        var i = this._vector;
                        if (this._vector = t[0].sub(t[1]), this._active || !this._isBelowThreshold(this._vector)) return this._active = !0, {
                            bearingDelta: ln(this._vector, i),
                            pinchAround: e
                        }
                    }, e.prototype._isBelowThreshold = function (t) {
                        this._minDiameter = Math.min(this._minDiameter, t.mag());
                        var e = 25 / (Math.PI * this._minDiameter) * 360, i = ln(t, this._startVector);
                        return Math.abs(i) < e
                    }, e
                }(d);

                function hn(t) {
                    return Math.abs(t.y) > Math.abs(t.x)
                }

                var cn = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                        t.prototype.reset.call(this), this._valid = void 0, delete this._firstMove, delete this._lastPoints
                    }, e.prototype._start = function (t) {
                        this._lastPoints = t, hn(t[0].sub(t[1])) && (this._valid = !1)
                    }, e.prototype._move = function (t, e, i) {
                        var r = t[0].sub(this._lastPoints[0]), n = t[1].sub(this._lastPoints[1]);
                        if (this._valid = this.gestureBeginsVertically(r, n, i.timeStamp), this._valid) return this._lastPoints = t, this._active = !0, {pitchDelta: (r.y + n.y) / 2 * -.5}
                    }, e.prototype.gestureBeginsVertically = function (t, e, i) {
                        if (void 0 !== this._valid) return this._valid;
                        var r = t.mag() >= 2, n = e.mag() >= 2;
                        if (r || n) {
                            if (!r || !n) return void 0 === this._firstMove && (this._firstMove = i), i - this._firstMove < 100 && void 0;
                            var a = t.y > 0 == e.y > 0;
                            return hn(t) && hn(e) && a
                        }
                    }, e
                }(d), pn = {panStep: 100, bearingStep: 15, pitchStep: 10}, fn = function () {
                    var t = pn;
                    this._panStep = t.panStep, this._bearingStep = t.bearingStep, this._pitchStep = t.pitchStep
                };

                function dn(t) {
                    return t * (2 - t)
                }

                fn.prototype.reset = function () {
                    this._active = !1
                }, fn.prototype.keydown = function (i) {
                    var r = this;
                    if (!(i.altKey || i.ctrlKey || i.metaKey)) {
                        var n = 0, a = 0, o = 0, s = 0, l = 0;
                        switch (i.keyCode) {
                            case 61:
                            case 107:
                            case 171:
                            case 187:
                                n = 1;
                                break;
                            case 189:
                            case 109:
                            case 173:
                                n = -1;
                                break;
                            case 37:
                                i.shiftKey ? a = -1 : (i.preventDefault(), s = -1);
                                break;
                            case 39:
                                i.shiftKey ? a = 1 : (i.preventDefault(), s = 1);
                                break;
                            case 38:
                                i.shiftKey ? o = 1 : (i.preventDefault(), l = -1);
                                break;
                            case 40:
                                i.shiftKey ? o = -1 : (i.preventDefault(), l = 1);
                                break;
                            default:
                                return
                        }
                        return {
                            cameraAnimation: function (t) {
                                var e = t.getZoom();
                                t.easeTo({
                                    duration: 300,
                                    easeId: "keyboardHandler",
                                    easing: dn,
                                    zoom: n ? Math.round(e) + n * (i.shiftKey ? 2 : 1) : e,
                                    bearing: t.getBearing() + a * r._bearingStep,
                                    pitch: t.getPitch() + o * r._pitchStep,
                                    offset: [-s * r._panStep, -l * r._panStep],
                                    center: t.getCenter()
                                }, {originalEvent: i})
                            }
                        }
                    }
                }, fn.prototype.enable = function () {
                    this._enabled = !0
                }, fn.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, fn.prototype.isEnabled = function () {
                    return this._enabled
                }, fn.prototype.isActive = function () {
                    return this._active
                };
                var E = function (t, e) {
                    this._map = t, this._el = t.getCanvasContainer(), this._handler = e, this._delta = 0, this._defaultZoomRate = .01, this._wheelZoomRate = 1 / 450, ot.bindAll(["_onTimeout"], this)
                };
                E.prototype.setZoomRate = function (t) {
                    this._defaultZoomRate = t
                }, E.prototype.setWheelZoomRate = function (t) {
                    this._wheelZoomRate = t
                }, E.prototype.isEnabled = function () {
                    return !!this._enabled
                }, E.prototype.isActive = function () {
                    return !!this._active || void 0 !== this._finishTimeout
                }, E.prototype.isZooming = function () {
                    return !!this._zooming
                }, E.prototype.enable = function (t) {
                    this.isEnabled() || (this._enabled = !0, this._aroundCenter = t && "center" === t.around)
                }, E.prototype.disable = function () {
                    this.isEnabled() && (this._enabled = !1)
                }, E.prototype.wheel = function (t) {
                    if (this.isEnabled()) {
                        var e = t.deltaMode === ot.window.WheelEvent.DOM_DELTA_LINE ? 40 * t.deltaY : t.deltaY,
                            i = ot.browser.now(), r = i - (this._lastWheelEventTime || 0);
                        this._lastWheelEventTime = i, 0 !== e && e % 4.000244140625 == 0 ? this._type = "wheel" : 0 !== e && Math.abs(e) < 4 ? this._type = "trackpad" : r > 400 ? (this._type = null, this._lastValue = e, this._timeout = setTimeout(this._onTimeout, 40, t)) : this._type || (this._type = Math.abs(r * e) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, e += this._lastValue)), t.shiftKey && e && (e /= 4), this._type && (this._lastWheelEvent = t, this._delta -= e, this._active || this._start(t)), t.preventDefault()
                    }
                }, E.prototype._onTimeout = function (t) {
                    this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(t)
                }, E.prototype._start = function (t) {
                    if (this._delta) {
                        this._frameId && (this._frameId = null), this._active = !0, this.isZooming() || (this._zooming = !0), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
                        var e = x.mousePos(this._el, t);
                        this._around = ot.LngLat.convert(this._aroundCenter ? this._map.getCenter() : this._map.unproject(e)), this._aroundPoint = this._map.transform.locationPoint(this._around), this._frameId || (this._frameId = !0, this._handler._triggerRenderFrame())
                    }
                }, E.prototype.renderFrame = function () {
                    var t = this;
                    if (this._frameId && (this._frameId = null, this.isActive())) {
                        var e = this._map.transform;
                        if (0 !== this._delta) {
                            var i = "wheel" === this._type && Math.abs(this._delta) > 4.000244140625 ? this._wheelZoomRate : this._defaultZoomRate,
                                r = 2 / (1 + Math.exp(-Math.abs(this._delta * i)));
                            this._delta < 0 && 0 !== r && (r = 1 / r);
                            var n = "number" == typeof this._targetZoom ? e.zoomScale(this._targetZoom) : e.scale;
                            this._targetZoom = Math.min(e.maxZoom, Math.max(e.minZoom, e.scaleZoom(n * r))), "wheel" === this._type && (this._startZoom = e.zoom, this._easing = this._smoothOutEasing(200)), this._delta = 0
                        }
                        var a, o = "number" == typeof this._targetZoom ? this._targetZoom : e.zoom, s = this._startZoom,
                            l = this._easing, u = !1;
                        if ("wheel" === this._type && s && l) {
                            var h = Math.min((ot.browser.now() - this._lastWheelEventTime) / 200, 1), c = l(h);
                            a = ot.number(s, o, c), h < 1 ? this._frameId || (this._frameId = !0) : u = !0
                        } else a = o, u = !0;
                        return this._active = !0, u && (this._active = !1, this._finishTimeout = setTimeout(function () {
                            t._zooming = !1, t._handler._triggerRenderFrame(), delete t._targetZoom, delete t._finishTimeout
                        }, 200)), {
                            noInertia: !0,
                            needsRenderFrame: !u,
                            zoomDelta: a - e.zoom,
                            around: this._aroundPoint,
                            originalEvent: this._lastWheelEvent
                        }
                    }
                }, E.prototype._smoothOutEasing = function (t) {
                    var e = ot.ease;
                    if (this._prevEase) {
                        var i = this._prevEase, r = (ot.browser.now() - i.start) / i.duration,
                            n = i.easing(r + .01) - i.easing(r), a = .27 / Math.sqrt(n * n + 1e-4) * .01,
                            o = Math.sqrt(.0729 - a * a);
                        e = ot.bezier(a, o, .25, 1)
                    }
                    return this._prevEase = {start: ot.browser.now(), duration: t, easing: e}, e
                }, E.prototype.reset = function () {
                    this._active = !1
                };
                var mn = function (t, e) {
                    this._clickZoom = t, this._tapZoom = e
                };
                mn.prototype.enable = function () {
                    this._clickZoom.enable(), this._tapZoom.enable()
                }, mn.prototype.disable = function () {
                    this._clickZoom.disable(), this._tapZoom.disable()
                }, mn.prototype.isEnabled = function () {
                    return this._clickZoom.isEnabled() && this._tapZoom.isEnabled()
                }, mn.prototype.isActive = function () {
                    return this._clickZoom.isActive() || this._tapZoom.isActive()
                };
                var yn = function () {
                    this.reset()
                };
                yn.prototype.reset = function () {
                    this._active = !1
                }, yn.prototype.dblclick = function (e, i) {
                    return e.preventDefault(), {
                        cameraAnimation: function (t) {
                            t.easeTo({
                                duration: 300,
                                zoom: t.getZoom() + (e.shiftKey ? -1 : 1),
                                around: t.unproject(i)
                            }, {originalEvent: e})
                        }
                    }
                }, yn.prototype.enable = function () {
                    this._enabled = !0
                }, yn.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, yn.prototype.isEnabled = function () {
                    return this._enabled
                }, yn.prototype.isActive = function () {
                    return this._active
                };
                var I = function () {
                    this._tap = new $r({numTouches: 1, numTaps: 1}), this.reset()
                };
                I.prototype.reset = function () {
                    this._active = !1, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset()
                }, I.prototype.touchstart = function (t, e, i) {
                    this._swipePoint || (this._tapTime && t.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i.length > 0 && (this._swipePoint = e[0], this._swipeTouch = i[0].identifier) : this._tap.touchstart(t, e, i))
                }, I.prototype.touchmove = function (t, e, i) {
                    if (this._tapTime) {
                        if (this._swipePoint) {
                            if (i[0].identifier !== this._swipeTouch) return;
                            var r = e[0], n = r.y - this._swipePoint.y;
                            return this._swipePoint = r, t.preventDefault(), this._active = !0, {zoomDelta: n / 128}
                        }
                    } else this._tap.touchmove(t, e, i)
                }, I.prototype.touchend = function (t, e, i) {
                    this._tapTime ? this._swipePoint && 0 === i.length && this.reset() : this._tap.touchend(t, e, i) && (this._tapTime = t.timeStamp)
                }, I.prototype.touchcancel = function () {
                    this.reset()
                }, I.prototype.enable = function () {
                    this._enabled = !0
                }, I.prototype.disable = function () {
                    this._enabled = !1, this.reset()
                }, I.prototype.isEnabled = function () {
                    return this._enabled
                }, I.prototype.isActive = function () {
                    return this._active
                };
                var gn = function (t, e, i) {
                    this._el = t, this._mousePan = e, this._touchPan = i
                };
                gn.prototype.enable = function (t) {
                    this._inertiaOptions = t || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("mapboxgl-touch-drag-pan")
                }, gn.prototype.disable = function () {
                    this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("mapboxgl-touch-drag-pan")
                }, gn.prototype.isEnabled = function () {
                    return this._mousePan.isEnabled() && this._touchPan.isEnabled()
                }, gn.prototype.isActive = function () {
                    return this._mousePan.isActive() || this._touchPan.isActive()
                };
                var _n = function (t, e, i) {
                    this._pitchWithRotate = t.pitchWithRotate, this._mouseRotate = e, this._mousePitch = i
                };
                _n.prototype.enable = function () {
                    this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable()
                }, _n.prototype.disable = function () {
                    this._mouseRotate.disable(), this._mousePitch.disable()
                }, _n.prototype.isEnabled = function () {
                    return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled())
                }, _n.prototype.isActive = function () {
                    return this._mouseRotate.isActive() || this._mousePitch.isActive()
                };
                var vn = function (t, e, i, r) {
                    this._el = t, this._touchZoom = e, this._touchRotate = i, this._tapDragZoom = r, this._rotationDisabled = !1, this._enabled = !0
                };
                vn.prototype.enable = function (t) {
                    this._touchZoom.enable(t), this._rotationDisabled || this._touchRotate.enable(t), this._tapDragZoom.enable(), this._el.classList.add("mapboxgl-touch-zoom-rotate")
                }, vn.prototype.disable = function () {
                    this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("mapboxgl-touch-zoom-rotate")
                }, vn.prototype.isEnabled = function () {
                    return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled()
                }, vn.prototype.isActive = function () {
                    return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive()
                }, vn.prototype.disableRotation = function () {
                    this._rotationDisabled = !0, this._touchRotate.disable()
                }, vn.prototype.enableRotation = function () {
                    this._rotationDisabled = !1, this._touchZoom.isEnabled() && this._touchRotate.enable()
                };
                var xn = function (t) {
                    return t.zoom || t.drag || t.pitch || t.rotate
                }, bn = function (t) {
                    function e() {
                        t.apply(this, arguments)
                    }

                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
                }(ot.Event);

                function wn(t) {
                    return t.panDelta && t.panDelta.mag() || t.zoomDelta || t.bearingDelta || t.pitchDelta
                }

                var g = function (t, e) {
                    this._map = t, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new Wr(t), this._bearingSnap = e.bearingSnap, this._previousActiveHandlers = {}, this._eventsInProgress = {}, this._addDefaultHandlers(e), ot.bindAll(["handleEvent", "handleWindowEvent"], this);
                    var i = this._el;
                    this._listeners = [[i, "touchstart", {passive: !0}], [i, "touchmove", {passive: !1}], [i, "touchend", void 0], [i, "touchcancel", void 0], [i, "mousedown", void 0], [i, "mousemove", void 0], [i, "mouseup", void 0], [ot.window.document, "mousemove", {capture: !0}], [ot.window.document, "mouseup", void 0], [i, "mouseover", void 0], [i, "mouseout", void 0], [i, "dblclick", void 0], [i, "click", void 0], [i, "keydown", {capture: !1}], [i, "keyup", void 0], [i, "wheel", {passive: !1}], [i, "contextmenu", void 0], [ot.window, "blur", void 0]];
                    for (var r = 0, n = this._listeners; r < n.length; r += 1) {
                        var a = n[r], o = a[0];
                        x.addEventListener(o, a[1], o === ot.window.document ? this.handleWindowEvent : this.handleEvent, a[2])
                    }
                };
                g.prototype.destroy = function () {
                    for (var t = 0, e = this._listeners; t < e.length; t += 1) {
                        var i = e[t], r = i[0];
                        x.removeEventListener(r, i[1], r === ot.window.document ? this.handleWindowEvent : this.handleEvent, i[2])
                    }
                }, g.prototype._addDefaultHandlers = function (t) {
                    var e = this._map, i = e.getCanvasContainer();
                    this._add("mapEvent", new v(e, t));
                    var r = e.boxZoom = new w(e, t);
                    this._add("boxZoom", r);
                    var n = new M, a = new yn;
                    e.doubleClickZoom = new mn(a, n), this._add("tapZoom", n), this._add("clickZoom", a);
                    var o = new I;
                    this._add("tapDragZoom", o);
                    var s = e.touchPitch = new cn;
                    this._add("touchPitch", s);
                    var l = new rn(t), u = new nn(t);
                    e.dragRotate = new _n(t, l, u), this._add("mouseRotate", l, ["mousePitch"]), this._add("mousePitch", u, ["mouseRotate"]);
                    var h = new en(t), c = new S(t);
                    e.dragPan = new gn(i, h, c), this._add("mousePan", h), this._add("touchPan", c, ["touchZoom", "touchRotate"]);
                    var p = new un, f = new sn;
                    e.touchZoomRotate = new vn(i, f, p, o), this._add("touchRotate", p, ["touchPan", "touchZoom"]), this._add("touchZoom", f, ["touchPan", "touchRotate"]);
                    var d = e.scrollZoom = new E(e, this);
                    this._add("scrollZoom", d, ["mousePan"]);
                    var m = e.keyboard = new fn;
                    this._add("keyboard", m), this._add("blockableMapEvent", new b(e));
                    for (var y = 0, g = ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]; y < g.length; y += 1) {
                        var _ = g[y];
                        t.interactive && t[_] && e[_].enable(t[_])
                    }
                }, g.prototype._add = function (t, e, i) {
                    this._handlers.push({handlerName: t, handler: e, allowed: i}), this._handlersById[t] = e
                }, g.prototype.stop = function (t) {
                    if (!this._updatingCamera) {
                        for (var e = 0, i = this._handlers; e < i.length; e += 1) i[e].handler.reset();
                        this._inertia.clear(), this._fireEvents({}, {}, t), this._changes = []
                    }
                }, g.prototype.isActive = function () {
                    for (var t = 0, e = this._handlers; t < e.length; t += 1) if (e[t].handler.isActive()) return !0;
                    return !1
                }, g.prototype.isZooming = function () {
                    return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming()
                }, g.prototype.isRotating = function () {
                    return !!this._eventsInProgress.rotate
                }, g.prototype.isMoving = function () {
                    return Boolean(xn(this._eventsInProgress)) || this.isZooming()
                }, g.prototype._blockedByActive = function (t, e, i) {
                    for (var r in t) if (r !== i && (!e || e.indexOf(r) < 0)) return !0;
                    return !1
                }, g.prototype.handleWindowEvent = function (t) {
                    this.handleEvent(t, t.type + "Window")
                }, g.prototype._getMapTouches = function (t) {
                    for (var e = [], i = 0, r = t; i < r.length; i += 1) {
                        var n = r[i];
                        this._el.contains(n.target) && e.push(n)
                    }
                    return e
                }, g.prototype.handleEvent = function (t, e) {
                    if ("blur" !== t.type) {
                        this._updatingCamera = !0;
                        for (var i = "renderFrame" === t.type ? void 0 : t, r = {needsRenderFrame: !1}, n = {}, a = {}, o = t.touches ? this._getMapTouches(t.touches) : void 0, s = o ? x.touchPos(this._el, o) : x.mousePos(this._el, t), l = 0, u = this._handlers; l < u.length; l += 1) {
                            var h = u[l], c = h.handlerName, p = h.handler, f = h.allowed;
                            if (p.isEnabled()) {
                                var d = void 0;
                                this._blockedByActive(a, f, c) ? p.reset() : p[e || t.type] && (d = p[e || t.type](t, s, o), this.mergeHandlerResult(r, n, d, c, i), d && d.needsRenderFrame && this._triggerRenderFrame()), (d || p.isActive()) && (a[c] = p)
                            }
                        }
                        var m = {};
                        for (var y in this._previousActiveHandlers) a[y] || (m[y] = i);
                        this._previousActiveHandlers = a, (Object.keys(m).length || wn(r)) && (this._changes.push([r, n, m]), this._triggerRenderFrame()), (Object.keys(a).length || wn(r)) && this._map._stop(!0), this._updatingCamera = !1;
                        var g = r.cameraAnimation;
                        g && (this._inertia.clear(), this._fireEvents({}, {}, !0), this._changes = [], g(this._map))
                    } else this.stop(!0)
                }, g.prototype.mergeHandlerResult = function (t, e, i, r, n) {
                    if (i) {
                        ot.extend(t, i);
                        var a = {handlerName: r, originalEvent: i.originalEvent || n};
                        void 0 !== i.zoomDelta && (e.zoom = a), void 0 !== i.panDelta && (e.drag = a), void 0 !== i.pitchDelta && (e.pitch = a), void 0 !== i.bearingDelta && (e.rotate = a)
                    }
                }, g.prototype._applyChanges = function () {
                    for (var t = {}, e = {}, i = {}, r = 0, n = this._changes; r < n.length; r += 1) {
                        var a = n[r], o = a[0], s = a[1], l = a[2];
                        o.panDelta && (t.panDelta = (t.panDelta || new ot.Point(0, 0))._add(o.panDelta)), o.zoomDelta && (t.zoomDelta = (t.zoomDelta || 0) + o.zoomDelta), o.bearingDelta && (t.bearingDelta = (t.bearingDelta || 0) + o.bearingDelta), o.pitchDelta && (t.pitchDelta = (t.pitchDelta || 0) + o.pitchDelta), void 0 !== o.around && (t.around = o.around), void 0 !== o.pinchAround && (t.pinchAround = o.pinchAround), o.noInertia && (t.noInertia = o.noInertia), ot.extend(e, s), ot.extend(i, l)
                    }
                    this._updateMapTransform(t, e, i), this._changes = []
                }, g.prototype._updateMapTransform = function (t, e, i) {
                    var r = this._map, n = r.transform;
                    if (!wn(t)) return this._fireEvents(e, i, !0);
                    var a = t.panDelta, o = t.zoomDelta, s = t.bearingDelta, l = t.pitchDelta, u = t.around,
                        h = t.pinchAround;
                    void 0 !== h && (u = h), r._stop(!0), u = u || r.transform.centerPoint;
                    var c = n.pointLocation(a ? u.sub(a) : u);
                    s && (n.bearing += s), l && (n.pitch += l), o && (n.zoom += o), n.setLocationAtPoint(c, u), this._map._update(), t.noInertia || this._inertia.record(t), this._fireEvents(e, i, !0)
                }, g.prototype._fireEvents = function (t, e, i) {
                    var r = this, n = xn(this._eventsInProgress), a = xn(t), o = {};
                    for (var s in t) this._eventsInProgress[s] || (o[s + "start"] = t[s].originalEvent), this._eventsInProgress[s] = t[s];
                    for (var l in !n && a && this._fireEvent("movestart", a.originalEvent), o) this._fireEvent(l, o[l]);
                    for (var u in a && this._fireEvent("move", a.originalEvent), t) this._fireEvent(u, t[u].originalEvent);
                    var h, c = {};
                    for (var p in this._eventsInProgress) {
                        var f = this._eventsInProgress[p], d = f.handlerName, m = f.originalEvent;
                        this._handlersById[d].isActive() || (delete this._eventsInProgress[p], c[p + "end"] = h = e[d] || m)
                    }
                    for (var y in c) this._fireEvent(y, c[y]);
                    var g = xn(this._eventsInProgress);
                    if (i && (n || a) && !g) {
                        this._updatingCamera = !0;
                        var _ = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions), v = function (t) {
                            return 0 !== t && -r._bearingSnap < t && t < r._bearingSnap
                        };
                        _ ? (v(_.bearing || this._map.getBearing()) && (_.bearing = 0), this._map.easeTo(_, {originalEvent: h})) : (this._map.fire(new ot.Event("moveend", {originalEvent: h})), v(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = !1
                    }
                }, g.prototype._fireEvent = function (t, e) {
                    this._map.fire(new ot.Event(t, e ? {originalEvent: e} : {}))
                }, g.prototype._requestFrame = function () {
                    var e = this;
                    return this._map.triggerRepaint(), this._map._renderTaskQueue.add(function (t) {
                        delete e._frameId, e.handleEvent(new bn("renderFrame", {timeStamp: t})), e._applyChanges()
                    })
                }, g.prototype._triggerRenderFrame = function () {
                    void 0 === this._frameId && (this._frameId = this._requestFrame())
                };
                var Mn = function (i) {
                    function t(t, e) {
                        i.call(this), this._moving = !1, this._zooming = !1, this.transform = t, this._bearingSnap = e.bearingSnap, ot.bindAll(["_renderFrameCallback"], this)
                    }

                    return i && (t.__proto__ = i), (t.prototype = Object.create(i && i.prototype)).constructor = t, t.prototype.getCenter = function () {
                        return new ot.LngLat(this.transform.center.lng, this.transform.center.lat)
                    }, t.prototype.setCenter = function (t, e) {
                        return this.jumpTo({center: t}, e)
                    }, t.prototype.panBy = function (t, e, i) {
                        return t = ot.Point.convert(t).mult(-1), this.panTo(this.transform.center, ot.extend({offset: t}, e), i)
                    }, t.prototype.panTo = function (t, e, i) {
                        return this.easeTo(ot.extend({center: t}, e), i)
                    }, t.prototype.getZoom = function () {
                        return this.transform.zoom
                    }, t.prototype.setZoom = function (t, e) {
                        return this.jumpTo({zoom: t}, e), this
                    }, t.prototype.zoomTo = function (t, e, i) {
                        return this.easeTo(ot.extend({zoom: t}, e), i)
                    }, t.prototype.zoomIn = function (t, e) {
                        return this.zoomTo(this.getZoom() + 1, t, e), this
                    }, t.prototype.zoomOut = function (t, e) {
                        return this.zoomTo(this.getZoom() - 1, t, e), this
                    }, t.prototype.getBearing = function () {
                        return this.transform.bearing
                    }, t.prototype.setBearing = function (t, e) {
                        return this.jumpTo({bearing: t}, e), this
                    }, t.prototype.getPadding = function () {
                        return this.transform.padding
                    }, t.prototype.setPadding = function (t, e) {
                        return this.jumpTo({padding: t}, e), this
                    }, t.prototype.rotateTo = function (t, e, i) {
                        return this.easeTo(ot.extend({bearing: t}, e), i)
                    }, t.prototype.resetNorth = function (t, e) {
                        return this.rotateTo(0, ot.extend({duration: 1e3}, t), e), this
                    }, t.prototype.resetNorthPitch = function (t, e) {
                        return this.easeTo(ot.extend({bearing: 0, pitch: 0, duration: 1e3}, t), e), this
                    }, t.prototype.snapToNorth = function (t, e) {
                        return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(t, e) : this
                    }, t.prototype.getPitch = function () {
                        return this.transform.pitch
                    }, t.prototype.setPitch = function (t, e) {
                        return this.jumpTo({pitch: t}, e), this
                    }, t.prototype.cameraForBounds = function (t, e) {
                        return t = ot.LngLatBounds.convert(t), this._cameraForBoxAndBearing(t.getNorthWest(), t.getSouthEast(), 0, e)
                    }, t.prototype._cameraForBoxAndBearing = function (t, e, i, r) {
                        var n = {top: 0, bottom: 0, right: 0, left: 0};
                        if ("number" == typeof (r = ot.extend({
                            padding: n,
                            offset: [0, 0],
                            maxZoom: this.transform.maxZoom
                        }, r)).padding) {
                            var a = r.padding;
                            r.padding = {top: a, bottom: a, right: a, left: a}
                        }
                        r.padding = ot.extend(n, r.padding);
                        var o = this.transform, s = o.padding, l = o.project(ot.LngLat.convert(t)),
                            u = o.project(ot.LngLat.convert(e)), h = l.rotate(-i * Math.PI / 180),
                            c = u.rotate(-i * Math.PI / 180), p = new ot.Point(Math.max(h.x, c.x), Math.max(h.y, c.y)),
                            f = new ot.Point(Math.min(h.x, c.x), Math.min(h.y, c.y)), d = p.sub(f),
                            m = (o.width - (s.left + s.right + r.padding.left + r.padding.right)) / d.x,
                            y = (o.height - (s.top + s.bottom + r.padding.top + r.padding.bottom)) / d.y;
                        if (!(y < 0 || m < 0)) {
                            var g = Math.min(o.scaleZoom(o.scale * Math.min(m, y)), r.maxZoom),
                                _ = ot.Point.convert(r.offset),
                                v = new ot.Point(_.x + (r.padding.left - r.padding.right) / 2, _.y + (r.padding.top - r.padding.bottom) / 2).mult(o.scale / o.zoomScale(g));
                            return {center: o.unproject(l.add(u).div(2).sub(v)), zoom: g, bearing: i}
                        }
                        ot.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")
                    }, t.prototype.fitBounds = function (t, e, i) {
                        return this._fitInternal(this.cameraForBounds(t, e), e, i)
                    }, t.prototype.fitScreenCoordinates = function (t, e, i, r, n) {
                        return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(ot.Point.convert(t)), this.transform.pointLocation(ot.Point.convert(e)), i, r), r, n)
                    }, t.prototype._fitInternal = function (t, e, i) {
                        return t ? (delete (e = ot.extend(t, e)).padding, e.linear ? this.easeTo(e, i) : this.flyTo(e, i)) : this
                    }, t.prototype.jumpTo = function (t, e) {
                        this.stop();
                        var i = this.transform, r = !1, n = !1, a = !1;
                        return "zoom" in t && i.zoom !== +t.zoom && (r = !0, i.zoom = +t.zoom), void 0 !== t.center && (i.center = ot.LngLat.convert(t.center)), "bearing" in t && i.bearing !== +t.bearing && (n = !0, i.bearing = +t.bearing), "pitch" in t && i.pitch !== +t.pitch && (a = !0, i.pitch = +t.pitch), null == t.padding || i.isPaddingEqual(t.padding) || (i.padding = t.padding), this.fire(new ot.Event("movestart", e)).fire(new ot.Event("move", e)), r && this.fire(new ot.Event("zoomstart", e)).fire(new ot.Event("zoom", e)).fire(new ot.Event("zoomend", e)), n && this.fire(new ot.Event("rotatestart", e)).fire(new ot.Event("rotate", e)).fire(new ot.Event("rotateend", e)), a && this.fire(new ot.Event("pitchstart", e)).fire(new ot.Event("pitch", e)).fire(new ot.Event("pitchend", e)), this.fire(new ot.Event("moveend", e))
                    }, t.prototype.easeTo = function (t, a) {
                        var o = this;
                        this._stop(!1, t.easeId), (!1 === (t = ot.extend({
                            offset: [0, 0],
                            duration: 500,
                            easing: ot.ease
                        }, t)).animate || !t.essential && ot.browser.prefersReducedMotion) && (t.duration = 0);
                        var s = this.transform, l = this.getZoom(), u = this.getBearing(), h = this.getPitch(),
                            c = this.getPadding(), p = "zoom" in t ? +t.zoom : l,
                            f = "bearing" in t ? this._normalizeBearing(t.bearing, u) : u,
                            d = "pitch" in t ? +t.pitch : h, m = "padding" in t ? t.padding : s.padding,
                            y = ot.Point.convert(t.offset), g = s.centerPoint.add(y), e = s.pointLocation(g),
                            i = ot.LngLat.convert(t.center || e);
                        this._normalizeCenter(i);
                        var _, v, x = s.project(e), b = s.project(i).sub(x), w = s.zoomScale(p - l);
                        t.around && (_ = ot.LngLat.convert(t.around), v = s.locationPoint(_));
                        var r = {
                            moving: this._moving,
                            zooming: this._zooming,
                            rotating: this._rotating,
                            pitching: this._pitching
                        };
                        return this._zooming = this._zooming || p !== l, this._rotating = this._rotating || u !== f, this._pitching = this._pitching || d !== h, this._padding = !s.isPaddingEqual(m), this._easeId = t.easeId, this._prepareEase(a, t.noMoveStart, r), this._ease(function (t) {
                            if (o._zooming && (s.zoom = ot.number(l, p, t)), o._rotating && (s.bearing = ot.number(u, f, t)), o._pitching && (s.pitch = ot.number(h, d, t)), o._padding && (s.interpolatePadding(c, m, t), g = s.centerPoint.add(y)), _) s.setLocationAtPoint(_, v); else {
                                var e = s.zoomScale(s.zoom - l), i = p > l ? Math.min(2, w) : Math.max(.5, w),
                                    r = Math.pow(i, 1 - t), n = s.unproject(x.add(b.mult(t * r)).mult(e));
                                s.setLocationAtPoint(s.renderWorldCopies ? n.wrap() : n, g)
                            }
                            o._fireMoveEvents(a)
                        }, function (t) {
                            o._afterEase(a, t)
                        }, t), this
                    }, t.prototype._prepareEase = function (t, e, i) {
                        void 0 === i && (i = {}), this._moving = !0, e || i.moving || this.fire(new ot.Event("movestart", t)), this._zooming && !i.zooming && this.fire(new ot.Event("zoomstart", t)), this._rotating && !i.rotating && this.fire(new ot.Event("rotatestart", t)), this._pitching && !i.pitching && this.fire(new ot.Event("pitchstart", t))
                    }, t.prototype._fireMoveEvents = function (t) {
                        this.fire(new ot.Event("move", t)), this._zooming && this.fire(new ot.Event("zoom", t)), this._rotating && this.fire(new ot.Event("rotate", t)), this._pitching && this.fire(new ot.Event("pitch", t))
                    }, t.prototype._afterEase = function (t, e) {
                        if (!this._easeId || !e || this._easeId !== e) {
                            delete this._easeId;
                            var i = this._zooming, r = this._rotating, n = this._pitching;
                            this._moving = !1, this._zooming = !1, this._rotating = !1, this._pitching = !1, this._padding = !1, i && this.fire(new ot.Event("zoomend", t)), r && this.fire(new ot.Event("rotateend", t)), n && this.fire(new ot.Event("pitchend", t)), this.fire(new ot.Event("moveend", t))
                        }
                    }, t.prototype.flyTo = function (t, n) {
                        var a = this;
                        if (!t.essential && ot.browser.prefersReducedMotion) {
                            var e = ot.pick(t, ["center", "zoom", "bearing", "pitch", "around"]);
                            return this.jumpTo(e, n)
                        }
                        this.stop(), t = ot.extend({offset: [0, 0], speed: 1.2, curve: 1.42, easing: ot.ease}, t);
                        var o = this.transform, s = this.getZoom(), l = this.getBearing(), u = this.getPitch(),
                            h = this.getPadding(), c = "zoom" in t ? ot.clamp(+t.zoom, o.minZoom, o.maxZoom) : s,
                            p = "bearing" in t ? this._normalizeBearing(t.bearing, l) : l,
                            f = "pitch" in t ? +t.pitch : u, d = "padding" in t ? t.padding : o.padding,
                            i = o.zoomScale(c - s), m = ot.Point.convert(t.offset), y = o.centerPoint.add(m),
                            r = o.pointLocation(y), g = ot.LngLat.convert(t.center || r);
                        this._normalizeCenter(g);
                        var _ = o.project(r), v = o.project(g).sub(_), x = t.curve, b = Math.max(o.width, o.height),
                            w = b / i, M = v.mag();
                        if ("minZoom" in t) {
                            var S = ot.clamp(Math.min(t.minZoom, s, c), o.minZoom, o.maxZoom),
                                E = b / o.zoomScale(S - s);
                            x = Math.sqrt(E / M * 2)
                        }
                        var I = x * x;

                        function T(t) {
                            var e = (w * w - b * b + (t ? -1 : 1) * I * I * M * M) / (2 * (t ? w : b) * I * M);
                            return Math.log(Math.sqrt(e * e + 1) - e)
                        }

                        function C(t) {
                            return (Math.exp(t) - Math.exp(-t)) / 2
                        }

                        function P(t) {
                            return (Math.exp(t) + Math.exp(-t)) / 2
                        }

                        var A = T(0), z = function (t) {
                            return P(A) / P(A + x * t)
                        }, k = function (t) {
                            return b * ((P(A) * (C(e = A + x * t) / P(e)) - C(A)) / I) / M;
                            var e
                        }, L = (T(1) - A) / x;
                        if (Math.abs(M) < 1e-6 || !isFinite(L)) {
                            if (Math.abs(b - w) < 1e-6) return this.easeTo(t, n);
                            var D = w < b ? -1 : 1;
                            L = Math.abs(Math.log(w / b)) / x, k = function () {
                                return 0
                            }, z = function (t) {
                                return Math.exp(D * x * t)
                            }
                        }
                        return t.duration = "duration" in t ? +t.duration : 1e3 * L / ("screenSpeed" in t ? +t.screenSpeed / x : +t.speed), t.maxDuration && t.duration > t.maxDuration && (t.duration = 0), this._zooming = !0, this._rotating = l !== p, this._pitching = f !== u, this._padding = !o.isPaddingEqual(d), this._prepareEase(n, !1), this._ease(function (t) {
                            var e = t * L, i = 1 / z(e);
                            o.zoom = 1 === t ? c : s + o.scaleZoom(i), a._rotating && (o.bearing = ot.number(l, p, t)), a._pitching && (o.pitch = ot.number(u, f, t)), a._padding && (o.interpolatePadding(h, d, t), y = o.centerPoint.add(m));
                            var r = 1 === t ? g : o.unproject(_.add(v.mult(k(e))).mult(i));
                            o.setLocationAtPoint(o.renderWorldCopies ? r.wrap() : r, y), a._fireMoveEvents(n)
                        }, function () {
                            return a._afterEase(n)
                        }, t), this
                    }, t.prototype.isEasing = function () {
                        return !!this._easeFrameId
                    }, t.prototype.stop = function () {
                        return this._stop()
                    }, t.prototype._stop = function (t, e) {
                        if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
                            var i = this._onEaseEnd;
                            delete this._onEaseEnd, i.call(this, e)
                        }
                        if (!t) {
                            var r = this.handlers;
                            r && r.stop(!1)
                        }
                        return this
                    }, t.prototype._ease = function (t, e, i) {
                        !1 === i.animate || 0 === i.duration ? (t(1), e()) : (this._easeStart = ot.browser.now(), this._easeOptions = i, this._onEaseFrame = t, this._onEaseEnd = e, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback))
                    }, t.prototype._renderFrameCallback = function () {
                        var t = Math.min((ot.browser.now() - this._easeStart) / this._easeOptions.duration, 1);
                        this._onEaseFrame(this._easeOptions.easing(t)), t < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop()
                    }, t.prototype._normalizeBearing = function (t, e) {
                        t = ot.wrap(t, -180, 180);
                        var i = Math.abs(t - e);
                        return Math.abs(t - 360 - e) < i && (t -= 360), Math.abs(t + 360 - e) < i && (t += 360), t
                    }, t.prototype._normalizeCenter = function (t) {
                        var e = this.transform;
                        if (e.renderWorldCopies && !e.lngRange) {
                            var i = t.lng - e.center.lng;
                            t.lng += i > 180 ? -360 : i < -180 ? 360 : 0
                        }
                    }, t
                }(ot.Evented), Sn = function (t) {
                    void 0 === t && (t = {}), this.options = t, ot.bindAll(["_updateEditLink", "_updateData", "_updateCompact"], this)
                };
                Sn.prototype.getDefaultPosition = function () {
                    return "bottom-right"
                }, Sn.prototype.onAdd = function (t) {
                    var e = this.options && this.options.compact;
                    return this._map = t, this._container = x.create("div", "mapboxgl-ctrl mapboxgl-ctrl-attrib"), this._innerContainer = x.create("div", "mapboxgl-ctrl-attrib-inner", this._container), e && this._container.classList.add("mapboxgl-compact"), this._updateAttributions(), this._updateEditLink(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("moveend", this._updateEditLink), void 0 === e && (this._map.on("resize", this._updateCompact), this._updateCompact()), this._container
                }, Sn.prototype.onRemove = function () {
                    x.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("moveend", this._updateEditLink), this._map.off("resize", this._updateCompact), this._map = void 0, this._attribHTML = void 0
                }, Sn.prototype._updateEditLink = function () {
                    var t = this._editLink;
                    t || (t = this._editLink = this._container.querySelector(".mapbox-improve-map"));
                    var r = [{key: "owner", value: this.styleOwner}, {
                        key: "id",
                        value: this.styleId
                    }, {
                        key: "access_token",
                        value: this._map._requestManager._customAccessToken || ot.config.ACCESS_TOKEN
                    }];
                    if (t) {
                        var e = r.reduce(function (t, e, i) {
                            return e.value && (t += e.key + "=" + e.value + (i < r.length - 1 ? "&" : "")), t
                        }, "?");
                        t.href = ot.config.FEEDBACK_URL + "/" + e + (this._map._hash ? this._map._hash.getHashString(!0) : ""), t.rel = "noopener nofollow"
                    }
                }, Sn.prototype._updateData = function (t) {
                    !t || "metadata" !== t.sourceDataType && "style" !== t.dataType || (this._updateAttributions(), this._updateEditLink())
                }, Sn.prototype._updateAttributions = function () {
                    if (this._map.style) {
                        var r = [];
                        if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? r = r.concat(this.options.customAttribution.map(function (t) {
                            return "string" != typeof t ? "" : t
                        })) : "string" == typeof this.options.customAttribution && r.push(this.options.customAttribution)), this._map.style.stylesheet) {
                            var t = this._map.style.stylesheet;
                            this.styleOwner = t.owner, this.styleId = t.id
                        }
                        var e = this._map.style.sourceCaches;
                        for (var i in e) {
                            var n = e[i];
                            if (n.used) {
                                var a = n.getSource();
                                a.attribution && r.indexOf(a.attribution) < 0 && r.push(a.attribution)
                            }
                        }
                        r.sort(function (t, e) {
                            return t.length - e.length
                        });
                        var o = (r = r.filter(function (t, e) {
                            for (var i = e + 1; i < r.length; i++) if (r[i].indexOf(t) >= 0) return !1;
                            return !0
                        })).join(" | ");
                        o !== this._attribHTML && (this._attribHTML = o, r.length ? (this._innerContainer.innerHTML = o, this._container.classList.remove("mapboxgl-attrib-empty")) : this._container.classList.add("mapboxgl-attrib-empty"), this._editLink = null)
                    }
                }, Sn.prototype._updateCompact = function () {
                    this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("mapboxgl-compact") : this._container.classList.remove("mapboxgl-compact")
                };
                var En = function () {
                    ot.bindAll(["_updateLogo"], this), ot.bindAll(["_updateCompact"], this)
                };
                En.prototype.onAdd = function (t) {
                    this._map = t, this._container = x.create("div", "mapboxgl-ctrl");
                    var e = x.create("a", "mapboxgl-ctrl-logo");
                    return e.target = "_blank", e.rel = "noopener nofollow", e.href = "https://www.mapbox.com/", e.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), e.setAttribute("rel", "noopener nofollow"), this._container.appendChild(e), this._container.style.display = "none", this._map.on("sourcedata", this._updateLogo), this._updateLogo(), this._map.on("resize", this._updateCompact), this._updateCompact(), this._container
                }, En.prototype.onRemove = function () {
                    x.remove(this._container), this._map.off("sourcedata", this._updateLogo), this._map.off("resize", this._updateCompact)
                }, En.prototype.getDefaultPosition = function () {
                    return "bottom-left"
                }, En.prototype._updateLogo = function (t) {
                    t && "metadata" !== t.sourceDataType || (this._container.style.display = this._logoRequired() ? "block" : "none")
                }, En.prototype._logoRequired = function () {
                    if (this._map.style) {
                        var t = this._map.style.sourceCaches;
                        for (var e in t) if (t[e].getSource().mapbox_logo) return !0;
                        return !1
                    }
                }, En.prototype._updateCompact = function () {
                    var t = this._container.children;
                    if (t.length) {
                        var e = t[0];
                        this._map.getCanvasContainer().offsetWidth < 250 ? e.classList.add("mapboxgl-compact") : e.classList.remove("mapboxgl-compact")
                    }
                };
                var In = function () {
                    this._queue = [], this._id = 0, this._cleared = !1, this._currentlyRunning = !1
                };
                In.prototype.add = function (t) {
                    var e = ++this._id;
                    return this._queue.push({callback: t, id: e, cancelled: !1}), e
                }, In.prototype.remove = function (t) {
                    for (var e = this._currentlyRunning, i = 0, r = e ? this._queue.concat(e) : this._queue; i < r.length; i += 1) {
                        var n = r[i];
                        if (n.id === t) return void (n.cancelled = !0)
                    }
                }, In.prototype.run = function (t) {
                    void 0 === t && (t = 0);
                    var e = this._currentlyRunning = this._queue;
                    this._queue = [];
                    for (var i = 0, r = e; i < r.length; i += 1) {
                        var n = r[i];
                        if (!n.cancelled && (n.callback(t), this._cleared)) break
                    }
                    this._cleared = !1, this._currentlyRunning = !1
                }, In.prototype.clear = function () {
                    this._currentlyRunning && (this._cleared = !0), this._queue = []
                };
                var Tn = [];

                function _(t) {
                    Tn.push.apply(Tn, t.names || [])
                }

                _(ot.tmerc), _(ot.etmerc), _(ot.utm), _(ot.sterea), _(ot.stere), _(ot.somerc), _(ot.omerc), _(ot.lcc), _(ot.krovak), _(ot.cass), _(ot.laea), _(ot.aea), _(ot.gnom), _(ot.cea), _(ot.eqc), _(ot.poly), _(ot.nzmg), _(ot.mill), _(ot.sinu), _(ot.moll), _(ot.eqdc), _(ot.vandg), _(ot.aeqd), _(ot.ortho$1), _(ot.qsc), _(ot.robin), _(ot.geocent), _(ot.tpers), _(ot.geos);
                var T = function t(e, i, r) {
                    var n;
                    this.epsgCode = e, this.extent = r, this.renderWorldCopies = !0, Array.isArray(i) && (this.extent = i, i = null), this.WKT = i || t.defaultWKTs[e], this.WKT && ("object" != typeof (n = ot.parseCode(this.WKT)) && console.error("The projection defs value is not valid"), ot.proj4.Proj.projections.get(n.projName) || console.error("The projection name " + n.projName + " is not supported.Perhaps values are " + function (t) {
                        for (var e = t.split(/[\s_-]+/), i = new Set, r = 0; r < Tn.length; r++) for (var n = Tn[r], a = 0; a < e.length; a++) n.toLowerCase().indexOf(e[a].toLowerCase()) >= 0 && i.add(n);
                        return i.size > 0 ? Array.from(i) : Tn
                    }(n.projName).join(",")), ot.proj4.defs(e, this.WKT));
                    var a = ot.proj4.defs(e);
                    if (!a) throw new Error(e + " was not defined,make sure the WKT param was not null");
                    this.unit = a.units || "degree", this.proj4Projection = ot.proj4(e);
                    var o = this.proj4Projection.inverse([this.extent[0], this.extent[1]]),
                        s = this.proj4Projection.inverse([this.extent[2], this.extent[3]]);
                    this.lngLatExtent = o.concat(s), this._id = ot.uniqueId(), t.set(this)
                };
                T.prototype.getExtent = function () {
                    if (!this._rectifyExtent) {
                        var t = this.extent[2] - this.extent[0], e = this.extent[3] - this.extent[1];
                        if (t === e) this._rectifyExtent = [this.extent[0], this.extent[1], this.extent[2], this.extent[3]]; else {
                            var i = Math.max(t, e);
                            this._rectifyExtent = [this.extent[0], this.extent[3] - i, this.extent[0] + i, this.extent[3]]
                        }
                    }
                    return this._rectifyExtent
                }, T.prototype.getLngLatCenter = function () {
                    return [this.lngLatExtent[2] - (this.lngLatExtent[2] - this.lngLatExtent[0]) / 2, this.lngLatExtent[3] - (this.lngLatExtent[3] - this.lngLatExtent[1]) / 2]
                }, T.prototype.getLngLatExtent = function () {
                    if (!this._rectifyLngLatExtent) {
                        var t = this.proj4Projection.inverse([this.extent[0], this.extent[1]]),
                            e = this.proj4Projection.inverse([this.extent[2], this.extent[3]]), i = e[0] - t[0],
                            r = e[1] - t[1];
                        if (i === r) this._rectifyLngLatExtent = [t[0], t[1], e[0], e[0]]; else {
                            var n = Math.max(i, r);
                            this._rectifyLngLatExtent = [t[0], e[1] - n, t[0] + n, e[1]]
                        }
                    }
                    return this._rectifyLngLatExtent
                }, T.prototype.getOrigin = function () {
                    return [this.extent[0], this.extent[3]]
                }, T.prototype.getEpsgCode = function () {
                    return this.epsgCode
                }, T.prototype.getUnit = function () {
                    return this.unit
                }, T.prototype.getWKT = function () {
                    return this.WKT
                }, T.prototype.getWidth = function () {
                    return this._rectifyExtent[2] - this._rectifyExtent[0]
                }, T.prototype.getHeight = function () {
                    return this._rectifyExtent[3] - this._rectifyExtent[1]
                }, T.prototype.getOriginX = function () {
                    return this._rectifyExtent[0]
                }, T.prototype.getOriginY = function () {
                    return this._rectifyExtent[3]
                }, T.prototype.toWGS84 = function (t) {
                    return this.proj4Projection.inverse(t)
                }, T.prototype.fromWGS84 = function (t) {
                    return this.proj4Projection.forward(t)
                }, T.prototype.fromLngLat = function (t) {
                    var e = ot.LngLat.convert(t), i = this.renderWorldCopies ? e.lng : ot.clamp(e.lng, -180, 180),
                        r = this.fromWGS84([i, e.lat]);
                    return {
                        x: (r[0] - this.getOriginX()) / this.getWidth(),
                        y: (this.getOriginY() - r[1]) / this.getHeight(),
                        z: 0
                    }
                }, T.prototype.toLngLat = function (t, e) {
                    var i = this.renderWorldCopies ? t : ot.clamp(t, 0, 1),
                        r = this.toWGS84([i * this.getWidth() + this.getOriginX(), this.getOriginY() - e * this.getHeight()]);
                    return new ot.LngLat(r[0], r[1])
                }, T.get = function (t) {
                    for (var e in T) if (T.hasOwnProperty(e) && T[e].getEpsgCode && T[e].getEpsgCode() === t) return T[e];
                    return null
                }, T.set = function (t) {
                    var e = t.getEpsgCode().replace(":", "").toUpperCase();
                    T[e] = t
                }, T.defaultWKTs = {
                    "EPSG:4490": 'GEOGCS["China Geodetic Coordinate System 2000",DATUM["China_2000",SPHEROID["CGCS2000",6378137,298.257222101,AUTHORITY["EPSG","1024"]],AUTHORITY["EPSG","1043"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4490"]]',
                    "EPSG:4214": 'GEOGCS["Beijing 1954",DATUM["Beijing_1954",SPHEROID["Krassowsky 1940",6378245,298.3],TOWGS84[15.8,-154.4,-82.3,0,0,0,0]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4214"]]',
                    "EPSG:4610": 'GEOGCS["Xian 1980",DATUM["Xian_1980",SPHEROID["IAG 1975",6378140,298.257,AUTHORITY["EPSG","7049"]],AUTHORITY["EPSG","6610"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4610"]]'
                }, T.EPSG4326 = new T("EPSG:4326", [-180, -90, 180, 90]), T.EPSG4490 = new T("EPSG:4490", [-180, -90, 180, 90]), T.EPSG4214 = new T("EPSG:4214", [-180, -90, 180, 90]), T.EPSG4610 = new T("EPSG:4610", [-180, -90, 180, 90]), T.EPSG3857 = new T("EPSG:3857", [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]);
                var Cn = {
                    "FullscreenControl.Enter": "Enter fullscreen",
                    "FullscreenControl.Exit": "Exit fullscreen",
                    "GeolocateControl.FindMyLocation": "Find my location",
                    "GeolocateControl.LocationNotAvailable": "Location not available",
                    "LogoControl.Title": "Mapbox logo",
                    "NavigationControl.ResetBearing": "Reset bearing to north",
                    "NavigationControl.ZoomIn": "Zoom in",
                    "NavigationControl.ZoomOut": "Zoom out",
                    "ScaleControl.Feet": "ft",
                    "ScaleControl.Meters": "m",
                    "ScaleControl.Kilometers": "km",
                    "ScaleControl.Miles": "mi",
                    "ScaleControl.NauticalMiles": "nm"
                }, Pn = ot.window.HTMLImageElement, An = ot.window.HTMLElement, zn = ot.window.ImageBitmap, kn = {
                    center: [0, 0],
                    zoom: 0,
                    bearing: 0,
                    pitch: 0,
                    minZoom: -2,
                    maxZoom: 22,
                    minPitch: 0,
                    maxPitch: 60,
                    interactive: !0,
                    scrollZoom: !0,
                    boxZoom: !0,
                    dragRotate: !0,
                    dragPan: !0,
                    keyboard: !0,
                    doubleClickZoom: !0,
                    touchZoomRotate: !0,
                    touchPitch: !0,
                    bearingSnap: 7,
                    clickTolerance: 3,
                    pitchWithRotate: !0,
                    hash: !1,
                    attributionControl: !0,
                    failIfMajorPerformanceCaveat: !1,
                    preserveDrawingBuffer: !1,
                    trackResize: !0,
                    renderWorldCopies: !0,
                    refreshExpiredTiles: !0,
                    maxTileCacheSize: null,
                    localIdeographFontFamily: "sans-serif",
                    transformRequest: null,
                    accessToken: null,
                    fadeDuration: 300,
                    crossSourceCollisions: !0
                }, Ln = function (u) {
                    function t(t) {
                        var e = this;
                        if (null != (t = ot.extend({}, kn, t)).minZoom && null != t.maxZoom && t.minZoom > t.maxZoom) throw new Error("maxZoom must be greater than or equal to minZoom");
                        if (null != t.minPitch && null != t.maxPitch && t.minPitch > t.maxPitch) throw new Error("maxPitch must be greater than or equal to minPitch");
                        if (null != t.minPitch && t.minPitch < 0) throw new Error("minPitch must be greater than or equal to 0");
                        if (null != t.maxPitch && t.maxPitch > 60) throw new Error("maxPitch must be less than or equal to 60");
                        var i = new h(t.minZoom, t.maxZoom, t.minPitch, t.maxPitch, t.renderWorldCopies);
                        if (u.call(this, i, t), this.transform = i, this.crs = this.toCRS(t.crs), this.initCRS(this.crs), this._interactive = t.interactive, this._maxTileCacheSize = t.maxTileCacheSize, this._failIfMajorPerformanceCaveat = t.failIfMajorPerformanceCaveat, this._preserveDrawingBuffer = t.preserveDrawingBuffer, this._antialias = t.antialias, this._trackResize = t.trackResize, this._bearingSnap = t.bearingSnap, this._refreshExpiredTiles = t.refreshExpiredTiles, this._fadeDuration = t.fadeDuration, this._crossSourceCollisions = t.crossSourceCollisions, this._crossFadingFactor = 1, this._collectResourceTiming = t.collectResourceTiming, this._renderTaskQueue = new In, this._controls = [], this._markersCache = [], this._mapId = ot.uniqueId(), this._locale = ot.extend({}, Cn, t.locale), this._requestManager = new ot.RequestManager(t.transformRequest, t.accessToken), "string" == typeof t.container) {
                            if (this._container = ot.window.document.getElementById(t.container), !this._container) throw new Error("Container '" + t.container + "' not found.")
                        } else {
                            if (!(t.container instanceof An)) throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
                            this._container = t.container
                        }
                        if (t.maxBounds && this.setMaxBounds(t.maxBounds), ot.bindAll(["_onWindowOnline", "_onWindowResize", "_contextLost", "_contextRestored"], this), this._setupContainer(), this._setupPainter(), void 0 === this.painter) throw new Error("Failed to initialize WebGL.");
                        this.on("move", function () {
                            return e._update(!1)
                        }), this.on("moveend", function () {
                            return e._update(!1)
                        }), this.on("zoom", function () {
                            return e._update(!0)
                        }), void 0 !== ot.window && (ot.window.addEventListener("online", this._onWindowOnline, !1), ot.window.addEventListener("resize", this._onWindowResize, !1), ot.window.addEventListener("orientationchange", this._onWindowResize, !1)), this.handlers = new g(this, t), this._hash = t.hash && new Nr("string" == typeof t.hash && t.hash || void 0).addTo(this), this._hash && this._hash._onHashChange() || (this.jumpTo({
                            center: t.center,
                            zoom: t.zoom,
                            bearing: t.bearing,
                            pitch: t.pitch
                        }), t.bounds && (this.resize(), this.fitBounds(t.bounds, ot.extend({}, t.fitBoundsOptions, {duration: 0})))), this.resize(), this._localIdeographFontFamily = t.localIdeographFontFamily, t.style && this.setStyle(t.style, {localIdeographFontFamily: t.localIdeographFontFamily}), t.attributionControl && this.addControl(new Sn({customAttribution: t.customAttribution})), this.addControl(new En, t.logoPosition), this.on("style.load", function () {
                            e.transform.unmodified && e.jumpTo(e.style.stylesheet)
                        }), this.on("data", function (t) {
                            e._update("style" === t.dataType), e.fire(new ot.Event(t.dataType + "data", t))
                        }), this.on("dataloading", function (t) {
                            e.fire(new ot.Event(t.dataType + "dataloading", t))
                        })
                    }

                    u && (t.__proto__ = u), (t.prototype = Object.create(u && u.prototype)).constructor = t;
                    var e = {
                        showTileBoundaries: {configurable: !0},
                        showPadding: {configurable: !0},
                        showCollisionBoxes: {configurable: !0},
                        showOverdrawInspector: {configurable: !0},
                        repaint: {configurable: !0},
                        vertices: {configurable: !0},
                        version: {configurable: !0}
                    };
                    return t.prototype.toCRS = function (t) {
                        if (t && "string" == typeof t && !(t = T.get(t))) throw new Error("crs " + t + " is not define");
                        return t || T.EPSG3857
                    }, t.prototype.getCRS = function () {
                        return this.crs
                    }, t.prototype._getMapId = function () {
                        return this._mapId
                    }, t.prototype.addControl = function (t, e) {
                        if (void 0 === e && t.getDefaultPosition && (e = t.getDefaultPosition()), void 0 === e && (e = "top-right"), !t || !t.onAdd) return this.fire(new ot.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
                        var i = t.onAdd(this);
                        this._controls.push(t);
                        var r = this._controlPositions[e];
                        return -1 !== e.indexOf("bottom") ? r.insertBefore(i, r.firstChild) : r.appendChild(i), this
                    }, t.prototype.removeControl = function (t) {
                        if (!t || !t.onRemove) return this.fire(new ot.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));
                        var e = this._controls.indexOf(t);
                        return e > -1 && this._controls.splice(e, 1), t.onRemove(this), this
                    }, t.prototype.resize = function (t) {
                        var e = this._containerDimensions(), i = e[0], r = e[1];
                        this._resizeCanvas(i, r), this.transform.resize(i, r), this.painter.resize(i, r);
                        var n = !this._moving;
                        return n && (this.stop(), this.fire(new ot.Event("movestart", t)).fire(new ot.Event("move", t))), this.fire(new ot.Event("resize", t)), n && this.fire(new ot.Event("moveend", t)), this
                    }, t.prototype.getBounds = function () {
                        return this.transform.getBounds()
                    }, t.prototype.getMaxBounds = function () {
                        return this.transform.getMaxBounds()
                    }, t.prototype.setMaxBounds = function (t) {
                        return this.transform.setMaxBounds(ot.LngLatBounds.convert(t)), this._update()
                    }, t.prototype.setMinZoom = function (t) {
                        if ((t = null == t ? -2 : t) >= -2 && t <= this.transform.maxZoom) return this.transform.minZoom = t, this._update(), this.getZoom() < t && this.setZoom(t), this;
                        throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")
                    }, t.prototype.getMinZoom = function () {
                        return this.transform.minZoom
                    }, t.prototype.setMaxZoom = function (t) {
                        if ((t = null == t ? 22 : t) >= this.transform.minZoom) return this.transform.maxZoom = t, this._update(), this.getZoom() > t && this.setZoom(t), this;
                        throw new Error("maxZoom must be greater than the current minZoom")
                    }, t.prototype.getMaxZoom = function () {
                        return this.transform.maxZoom
                    }, t.prototype.setMinPitch = function (t) {
                        if ((t = null == t ? 0 : t) < 0) throw new Error("minPitch must be greater than or equal to 0");
                        if (t >= 0 && t <= this.transform.maxPitch) return this.transform.minPitch = t, this._update(), this.getPitch() < t && this.setPitch(t), this;
                        throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")
                    }, t.prototype.getMinPitch = function () {
                        return this.transform.minPitch
                    }, t.prototype.setMaxPitch = function (t) {
                        if ((t = null == t ? 60 : t) > 60) throw new Error("maxPitch must be less than or equal to 60");
                        if (t >= this.transform.minPitch) return this.transform.maxPitch = t, this._update(), this.getPitch() > t && this.setPitch(t), this;
                        throw new Error("maxPitch must be greater than the current minPitch")
                    }, t.prototype.getMaxPitch = function () {
                        return this.transform.maxPitch
                    }, t.prototype.getRenderWorldCopies = function () {
                        return this.transform.renderWorldCopies
                    }, t.prototype.setRenderWorldCopies = function (t) {
                        return this.transform.renderWorldCopies = t, this.crs.renderWorldCopies = t, this._update()
                    }, t.prototype.project = function (t) {
                        return this.transform.locationPoint(ot.LngLat.convert(t))
                    }, t.prototype.unproject = function (t) {
                        return this.transform.pointLocation(ot.Point.convert(t))
                    }, t.prototype.isMoving = function () {
                        return this._moving || this.handlers.isMoving()
                    }, t.prototype.isZooming = function () {
                        return this._zooming || this.handlers.isZooming()
                    }, t.prototype.isRotating = function () {
                        return this._rotating || this.handlers.isRotating()
                    }, t.prototype._createDelegatedListener = function (i, r, n) {
                        var t, a = this;
                        if ("mouseenter" === i || "mouseover" === i) {
                            var o = !1;
                            return {
                                layer: r, listener: n, delegates: {
                                    mousemove: function (t) {
                                        var e = a.getLayer(r) ? a.queryRenderedFeatures(t.point, {layers: [r]}) : [];
                                        e.length ? o || (o = !0, n.call(a, new c(i, a, t.originalEvent, {features: e}))) : o = !1
                                    }, mouseout: function () {
                                        o = !1
                                    }
                                }
                            }
                        }
                        if ("mouseleave" === i || "mouseout" === i) {
                            var e = !1;
                            return {
                                layer: r, listener: n, delegates: {
                                    mousemove: function (t) {
                                        (a.getLayer(r) ? a.queryRenderedFeatures(t.point, {layers: [r]}) : []).length ? e = !0 : e && (e = !1, n.call(a, new c(i, a, t.originalEvent)))
                                    }, mouseout: function (t) {
                                        e && (e = !1, n.call(a, new c(i, a, t.originalEvent)))
                                    }
                                }
                            }
                        }
                        return {
                            layer: r, listener: n, delegates: (t = {}, t[i] = function (t) {
                                var e = a.getLayer(r) ? a.queryRenderedFeatures(t.point, {layers: [r]}) : [];
                                e.length && (t.features = e, n.call(a, t), delete t.features)
                            }, t)
                        }
                    }, t.prototype.on = function (t, e, i) {
                        if (void 0 === i) return u.prototype.on.call(this, t, e);
                        var r = this._createDelegatedListener(t, e, i);
                        for (var n in this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[t] = this._delegatedListeners[t] || [], this._delegatedListeners[t].push(r), r.delegates) this.on(n, r.delegates[n]);
                        return this
                    }, t.prototype.once = function (t, e, i) {
                        if (void 0 === i) return u.prototype.once.call(this, t, e);
                        var r = this._createDelegatedListener(t, e, i);
                        for (var n in r.delegates) this.once(n, r.delegates[n]);
                        return this
                    }, t.prototype.off = function (a, o, s) {
                        var l = this;
                        return void 0 === s ? u.prototype.off.call(this, a, o) : (this._delegatedListeners && this._delegatedListeners[a] && function (t) {
                            for (var e = t[a], i = 0; i < e.length; i++) {
                                var r = e[i];
                                if (r.layer === o && r.listener === s) {
                                    for (var n in r.delegates) l.off(n, r.delegates[n]);
                                    return e.splice(i, 1), l
                                }
                            }
                        }(this._delegatedListeners), this)
                    }, t.prototype.queryRenderedFeatures = function (t, e) {
                        if (!this.style) return [];
                        var i;
                        if (void 0 !== e || void 0 === t || t instanceof ot.Point || Array.isArray(t) || (e = t, t = void 0), e = e || {}, (t = t || [[0, 0], [this.transform.width, this.transform.height]]) instanceof ot.Point || "number" == typeof t[0]) i = [ot.Point.convert(t)]; else {
                            var r = ot.Point.convert(t[0]), n = ot.Point.convert(t[1]);
                            i = [r, new ot.Point(n.x, r.y), n, new ot.Point(r.x, n.y), r]
                        }
                        return this.style.queryRenderedFeatures(i, e, this.transform)
                    }, t.prototype.querySourceFeatures = function (t, e) {
                        return this.style.querySourceFeatures(t, e)
                    }, t.prototype.setStyle = function (t, e) {
                        return !1 !== (e = ot.extend({}, {localIdeographFontFamily: this._localIdeographFontFamily}, e)).diff && e.localIdeographFontFamily === this._localIdeographFontFamily && this.style && t ? (this._diffStyle(t, e), this) : (this._localIdeographFontFamily = e.localIdeographFontFamily, this._updateStyle(t, e))
                    }, t.prototype._getUIString = function (t) {
                        var e = this._locale[t];
                        if (null == e) throw new Error("Missing UI string '" + t + "'");
                        return e
                    }, t.prototype._updateStyle = function (t, e) {
                        return this.style && (this.style.setEventedParent(null), this.style._remove()), t ? (this.style = new ui(this, e || {}), this.style.setEventedParent(this, {style: this.style}), "string" == typeof t ? this.style.loadURL(t) : this.style.loadJSON(t), this) : (delete this.style, this)
                    }, t.prototype._lazyInitEmptyStyle = function () {
                        this.style || (this.style = new ui(this, {}), this.style.setEventedParent(this, {style: this.style}), this.style.loadEmpty())
                    }, t.prototype._diffStyle = function (t, i) {
                        var r = this;
                        if ("string" == typeof t) {
                            var e = this._requestManager.normalizeStyleURL(t),
                                n = this._requestManager.transformRequest(e, ot.ResourceType.Style);
                            ot.getJSON(n, function (t, e) {
                                t ? r.fire(new ot.ErrorEvent(t)) : e && r._updateDiff(e, i)
                            })
                        } else "object" == typeof t && this._updateDiff(t, i)
                    }, t.prototype._updateDiff = function (t, e) {
                        var i = t.sources;
                        if ("string" == typeof t.sprite) {
                            var r = {};
                            for (var n in i) r[n] = t.sprite;
                            t.sprite = r
                        }
                        if ("string" == typeof t.glyphs) {
                            var a = {};
                            for (var o in i) a[o] = t.glyphs;
                            t.glyphs = a
                        }
                        try {
                            this.style.setState(t) && this._update(!0)
                        } catch (i) {
                            ot.warnOnce("Unable to perform style diff: " + (i.message || i.error || i) + ".  Rebuilding the style from scratch."), this._updateStyle(t, e)
                        }
                    }, t.prototype.addStyle = function (t, i, r, n) {
                        var a = this;
                        if ("string" == typeof t) {
                            this.fire(new ot.Event("dataloading", {dataType: "style"}));
                            var e = this._requestManager.transformRequest(this._requestManager.normalizeStyleURL(t), ot.ResourceType.Style);
                            ot.getJSON(e, function (t, e) {
                                t ? a.fire(new ot.ErrorEvent(t)) : e && a._loadByAdd(e, i, r, n)
                            })
                        } else this._loadByAdd(JSON.parse(JSON.stringify(t)), i, r, n)
                    }, t.prototype._loadByAdd = function (t, e, i, r) {
                        var n = this, a = t.layers, o = t.sources, s = t.sprite || {}, l = t.glyphs || {};
                        for (var u in o) this.addSource(u, o[u]), "string" == typeof s ? this.style.addSprite(u, s) : s[u] && this.style.addSprite(u, s[u]), "string" == typeof l ? this.style.addGlyphs(u, l) : l[u] && this.style.addGlyphs(u, l[u]);
                        a.forEach(function (t) {
                            "background" != t.type && (n.addLayer(t, e), isNaN(i) && isNaN(r) || n.setLayerZoomRange(t.id, i, r))
                        })
                    }, t.prototype.getStyle = function () {
                        if (this.style) return this.style.serialize()
                    }, t.prototype.isStyleLoaded = function () {
                        return this.style ? this.style.loaded() : ot.warnOnce("There is no style added to the map.")
                    }, t.prototype.addSource = function (t, e) {
                        return this._mapCRS && "geojson" == e.type && e.data && !e.data.customprj && (e.customprj = this.customConvertPoint), this._lazyInitEmptyStyle(), this.style.addSource(t, e), this._update(!0)
                    }, t.prototype.isSourceLoaded = function (t) {
                        var e = this.style && this.style.sourceCaches[t];
                        if (void 0 !== e) return e.loaded();
                        this.fire(new ot.ErrorEvent(new Error("There is no source with ID '" + t + "'")))
                    }, t.prototype.areTilesLoaded = function () {
                        var t = this.style && this.style.sourceCaches;
                        for (var e in t) {
                            var i = t[e]._tiles;
                            for (var r in i) {
                                var n = i[r];
                                if ("loaded" !== n.state && "errored" !== n.state) return !1
                            }
                        }
                        return !0
                    }, t.prototype.addSourceType = function (t, e, i) {
                        return this._lazyInitEmptyStyle(), this.style.addSourceType(t, e, i)
                    }, t.prototype.removeSource = function (t) {
                        return this.style.removeSource(t), this._update(!0)
                    }, t.prototype.getSource = function (t) {
                        return this.style.getSource(t)
                    }, t.prototype.addImage = function (t, e, i) {
                        void 0 === i && (i = {});
                        var r = i.pixelRatio;
                        void 0 === r && (r = 1);
                        var n = i.sdf;
                        void 0 === n && (n = !1);
                        var a = i.stretchX, o = i.stretchY, s = i.content;
                        if (this._lazyInitEmptyStyle(), e instanceof Pn || zn && e instanceof zn) {
                            var l = ot.browser.getImageData(e);
                            this.style.addImage(t, {
                                data: new ot.RGBAImage({width: l.width, height: l.height}, l.data),
                                pixelRatio: r,
                                stretchX: a,
                                stretchY: o,
                                content: s,
                                sdf: n,
                                version: 0
                            })
                        } else {
                            if (void 0 === e.width || void 0 === e.height) return this.fire(new ot.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
                            var u = e;
                            this.style.addImage(t, {
                                data: new ot.RGBAImage({
                                    width: e.width,
                                    height: e.height
                                }, new Uint8Array(e.data)),
                                pixelRatio: r,
                                stretchX: a,
                                stretchY: o,
                                content: s,
                                sdf: n,
                                version: 0,
                                userImage: u
                            }), u.onAdd && u.onAdd(this, t)
                        }
                    }, t.prototype.updateImage = function (t, e) {
                        var i = this.style.getImage(t);
                        if (!i) return this.fire(new ot.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
                        var r = e instanceof Pn || zn && e instanceof zn ? ot.browser.getImageData(e) : e, n = r.width,
                            a = r.height, o = r.data;
                        return void 0 === n || void 0 === a ? this.fire(new ot.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : n !== i.data.width || a !== i.data.height ? this.fire(new ot.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (i.data.replace(o, !(e instanceof Pn || zn && e instanceof zn)), void this.style.updateImage(t, i))
                    }, t.prototype.hasImage = function (t) {
                        return t ? !!this.style.getImage(t) : (this.fire(new ot.ErrorEvent(new Error("Missing required image id"))), !1)
                    }, t.prototype.removeImage = function (t) {
                        this.style.removeImage(t)
                    }, t.prototype.loadImage = function (t, e) {
                        ot.getImage(this._requestManager.transformRequest(t, ot.ResourceType.Image), e)
                    }, t.prototype.listImages = function () {
                        return this.style.listImages()
                    }, t.prototype.listMarkers = function () {
                        return this._markersCache
                    }, t.prototype.addLayer = function (t, e) {
                        return "object" == typeof t.source && this._mapCRS && t.source && "geojson" == t.source.type && t.source.data && !t.source.data.customprj && (t.source.customprj = this.customConvertPoint), this._lazyInitEmptyStyle(), this.style.addLayer(t, e), this._update(!0)
                    }, t.prototype.moveLayer = function (t, e) {
                        return this.style.moveLayer(t, e), this._update(!0)
                    }, t.prototype.removeLayer = function (t) {
                        return this.style.removeLayer(t), this._update(!0)
                    }, t.prototype.getLayer = function (t) {
                        return this.style.getLayer(t)
                    }, t.prototype.setLayerZoomRange = function (t, e, i) {
                        return this.style.setLayerZoomRange(t, e, i), this._update(!0)
                    }, t.prototype.setFilter = function (t, e, i) {
                        return void 0 === i && (i = {}), this.style.setFilter(t, e, i), this._update(!0)
                    }, t.prototype.getFilter = function (t) {
                        return this.style.getFilter(t)
                    }, t.prototype.setPaintProperty = function (t, e, i, r) {
                        return void 0 === r && (r = {}), this.style.setPaintProperty(t, e, i, r), this._update(!0)
                    }, t.prototype.getPaintProperty = function (t, e) {
                        return this.style.getPaintProperty(t, e)
                    }, t.prototype.setLayoutProperty = function (t, e, i, r) {
                        return void 0 === r && (r = {}), this.style.setLayoutProperty(t, e, i, r), this._update(!0)
                    }, t.prototype.getLayoutProperty = function (t, e) {
                        return this.style.getLayoutProperty(t, e)
                    }, t.prototype.setLight = function (t, e) {
                        return void 0 === e && (e = {}), this._lazyInitEmptyStyle(), this.style.setLight(t, e), this._update(!0)
                    }, t.prototype.getLight = function () {
                        return this.style.getLight()
                    }, t.prototype.setFeatureState = function (t, e) {
                        return this.style.setFeatureState(t, e), this._update()
                    }, t.prototype.removeFeatureState = function (t, e) {
                        return this.style.removeFeatureState(t, e), this._update()
                    }, t.prototype.getFeatureState = function (t) {
                        return this.style.getFeatureState(t)
                    }, t.prototype.getContainer = function () {
                        return this._container
                    }, t.prototype.getCanvasContainer = function () {
                        return this._canvasContainer
                    }, t.prototype.getCanvas = function () {
                        return this._canvas
                    }, t.prototype._containerDimensions = function () {
                        var t = 0, e = 0;
                        return this._container && (t = this._container.clientWidth || 400, e = this._container.clientHeight || 300), [t, e]
                    }, t.prototype._detectMissingCSS = function () {
                        "rgb(250, 128, 114)" !== ot.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") && ot.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")
                    }, t.prototype._setupContainer = function () {
                        var t = this._container;
                        t.classList.add("mapboxgl-map"), (this._missingCSSCanary = x.create("div", "mapboxgl-canary", t)).style.visibility = "hidden", this._detectMissingCSS();
                        var e = this._canvasContainer = x.create("div", "mapboxgl-canvas-container", t);
                        this._interactive && e.classList.add("mapboxgl-interactive"), this._canvas = x.create("canvas", "mapboxgl-canvas", e), this._canvas.addEventListener("webglcontextlost", this._contextLost, !1), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, !1), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map");
                        var i = this._containerDimensions();
                        this._resizeCanvas(i[0], i[1]);
                        var r = this._controlContainer = x.create("div", "mapboxgl-control-container", t),
                            n = this._controlPositions = {};
                        ["top-left", "top-right", "bottom-left", "bottom-right"].forEach(function (t) {
                            n[t] = x.create("div", "mapboxgl-ctrl-" + t, r)
                        })
                    }, t.prototype._resizeCanvas = function (t, e) {
                        var i = ot.browser.devicePixelRatio || 1;
                        this._canvas.width = i * t, this._canvas.height = i * e, this._canvas.style.width = t + "px", this._canvas.style.height = e + "px"
                    }, t.prototype._setupPainter = function () {
                        var t = ot.extend({}, A.webGLContextAttributes, {
                            failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,
                            preserveDrawingBuffer: this._preserveDrawingBuffer,
                            antialias: this._antialias || !1
                        }), e = this._canvas.getContext("webgl", t) || this._canvas.getContext("experimental-webgl", t);
                        e ? (this.painter = new l(e, this.transform), ot.webpSupported.testSupport(e)) : this.fire(new ot.ErrorEvent(new Error("Failed to initialize WebGL")))
                    }, t.prototype._contextLost = function (t) {
                        t.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new ot.Event("webglcontextlost", {originalEvent: t}))
                    }, t.prototype._contextRestored = function (t) {
                        this._setupPainter(), this.resize(), this._update(), this.fire(new ot.Event("webglcontextrestored", {originalEvent: t}))
                    }, t.prototype.loaded = function () {
                        return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded()
                    }, t.prototype._update = function (t) {
                        return this.style ? (this._styleDirty = this._styleDirty || t, this._sourcesDirty = !0, this.triggerRepaint(), this) : this
                    }, t.prototype._requestRenderFrame = function (t) {
                        return this._update(), this._renderTaskQueue.add(t)
                    }, t.prototype._cancelRenderFrame = function (t) {
                        this._renderTaskQueue.remove(t)
                    }, t.prototype._render = function (t) {
                        var e, i = this, r = 0, n = this.painter.context.extTimerQuery;
                        if (this.listens("gpu-timing-frame") && (e = n.createQueryEXT(), n.beginQueryEXT(n.TIME_ELAPSED_EXT, e), r = ot.browser.now()), this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(t), !this._removed) {
                            var a = !1;
                            if (this.style && this._styleDirty) {
                                this._styleDirty = !1;
                                var o = this.transform.zoom, s = ot.browser.now();
                                this.style.zoomHistory.update(o, s);
                                var l = new ot.EvaluationParameters(o, {
                                    now: s,
                                    fadeDuration: this._fadeDuration,
                                    zoomHistory: this.style.zoomHistory,
                                    transition: this.style.getTransition()
                                }), u = l.crossFadingFactor();
                                1 === u && u === this._crossFadingFactor || (a = !0, this._crossFadingFactor = u), this.style.update(l)
                            }
                            if (this.style && this._sourcesDirty && (this._sourcesDirty = !1, this.style._updateSources(this.transform)), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, this._fadeDuration, this._crossSourceCollisions), this.painter.render(this.style, {
                                showTileBoundaries: this.showTileBoundaries,
                                showOverdrawInspector: this._showOverdrawInspector,
                                rotating: this.isRotating(),
                                zooming: this.isZooming(),
                                moving: this.isMoving(),
                                fadeDuration: this._fadeDuration,
                                showPadding: this.showPadding,
                                gpuTiming: !!this.listens("gpu-timing-layer")
                            }), this.fire(new ot.Event("render")), this.loaded() && !this._loaded && (this._loaded = !0, this.fire(new ot.Event("load"))), this.style && (this.style.hasTransitions() || a) && (this._styleDirty = !0), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
                                var h = ot.browser.now() - r;
                                n.endQueryEXT(n.TIME_ELAPSED_EXT, e), setTimeout(function () {
                                    var t = n.getQueryObjectEXT(e, n.QUERY_RESULT_EXT) / 1e6;
                                    n.deleteQueryEXT(e), i.fire(new ot.Event("gpu-timing-frame", {
                                        cpuTime: h,
                                        gpuTime: t
                                    }))
                                }, 50)
                            }
                            if (this.listens("gpu-timing-layer")) {
                                var c = this.painter.collectGpuTimers();
                                setTimeout(function () {
                                    var t = i.painter.queryGpuTimers(c);
                                    i.fire(new ot.Event("gpu-timing-layer", {layerTimes: t}))
                                }, 50)
                            }
                            var p = this._sourcesDirty || this._styleDirty || this._placementDirty;
                            return p || this._repaint ? this.triggerRepaint() : !this.isMoving() && this.loaded() && this.fire(new ot.Event("idle")), !this._loaded || this._fullyLoaded || p || (this._fullyLoaded = !0), this
                        }
                    }, t.prototype.remove = function () {
                        this._hash && this._hash.remove();
                        for (var t = 0, e = this._controls; t < e.length; t += 1) e[t].onRemove(this);
                        this._controls = [], this._markersCache = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), void 0 !== ot.window && (ot.window.removeEventListener("resize", this._onWindowResize, !1), ot.window.removeEventListener("orientationchange", this._onWindowResize, !1), ot.window.removeEventListener("online", this._onWindowOnline, !1));
                        var i = this.painter.context.gl.getExtension("WEBGL_lose_context");
                        i && i.loseContext(), Dn(this._canvasContainer), Dn(this._controlContainer), Dn(this._missingCSSCanary), this._container.classList.remove("mapboxgl-map"), this._removed = !0, this.fire(new ot.Event("remove"))
                    }, t.prototype.triggerRepaint = function () {
                        var e = this;
                        this.style && !this._frame && (this._frame = ot.browser.frame(function (t) {
                            e._frame = null, e._render(t)
                        }))
                    }, t.prototype._onWindowOnline = function () {
                        this._update()
                    }, t.prototype._onWindowResize = function (t) {
                        this._trackResize && this.resize({originalEvent: t})._update()
                    }, e.showTileBoundaries.get = function () {
                        return !!this._showTileBoundaries
                    }, e.showTileBoundaries.set = function (t) {
                        this._showTileBoundaries !== t && (this._showTileBoundaries = t, this._update())
                    }, e.showPadding.get = function () {
                        return !!this._showPadding
                    }, e.showPadding.set = function (t) {
                        this._showPadding !== t && (this._showPadding = t, this._update())
                    }, e.showCollisionBoxes.get = function () {
                        return !!this._showCollisionBoxes
                    }, e.showCollisionBoxes.set = function (t) {
                        this._showCollisionBoxes !== t && (this._showCollisionBoxes = t, t ? this.style._generateCollisionBoxes() : this._update())
                    }, e.showOverdrawInspector.get = function () {
                        return !!this._showOverdrawInspector
                    }, e.showOverdrawInspector.set = function (t) {
                        this._showOverdrawInspector !== t && (this._showOverdrawInspector = t, this._update())
                    }, e.repaint.get = function () {
                        return !!this._repaint
                    }, e.repaint.set = function (t) {
                        this._repaint !== t && (this._repaint = t, this.triggerRepaint())
                    }, e.vertices.get = function () {
                        return !!this._vertices
                    }, e.vertices.set = function (t) {
                        this._vertices = t, this._update()
                    }, t.prototype._setCacheLimits = function (t, e) {
                        ot.setCacheLimits(t, e)
                    },t.prototype.setCRS = function (t) {
                        this.crs = this.toCRS(t), this.initCRS(this.crs);
                        var e = this.style && this.style.sourceCaches;
                        if (e) for (var i in e) this._mapCRS && "geojson" == e[i]._source.type && this.style.getSource(i).setCustomprj(this.customConvertPoint);
                        this._sourcesDirty = !0, this._canvas && this.resize(), this._update(!0)
                    },t.prototype.initCRS = function (i) {
                        this._mapCRS = i, this.transform.setCRS(i), this._tileExtent = i.getExtent();
                        var r = this._tileExtent[2] - this._tileExtent[0],
                            n = this._tileExtent[3] - this._tileExtent[1],
                            t = (this._tileExtent[2] + this._tileExtent[0]) / 2,
                            e = (this._tileExtent[3] + this._tileExtent[1]) / 2, a = this._tileExtent[0],
                            o = this._tileExtent[3];
                        ot.Feature.yLat = function (t, e) {
                            return o - t * n / e
                        }, ot.Feature.toLngLat = function (t, e) {
                            return i.toWGS84([t * r + a, o - e * n])
                        }, this.mercatorZfromAltitude = ot.mercatorZfromAltitude, this.updateTransformByCRS(i.getUnit(), a, o, t, e, r, n)
                    },t.prototype.updateTransformByCRS = function (t, e, i, r, n, a, o) {
                        this.transform.units = t;
                        var s = function (t, e, i) {
                            var r = "";
                            for (var n in t) Object.hasOwnProperty.call(t, n) && (r += n + ":" + t[n] + ",");
                            for (var a in i) if (Object.hasOwnProperty.call(i, a)) {
                                var o = "(" + i[a] + ")";
                                r = r.replace(new RegExp('"' + a + '"', "g"), o)
                            }
                            return "customConvertPoint={" + r + "}"
                        }({
                            toLngLat: function (t, e, i) {
                                return i.inverse(["__width" * t + "__originX", "__originY" - "__height" * e])
                            }, projectXY: function (t, e, i) {
                                var r = i.forward([t, e]);
                                return [(r[0] - "__originX") / "__width", ("__originY" - r[1]) / "__height"]
                            }, projectX: function (t) {
                                return (t - "__centerX") / "__width" + .5
                            }, projectY: function (t) {
                                return (t = .5 - (t - "__centerY") / "__height") < 0 ? 0 : t > 1 ? 1 : t
                            }, toY: function (t) {
                                return "__height" * (.5 - t) + "__centerY"
                            }
                        }, 0, {__width: a, __height: o, __centerX: r, __centerY: n, __originY: i, __originX: e});
                        this.customConvertPoint = ot.window.URL.createObjectURL(new Blob([s], {type: "text/javascript"}))
                    },e.version.get = function () {
                        return ot.version
                    },Object.defineProperties(t.prototype, e),t
                }(Mn);

                function Dn(t) {
                    t.parentNode && t.parentNode.removeChild(t)
                }

                var Rn = {showCompass: !0, showZoom: !0, visualizePitch: !1}, Bn = function (t) {
                    var e = this;
                    this.options = ot.extend({}, Rn, t), this._container = x.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._container.addEventListener("contextmenu", function (t) {
                        return t.preventDefault()
                    }), this.options.showZoom && (ot.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("mapboxgl-ctrl-zoom-in", function (t) {
                        return e._map.zoomIn({}, {originalEvent: t})
                    }), x.create("span", "mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", !0), this._zoomOutButton = this._createButton("mapboxgl-ctrl-zoom-out", function (t) {
                        return e._map.zoomOut({}, {originalEvent: t})
                    }), x.create("span", "mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", !0)), this.options.showCompass && (ot.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("mapboxgl-ctrl-compass", function (t) {
                        e.options.visualizePitch ? e._map.resetNorthPitch({}, {originalEvent: t}) : e._map.resetNorth({}, {originalEvent: t})
                    }), this._compassIcon = x.create("span", "mapboxgl-ctrl-icon", this._compass), this._compassIcon.setAttribute("aria-hidden", !0))
                };
                Bn.prototype._updateZoomButtons = function () {
                    var t = this._map.getZoom();
                    this._zoomInButton.disabled = t === this._map.getMaxZoom(), this._zoomOutButton.disabled = t === this._map.getMinZoom()
                }, Bn.prototype._rotateCompassArrow = function () {
                    var t = this.options.visualizePitch ? "rotateX(" + this._map.transform.pitch + "deg) rotateZ(" + this._map.transform.angle * (180 / Math.PI) + "deg)" : "rotate(" + this._map.transform.angle + "deg)";
                    this._compassIcon.style.transform = t
                }, Bn.prototype.onAdd = function (t) {
                    return this._map = t, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new C(this._map, this._compass, this.options.visualizePitch)), this._container
                }, Bn.prototype.onRemove = function () {
                    x.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map
                }, Bn.prototype._createButton = function (t, e) {
                    var i = x.create("button", t, this._container);
                    return i.type = "button", i.addEventListener("click", e), i
                }, Bn.prototype._setButtonTitle = function (t, e) {
                    var i = this._map._getUIString("NavigationControl." + e);
                    t.title = i, t.setAttribute("aria-label", i)
                };
                var C = function (t, e, i) {
                    void 0 === i && (i = !1), this._clickTolerance = 10, this.element = e, this.mouseRotate = new rn({clickTolerance: t.dragRotate._mouseRotate._clickTolerance}), this.map = t, i && (this.mousePitch = new nn({clickTolerance: t.dragRotate._mousePitch._clickTolerance})), ot.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), x.addEventListener(e, "mousedown", this.mousedown), x.addEventListener(e, "touchstart", this.touchstart, {passive: !1}), x.addEventListener(e, "touchmove", this.touchmove), x.addEventListener(e, "touchend", this.touchend), x.addEventListener(e, "touchcancel", this.reset)
                };

                function On(t, e, i) {
                    if (t = new ot.LngLat(t.lng, t.lat), e) {
                        var r = new ot.LngLat(t.lng - 360, t.lat), n = new ot.LngLat(t.lng + 360, t.lat),
                            a = i.locationPoint(t).distSqr(e);
                        i.locationPoint(r).distSqr(e) < a ? t = r : i.locationPoint(n).distSqr(e) < a && (t = n)
                    }
                    for (; Math.abs(t.lng - i.center.lng) > 180;) {
                        var o = i.locationPoint(t);
                        if (o.x >= 0 && o.y >= 0 && o.x <= i.width && o.y <= i.height) break;
                        t.lng > i.center.lng ? t.lng -= 360 : t.lng += 360
                    }
                    return t
                }

                C.prototype.down = function (t, e) {
                    this.mouseRotate.mousedown(t, e), this.mousePitch && this.mousePitch.mousedown(t, e), x.disableDrag()
                }, C.prototype.move = function (t, e) {
                    var i = this.map, r = this.mouseRotate.mousemoveWindow(t, e);
                    if (r && r.bearingDelta && i.setBearing(i.getBearing() + r.bearingDelta), this.mousePitch) {
                        var n = this.mousePitch.mousemoveWindow(t, e);
                        n && n.pitchDelta && i.setPitch(i.getPitch() + n.pitchDelta)
                    }
                }, C.prototype.off = function () {
                    var t = this.element;
                    x.removeEventListener(t, "mousedown", this.mousedown), x.removeEventListener(t, "touchstart", this.touchstart, {passive: !1}), x.removeEventListener(t, "touchmove", this.touchmove), x.removeEventListener(t, "touchend", this.touchend), x.removeEventListener(t, "touchcancel", this.reset), this.offTemp()
                }, C.prototype.offTemp = function () {
                    x.enableDrag(), x.removeEventListener(ot.window, "mousemove", this.mousemove), x.removeEventListener(ot.window, "mouseup", this.mouseup)
                }, C.prototype.mousedown = function (t) {
                    this.down(ot.extend({}, t, {
                        ctrlKey: !0, preventDefault: function () {
                            return t.preventDefault()
                        }
                    }), x.mousePos(this.element, t)), x.addEventListener(ot.window, "mousemove", this.mousemove), x.addEventListener(ot.window, "mouseup", this.mouseup)
                }, C.prototype.mousemove = function (t) {
                    this.move(t, x.mousePos(this.element, t))
                }, C.prototype.mouseup = function (t) {
                    this.mouseRotate.mouseupWindow(t), this.mousePitch && this.mousePitch.mouseupWindow(t), this.offTemp()
                }, C.prototype.touchstart = function (t) {
                    1 !== t.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = x.touchPos(this.element, t.targetTouches)[0], this.down({
                        type: "mousedown",
                        button: 0,
                        ctrlKey: !0,
                        preventDefault: function () {
                            return t.preventDefault()
                        }
                    }, this._startPos))
                }, C.prototype.touchmove = function (t) {
                    1 !== t.targetTouches.length ? this.reset() : (this._lastPos = x.touchPos(this.element, t.targetTouches)[0], this.move({
                        preventDefault: function () {
                            return t.preventDefault()
                        }
                    }, this._lastPos))
                }, C.prototype.touchend = function (t) {
                    0 === t.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset()
                }, C.prototype.reset = function () {
                    this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp()
                };
                var Fn = {
                    center: "translate(-50%,-50%)",
                    top: "translate(-50%,0)",
                    "top-left": "translate(0,0)",
                    "top-right": "translate(-100%,0)",
                    bottom: "translate(-50%,-100%)",
                    "bottom-left": "translate(0,-100%)",
                    "bottom-right": "translate(-100%,-100%)",
                    left: "translate(0,-50%)",
                    right: "translate(-100%,-50%)"
                };

                function Un(t, e, i) {
                    var r = t.classList;
                    for (var n in Fn) r.remove("mapboxgl-" + i + "-anchor-" + n);
                    r.add("mapboxgl-" + i + "-anchor-" + e)
                }

                var Nn, Vn = function (v) {
                    function t(t, e) {
                        var i = this;
                        if (v.call(this), (t instanceof ot.window.HTMLElement || e) && (t = ot.extend({element: t}, e)), ot.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], this), this._anchor = t && t.anchor || "center", this._color = t && t.color || "#3FB1CE", this._scale = t && t.scale || 1, this._draggable = t && t.draggable || !1, this._state = "inactive", this._rotation = t && t.rotation || 0, this._rotationAlignment = t && t.rotationAlignment || "auto", this._pitchAlignment = t && t.pitchAlignment && "auto" !== t.pitchAlignment ? t.pitchAlignment : this._rotationAlignment, t && t.element) this._element = t.element, this._offset = ot.Point.convert(t && t.offset || [0, 0]); else {
                            this._defaultMarker = !0, this._element = x.create("div"), this._element.setAttribute("aria-label", "Map marker");
                            var r = x.createNS("http://www.w3.org/2000/svg", "svg");
                            r.setAttributeNS(null, "display", "block"), r.setAttributeNS(null, "height", "41px"), r.setAttributeNS(null, "width", "27px"), r.setAttributeNS(null, "viewBox", "0 0 27 41");
                            var n = x.createNS("http://www.w3.org/2000/svg", "g");
                            n.setAttributeNS(null, "stroke", "none"), n.setAttributeNS(null, "stroke-width", "1"), n.setAttributeNS(null, "fill", "none"), n.setAttributeNS(null, "fill-rule", "evenodd");
                            var a = x.createNS("http://www.w3.org/2000/svg", "g");
                            a.setAttributeNS(null, "fill-rule", "nonzero");
                            var o = x.createNS("http://www.w3.org/2000/svg", "g");
                            o.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), o.setAttributeNS(null, "fill", "#000000");
                            for (var s = 0, l = [{rx: "10.5", ry: "5.25002273"}, {
                                rx: "10.5",
                                ry: "5.25002273"
                            }, {rx: "9.5", ry: "4.77275007"}, {rx: "8.5", ry: "4.29549936"}, {
                                rx: "7.5",
                                ry: "3.81822308"
                            }, {rx: "6.5", ry: "3.34094679"}, {rx: "5.5", ry: "2.86367051"}, {
                                rx: "4.5",
                                ry: "2.38636864"
                            }]; s < l.length; s += 1) {
                                var u = l[s], h = x.createNS("http://www.w3.org/2000/svg", "ellipse");
                                h.setAttributeNS(null, "opacity", "0.04"), h.setAttributeNS(null, "cx", "10.5"), h.setAttributeNS(null, "cy", "5.80029008"), h.setAttributeNS(null, "rx", u.rx), h.setAttributeNS(null, "ry", u.ry), o.appendChild(h)
                            }
                            var c = x.createNS("http://www.w3.org/2000/svg", "g");
                            c.setAttributeNS(null, "fill", this._color);
                            var p = x.createNS("http://www.w3.org/2000/svg", "path");
                            p.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), c.appendChild(p);
                            var f = x.createNS("http://www.w3.org/2000/svg", "g");
                            f.setAttributeNS(null, "opacity", "0.25"), f.setAttributeNS(null, "fill", "#000000");
                            var d = x.createNS("http://www.w3.org/2000/svg", "path");
                            d.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), f.appendChild(d);
                            var m = x.createNS("http://www.w3.org/2000/svg", "g");
                            m.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), m.setAttributeNS(null, "fill", "#FFFFFF");
                            var y = x.createNS("http://www.w3.org/2000/svg", "g");
                            y.setAttributeNS(null, "transform", "translate(8.0, 8.0)");
                            var g = x.createNS("http://www.w3.org/2000/svg", "circle");
                            g.setAttributeNS(null, "fill", "#000000"), g.setAttributeNS(null, "opacity", "0.25"), g.setAttributeNS(null, "cx", "5.5"), g.setAttributeNS(null, "cy", "5.5"), g.setAttributeNS(null, "r", "5.4999962");
                            var _ = x.createNS("http://www.w3.org/2000/svg", "circle");
                            _.setAttributeNS(null, "fill", "#FFFFFF"), _.setAttributeNS(null, "cx", "5.5"), _.setAttributeNS(null, "cy", "5.5"), _.setAttributeNS(null, "r", "5.4999962"), y.appendChild(g), y.appendChild(_), a.appendChild(o), a.appendChild(c), a.appendChild(f), a.appendChild(m), a.appendChild(y), r.appendChild(a), r.setAttributeNS(null, "height", 41 * this._scale + "px"), r.setAttributeNS(null, "width", 27 * this._scale + "px"), this._element.appendChild(r), this._offset = ot.Point.convert(t && t.offset || [0, -14])
                        }
                        this._element.classList.add("mapboxgl-marker"), this._element.addEventListener("dragstart", function (t) {
                            t.preventDefault()
                        }), this._element.addEventListener("mousedown", function (t) {
                            t.preventDefault()
                        }), this._element.addEventListener("focus", function () {
                            var t = i._map.getContainer();
                            t.scrollTop = 0, t.scrollLeft = 0
                        }), Un(this._element, this._anchor, "marker"), this._popup = null
                    }

                    return v && (t.__proto__ = v), (t.prototype = Object.create(v && v.prototype)).constructor = t, t.prototype.addTo = function (t) {
                        return this.remove(), this._map = t, t.getCanvasContainer().appendChild(this._element), t.on("move", this._update), t.on("moveend", this._update), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this._map._markersCache && this._map._markersCache.push(this), this
                    }, t.prototype.remove = function () {
                        if (this._map) {
                            this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove);
                            var t = this._map._markersCache.indexOf(this);
                            t > -1 && this._map._markersCache.splice(t, 1), delete this._map
                        }
                        return x.remove(this._element), this._popup && this._popup.remove(), this
                    }, t.prototype.getLngLat = function () {
                        return this._lngLat
                    }, t.prototype.setLngLat = function (t) {
                        return this._lngLat = ot.LngLat.convert(t), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this
                    }, t.prototype.getElement = function () {
                        return this._element
                    }, t.prototype.setPopup = function (t) {
                        if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), t) {
                            if (!("offset" in t.options)) {
                                var e = Math.sqrt(Math.pow(13.5, 2) / 2);
                                t.options.offset = this._defaultMarker ? {
                                    top: [0, 0],
                                    "top-left": [0, 0],
                                    "top-right": [0, 0],
                                    bottom: [0, -38.1],
                                    "bottom-left": [e, -1 * (24.6 + e)],
                                    "bottom-right": [-e, -1 * (24.6 + e)],
                                    left: [13.5, -24.6],
                                    right: [-13.5, -24.6]
                                } : this._offset
                            }
                            this._popup = t, this._lngLat && this._popup.setLngLat(this._lngLat), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress)
                        }
                        return this
                    }, t.prototype._onKeyPress = function (t) {
                        var e = t.code, i = t.charCode || t.keyCode;
                        "Space" !== e && "Enter" !== e && 32 !== i && 13 !== i || this.togglePopup()
                    }, t.prototype._onMapClick = function (t) {
                        var e = t.originalEvent.target, i = this._element;
                        this._popup && (e === i || i.contains(e)) && this.togglePopup()
                    }, t.prototype.getPopup = function () {
                        return this._popup
                    }, t.prototype.togglePopup = function () {
                        var t = this._popup;
                        return t ? (t.isOpen() ? t.remove() : t.addTo(this._map), this) : this
                    }, t.prototype._update = function (t) {
                        if (this._map) {
                            this._map.transform.renderWorldCopies && (this._lngLat = On(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._offset);
                            var e = "";
                            "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? e = "rotateZ(" + this._rotation + "deg)" : "map" === this._rotationAlignment && (e = "rotateZ(" + (this._rotation - this._map.getBearing()) + "deg)");
                            var i = "";
                            "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? i = "rotateX(0deg)" : "map" === this._pitchAlignment && (i = "rotateX(" + this._map.getPitch() + "deg)"), t && "moveend" !== t.type || (this._pos = this._pos.round()), x.setTransform(this._element, Fn[this._anchor] + " translate(" + this._pos.x + "px, " + this._pos.y + "px) " + i + " " + e)
                        }
                    }, t.prototype.getOffset = function () {
                        return this._offset
                    }, t.prototype.setOffset = function (t) {
                        return this._offset = ot.Point.convert(t), this._update(), this
                    }, t.prototype._onMove = function (t) {
                        this._pos = t.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", "pending" === this._state && (this._state = "active", this.fire(new ot.Event("dragstart"))), this.fire(new ot.Event("drag"))
                    }, t.prototype._onUp = function () {
                        this._element.style.pointerEvents = "auto", this._positionDelta = null, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), "active" === this._state && this.fire(new ot.Event("dragend")), this._state = "inactive"
                    }, t.prototype._addDragHandler = function (t) {
                        this._element.contains(t.originalEvent.target) && (t.preventDefault(), this._positionDelta = t.point.sub(this._pos).add(this._offset), this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp))
                    }, t.prototype.setDraggable = function (t) {
                        return this._draggable = !!t, this._map && (t ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this
                    }, t.prototype.isDraggable = function () {
                        return this._draggable
                    }, t.prototype.setRotation = function (t) {
                        return this._rotation = t || 0, this._update(), this
                    }, t.prototype.getRotation = function () {
                        return this._rotation
                    }, t.prototype.setRotationAlignment = function (t) {
                        return this._rotationAlignment = t || "auto", this._update(), this
                    }, t.prototype.getRotationAlignment = function () {
                        return this._rotationAlignment
                    }, t.prototype.setPitchAlignment = function (t) {
                        return this._pitchAlignment = t && "auto" !== t ? t : this._rotationAlignment, this._update(), this
                    }, t.prototype.getPitchAlignment = function () {
                        return this._pitchAlignment
                    }, t
                }(ot.Evented), jn = {
                    positionOptions: {enableHighAccuracy: !1, maximumAge: 0, timeout: 6e3},
                    fitBoundsOptions: {maxZoom: 15},
                    trackUserLocation: !1,
                    showAccuracyCircle: !0,
                    showUserLocation: !0
                }, qn = 0, Gn = !1, Zn = function (e) {
                    function t(t) {
                        e.call(this), this.options = ot.extend({}, jn, t), ot.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], this)
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.onAdd = function (t) {
                        var e;
                        return this._map = t, this._container = x.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), e = this._setupUI, void 0 !== Nn ? e(Nn) : void 0 !== ot.window.navigator.permissions ? ot.window.navigator.permissions.query({name: "geolocation"}).then(function (t) {
                            e(Nn = "denied" !== t.state)
                        }) : e(Nn = !!ot.window.navigator.geolocation), this._container
                    }, t.prototype.onRemove = function () {
                        void 0 !== this._geolocationWatchID && (ot.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), x.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, qn = 0, Gn = !1
                    }, t.prototype._isOutOfMapMaxBounds = function (t) {
                        var e = this._map.getMaxBounds(), i = t.coords;
                        return e && (i.longitude < e.getWest() || i.longitude > e.getEast() || i.latitude < e.getSouth() || i.latitude > e.getNorth())
                    }, t.prototype._setErrorState = function () {
                        switch (this._watchState) {
                            case"WAITING_ACTIVE":
                                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                                break;
                            case"ACTIVE_LOCK":
                                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
                                break;
                            case"BACKGROUND":
                                this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")
                        }
                    }, t.prototype._onSuccess = function (t) {
                        if (this._map) {
                            if (this._isOutOfMapMaxBounds(t)) return this._setErrorState(), this.fire(new ot.Event("outofmaxbounds", t)), this._updateMarker(), void this._finish();
                            if (this.options.trackUserLocation) switch (this._lastKnownPosition = t, this._watchState) {
                                case"WAITING_ACTIVE":
                                case"ACTIVE_LOCK":
                                case"ACTIVE_ERROR":
                                    this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                    break;
                                case"BACKGROUND":
                                case"BACKGROUND_ERROR":
                                    this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")
                            }
                            this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(t), this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(t), this.options.showUserLocation && this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"), this.fire(new ot.Event("geolocate", t)), this._finish()
                        }
                    }, t.prototype._updateCamera = function (t) {
                        var e = new ot.LngLat(t.coords.longitude, t.coords.latitude), i = t.coords.accuracy,
                            r = this._map.getBearing(), n = ot.extend({bearing: r}, this.options.fitBoundsOptions);
                        this._map.fitBounds(e.toBounds(i), n, {geolocateSource: !0})
                    }, t.prototype._updateMarker = function (t) {
                        if (t) {
                            var e = new ot.LngLat(t.coords.longitude, t.coords.latitude);
                            this._accuracyCircleMarker.setLngLat(e).addTo(this._map), this._userLocationDotMarker.setLngLat(e).addTo(this._map), this._accuracy = t.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius()
                        } else this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove()
                    }, t.prototype._updateCircleRadius = function () {
                        var t = this._map._container.clientHeight / 2, e = this._map.unproject([0, t]),
                            i = this._map.unproject([1, t]), r = e.distanceTo(i), n = Math.ceil(2 * this._accuracy / r);
                        this._circleElement.style.width = n + "px", this._circleElement.style.height = n + "px"
                    }, t.prototype._onZoom = function () {
                        this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius()
                    }, t.prototype._onError = function (t) {
                        if (this._map) {
                            if (this.options.trackUserLocation) if (1 === t.code) {
                                this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.disabled = !0;
                                var e = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                                this._geolocateButton.title = e, this._geolocateButton.setAttribute("aria-label", e), void 0 !== this._geolocationWatchID && this._clearWatch()
                            } else {
                                if (3 === t.code && Gn) return;
                                this._setErrorState()
                            }
                            "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("mapboxgl-user-location-dot-stale"), this.fire(new ot.Event("error", t)), this._finish()
                        }
                    }, t.prototype._finish = function () {
                        this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0
                    }, t.prototype._setupUI = function (t) {
                        var e = this;
                        if (this._container.addEventListener("contextmenu", function (t) {
                            return t.preventDefault()
                        }), this._geolocateButton = x.create("button", "mapboxgl-ctrl-geolocate", this._container), x.create("span", "mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", !0), this._geolocateButton.type = "button", !1 === t) {
                            ot.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");
                            var i = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                            this._geolocateButton.disabled = !0, this._geolocateButton.title = i, this._geolocateButton.setAttribute("aria-label", i)
                        } else {
                            var r = this._map._getUIString("GeolocateControl.FindMyLocation");
                            this._geolocateButton.title = r, this._geolocateButton.setAttribute("aria-label", r)
                        }
                        this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = x.create("div", "mapboxgl-user-location-dot"), this._userLocationDotMarker = new Vn(this._dotElement), this._circleElement = x.create("div", "mapboxgl-user-location-accuracy-circle"), this._accuracyCircleMarker = new Vn({
                            element: this._circleElement,
                            pitchAlignment: "map"
                        }), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = !0, this.options.trackUserLocation && this._map.on("movestart", function (t) {
                            t.geolocateSource || "ACTIVE_LOCK" !== e._watchState || t.originalEvent && "resize" === t.originalEvent.type || (e._watchState = "BACKGROUND", e._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"), e._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), e.fire(new ot.Event("trackuserlocationend")))
                        })
                    }, t.prototype.trigger = function () {
                        if (!this._setup) return ot.warnOnce("Geolocate control triggered before added to a map"), !1;
                        if (this.options.trackUserLocation) {
                            switch (this._watchState) {
                                case"OFF":
                                    this._watchState = "WAITING_ACTIVE", this.fire(new ot.Event("trackuserlocationstart"));
                                    break;
                                case"WAITING_ACTIVE":
                                case"ACTIVE_LOCK":
                                case"ACTIVE_ERROR":
                                case"BACKGROUND_ERROR":
                                    qn--, Gn = !1, this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this.fire(new ot.Event("trackuserlocationend"));
                                    break;
                                case"BACKGROUND":
                                    this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new ot.Event("trackuserlocationstart"))
                            }
                            switch (this._watchState) {
                                case"WAITING_ACTIVE":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                    break;
                                case"ACTIVE_LOCK":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                    break;
                                case"ACTIVE_ERROR":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                                    break;
                                case"BACKGROUND":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
                                    break;
                                case"BACKGROUND_ERROR":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")
                            }
                            if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID) this._clearWatch(); else if (void 0 === this._geolocationWatchID) {
                                var t;
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), ++qn > 1 ? (t = {
                                    maximumAge: 6e5,
                                    timeout: 0
                                }, Gn = !0) : (t = this.options.positionOptions, Gn = !1), this._geolocationWatchID = ot.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, t)
                            }
                        } else ot.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);
                        return !0
                    }, t.prototype._clearWatch = function () {
                        ot.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null)
                    }, t
                }(ot.Evented), Wn = {maxWidth: 100, unit: "metric"}, Xn = function (t) {
                    this.options = ot.extend({}, Wn, t), ot.bindAll(["_onMove", "setUnit"], this)
                };

                function Hn(t, e, i) {
                    var r = i && i.maxWidth || 100, n = t.project(t.crs.getLngLatCenter()), a = t.unproject([n.x, n.y]),
                        o = t.unproject([n.x + r, n.y]);
                    o.lng === a.lng && (o = t.unproject([n.x - r, n.y]));
                    var s = a.distanceTo(o);
                    if (i && "imperial" === i.unit) {
                        var l = 3.2808 * s;
                        l > 5280 ? Kn(e, r, l / 5280, t._getUIString("ScaleControl.Miles")) : Kn(e, r, l, t._getUIString("ScaleControl.Feet"))
                    } else i && "nautical" === i.unit ? Kn(e, r, s / 1852, t._getUIString("ScaleControl.NauticalMiles")) : s >= 1e3 ? Kn(e, r, s / 1e3, t._getUIString("ScaleControl.Kilometers")) : Kn(e, r, s, t._getUIString("ScaleControl.Meters"))
                }

                function Kn(t, e, i, r) {
                    var n, a, o,
                        s = (n = i, (a = Math.pow(10, ("" + Math.floor(n)).length - 1)) * (o = (o = n / a) >= 10 ? 10 : o >= 5 ? 5 : o >= 3 ? 3 : o >= 2 ? 2 : o >= 1 ? 1 : function (t) {
                            var e = Math.pow(10, Math.ceil(-Math.log(t) / Math.LN10));
                            return Math.round(t * e) / e
                        }(o)));
                    t.style.width = e * (s / i) + "px", t.innerHTML = s + "&nbsp;" + r
                }

                Xn.prototype.getDefaultPosition = function () {
                    return "bottom-left"
                }, Xn.prototype._onMove = function () {
                    Hn(this._map, this._container, this.options)
                }, Xn.prototype.onAdd = function (t) {
                    return this._map = t, this._container = x.create("div", "mapboxgl-ctrl mapboxgl-ctrl-scale", t.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container
                }, Xn.prototype.onRemove = function () {
                    x.remove(this._container), this._map.off("move", this._onMove), this._map = void 0
                }, Xn.prototype.setUnit = function (t) {
                    this.options.unit = t, Hn(this._map, this._container, this.options)
                };
                var P = function (t) {
                    this._fullscreen = !1, t && t.container && (t.container instanceof ot.window.HTMLElement ? this._container = t.container : ot.warnOnce("Full screen control 'container' must be a DOM element.")), ot.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in ot.window.document ? this._fullscreenchange = "fullscreenchange" : "onmozfullscreenchange" in ot.window.document ? this._fullscreenchange = "mozfullscreenchange" : "onwebkitfullscreenchange" in ot.window.document ? this._fullscreenchange = "webkitfullscreenchange" : "onmsfullscreenchange" in ot.window.document && (this._fullscreenchange = "MSFullscreenChange")
                };
                P.prototype.onAdd = function (t) {
                    return this._map = t, this._container || (this._container = this._map.getContainer()), this._controlContainer = x.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", ot.warnOnce("This device does not support fullscreen mode.")), this._controlContainer
                }, P.prototype.onRemove = function () {
                    x.remove(this._controlContainer), this._map = null, ot.window.document.removeEventListener(this._fullscreenchange, this._changeIcon)
                }, P.prototype._checkFullscreenSupport = function () {
                    return !!(ot.window.document.fullscreenEnabled || ot.window.document.mozFullScreenEnabled || ot.window.document.msFullscreenEnabled || ot.window.document.webkitFullscreenEnabled)
                }, P.prototype._setupUI = function () {
                    var t = this._fullscreenButton = x.create("button", "mapboxgl-ctrl-fullscreen", this._controlContainer);
                    x.create("span", "mapboxgl-ctrl-icon", t).setAttribute("aria-hidden", !0), t.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), ot.window.document.addEventListener(this._fullscreenchange, this._changeIcon)
                }, P.prototype._updateTitle = function () {
                    var t = this._getTitle();
                    this._fullscreenButton.setAttribute("aria-label", t), this._fullscreenButton.title = t
                }, P.prototype._getTitle = function () {
                    return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter")
                }, P.prototype._isFullscreen = function () {
                    return this._fullscreen
                }, P.prototype._changeIcon = function () {
                    (ot.window.document.fullscreenElement || ot.window.document.mozFullScreenElement || ot.window.document.webkitFullscreenElement || ot.window.document.msFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"), this._updateTitle())
                }, P.prototype._onClickFullscreen = function () {
                    this._isFullscreen() ? ot.window.document.exitFullscreen ? ot.window.document.exitFullscreen() : ot.window.document.mozCancelFullScreen ? ot.window.document.mozCancelFullScreen() : ot.window.document.msExitFullscreen ? ot.window.document.msExitFullscreen() : ot.window.document.webkitCancelFullScreen && ot.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.mozRequestFullScreen ? this._container.mozRequestFullScreen() : this._container.msRequestFullscreen ? this._container.msRequestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen()
                };
                var Yn = {
                    closeButton: !0,
                    closeOnClick: !0,
                    className: "",
                    maxWidth: "240px",
                    showArrow: !0,
                    contentClass: null
                }, Jn = function (e) {
                    function t(t) {
                        e.call(this), this.options = ot.extend(Object.create(Yn), t), ot.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], this)
                    }

                    return e && (t.__proto__ = e), (t.prototype = Object.create(e && e.prototype)).constructor = t, t.prototype.addTo = function (t) {
                        return this._map && this.remove(), this._map = t, this.options.closeOnClick && this._map.on("click", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")) : this._map.on("move", this._update), this.fire(new ot.Event("open")), this
                    }, t.prototype.isOpen = function () {
                        return !!this._map
                    }, t.prototype.remove = function () {
                        return this._content && x.remove(this._content), this._container && (x.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new ot.Event("close")), this
                    }, t.prototype.getLngLat = function () {
                        return this._lngLat
                    }, t.prototype.setLngLat = function (t) {
                        return this._lngLat = ot.LngLat.convert(t), this._pos = null, this._trackPointer = !1, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._container && this._container.classList.remove("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")), this
                    }, t.prototype.trackPointer = function () {
                        return this._trackPointer = !0, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")), this
                    }, t.prototype.getElement = function () {
                        return this._container
                    }, t.prototype.setText = function (t) {
                        return this.setDOMContent(ot.window.document.createTextNode(t))
                    }, t.prototype.setHTML = function (t) {
                        var e, i = ot.window.document.createDocumentFragment(),
                            r = ot.window.document.createElement("body");
                        for (r.innerHTML = t; e = r.firstChild;) i.appendChild(e);
                        return this.setDOMContent(i)
                    }, t.prototype.getMaxWidth = function () {
                        return this._container && this._container.style.maxWidth
                    }, t.prototype.setMaxWidth = function (t) {
                        return this.options.maxWidth = t, this._update(), this
                    }, t.prototype.setDOMContent = function (t) {
                        return this._createContent(), this._content.appendChild(t), this._update(), this
                    }, t.prototype.addClassName = function (t) {
                        this._container && this._container.classList.add(t)
                    }, t.prototype.removeClassName = function (t) {
                        this._container && this._container.classList.remove(t)
                    }, t.prototype.toggleClassName = function (t) {
                        if (this._container) return this._container.classList.toggle(t)
                    }, t.prototype._createContent = function () {
                        this._content && x.remove(this._content), this._content = x.create("div", "mapboxgl-popup-content" + (this.options.contentClass ? " " + this.options.contentClass : ""), this._container), this.options.closeButton && (this._closeButton = x.create("button", "mapboxgl-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose))
                    }, t.prototype._onMouseUp = function (t) {
                        this._update(t.point)
                    }, t.prototype._onMouseMove = function (t) {
                        this._update(t.point)
                    }, t.prototype._onDrag = function (t) {
                        this._update(t.point)
                    }, t.prototype._update = function (t) {
                        var e = this;
                        if (this._map && (this._lngLat || this._trackPointer) && this._content && (this._container || (this._container = x.create("div", "mapboxgl-popup", this._map.getContainer()), this._tip = x.create("div", "mapboxgl-popup-tip", this._container), this._container.appendChild(this._content), this.options.className && this.options.className.split(" ").forEach(function (t) {
                            return e._container.classList.add(t)
                        }), this._trackPointer && this._container.classList.add("mapboxgl-popup-track-pointer")), this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = On(this._lngLat, this._pos, this._map.transform)), !this._trackPointer || t)) {
                            var i = this._pos = this._trackPointer && t ? t : this._map.project(this._lngLat),
                                r = this.options.anchor, n = function t(e) {
                                    if (e) {
                                        if ("number" == typeof e) {
                                            var i = Math.round(Math.sqrt(.5 * Math.pow(e, 2)));
                                            return {
                                                center: new ot.Point(0, 0),
                                                top: new ot.Point(0, e),
                                                "top-left": new ot.Point(i, i),
                                                "top-right": new ot.Point(-i, i),
                                                bottom: new ot.Point(0, -e),
                                                "bottom-left": new ot.Point(i, -i),
                                                "bottom-right": new ot.Point(-i, -i),
                                                left: new ot.Point(e, 0),
                                                right: new ot.Point(-e, 0)
                                            }
                                        }
                                        if (e instanceof ot.Point || Array.isArray(e)) {
                                            var r = ot.Point.convert(e);
                                            return {
                                                center: r,
                                                top: r,
                                                "top-left": r,
                                                "top-right": r,
                                                bottom: r,
                                                "bottom-left": r,
                                                "bottom-right": r,
                                                left: r,
                                                right: r
                                            }
                                        }
                                        return {
                                            center: ot.Point.convert(e.center || [0, 0]),
                                            top: ot.Point.convert(e.top || [0, 0]),
                                            "top-left": ot.Point.convert(e["top-left"] || [0, 0]),
                                            "top-right": ot.Point.convert(e["top-right"] || [0, 0]),
                                            bottom: ot.Point.convert(e.bottom || [0, 0]),
                                            "bottom-left": ot.Point.convert(e["bottom-left"] || [0, 0]),
                                            "bottom-right": ot.Point.convert(e["bottom-right"] || [0, 0]),
                                            left: ot.Point.convert(e.left || [0, 0]),
                                            right: ot.Point.convert(e.right || [0, 0])
                                        }
                                    }
                                    return t(new ot.Point(0, 0))
                                }(this.options.offset);
                            if (!r) {
                                var a, o = this._container.offsetWidth, s = this._container.offsetHeight;
                                a = i.y + n.bottom.y < s ? ["top"] : i.y > this._map.transform.height - s ? ["bottom"] : [], i.x < o / 2 ? a.push("left") : i.x > this._map.transform.width - o / 2 && a.push("right"), r = 0 === a.length ? "bottom" : a.join("-")
                            }
                            var l = i.add(n[r]).round();
                            x.setTransform(this._container, Fn[r] + " translate(" + l.x + "px," + l.y + "px)"), Un(this._container, r, "popup")
                        }
                    }, t.prototype._onClose = function () {
                        this.remove()
                    }, t
                }(ot.Evented), Qn = {
                    proj4: ot.proj4,
                    version: ot.version,
                    supported: A,
                    setRTLTextPlugin: ot.setRTLTextPlugin,
                    getRTLTextPluginStatus: ot.getRTLTextPluginStatus,
                    Map: Ln,
                    NavigationControl: Bn,
                    GeolocateControl: Zn,
                    AttributionControl: Sn,
                    ScaleControl: Xn,
                    FullscreenControl: P,
                    Popup: Jn,
                    Marker: Vn,
                    Style: ui,
                    CRS: T,
                    LngLat: ot.LngLat,
                    LngLatBounds: ot.LngLatBounds,
                    Point: ot.Point,
                    MercatorCoordinate: ot.MercatorCoordinate,
                    Evented: ot.Evented,
                    config: ot.config,
                    prewarm: function () {
                        he().acquire(oe)
                    },
                    clearPrewarmedResources: function () {
                        var t = le;
                        t && (t.isPreloaded() && 1 === t.numActive() ? (t.release(oe), le = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))
                    },
                    get accessToken() {
                        return ot.config.ACCESS_TOKEN
                    },
                    set accessToken(t) {
                        ot.config.ACCESS_TOKEN = t
                    },
                    get baseApiUrl() {
                        return ot.config.API_URL
                    },
                    set baseApiUrl(t) {
                        ot.config.API_URL = t
                    },
                    get workerCount() {
                        return se.workerCount
                    },
                    set workerCount(t) {
                        se.workerCount = t
                    },
                    get maxParallelImageRequests() {
                        return ot.config.MAX_PARALLEL_IMAGE_REQUESTS
                    },
                    set maxParallelImageRequests(t) {
                        ot.config.MAX_PARALLEL_IMAGE_REQUESTS = t
                    },
                    clearStorage: function (t) {
                        ot.clearTileCache(t)
                    },
                    workerUrl: ""
                };
                return Qn
            }), window) window.mapboxgl = o;
            return o
        }()
    }
}]);