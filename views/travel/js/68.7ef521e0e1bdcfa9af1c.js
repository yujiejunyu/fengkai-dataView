(window.webpackJsonp=window.webpackJsonp||[]).push([[68,34],{CKgU:function(t,e,n){"use strict";var r=n("FuRH"),s=n("yIpb"),a=n("K79h"),o=n("oCYn"),n=n("YKMj");function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===p(t)?t:String(t)}(o.key),o)}}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=i(n),e=(t=o?(t=i(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(s=(r<3?i(s):3<r?i(e,n,s):i(e,n))||s);return 3<r&&s&&Object.defineProperty(e,n,s),s};function d(e,n){for(var t=arguments.length,o=new Array(2<t?t-2:0),i=2;i<t;i++)o[i-2]=arguments[i];var r=e.constructor.options;r.mixins&&r.mixins.forEach(function(t){t[n]&&(t=t[n]).call.apply(t,[e].concat(o))}),r[n]&&(r=r[n]).call.apply(r,[e].concat(o))}o=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t);var n,o=l(i);function i(){var t=this,e=i;if(t instanceof e)return o.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"mapTargetChanged",value:function(t,e){var n;t&&e&&t!==e&&(e=e||this.firstDefaultTarget,(n=r.a.$options.getMap(e))&&this.removeMap(n,e),r.a.$options.getMap(t))&&this.loadMap(t)}},{key:"mounted",value:function(){var t=this.getTargetName();this.firstDefaultTarget=t,r.a.$options.getMap(t)&&this.loadMap(t),r.a.$on("load-map",this.loadMapSucceed),s.a.$on("delete-map",this.removeMapSucceed)}},{key:"beforeDestroy",value:function(){this.removeMap(),r.a.$off("load-map",this.loadMapSucceed),s.a.$off("delete-map",this.removeMapSucceed)}},{key:"getFirstTarget",value:function(){var t,e;for(e in r.a.$options.getAllMaps())if(e){t=e;break}return t}},{key:"getTargetName",value:function(){var t=this.$parent,t=t&&t.$options.name&&-1!==["smwebmap","smncpmap"].indexOf(t.$options.name.toLowerCase())&&t.target;return this.mapTarget||t||this.getFirstTarget()}},{key:"loadMap",value:function(t){var e=this;this.firstDefaultTarget||(this.firstDefaultTarget=t),this.map=r.a.$options.getMap(t),this.webmap=r.a.$options.getWebMap(t),this.viewModel&&"function"==typeof this.viewModel.setMap&&this.viewModel.setMap({map:this.map,webmap:this.webmap,mapTarget:t}),d(this,"loaded",this.map,t),this.$nextTick(function(){e.$emit("loaded")})}},{key:"removeMap",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.map,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getTargetName();t&&(this.viewModel&&this.viewModel.removed&&this.viewModel.removed(),d(this,"removed",t,e),this.map=null,this.webmap=null,this.firstDefaultTarget=null)}},{key:"loadMapSucceed",value:function(t,e){e===this.getTargetName()&&this.loadMap(e)}},{key:"removeMapSucceed",value:function(t){t===this.getTargetName()&&this.removeMap()}},{key:"mapNotLoadedTip",value:function(){return!this.map&&(a.a.destroy(),a.a.warning(this.$t("warning.unassociatedMap")),!0)}}])&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(o.default);h([Object(n.Prop)()],o.prototype,"mapTarget",void 0),h([Object(n.Watch)("mapTarget")],o.prototype,"mapTargetChanged",null),o=h([n.Component],o),e.a=o},INC6:function(t,e,n){!function(e){t.exports=function o(i,r,s){function a(e,t){if(!r[e]){if(!i[e]){if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}n=r[e]={exports:{}};i[e][0].call(n.exports,function(t){return a(i[e][1][t]||t)},n,n.exports,o,i,r,s)}return r[e].exports}for(var c=!1,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,n){"use strict";var o=t("./src/setup"),i=t("./src/options"),r=t("./src/api"),s=t("./src/constants");e.exports=function(t){var e,n;e=this,n={options:t=i(t)},e=r(n,e),n.api=e,n=o(n),e.onAdd=n.onAdd,e.onRemove=n.onRemove,e.types=s.types,e.options=t},e.exports.modes=t("./src/modes")},{"./src/api":22,"./src/constants":23,"./src/modes":56,"./src/options":61,"./src/setup":63}],2:[function(t,e,n){function o(t){if(!(this instanceof o))return new o(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}(e.exports=o).prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},o.prototype.equals=function(t){t=t instanceof o?t.bbox():t;return this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]},o.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},o.prototype.union=function(t){return this._valid=!0,t=t instanceof o?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this},o.prototype.bbox=function(){return this._valid?this._bbox:null},o.prototype.contains=function(t){var e;return t?this._valid?(e=t[0],t=t[1],this._bbox[0]<=e&&this._bbox[1]<=t&&this._bbox[2]>=e&&this._bbox[3]>=t):null:this._fastContains()},o.prototype.intersect=function(t){return this._valid?(t=t instanceof o?t.bbox():t,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])):null},o.prototype._fastContains=function(){var t;return this._valid?(t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]",new Function("ll",t)):new Function("return null;")},o.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null}},{}],3:[function(t,e,n){var u=t("wgs84");function i(t){var e=0;if(t&&0<t.length){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,o,i,r,s,a=0,c=t.length;if(2<c){for(s=0;s<c;s++)r=s===c-2?(o=c-2,i=c-1,0):s===c-1?(o=c-1,i=0,1):(i=(o=s)+1,s+2),e=t[o],n=t[i],a+=(l(t[r][0])-l(e[0]))*Math.sin(l(n[1]));a=a*u.RADIUS*u.RADIUS/2}return a}function l(t){return t*Math.PI/180}e.exports.geometry=function t(e){var n,o=0;switch(e.type){case"Polygon":return i(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)o+=i(e.coordinates[n]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)o+=t(e.geometries[n]);return o}},e.exports.ring=o},{wgs84:20}],4:[function(t,e,n){e.exports=function n(t){return Array.isArray(t)&&t.length&&"number"==typeof t[0]?[t]:t.reduce(function(t,e){return Array.isArray(e)&&Array.isArray(e[0])?t.concat(n(e)):(t.push(e),t)},[])}},{}],5:[function(t,e,n){var o=t("@mapbox/geojson-normalize"),i=t("geojson-flatten"),r=t("./flatten");e.exports=function(t){var e;return t?(t=i(o(t)),e=[],t.features.forEach(function(t){t.geometry&&(e=e.concat(r(t.geometry.coordinates)))}),e):[]}},{"./flatten":4,"@mapbox/geojson-normalize":7,"geojson-flatten":13}],6:[function(t,e,n){var i=t("@mapbox/geojson-coords"),o=t("traverse"),r=t("@mapbox/extent"),s={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},a=Object.keys(s);function c(t){for(var e=r(),n=i(t),o=0;o<n.length;o++)e.include(n[o]);return e}e.exports=function(t){return c(t).bbox()},e.exports.polygon=function(t){return c(t).polygon()},e.exports.bboxify=function(t){return o(t).map(function(e){e&&a.some(function(t){return!!e[t]&&-1!==s[t].indexOf(e.type)})&&(e.bbox=c(e).bbox(),this.update(e))})}},{"@mapbox/extent":2,"@mapbox/geojson-coords":5,traverse:19}],7:[function(t,e,n){e.exports=function(t){var e;return t&&t.type&&(e=o[t.type])?"geometry"===e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===e?{type:"FeatureCollection",features:[t]}:"featurecollection"===e?t:void 0:null};var o={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},{}],8:[function(t,e,n){var r=t("jsonlint-lines"),s=t("./object");e.exports.hint=function(t,e){var n,o=[];if("object"==typeof t)n=t;else{if("string"!=typeof t)return[{message:"Expected string or object as input",line:0}];try{n=r.parse(t)}catch(t){var i=t.message.match(/line (\d+)/);return[{line:parseInt(i[1],10)-1,message:t.message,error:t}]}}return o.concat(s.hint(n,e))}},{"./object":9,"jsonlint-lines":15}],9:[function(t,e,n){var f=t("./rhr");e.exports.hint=function(t,i){var r=[],s=0;function n(t){var e;i&&!1===i.noDuplicateMembers||!t.__duplicateProperties__||r.push({message:"An object contained duplicate members, making parsing ambigous: "+t.__duplicateProperties__.join(", "),line:t.__line__}),o(t,"type","string")||(h[t.type]?t&&h[t.type](t):void 0!==(e=d[t.type.toLowerCase()])?r.push({message:"Expected "+e+" but got "+t.type+" (case sensitive)",line:t.__line__}):r.push({message:"The type "+t.type+" is unknown",line:t.__line__}))}function a(t,e){return t.every(function(t){return null!==t&&typeof t===e})}function o(t,e,n){return void 0===t[e]?r.push({message:'"'+e+'" member required',line:t.__line__}):"array"===n?!Array.isArray(t[e])&&r.push({message:'"'+e+'" member should be an array, but is an '+typeof t[e]+" instead",line:t.__line__}):"object"===n&&t[e]&&"Object"!==t[e].constructor.name?r.push({message:'"'+e+'" member should be '+n+", but is an "+t[e].constructor.name+" instead",line:t.__line__}):n&&typeof t[e]!==n&&r.push({message:'"'+e+'" member should be '+n+", but is an "+typeof t[e]+" instead",line:t.__line__})}function c(n,o){if(!Array.isArray(n))return r.push({message:"position should be an array, is a "+typeof n+" instead",line:n.__line__||o});if(n.length<2)return r.push({message:"position must have 2 or more elements",line:n.__line__||o});if(3<n.length)return r.push({message:"position should not have more than 3 elements",level:"message",line:n.__line__||o});if(!a(n,"number"))return r.push({message:"each element in a position must be a number",line:n.__line__||o});if(i&&i.precisionWarning){if(10===s)return s+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning 10 times, no more warnings will be reported",level:"message",line:n.__line__||o});s<10&&n.forEach(function(t){var e=0,t=String(t).split(".")[1];if(6<(e=void 0!==t?t.length:e))return s+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:n.__line__||o})})}}function u(n,e,o,i){if(void 0===i&&void 0!==n.__line__&&(i=n.__line__),0===o)return c(n,i);if(1===o&&e)if("LinearRing"===e){if(!Array.isArray(n[n.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:i}),!0;if(n.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:i}),n.length&&(n[n.length-1].length!==n[0].length||!n[n.length-1].every(function(t,e){return n[0][e]===t})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:i}),!0}else if("Line"===e&&n.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:i});if(Array.isArray(n))return n.map(function(t){return u(t,e,o-1,t.__line__||i)}).some(function(t){return t});r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:i})}function l(t){t.crs&&("object"==typeof t.crs&&t.crs.properties&&"urn:ogc:def:crs:OGC:1.3:CRS84"===t.crs.properties.name?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:t.__line__}):r.push({message:"old-style crs member is not recommended",line:t.__line__}))}function p(t){t.bbox&&(Array.isArray(t.bbox)?(a(t.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:t.bbox.__line__}),4!==t.bbox.length&&6!==t.bbox.length&&r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:t.bbox.__line__}),r.length):r.push({message:"bbox member must be an array of numbers, but is a "+typeof t.bbox,line:t.__line__}))}function e(t){l(t),p(t),void 0!==t.id&&"string"!=typeof t.id&&"number"!=typeof t.id&&r.push({message:'Feature "id" member must have a string or number value',line:t.__line__}),void 0!==t.features&&r.push({message:'Feature object cannot contain a "features" member',line:t.__line__}),void 0!==t.coordinates&&r.push({message:'Feature object cannot contain a "coordinates" member',line:t.__line__}),"Feature"!==t.type&&r.push({message:"GeoJSON features must have a type=feature member",line:t.__line__}),o(t,"properties","object"),o(t,"geometry","object")||t.geometry&&n(t.geometry)}var h={Point:function(t){var e;l(t),p(t),void 0!==(e=t).properties&&r.push({message:'geometry object cannot contain a "properties" member',line:e.__line__}),void 0!==e.geometry&&r.push({message:'geometry object cannot contain a "geometry" member',line:e.__line__}),void 0!==e.features&&r.push({message:'geometry object cannot contain a "features" member',line:e.__line__}),o(t,"coordinates","array")||c(t.coordinates)},Feature:e,MultiPoint:function(t){l(t),p(t),o(t,"coordinates","array")||u(t.coordinates,"",1)},LineString:function(t){l(t),p(t),o(t,"coordinates","array")||u(t.coordinates,"Line",1)},MultiLineString:function(t){l(t),p(t),o(t,"coordinates","array")||u(t.coordinates,"Line",2)},FeatureCollection:function(t){if(l(t),p(t),void 0!==t.properties&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:t.__line__}),void 0!==t.coordinates&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:t.__line__}),!o(t,"features","array")){if(!a(t.features,"object"))return r.push({message:"Every feature must be an object",line:t.__line__});t.features.forEach(e)}},GeometryCollection:function(e){l(e),p(e),o(e,"geometries","array")||(a(e.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:e.__line__}),1===e.geometries.length&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:e.geometries.__line__}),e.geometries.forEach(function(t){t&&("GeometryCollection"===t.type&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:e.geometries.__line__}),n(t))}))},Polygon:function(t){l(t),p(t),o(t,"coordinates","array")||u(t.coordinates,"LinearRing",2)||f(t,r)},MultiPolygon:function(t){l(t),p(t),o(t,"coordinates","array")||u(t.coordinates,"LinearRing",3)||f(t,r)}},d=Object.keys(h).reduce(function(t,e){return t[e.toLowerCase()]=e,t},{});return"object"!=typeof t||null==t?r.push({message:"The root of a GeoJSON object must be an object.",line:0}):(n(t),r.forEach(function(t){!{}.hasOwnProperty.call(t,"line")||void 0!==t.line||delete t.line})),r}},{"./rhr":10}],10:[function(t,e,n){function r(t){return t*Math.PI/180}function o(t){var e=0;if(2<t.length)for(var n,o,i=0;i<t.length-1;i++)n=t[i],e+=r((o=t[i+1])[0]-n[0])*(2+Math.sin(r(n[1]))+Math.sin(r(o[1])));return 0<=e}function i(t){if(t&&0<t.length){if(o(t[0]))return!1;if(!t.slice(1,t.length).every(o))return!1}return!0}e.exports=function(t,e){var n;("Polygon"===(n=t).type?i(n.coordinates):"MultiPolygon"===n.type&&n.coordinates.every(i))||e.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})}},{}],11:[function(t,e,n){"use strict";function o(t,e){this.x=t,this.y=e}(e.exports=o).prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,t=t.y-this.y;return e*e+t*t},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,t=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=t,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),t=Math.sin(t),n=e*this.x-t*this.y,t=t*this.x+e*this.y;return this.x=n,this.y=t,this},_rotateAround:function(t,e){var n=Math.cos(t),t=Math.sin(t),o=e.x+n*(this.x-e.x)-t*(this.y-e.y),t=e.y+t*(this.x-e.x)+n*(this.y-e.y);return this.x=o,this.y=t,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return!(t instanceof o)&&Array.isArray(t)?new o(t[0],t[1]):t}},{}],12:[function(t,e,n){},{}],13:[function(t,e,n){e.exports=function n(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,e){return t.concat(n(e))},[]),e;case"Feature":return e.geometry?n(e.geometry).map(function(t){t={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return void 0!==e.id&&(t.id=e.id),t}):e;case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(n).reduce(function(t,e){return t.concat(e)},[]);case"Point":case"Polygon":case"LineString":return[e]}}},{}],14:[function(t,e,n){var a=e.exports=function(t,e){if(e=e||16,(t=void 0===t?128:t)<=0)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),o=2;n===1/0;o*=2)n=Math.log(Math.pow(2,t/o))/Math.log(e)*o;for(var i=n-Math.floor(n),r="",o=0;o<Math.floor(n);o++)r=Math.floor(Math.random()*e).toString(e)+r;i&&(i=Math.pow(e,i),r=Math.floor(Math.random()*i).toString(e)+r);i=parseInt(r,e);return i!==1/0&&i>=Math.pow(2,t)?a(t,e):r};a.rack=function(o,i,r){function n(t){var e=0;do{if(10<e++){if(!r)throw new Error("too many ID collisions, use more bits");o+=r}var n=a(o,i)}while(Object.hasOwnProperty.call(s,n));return s[n]=t,n}var s=n.hats={};return n.get=function(t){return n.hats[t]},n.set=function(t,e){return n.hats[t]=e,n},n.bits=o||128,n.base=i||16,n}},{}],15:[function(f,m,y){!function(e){u=[18,22],l=[22,24],(c={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,n,o,i,r,s){var a=r.length-1;switch(i){case 1:this.$=t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(t);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=r[a-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=r[a-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[r[a-2],r[a]];break;case 16:this.$={},this.$[r[a][0]]=r[a][1];break;case 17:this.$=r[a-2],void 0!==r[a-2][r[a][0]]&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(r[a][0])),r[a-2][r[a][0]]=r[a][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[r[a]];break;case 21:this.$=r[a-2],r[a-2].push(r[a])}},table:[{3:5,4:t=[1,12],5:6,6:n=[1,13],7:3,8:o=[1,9],9:4,10:i=[1,10],11:r=[1,11],12:1,13:2,15:7,16:8,17:s=[1,14],23:a=[1,15]},{1:[3]},{14:[1,16]},h(c=[14,18,22,24],[2,7]),h(c,[2,8]),h(c,[2,9]),h(c,[2,10]),h(c,[2,11]),h(c,[2,12]),h(c,[2,3]),h(c,[2,4]),h(c,[2,5]),h([14,18,21,22,24],[2,1]),h(c,[2,2]),{3:20,4:t,18:[1,17],19:18,20:19},{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:i,11:r,13:23,15:7,16:8,17:s,23:a,24:[1,21],25:22},{1:[2,6]},h(c,[2,13]),{18:[1,24],22:[1,25]},h(u,[2,16]),{21:[1,26]},h(c,[2,18]),{22:[1,28],24:[1,27]},h(l,[2,20]),h(c,[2,14]),{3:20,4:t,20:29},{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:i,11:r,13:30,15:7,16:8,17:s,23:a},h(c,[2,19]),{3:5,4:t,5:6,6:n,7:3,8:o,9:4,10:i,11:r,13:31,15:7,16:8,17:s,23:a},h(u,[2,17]),h(u,[2,15]),h(l,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){function n(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw n.prototype=Error,new n(t,e);this.trace(t)},parse:function(t){var e,n=this,o=[0],i=[null],r=[],s=this.table,a="",c=0,u=0,l=0,p=r.slice.call(arguments,1),h=Object.create(this.lexer),d={yy:{}};for(e in this.yy)Object.prototype.hasOwnProperty.call(this.yy,e)&&(d.yy[e]=this.yy[e]);h.setInput(t,d.yy),d.yy.lexer=h,d.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var f=h.yylloc,m=(r.push(f),h.options&&h.options.ranges);"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,g,v,_,b,w,E,S={};;){if(v=o[o.length-1],void 0===(_=this.defaultActions[v]||(null==y&&(T=void 0,y=T="number"!=typeof(T=h.lex()||1)&&n.symbols_[T]||T),s[v]&&s[v][y]))||!_.length||!_[0]){var T,O=[];for(b in s[v])this.terminals_[b]&&2<b&&O.push("'"+this.terminals_[b]+"'");T=h.showPosition?"Parse error on line "+(c+1)+":\n"+h.showPosition()+"\nExpecting "+O.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(c+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(T,{text:h.match,token:this.terminals_[y]||y,line:h.yylineno,loc:f,expected:O})}if(_[0]instanceof Array&&1<_.length)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+y);switch(_[0]){case 1:o.push(y),i.push(h.yytext),r.push(h.yylloc),o.push(_[1]),y=null,g?(y=g,g=null):(u=h.yyleng,a=h.yytext,c=h.yylineno,f=h.yylloc,0<l&&l--);break;case 2:if(w=this.productions_[_[1]][1],S.$=i[i.length-w],S._$={first_line:r[r.length-(w||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(w||1)].first_column,last_column:r[r.length-1].last_column},m&&(S._$.range=[r[r.length-(w||1)].range[0],r[r.length-1].range[1]]),void 0!==(E=this.performAction.apply(S,[a,u,c,d.yy,_[1],i,r].concat(p))))return E;w&&(o=o.slice(0,-1*w*2),i=i.slice(0,-1*w),r=r.slice(0,-1*w)),o.push(this.productions_[_[1]][0]),i.push(S.$),r.push(S._$),E=s[o[o.length-2]][o[o.length-1]],o.push(E);break;case 3:return!0}}return!0}}).lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g),t=(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e,this.match.split(/(?:\r\n?|\n)/g)),o=(this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1),this.yylloc.range);return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===t.length?this.yylloc.first_column:0)+t[t.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges)&&(o.yylloc.range=this.yylloc.range.slice(0)),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack)for(var i in o)this[i]=o[i];return!1},next:function(){if(this.done)return this.EOF;var t,e,n,o;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),r=0;r<i.length;r++)if((n=this._input.match(this.rules[i[r]]))&&(!e||n[0].length>e[0].length)){if(e=n,o=r,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[r])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[o]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,o){switch(n){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};var t,n,o,i,r,s,a,c,u,l,p=new((d.prototype=c).Parser=d);function h(t,e,n,o){for(n=n||{},o=t.length;o--;n[t[o]]=e);return n}function d(){this.yy={}}void 0!==f&&void 0!==y&&(y.parser=p,y.Parser=p.Parser,y.parse=function(){return p.parse.apply(p,arguments)},y.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),e.exit(1));t=f("fs").readFileSync(f("path").normalize(t[1]),"utf8");return y.parser.parse(t)},void 0!==m)&&f.main===m&&y.main(e.argv.slice(1))}.call(this,f("_process"))},{_process:18,fs:12,path:17}],16:[function(t,Nt,jt){!function(t){var o="__lodash_hash_undefined__",v=1,F=2,D=9007199254740991,p="[object Arguments]",h="[object Array]",R="[object AsyncFunction]",U="[object Boolean]",$="[object Date]",B="[object Error]",V="[object Function]",G="[object GeneratorFunction]",d="[object Map]",J="[object Number]",f="[object Object]",z="[object Promise]",H="[object Proxy]",q="[object RegExp]",m="[object Set]",K="[object String]",n="[object WeakMap]",Y="[object ArrayBuffer]",y="[object DataView]",W=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,e={},t=(e["[object Float32Array]"]=e["[object Float64Array]"]=e["[object Int8Array]"]=e["[object Int16Array]"]=e["[object Int32Array]"]=e["[object Uint8Array]"]=e["[object Uint8ClampedArray]"]=e["[object Uint16Array]"]=e["[object Uint32Array]"]=!0,e[p]=e[h]=e[Y]=e[U]=e[y]=e[$]=e[B]=e[V]=e[d]=e[J]=e[f]=e[q]=e[m]=e[K]=e[n]=!1,"object"==typeof t&&t&&t.Object===Object&&t),i="object"==typeof self&&self&&self.Object===Object&&self,i=t||i||Function("return this")(),r="object"==typeof jt&&jt&&!jt.nodeType&&jt,s=r&&"object"==typeof Nt&&Nt&&!Nt.nodeType&&Nt,s=s&&s.exports===r,a=s&&t.process,r=function(){try{return a&&a.binding&&a.binding("util")}catch(t){}}(),t=r&&r.isTypedArray;function Z(t){var n=-1,o=Array(t.size);return t.forEach(function(t,e){o[++n]=[e,t]}),o}function Q(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var tt,et,r=Array.prototype,c=Function.prototype,u=Object.prototype,l=i["__core-js_shared__"],nt=c.toString,_=u.hasOwnProperty,ot=(c=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",it=u.toString,rt=RegExp("^"+nt.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),l=s?i.Buffer:void 0,c=i.Symbol,st=i.Uint8Array,at=u.propertyIsEnumerable,ct=r.splice,g=c?c.toStringTag:void 0,ut=Object.getOwnPropertySymbols,s=l?l.isBuffer:void 0,r=(tt=Object.keys,et=Object,N(i,"DataView")),b=N(i,"Map"),l=N(i,"Promise"),w=N(i,"Set"),i=N(i,"WeakMap"),E=N(Object,"create"),lt=I(r),pt=I(b),ht=I(l),dt=I(w),ft=I(i),c=c?c.prototype:void 0,mt=c?c.valueOf:void 0;function S(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function T(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function O(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function x(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new O;++e<n;)this.add(t[e])}function C(t){t=this.__data__=new T(t);this.size=t.size}function yt(t,e){var n,o,i,r=A(t),s=!r&&Tt(t),a=!r&&!s&&Ot(t),c=!r&&!s&&!a&&Pt(t),u=r||s||a||c,l=u?function(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}(t.length,String):[],p=l.length;for(n in t)!e&&!_.call(t,n)||u&&("length"==n||a&&("offset"==n||"parent"==n)||c&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||(o=n,i=p,(i=null==i?D:i)&&("number"==typeof o||X.test(o))&&-1<o&&o%1==0&&o<i))||l.push(n);return l}function M(t,e){for(var n=t.length;n--;)if(St(t[n][0],e))return n;return-1}function L(t){{if(null==t)return void 0===t?"[object Undefined]":"[object Null]";if(g&&g in Object(t)){var e=t,n=_.call(e,g),o=e[g];try{var i=!(e[g]=void 0)}catch(e){}var r=it.call(e);return i&&(n?e[g]=o:delete e[g]),r}return it.call(t)}}function gt(t){return k(t)&&L(t)==p}function vt(t,e,n,o,i){return t===e||(null==t||null==e||!k(t)&&!k(e)?t!=t&&e!=e:function(t,e,n,o,i,r){var s=A(t),a=A(e),c=s?h:j(t),a=a?h:j(e),u=(c=c==p?f:c)==f,l=(a=a==p?f:a)==f,a=c==a;if(a&&Ot(t)){if(!Ot(e))return!1;u=!(s=!0)}if(a&&!u)return r=r||new C,(s||Pt(t)?bt:function(t,e,n,o,i,r){switch(c){case y:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Y:return!(t.byteLength!=e.byteLength||!i(new st(t),new st(e)));case U:case $:case J:return St(+t,+e);case B:return t.name==e.name&&t.message==e.message;case q:case K:return t==e+"";case d:var s=Z;case m:s=s||Q;if(t.size!=e.size&&!(n&v))return!1;var a=r.get(t);if(a)return a==e;n|=F,r.set(t,e);a=bt(s(t),s(e),n,o,i,r);return r.delete(t),a;case"[object Symbol]":if(mt)return mt.call(t)==mt.call(e)}return!1})(t,e,n,o,i,r);if(!(n&v)){s=u&&_.call(t,"__wrapped__"),u=l&&_.call(e,"__wrapped__");if(s||u)return i(s?t.value():t,u?e.value():e,n,o,r=r||new C)}return!!a&&function(t,e,n,o,i,r){var s=n&v,a=wt(t),c=a.length;if(c!=wt(e).length&&!s)return!1;for(var u=c;u--;){var l=a[u];if(!(s?l in e:_.call(e,l)))return!1}var p=r.get(t);if(p&&r.get(e))return p==e;var h=!0;r.set(t,e),r.set(e,t);for(var d,f=s;++u<c;){var m,y=t[l=a[u]],g=e[l];if(!(void 0===(m=o?s?o(g,y,l,e,t,r):o(y,g,l,t,e,r):m)?y===g||i(y,g,n,o,r):m)){h=!1;break}f=f||"constructor"==l}return h&&!f&&(p=t.constructor)!=(d=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof p&&p instanceof p&&"function"==typeof d&&d instanceof d)&&(h=!1),r.delete(t),r.delete(e),h}(t,e,n,o,i,r=r||new C)}(t,e,n,o,vt,i))}function _t(t){if(e=t&&t.constructor,t!==("function"==typeof e&&e.prototype||u))return tt(et(t));var e,n,o=[];for(n in Object(t))_.call(t,n)&&"constructor"!=n&&o.push(n);return o}function bt(t,e,n,o,i,r){var s=n&v,a=t.length,c=e.length;if(a!=c&&!(s&&a<c))return!1;c=r.get(t);if(c&&r.get(e))return c==e;var u=-1,l=!0,p=n&F?new x:void 0;for(r.set(t,e),r.set(e,t);++u<a;){var h,d=t[u],f=e[u];if(void 0!==(h=o?s?o(f,d,u,e,t,r):o(d,f,u,t,e,r):h)){if(h)continue;l=!1;break}if(p){if(!function(t,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(t[n],n,t))return 1}(e,function(t,e){return!p.has(e)&&(d===t||i(d,t,n,o,r))&&p.push(e)})){l=!1;break}}else if(d!==f&&!i(d,f,n,o,r)){l=!1;break}}return r.delete(t),r.delete(e),l}function wt(t){if(n=Et,e=t=t,o=(null!=(o=e)&&Ct(o.length)&&!xt(o)?yt:_t)(e),A(t))return o;for(var e,n,o,i=o,r=n(t),s=-1,a=r.length,c=i.length;++s<a;)i[c+s]=r[s];return i}function P(t,e){var n,t=t.__data__;return("string"==(n=typeof e)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?t["string"==typeof e?"string":"hash"]:t.map}function N(t,e){t=null==t?void 0:t[e];return!Mt(e=t)||ot&&ot in e||!(xt(e)?rt:W).test(I(e))?void 0:t}S.prototype.clear=function(){this.__data__=E?E(null):{},this.size=0},S.prototype.delete=function(t){t=this.has(t)&&delete this.__data__[t];return this.size-=t?1:0,t},S.prototype.get=function(t){var e,n=this.__data__;return E?(e=n[t])===o?void 0:e:_.call(n,t)?n[t]:void 0},S.prototype.has=function(t){var e=this.__data__;return E?void 0!==e[t]:_.call(e,t)},S.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=E&&void 0===e?o:e,this},T.prototype.clear=function(){this.__data__=[],this.size=0},T.prototype.delete=function(t){var e=this.__data__,t=M(e,t);return!(t<0||(t==e.length-1?e.pop():ct.call(e,t,1),--this.size,0))},T.prototype.get=function(t){var e=this.__data__,t=M(e,t);return t<0?void 0:e[t][1]},T.prototype.has=function(t){return-1<M(this.__data__,t)},T.prototype.set=function(t,e){var n=this.__data__,o=M(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this},O.prototype.clear=function(){this.size=0,this.__data__={hash:new S,map:new(b||T),string:new S}},O.prototype.delete=function(t){t=P(this,t).delete(t);return this.size-=t?1:0,t},O.prototype.get=function(t){return P(this,t).get(t)},O.prototype.has=function(t){return P(this,t).has(t)},O.prototype.set=function(t,e){var n=P(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this},x.prototype.add=x.prototype.push=function(t){return this.__data__.set(t,o),this},x.prototype.has=function(t){return this.__data__.has(t)},C.prototype.clear=function(){this.__data__=new T,this.size=0},C.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},C.prototype.get=function(t){return this.__data__.get(t)},C.prototype.has=function(t){return this.__data__.has(t)},C.prototype.set=function(t,e){var n=this.__data__;if(n instanceof T){var o=n.__data__;if(!b||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new O(o)}return n.set(t,e),this.size=n.size,this};var Et=ut?function(t){if(null==t)return[];t=Object(t);for(var e=ut(t),n=-1,o=null==e?0:e.length,i=0,r=[];++n<o;){var s=e[n];at.call(t,s)&&(r[i++]=s)}return r}:function(){return[]},j=L;function I(t){if(null!=t){try{return nt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function St(t,e){return t===e||t!=t&&e!=e}(r&&j(new r(new ArrayBuffer(1)))!=y||b&&j(new b)!=d||l&&j(l.resolve())!=z||w&&j(new w)!=m||i&&j(new i)!=n)&&(j=function(t){var e=L(t),t=e==f?t.constructor:void 0,t=t?I(t):"";if(t)switch(t){case lt:return y;case pt:return d;case ht:return z;case dt:return m;case ft:return n}return e});var Tt=gt(function(){return arguments}())?gt:function(t){return k(t)&&_.call(t,"callee")&&!at.call(t,"callee")},A=Array.isArray,Ot=s||function(){return!1};function xt(t){if(Mt(t))return(t=L(t))==V||t==G||t==R||t==H}function Ct(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=D}function Mt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function k(t){return null!=t&&"object"==typeof t}var Lt,Pt=t?(Lt=t,function(t){return Lt(t)}):function(t){return k(t)&&Ct(t.length)&&!!e[L(t)]};Nt.exports=function(t,e){return vt(t,e)}}.call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(t,e,u){!function(i){function r(t,e){for(var n=0,o=t.length-1;0<=o;o--){var i=t[o];"."===i?t.splice(o,1):".."===i?(t.splice(o,1),n++):n&&(t.splice(o,1),n--)}if(e)for(;n--;)t.unshift("..");return t}function s(t,e){if(t.filter)return t.filter(e);for(var n=[],o=0;o<t.length;o++)e(t[o],o,t)&&n.push(t[o]);return n}u.resolve=function(){for(var t="",e=!1,n=arguments.length-1;-1<=n&&!e;n--){var o=0<=n?arguments[n]:i.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,e="/"===o.charAt(0))}return(e?"/":"")+r(s(t.split("/"),function(t){return!!t}),!e).join("/")||"."},u.normalize=function(t){var e=u.isAbsolute(t),n="/"===o(t,-1);return(t=(t=r(s(t.split("/"),function(t){return!!t}),!e).join("/"))||e?t:".")&&n&&(t+="/"),(e?"/":"")+t},u.isAbsolute=function(t){return"/"===t.charAt(0)},u.join=function(){var t=Array.prototype.slice.call(arguments,0);return u.normalize(s(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},u.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;0<=n&&""===t[n];n--);return n<e?[]:t.slice(e,n-e+1)}t=u.resolve(t).substr(1),e=u.resolve(e).substr(1);for(var o=n(t.split("/")),i=n(e.split("/")),r=Math.min(o.length,i.length),s=r,a=0;a<r;a++)if(o[a]!==i[a]){s=a;break}for(var c=[],a=s;a<o.length;a++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},u.sep="/",u.delimiter=":",u.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=47===t.charCodeAt(0),n=-1,o=!0,i=t.length-1;1<=i;--i)if(47===t.charCodeAt(i)){if(!o){n=i;break}}else o=!1;return-1===n?e?"/":".":e&&1===n?"/":t.slice(0,n)},u.basename=function(t,e){t=function(t){"string"!=typeof t&&(t+="");for(var e=0,n=-1,o=!0,i=t.length-1;0<=i;--i)if(47===t.charCodeAt(i)){if(!o){e=i+1;break}}else-1===n&&(o=!1,n=i+1);return-1===n?"":t.slice(e,n)}(t);return t=e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},u.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,o=-1,i=!0,r=0,s=t.length-1;0<=s;--s){var a=t.charCodeAt(s);if(47===a){if(i)continue;n=s+1;break}-1===o&&(i=!1,o=s+1),46===a?-1===e?e=s:1!==r&&(r=1):-1!==e&&(r=-1)}return-1===e||-1===o||0===r||1===r&&e===o-1&&e===n+1?"":t.slice(e,o)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}.call(this,t("_process"))},{_process:18}],18:[function(t,e,n){var o,i,e=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(o===setTimeout)return setTimeout(e,0);if((o===r||!o)&&setTimeout)return(o=setTimeout)(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}try{o="function"==typeof setTimeout?setTimeout:r}catch(t){o=r}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}var c,u=[],l=!1,p=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length)&&d()}function d(){if(!l){var t=a(h);l=!0;for(var e=u.length;e;){for(c=u,u=[];++p<e;)c&&c[p].run();p=-1,e=u.length}c=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return(i=clearTimeout)(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=m,e.addListener=m,e.once=m,e.off=m,e.removeListener=m,e.removeAllListeners=m,e.emit=m,e.prependListener=m,e.prependOnceListener=m,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],19:[function(t,e,n){var i=e.exports=function(t){return new r(t)};function r(t){this.value=t}function o(t,a,c){var u=[],l=[],p=!0;return function o(e){var t=c?h(e):e,i={},n=!0,r={node:t,node_:e,path:[].concat(u),parent:l[l.length-1],parents:l,key:u.slice(-1)[0],isRoot:0===u.length,level:u.length,circular:null,update:function(t,e){r.isRoot||(r.parent.node[r.key]=t),r.node=t,e&&(n=!1)},delete:function(t){delete r.parent.node[r.key],t&&(n=!1)},remove:function(t){f(r.parent.node)?r.parent.node.splice(r.key,1):delete r.parent.node[r.key],t&&(n=!1)},keys:null,before:function(t){i.before=t},after:function(t){i.after=t},pre:function(t){i.pre=t},post:function(t){i.post=t},stop:function(){p=!1},block:function(){n=!1}};return p&&(s(),void 0!==(t=a.call(r,r.node))&&r.update&&r.update(t),i.before&&i.before.call(r,r.node),n)&&("object"!=typeof r.node||null===r.node||r.circular||(l.push(r),s(),m(r.keys,function(t,e){u.push(t),i.pre&&i.pre.call(r,r.node[t],t);var n=o(r.node[t]);c&&y.call(r.node,t)&&(r.node[t]=n.node),n.isLast=e==r.keys.length-1,n.isFirst=0==e,i.post&&i.post.call(r,n),u.pop()}),l.pop()),i.after)&&i.after.call(r,r.node),r;function s(){if("object"==typeof r.node&&null!==r.node){r.keys&&r.node_===r.node||(r.keys=d(r.node)),r.isLeaf=0==r.keys.length;for(var t=0;t<l.length;t++)if(l[t].node_===e){r.circular=l[t];break}}else r.isLeaf=!0,r.keys=null;r.notLeaf=!r.isLeaf,r.notRoot=!r.isRoot}}(t).node}function h(e){var t,n,o;return"object"!=typeof e||null===e?e:(o=f(e)?[]:"[object Date]"===s(e)?new Date(e.getTime?e.getTime():e):"[object RegExp]"===s(e)?new RegExp(e):"[object Error]"===s(e)?{message:e.message}:"[object Boolean]"===s(e)?new Boolean(e):"[object Number]"===s(e)?new Number(e):"[object String]"===s(e)?new String(e):Object.create&&Object.getPrototypeOf?Object.create(Object.getPrototypeOf(e)):e.constructor===Object?{}:(t=e.constructor&&e.constructor.prototype||e.__proto__||{},(n=function(){}).prototype=t,new n),m(d(e),function(t){o[t]=e[t]}),o)}r.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var o=t[n];if(!e||!y.call(e,o)){e=void 0;break}e=e[o]}return e},r.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var o=t[n];if(!e||!y.call(e,o))return!1;e=e[o]}return!0},r.prototype.set=function(t,e){for(var n=this.value,o=0;o<t.length-1;o++){var i=t[o];y.call(n,i)||(n[i]={}),n=n[i]}return n[t[o]]=e},r.prototype.map=function(t){return o(this.value,t,!0)},r.prototype.forEach=function(t){return this.value=o(this.value,t,!1),this.value},r.prototype.reduce=function(e,t){var n=1===arguments.length,o=n?this.value:t;return this.forEach(function(t){this.isRoot&&n||(o=e.call(this,o,t))}),o},r.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},r.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},r.prototype.clone=function(){var i=[],r=[];return function e(n){for(var o,t=0;t<i.length;t++)if(i[t]===n)return r[t];return"object"!=typeof n||null===n?n:(o=h(n),i.push(n),r.push(o),m(d(n),function(t){o[t]=e(n[t])}),i.pop(),r.pop(),o)}(this.value)};var d=Object.keys||function(t){var e,n=[];for(e in t)n.push(e);return n};function s(t){return Object.prototype.toString.call(t)}var f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},m=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)},y=(m(d(r.prototype),function(o){i[o]=function(t){var e=[].slice.call(arguments,1),n=new r(t);return n[o].apply(n,e)}}),Object.hasOwnProperty||function(t,e){return e in t})},{}],20:[function(t,e,n){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},{}],21:[function(t,e,n){e.exports=function(){for(var t={},e=0;e<arguments.length;e++){var n,o=arguments[e];for(n in o)i.call(o,n)&&(t[n]=o[n])}return t};var i=Object.prototype.hasOwnProperty},{}],22:[function(t,e,n){"use strict";var o=t("lodash.isequal"),s=t("@mapbox/geojson-normalize"),a=t("hat"),c=t("./lib/features_at"),u=t("./lib/string_sets_are_equal"),l=t("@mapbox/geojsonhint"),p=t("./constants"),h=t("./lib/string_set"),d={Polygon:t("./feature_types/polygon"),LineString:t("./feature_types/line_string"),Point:t("./feature_types/point"),MultiPolygon:t("./feature_types/multi_feature"),MultiLineString:t("./feature_types/multi_feature"),MultiPoint:t("./feature_types/multi_feature")};e.exports=function(i,r){return r.modes=p.modes,r.getFeatureIdsAt=function(t){return c.click({point:t},null,i).map(function(t){return t.properties.id})},r.getSelectedIds=function(){return i.store.getSelectedIds()},r.getSelected=function(){return{type:p.geojsonTypes.FEATURE_COLLECTION,features:i.store.getSelectedIds().map(function(t){return i.store.get(t)}).map(function(t){return t.toGeoJSON()})}},r.getSelectedPoints=function(){return{type:p.geojsonTypes.FEATURE_COLLECTION,features:i.store.getSelectedCoordinates().map(function(t){return{type:p.geojsonTypes.FEATURE,properties:{},geometry:{type:p.geojsonTypes.POINT,coordinates:t.coordinates}}})}},r.set=function(t){var e,n,o;if(void 0!==t.type&&t.type===p.geojsonTypes.FEATURE_COLLECTION&&Array.isArray(t.features))return e=i.store.createRenderBatch(),n=i.store.getAllIds().slice(),t=r.add(t),o=new h(t),(n=n.filter(function(t){return!o.has(t)})).length&&r.delete(n),e(),t;throw new Error("Invalid FeatureCollection")},r.add=function(t){var e=l.hint(t,{precisionWarning:!1}).filter(function(t){return"message"!==t.level});if(e.length)throw new Error(e[0].message);e=JSON.parse(JSON.stringify(s(t))).features.map(function(t){if(t.id=t.id||a(),null===t.geometry)throw new Error("Invalid geometry: null");if(void 0===i.store.get(t.id)||i.store.get(t.id).type!==t.geometry.type){var e=d[t.geometry.type];if(void 0===e)throw new Error("Invalid geometry type: ".concat(t.geometry.type,"."));e=new e(i,t);i.store.add(e)}else{e=i.store.get(t.id);e.properties=t.properties,o(e.getCoordinates(),t.geometry.coordinates)||e.incomingCoords(t.geometry.coordinates)}return t.id});return i.store.render(),e},r.get=function(t){t=i.store.get(t);if(t)return t.toGeoJSON()},r.getAll=function(){return{type:p.geojsonTypes.FEATURE_COLLECTION,features:i.store.getAll().map(function(t){return t.toGeoJSON()})}},r.delete=function(t){return i.store.delete(t,{silent:!0}),r.getMode()!==p.modes.DIRECT_SELECT||i.store.getSelectedIds().length?i.store.render():i.events.changeMode(p.modes.SIMPLE_SELECT,void 0,{silent:!0}),r},r.deleteAll=function(){return i.store.delete(i.store.getAllIds(),{silent:!0}),r.getMode()===p.modes.DIRECT_SELECT?i.events.changeMode(p.modes.SIMPLE_SELECT,void 0,{silent:!0}):i.store.render(),r},r.changeMode=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t===p.modes.SIMPLE_SELECT&&r.getMode()===p.modes.SIMPLE_SELECT?u(e.featureIds||[],i.store.getSelectedIds())||(i.store.setSelected(e.featureIds,{silent:!0}),i.store.render()):t===p.modes.DIRECT_SELECT&&r.getMode()===p.modes.DIRECT_SELECT&&e.featureId===i.store.getSelectedIds()[0]||i.events.changeMode(t,e,{silent:!0}),r},r.getMode=function(){return i.events.getMode()},r.trash=function(){return i.events.trash({silent:!0}),r},r.combineFeatures=function(){return i.events.combineFeatures({silent:!0}),r},r.uncombineFeatures=function(){return i.events.uncombineFeatures({silent:!0}),r},r.setFeatureProperty=function(t,e,n){return i.store.setFeatureProperty(t,e,n),r},r}},{"./constants":23,"./feature_types/line_string":26,"./feature_types/multi_feature":27,"./feature_types/point":28,"./feature_types/polygon":29,"./lib/features_at":37,"./lib/string_set":47,"./lib/string_sets_are_equal":48,"@mapbox/geojson-normalize":7,"@mapbox/geojsonhint":8,hat:14,"lodash.isequal":16}],23:[function(t,e,n){"use strict";e.exports={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}},{}],24:[function(t,e,n){"use strict";var p=t("./lib/mode_handler"),h=t("./lib/get_features_and_set_cursor"),d=t("./lib/features_at"),f=t("./lib/is_click"),m=t("./lib/is_tap"),y=t("./constants"),g=t("./modes/object_to_mode");e.exports=function(i){function e(t){return!(8===t||46===t||48<=t&&t<=57)}var r=Object.keys(i.options.modes).reduce(function(t,e){return t[e]=g(i.options.modes[e]),t},{}),n={},o={},s={},a=null,c=null;s.drag=function(t,e){e({point:t.point,time:(new Date).getTime()})?(i.ui.queueMapClasses({mouse:y.cursors.DRAG}),c.drag(t)):t.originalEvent.stopPropagation()},s.mousedrag=function(t){s.drag(t,function(t){return!f(n,t)})},s.touchdrag=function(t){s.drag(t,function(t){return!m(o,t)})},s.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return s.mousedrag(t);var e=h(t,i);t.featureTarget=e,c.mousemove(t)},s.mousedown=function(t){n={time:(new Date).getTime(),point:t.point};var e=h(t,i);t.featureTarget=e,c.mousedown(t)},s.mouseup=function(t){var e=h(t,i);t.featureTarget=e,f(n,{point:t.point,time:(new Date).getTime()})?c.click(t):c.mouseup(t)},s.mouseout=function(t){c.mouseout(t)},s.touchstart=function(t){var e;i.options.touchEnabled&&(o={time:(new Date).getTime(),point:t.point},e=d.touch(t,null,i)[0])&&(t.originalEvent.preventDefault(),t.featureTarget=e,c.touchstart(t))},s.touchmove=function(t){if(t.originalEvent.preventDefault(),i.options.touchEnabled)return c.touchmove(t),s.touchdrag(t)},s.touchend=function(t){var e;i.options.touchEnabled&&(e=d.touch(t,null,i)[0])&&(t.originalEvent.preventDefault(),t.featureTarget=e,m(o,{time:(new Date).getTime(),point:t.point})?c.tap(t):c.touchend(t))};function u(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=(c.stop(),r[t]);if(void 0===o)throw new Error("".concat(t," is not valid"));a=t;o=o(i,e);c=p(o,i),n.silent||i.map.fire(y.events.MODE_CHANGE,{mode:t}),i.store.setDirty(),i.store.render()}s.keydown=function(t){"mapboxgl-canvas"===(t.srcElement||t.target).classList[0]&&(8!==t.keyCode&&46!==t.keyCode||!i.options.controls.trash?e(t.keyCode)?c.keydown(t):49===t.keyCode&&i.options.controls.point?u(y.modes.DRAW_POINT):50===t.keyCode&&i.options.controls.line_string?u(y.modes.DRAW_LINE_STRING):51===t.keyCode&&i.options.controls.polygon&&u(y.modes.DRAW_POLYGON):(t.preventDefault(),c.trash()))},s.keyup=function(t){e(t.keyCode)&&c.keyup(t)},s.zoomend=function(){i.store.changeZoom()};var l={trash:!(s.data=function(t){var e,n,o;"style"===t.dataType&&(t=i.setup,e=i.map,n=i.options,o=i.store,n.styles.some(function(t){return e.getLayer(t.id)})||(t.addLayers(),o.setDirty(),o.render()))}),combineFeatures:!1,uncombineFeatures:!1};return{start:function(){a=i.options.defaultMode,c=p(r[a](i),i)},changeMode:u,actionable:function(e){var n=!1;Object.keys(e).forEach(function(t){if(void 0===l[t])throw new Error("Invalid action type");l[t]!==e[t]&&(n=!0),l[t]=e[t]}),n&&i.map.fire(y.events.ACTIONABLE,{actions:l})},currentModeName:function(){return a},currentModeRender:function(t,e){return c.render(t,e)},fire:function(t,e){s[t]&&s[t](e)},addEventListeners:function(){i.map.on("mousemove",s.mousemove),i.map.on("mousedown",s.mousedown),i.map.on("mouseup",s.mouseup),i.map.on("data",s.data),i.map.on("touchmove",s.touchmove),i.map.on("touchstart",s.touchstart),i.map.on("touchend",s.touchend),i.container.addEventListener("mouseout",s.mouseout),i.options.keybindings&&(i.container.addEventListener("keydown",s.keydown),i.container.addEventListener("keyup",s.keyup))},removeEventListeners:function(){i.map.off("mousemove",s.mousemove),i.map.off("mousedown",s.mousedown),i.map.off("mouseup",s.mouseup),i.map.off("data",s.data),i.map.off("touchmove",s.touchmove),i.map.off("touchstart",s.touchstart),i.map.off("touchend",s.touchend),i.container.removeEventListener("mouseout",s.mouseout),i.options.keybindings&&(i.container.removeEventListener("keydown",s.keydown),i.container.removeEventListener("keyup",s.keyup))},trash:function(t){c.trash(t)},combineFeatures:function(){c.combineFeatures()},uncombineFeatures:function(){c.uncombineFeatures()},getMode:function(){return a}}}},{"./constants":23,"./lib/features_at":37,"./lib/get_features_and_set_cursor":38,"./lib/is_click":39,"./lib/is_tap":41,"./lib/mode_handler":43,"./modes/object_to_mode":59}],25:[function(t,e,n){"use strict";function o(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||i(),this.type=e.geometry.type}var i=t("hat"),r=t("../constants");o.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},o.prototype.incomingCoords=function(t){this.setCoordinates(t)},o.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},o.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},o.prototype.setProperty=function(t,e){this.properties[t]=e},o.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:r.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},o.prototype.internal=function(t){var e={id:this.id,meta:r.meta.FEATURE,"meta:type":this.type,active:r.activeStates.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(var n in this.properties)e["user_".concat(n)]=this.properties[n];return{type:r.geojsonTypes.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}},e.exports=o},{"../constants":23,hat:14}],26:[function(t,e,n){"use strict";function o(t,e){i.call(this,t,e)}var i=t("./feature");(o.prototype=Object.create(i.prototype)).isValid=function(){return 1<this.coordinates.length},o.prototype.addCoordinate=function(t,e,n){this.changed();t=parseInt(t,10);this.coordinates.splice(t,0,[e,n])},o.prototype.getCoordinate=function(t){t=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},o.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},o.prototype.updateCoordinate=function(t,e,n){t=parseInt(t,10);this.coordinates[t]=[e,n],this.changed()},e.exports=o},{"./feature":25}],27:[function(t,e,n){"use strict";function o(t,e,n,o,i){var n=n.split("."),r=parseInt(n[0],10),n=n[1]?n.slice(1).join("."):null;return t[r][e](n,o,i)}function i(t,e){if(r.call(this,t,e),delete this.coordinates,this.model=c[e.geometry.type],void 0===this.model)throw new TypeError("".concat(e.geometry.type," is not a valid type"));this.features=this._coordinatesToFeatures(e.geometry.coordinates)}var r=t("./feature"),s=t("../constants"),a=t("hat"),c={MultiPoint:t("./point"),MultiLineString:t("./line_string"),MultiPolygon:t("./polygon")};(i.prototype=Object.create(r.prototype))._coordinatesToFeatures=function(t){var e=this,n=this.model.bind(this);return t.map(function(t){return new n(e.ctx,{id:a(),type:s.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:t,type:e.type.replace("Multi","")}})})},i.prototype.isValid=function(){return this.features.every(function(t){return t.isValid()})},i.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},i.prototype.getCoordinate=function(t){return o(this.features,"getCoordinate",t)},i.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(t){return t.type===s.geojsonTypes.POLYGON?t.getCoordinates():t.coordinates})))},i.prototype.updateCoordinate=function(t,e,n){o(this.features,"updateCoordinate",t,e,n),this.changed()},i.prototype.addCoordinate=function(t,e,n){o(this.features,"addCoordinate",t,e,n),this.changed()},i.prototype.removeCoordinate=function(t){o(this.features,"removeCoordinate",t),this.changed()},i.prototype.getFeatures=function(){return this.features},e.exports=i},{"../constants":23,"./feature":25,"./line_string":26,"./point":28,"./polygon":29,hat:14}],28:[function(t,e,n){"use strict";function o(t,e){i.call(this,t,e)}var i=t("./feature");(o.prototype=Object.create(i.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},o.prototype.updateCoordinate=function(t,e,n){this.coordinates=3===arguments.length?[e,n]:[t,e],this.changed()},o.prototype.getCoordinate=function(){return this.getCoordinates()},e.exports=o},{"./feature":25}],29:[function(t,e,n){"use strict";function o(t,e){i.call(this,t,e),this.coordinates=this.coordinates.map(function(t){return t.slice(0,-1)})}var i=t("./feature");(o.prototype=Object.create(i.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(function(t){return 2<t.length})},o.prototype.incomingCoords=function(t){this.coordinates=t.map(function(t){return t.slice(0,-1)}),this.changed()},o.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},o.prototype.addCoordinate=function(t,e,n){this.changed();t=t.split(".").map(function(t){return parseInt(t,10)});this.coordinates[t[0]].splice(t[1],0,[e,n])},o.prototype.removeCoordinate=function(t){this.changed();var t=t.split(".").map(function(t){return parseInt(t,10)}),e=this.coordinates[t[0]];e&&(e.splice(t[1],1),e.length<3)&&this.coordinates.splice(t[0],1)},o.prototype.getCoordinate=function(t){var t=t.split(".").map(function(t){return parseInt(t,10)}),e=this.coordinates[t[0]];return JSON.parse(JSON.stringify(e[t[1]]))},o.prototype.getCoordinates=function(){return this.coordinates.map(function(t){return t.concat([t[0]])})},o.prototype.updateCoordinate=function(t,e,n){this.changed();var t=t.split("."),o=parseInt(t[0],10),t=parseInt(t[1],10);void 0===this.coordinates[o]&&(this.coordinates[o]=[]),this.coordinates[o][t]=[e,n]},e.exports=o},{"./feature":25}],30:[function(t,e,n){"use strict";var o=t("../constants");e.exports={isOfMetaType:function(e){return function(t){t=t.featureTarget;return!!t&&!!t.properties&&t.properties.meta===e}},isShiftMousedown:function(t){return!!t.originalEvent&&!!t.originalEvent.shiftKey&&0===t.originalEvent.button},isActiveFeature:function(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===o.activeStates.ACTIVE&&t.featureTarget.properties.meta===o.meta.FEATURE},isInactiveFeature:function(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===o.activeStates.INACTIVE&&t.featureTarget.properties.meta===o.meta.FEATURE},noTarget:function(t){return void 0===t.featureTarget},isFeature:function(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.meta===o.meta.FEATURE},isVertex:function(t){t=t.featureTarget;return!!t&&!!t.properties&&t.properties.meta===o.meta.VERTEX},isShiftDown:function(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey},isEscapeKey:function(t){return 27===t.keyCode},isEnterKey:function(t){return 13===t.keyCode},true:function(){return!0}}},{"../constants":23}],31:[function(t,e,n){"use strict";var l=t("@mapbox/geojson-extent"),t=t("../constants"),o=t.LAT_MIN,p=t.LAT_MAX,h=t.LAT_RENDERED_MIN,d=t.LAT_RENDERED_MAX,f=t.LNG_MIN,m=t.LNG_MAX;e.exports=function(t,e){var i=o,r=p,s=o,a=p,c=m,u=f,t=(t.forEach(function(t){var t=l(t),e=t[1],n=t[3],o=t[0],t=t[2];i<e&&(i=e),n<r&&(r=n),s<n&&(s=n),e<a&&(a=e),o<c&&(c=o),u<t&&(u=t)}),e);return i+t.lat>d&&(t.lat=d-i),s+t.lat>p&&(t.lat=p-s),r+t.lat<h&&(t.lat=h-r),a+t.lat<o&&(t.lat=o-a),c+t.lng<=f&&(t.lng+=360*Math.ceil(Math.abs(t.lng)/360)),u+t.lng>=m&&(t.lng-=360*Math.ceil(Math.abs(t.lng)/360)),t}},{"../constants":23,"@mapbox/geojson-extent":6}],32:[function(t,e,n){"use strict";var r=t("../constants");e.exports=function(t,e,n,o){var e=e.geometry.coordinates,i=n.geometry.coordinates;return e[1]>r.LAT_RENDERED_MAX||e[1]<r.LAT_RENDERED_MIN||i[1]>r.LAT_RENDERED_MAX||i[1]<r.LAT_RENDERED_MIN?null:(e=o.project([e[0],e[1]]),i=o.project([i[0],i[1]]),o=o.unproject([(e.x+i.x)/2,(e.y+i.y)/2]),{type:r.geojsonTypes.FEATURE,properties:{meta:r.meta.MIDPOINT,parent:t,lng:o.lng,lat:o.lat,coord_path:n.properties.coord_path},geometry:{type:r.geojsonTypes.POINT,coordinates:[o.lng,o.lat]}})}},{"../constants":23}],33:[function(t,e,n){"use strict";var p=t("./create_vertex"),h=t("./create_midpoint"),d=t("../constants");e.exports=function n(o){var i,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,t=o.geometry,e=t.type,t=t.coordinates,c=o.properties&&o.properties.id,u=[];function s(t,i){var r="",s=null;t.forEach(function(t,e){var n=null!=i?"".concat(i,".").concat(e):String(e),n=p(c,t,n,l(n)),o=(a.midpoints&&s&&(o=h(c,s,n,a.map))&&u.push(o),s=n,JSON.stringify(t));r!==o&&u.push(n),0===e&&(r=o)})}function l(t){return!!a.selectedPaths&&-1!==a.selectedPaths.indexOf(t)}return e===d.geojsonTypes.POINT?u.push(p(c,t,r,l(r))):e===d.geojsonTypes.POLYGON?t.forEach(function(t,e){s(t,null!==r?"".concat(r,".").concat(e):String(e))}):e===d.geojsonTypes.LINE_STRING?s(t,r):0===e.indexOf(d.geojsonTypes.MULTI_PREFIX)&&(i=e.replace(d.geojsonTypes.MULTI_PREFIX,""),t.forEach(function(t,e){t={type:d.geojsonTypes.FEATURE,properties:o.properties,geometry:{type:i,coordinates:t}};u=u.concat(n(t,a,e))})),u}},{"../constants":23,"./create_midpoint":32,"./create_vertex":34}],34:[function(t,e,n){"use strict";var i=t("../constants");e.exports=function(t,e,n,o){return{type:i.geojsonTypes.FEATURE,properties:{meta:i.meta.VERTEX,parent:t,coord_path:n,active:o?i.activeStates.ACTIVE:i.activeStates.INACTIVE},geometry:{type:i.geojsonTypes.POINT,coordinates:e}}}},{"../constants":23}],35:[function(t,e,n){"use strict";e.exports={enable:function(t){setTimeout(function(){t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()},0)},disable:function(t){setTimeout(function(){t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()},0)}}},{}],36:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.x-e.x,t=t.y-e.y;return Math.sqrt(n*n+t*t)}},{}],37:[function(t,e,n){"use strict";var s=t("./sort_features"),a=t("./map_event_to_bounding_box"),o=t("../constants"),c=t("./string_set"),u=[o.meta.FEATURE,o.meta.MIDPOINT,o.meta.VERTEX];function i(t,e,n,o){var i,r;return null===n.map?[]:(t=t?a(t,o):e,o={},n.options.styles&&(o.layers=n.options.styles.map(function(t){return t.id})),e=n.map.queryRenderedFeatures(t,o).filter(function(t){return-1!==u.indexOf(t.properties.meta)}),i=new c,r=[],e.forEach(function(t){var e=t.properties.id;i.has(e)||(i.add(e),r.push(t))}),s(r))}e.exports={click:function(t,e,n){return i(t,e,n,n.options.clickBuffer)},touch:function(t,e,n){return i(t,e,n,n.options.touchBuffer)}}},{"../constants":23,"./map_event_to_bounding_box":42,"./sort_features":46,"./string_set":47}],38:[function(t,e,n){"use strict";var o=t("./features_at"),i=t("../constants");e.exports=function(t,e){var t=o.click(t,null,e),n={mouse:i.cursors.NONE};return t[0]&&(n.mouse=t[0].properties.active===i.activeStates.ACTIVE?i.cursors.MOVE:i.cursors.POINTER,n.feature=t[0].properties.meta),-1!==e.events.currentModeName().indexOf("draw")&&(n.mouse=i.cursors.ADD),e.ui.queueMapClasses(n),e.ui.updateMapClasses(),t[0]}},{"../constants":23,"./features_at":37}],39:[function(t,e,n){"use strict";var s=t("./euclidean_distance");e.exports=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=null!=n.fineTolerance?n.fineTolerance:4,i=null!=n.grossTolerance?n.grossTolerance:12,n=null!=n.interval?n.interval:500,r=(t.point=t.point||e.point,t.time=t.time||e.time,s(t.point,e.point));return r<o||r<i&&e.time-t.time<n}},{"./euclidean_distance":36}],40:[function(t,e,n){"use strict";e.exports=function(t,e){return!!t.lngLat&&t.lngLat.lng===e[0]&&t.lngLat.lat===e[1]}},{}],41:[function(t,e,n){"use strict";var i=t("./euclidean_distance");e.exports=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=null!=n.tolerance?n.tolerance:25,n=null!=n.interval?n.interval:250;return t.point=t.point||e.point,t.time=t.time||e.time,i(t.point,e.point)<o&&e.time-t.time<n}},{"./euclidean_distance":36}],42:[function(t,e,n){"use strict";e.exports=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}},{}],43:[function(t,e,n){"use strict";e.exports=function(t,r){function e(t,e){for(var n=s[t],o=n.length;o--;){var i=n[o];if(i.selector(e)){i.fn.call(a,e),r.store.render(),r.ui.updateMapClasses();break}}}var s={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},a={on:function(t,e,n){if(void 0===s[t])throw new Error("Invalid event type: ".concat(t));s[t].push({selector:e,fn:n})},render:function(t){r.store.featureChanged(t)}};return t.start.call(a),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),r.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(t){e("drag",t)},click:function(t){e("click",t)},mousemove:function(t){e("mousemove",t)},mousedown:function(t){e("mousedown",t)},mouseup:function(t){e("mouseup",t)},mouseout:function(t){e("mouseout",t)},keydown:function(t){e("keydown",t)},keyup:function(t){e("keyup",t)},touchstart:function(t){e("touchstart",t)},touchmove:function(t){e("touchmove",t)},touchend:function(t){e("touchend",t)},tap:function(t){e("tap",t)}}}},{}],44:[function(t,e,n){"use strict";var o=t("@mapbox/point-geometry");e.exports=function(t,e){var n=e.getBoundingClientRect();return new o(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}},{"@mapbox/point-geometry":11}],45:[function(t,e,n){"use strict";var o=t("./constrain_feature_movement"),s=t("../constants");e.exports=function(t,e){var r=o(t.map(function(t){return t.toGeoJSON()}),e);t.forEach(function(t){function e(t){return[t[0]+r.lng,t[1]+r.lat]}function n(t){return t.map(e)}var o,i=t.getCoordinates();t.type===s.geojsonTypes.POINT?o=e(i):t.type===s.geojsonTypes.LINE_STRING||t.type===s.geojsonTypes.MULTI_POINT?o=i.map(e):t.type===s.geojsonTypes.POLYGON||t.type===s.geojsonTypes.MULTI_LINE_STRING?o=i.map(n):t.type===s.geojsonTypes.MULTI_POLYGON&&(o=i.map(function(t){return t.map(n)})),t.incomingCoords(o)})}},{"../constants":23,"./constrain_feature_movement":31}],46:[function(t,e,n){"use strict";var o=t("@mapbox/geojson-area"),i=t("../constants"),r={Point:0,LineString:1,Polygon:2};function s(t,e){var n=r[t.geometry.type]-r[e.geometry.type];return 0==n&&t.geometry.type===i.geojsonTypes.POLYGON?t.area-e.area:n}e.exports=function(t){return t.map(function(t){return t.geometry.type===i.geojsonTypes.POLYGON&&(t.area=o.geometry({type:i.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t}).sort(s).map(function(t){return delete t.area,t})}},{"../constants":23,"@mapbox/geojson-area":3}],47:[function(t,e,n){"use strict";function o(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,n=t.length;e<n;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}o.prototype.add=function(t){return this.has(t)||(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},o.prototype.delete=function(t){return!1!==this.has(t)&&(this._length--,delete this._items[t],delete this._nums[t]),this},o.prototype.has=function(t){return!("string"!=typeof t&&"number"!=typeof t||void 0===this._items[t]&&void 0===this._nums[t])},o.prototype.values=function(){var e=this,n=[];return Object.keys(this._items).forEach(function(t){n.push({k:t,v:e._items[t]})}),Object.keys(this._nums).forEach(function(t){n.push({k:JSON.parse(t),v:e._nums[t]})}),n.sort(function(t,e){return t.v-e.v}).map(function(t){return t.k})},o.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this},e.exports=o},{}],48:[function(t,e,n){"use strict";e.exports=function(t,e){return t.length===e.length&&JSON.stringify(t.map(function(t){return t}).sort())===JSON.stringify(e.map(function(t){return t}).sort())}},{}],49:[function(t,e,n){"use strict";e.exports=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}]},{}],50:[function(t,e,n){"use strict";e.exports=function(t,e,n){var o,i;function r(){o=!1,i&&(s.apply(n,i),i=!1)}function s(){o?i=arguments:(o=!0,t.apply(n,arguments),setTimeout(r,e))}return s}},{}],51:[function(t,e,n){"use strict";e.exports=function(t){return[].concat(t).filter(function(t){return void 0!==t})}},{}],52:[function(t,e,n){"use strict";var o=t("../lib/common_selectors"),i=o.noTarget,r=o.isOfMetaType,s=o.isInactiveFeature,a=o.isShiftDown,c=t("../lib/create_supplementary_points"),u=t("../lib/constrain_feature_movement"),l=t("../lib/double_click_zoom"),p=t("../constants"),h=t("../lib/common_selectors"),d=t("../lib/move_features"),f=r(p.meta.VERTEX),m=r(p.meta.MIDPOINT),o={fireUpdate:function(){this.map.fire(p.events.UPDATE,{action:p.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(function(t){return t.toGeoJSON()})})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:0<t.selectedCoordPaths.length})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties,o=t.selectedCoordPaths.indexOf(n.coord_path),e=(a(e)||-1!==o?a(e)&&-1===o&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path],this.pathsToCoordinates(t.featureId,t.selectedCoordPaths));this.setSelectedCoordinates(e)},onMidpoint:function(t,e){this.startDragging(t,e);e=e.featureTarget.properties;t.feature.addCoordinate(e.coord_path,e.lng,e.lat),this.fireUpdate(),t.selectedCoordPaths=[e.coord_path]},pathsToCoordinates:function(e,t){return t.map(function(t){return{feature_id:e,coord_path:t}})},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){d(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(e,t,n){for(var o=e.selectedCoordPaths.map(function(t){return e.feature.getCoordinate(t)}),i=o.map(function(t){return{type:p.geojsonTypes.FEATURE,properties:{},geometry:{type:p.geojsonTypes.POINT,coordinates:t}}}),r=u(i,n),s=0;s<o.length;s++){var a=o[s];e.feature.updateCoordinate(e.selectedCoordPaths[s],a[0]+r.lng,a[1]+r.lat)}},clickNoTarget:function(){this.changeMode(p.modes.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(p.modes.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){var e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===p.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");n={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,n.selectedCoordPaths)),this.setSelected(e),l.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){l.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=p.activeStates.ACTIVE,n(e),c(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=p.activeStates.INACTIVE,n(e)),this.fireActionable(t)},onTrash:function(e){e.selectedCoordPaths.sort().reverse().forEach(function(t){return e.feature.removeCoordinate(t)}),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode(p.modes.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){var n=h.isActiveFeature(e),e=f(e),o=0===t.selectedCoordPaths.length;n&&o||e&&!o?this.updateUIClasses({mouse:p.cursors.MOVE}):this.updateUIClasses({mouse:p.cursors.NONE}),this.stopDragging(t)},onMouseOut:function(t){t.dragMoving&&this.fireUpdate()}};o.onTouchStart=o.onMouseDown=function(t,e){return f(e)?this.onVertex(t,e):h.isActiveFeature(e)?this.onFeature(t,e):m(e)?this.onMidpoint(t,e):void 0},o.onDrag=function(t,e){var n;!0===t.canDragMove&&(t.dragMoving=!0,e.originalEvent.stopPropagation(),n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat},0<t.selectedCoordPaths.length?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat)},o.onClick=function(t,e){return i(e)?this.clickNoTarget(t,e):h.isActiveFeature(e)?this.clickActiveFeature(t,e):s(e)?this.clickInactive(t,e):void this.stopDragging(t)},o.onTap=function(t,e){return i(e)?this.clickNoTarget(t,e):h.isActiveFeature(e)?this.clickActiveFeature(t,e):s(e)?this.clickInactive(t,e):void 0},o.onTouchEnd=o.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)},e.exports=o},{"../constants":23,"../lib/common_selectors":30,"../lib/constrain_feature_movement":31,"../lib/create_supplementary_points":33,"../lib/double_click_zoom":35,"../lib/move_features":45}],53:[function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=t("../lib/common_selectors"),i=t("../lib/is_event_at_coordinates"),s=t("../lib/double_click_zoom"),a=t("../constants"),c=t("../lib/create_vertex"),t={onSetup:function(t){var e,n=(t=t||{}).featureId,o="forward";if(n){if(!(e=this.getFeature(n)))throw new Error("Could not find a feature with the provided featureId");n=t.from;if(!(n=(n=n&&"Feature"===n.type&&n.geometry&&"Point"===n.geometry.type?n.geometry:n)&&"Point"===n.type&&n.coordinates&&2===n.coordinates.length?n.coordinates:n)||!Array.isArray(n))throw new Error("Please use the `from` property to indicate which point to continue the line from");t=e.coordinates.length-1;if(e.coordinates[t][0]===n[0]&&e.coordinates[t][1]===n[1]){var i=1+t;e.addCoordinate.apply(e,[i].concat(r(e.coordinates[t])))}else{if(e.coordinates[0][0]!==n[0]||e.coordinates[0][1]!==n[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");o="backwards";e.addCoordinate.apply(e,[i=0].concat(r(e.coordinates[0])))}}else e=this.newFeature({type:a.geojsonTypes.FEATURE,properties:{},geometry:{type:a.geojsonTypes.LINE_STRING,coordinates:[]}}),i=0,this.addFeature(e);return this.clearSelectedFeatures(),s.disable(this),this.updateUIClasses({mouse:a.cursors.ADD}),this.activateUIButton(a.types.LINE),this.setActionableState({trash:!0}),{line:e,currentVertexPosition:i,direction:o}},clickAnywhere:function(t,e){if(0<t.currentVertexPosition&&i(e,t.line.coordinates[t.currentVertexPosition-1])||"backwards"===t.direction&&i(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:a.cursors.ADD}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),"forward"===t.direction?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),o.isVertex(e)&&this.updateUIClasses({mouse:a.cursors.POINTER})}};t.onTap=t.onClick=function(t,e){if(o.isVertex(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},t.onKeyUp=function(t,e){o.isEnterKey(e)?this.changeMode(a.modes.SIMPLE_SELECT,{featureIds:[t.line.id]}):o.isEscapeKey(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT))},t.onStop=function(t){s.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.line.id)&&(t.line.removeCoordinate("".concat(t.currentVertexPosition)),t.line.isValid()?this.map.fire(a.events.CREATE,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT,{},{silent:!0})))},t.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(a.modes.SIMPLE_SELECT)},t.toDisplayFeatures=function(t,e,n){var o=e.properties.id===t.line.id;if(e.properties.active=o?a.activeStates.ACTIVE:a.activeStates.INACTIVE,!o)return n(e);e.geometry.coordinates.length<2||(e.properties.meta=a.meta.FEATURE,n(c(t.line.id,e.geometry.coordinates["forward"===t.direction?e.geometry.coordinates.length-2:1],"".concat("forward"===t.direction?e.geometry.coordinates.length-2:1),!1)),n(e))},e.exports=t},{"../constants":23,"../lib/common_selectors":30,"../lib/create_vertex":34,"../lib/double_click_zoom":35,"../lib/is_event_at_coordinates":40}],54:[function(t,e,n){"use strict";var o=t("../lib/common_selectors"),i=t("../constants"),t={onSetup:function(){var t=this.newFeature({type:i.geojsonTypes.FEATURE,properties:{},geometry:{type:i.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:i.cursors.ADD}),this.activateUIButton(i.types.POINT),this.setActionableState({trash:!0}),{point:t}},stopDrawingAndRemove:function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(i.modes.SIMPLE_SELECT)}};t.onTap=t.onClick=function(t,e){this.updateUIClasses({mouse:i.cursors.MOVE}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.map.fire(i.events.CREATE,{features:[t.point.toGeoJSON()]}),this.changeMode(i.modes.SIMPLE_SELECT,{featureIds:[t.point.id]})},t.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},t.toDisplayFeatures=function(t,e,n){t=e.properties.id===t.point.id;if(e.properties.active=t?i.activeStates.ACTIVE:i.activeStates.INACTIVE,!t)return n(e)},t.onTrash=t.stopDrawingAndRemove,t.onKeyUp=function(t,e){if(o.isEscapeKey(e)||o.isEnterKey(e))return this.stopDrawingAndRemove(t,e)},e.exports=t},{"../constants":23,"../lib/common_selectors":30}],55:[function(t,e,n){"use strict";var o=t("../lib/common_selectors"),i=t("../lib/double_click_zoom"),r=t("../constants"),s=t("../lib/is_event_at_coordinates"),a=t("../lib/create_vertex"),t={onSetup:function(){var t=this.newFeature({type:r.geojsonTypes.FEATURE,properties:{},geometry:{type:r.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),i.disable(this),this.updateUIClasses({mouse:r.cursors.ADD}),this.activateUIButton(r.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(0<t.currentVertexPosition&&s(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:r.cursors.ADD}),t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e.lngLat.lng,e.lngLat.lat),o.isVertex(e)&&this.updateUIClasses({mouse:r.cursors.POINTER})}};t.onTap=t.onClick=function(t,e){return o.isVertex(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},t.onKeyUp=function(t,e){o.isEscapeKey(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT)):o.isEnterKey(e)&&this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},t.onStop=function(t){this.updateUIClasses({mouse:r.cursors.NONE}),i.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate("0.".concat(t.currentVertexPosition)),t.polygon.isValid()?this.map.fire(r.events.CREATE,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT,{},{silent:!0})))},t.toDisplayFeatures=function(t,e,n){var o=e.properties.id===t.polygon.id;if(e.properties.active=o?r.activeStates.ACTIVE:r.activeStates.INACTIVE,!o)return n(e);if(0!==e.geometry.coordinates.length){var i,o=e.geometry.coordinates[0].length;if(!(o<3)){if(e.properties.meta=r.meta.FEATURE,n(a(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),3<o&&(i=e.geometry.coordinates[0].length-3,n(a(t.polygon.id,e.geometry.coordinates[0][i],"0.".concat(i),!1))),o<=4){t=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:r.geojsonTypes.FEATURE,properties:e.properties,geometry:{coordinates:t,type:r.geojsonTypes.LINE_STRING}}),3===o)return}return n(e)}}},t.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT)},e.exports=t},{"../constants":23,"../lib/common_selectors":30,"../lib/create_vertex":34,"../lib/double_click_zoom":35,"../lib/is_event_at_coordinates":40}],56:[function(t,e,n){"use strict";e.exports={simple_select:t("./simple_select"),direct_select:t("./direct_select"),draw_point:t("./draw_point"),draw_polygon:t("./draw_polygon"),draw_line_string:t("./draw_line_string")}},{"./direct_select":52,"./draw_line_string":53,"./draw_point":54,"./draw_polygon":55,"./simple_select":60}],57:[function(t,e,n){"use strict";e=e.exports=t("./mode_interface_accessors");e.prototype.onSetup=function(){},e.prototype.onDrag=function(){},e.prototype.onClick=function(){},e.prototype.onMouseMove=function(){},e.prototype.onMouseDown=function(){},e.prototype.onMouseUp=function(){},e.prototype.onMouseOut=function(){},e.prototype.onKeyUp=function(){},e.prototype.onKeyDown=function(){},e.prototype.onTouchStart=function(){},e.prototype.onTouchMove=function(){},e.prototype.onTouchEnd=function(){},e.prototype.onTap=function(){},e.prototype.onStop=function(){},e.prototype.onTrash=function(){},e.prototype.onCombineFeature=function(){},e.prototype.onUncombineFeature=function(){},e.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")}},{"./mode_interface_accessors":58}],58:[function(t,e,n){"use strict";var o=t("../constants"),i=t("../lib/features_at"),r=t("../feature_types/point"),s=t("../feature_types/line_string"),a=t("../feature_types/polygon"),c=t("../feature_types/multi_feature"),t=e.exports=function(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t};t.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},t.prototype.setSelectedCoordinates=function(t){var n=this;this._ctx.store.setSelectedCoordinates(t),t.reduce(function(t,e){return void 0===t[e.feature_id]&&(t[e.feature_id]=!0,n._ctx.store.get(e.feature_id).changed()),t},{})},t.prototype.getSelected=function(){return this._ctx.store.getSelected()},t.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},t.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},t.prototype.getFeature=function(t){return this._ctx.store.get(t)},t.prototype.select=function(t){return this._ctx.store.select(t)},t.prototype.deselect=function(t){return this._ctx.store.deselect(t)},t.prototype.deleteFeature=function(t){return this._ctx.store.delete(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},t.prototype.addFeature=function(t){return this._ctx.store.add(t)},t.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},t.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},t.prototype.setActionableState=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(t)},t.prototype.changeMode=function(t){return this._ctx.events.changeMode(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})},t.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},t.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},t.prototype.featuresAt=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"click";if("click"!==n&&"touch"!==n)throw new Error("invalid buffer type");return i[n](t,e,this._ctx)},t.prototype.newFeature=function(t){var e=t.geometry.type;return new(e===o.geojsonTypes.POINT?r:e===o.geojsonTypes.LINE_STRING?s:e===o.geojsonTypes.POLYGON?a:c)(this._ctx,t)},t.prototype.isInstanceOf=function(t,e){if(t===o.geojsonTypes.POINT)return e instanceof r;if(t===o.geojsonTypes.LINE_STRING)return e instanceof s;if(t===o.geojsonTypes.POLYGON)return e instanceof a;if("MultiFeature"===t)return e instanceof c;throw new Error("Unknown feature class: ".concat(t))},t.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)}},{"../constants":23,"../feature_types/line_string":26,"../feature_types/multi_feature":27,"../feature_types/point":28,"../feature_types/polygon":29,"../lib/features_at":37}],59:[function(t,e,n){"use strict";var o=t("./mode_interface"),c={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},u=Object.keys(c);e.exports=function(a){var n=Object.keys(a);return function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r={},s=n.reduce(function(t,e){return t[e]=a[e],t},new o(t));return{start:function(){var i=this;r=s.onSetup(e),u.forEach(function(t){var e,n=c[t],o=function(){return!1};a[n]&&(o=function(){return!0}),i.on(t,o,(e=n,function(t){s[e](r,t)}))})},stop:function(){s.onStop(r)},trash:function(){s.onTrash(r)},combineFeatures:function(){s.onCombineFeatures(r)},uncombineFeatures:function(){s.onUncombineFeatures(r)},render:function(t,e){s.toDisplayFeatures(r,t,e)}}}}},{"./mode_interface":57}],60:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),s=t("../lib/mouse_event_point"),o=t("../lib/create_supplementary_points"),i=t("../lib/string_set"),a=t("../lib/double_click_zoom"),c=t("../lib/move_features"),u=t("../constants"),t={onSetup:function(t){var e=this,t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(function(t){return void 0!==e.getFeature(t)})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t},fireUpdate:function(){this.map.fire(u.events.UPDATE,{action:u.updateActions.MOVE,features:this.getSelected().map(function(t){return t.toGeoJSON()})})},fireActionable:function(){var e,n=this,t=this.getSelected(),o=t.filter(function(t){return n.isInstanceOf("MultiFeature",t)}),i=!1,o=(1<t.length&&(i=!0,e=t[0].type.replace("Multi",""),t.forEach(function(t){t.type.replace("Multi","")!==e&&(i=!1)})),0<o.length),t=0<t.length;this.setActionableState({combineFeatures:i,uncombineFeatures:o,trash:t})},getUniqueIds:function(t){return t.length?t.map(function(t){return t.properties.id}).filter(function(t){return void 0!==t}).reduce(function(t,e){return t.add(e),t},new i).values():[]},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){a.enable(this)},onMouseMove:function(t){return this.stopExtendedInteractions(t)},onMouseOut:function(t){if(t.dragMoving)return this.fireUpdate()}};t.onTap=t.onClick=function(t,e){return r.noTarget(e)?this.clickAnywhere(t,e):r.isOfMetaType(u.meta.VERTEX)(e)?this.clickOnVertex(t,e):r.isFeature(e)?this.clickOnFeature(t,e):void 0},t.clickAnywhere=function(t){var e=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach(function(t){return e.doRender(t)})),a.enable(this),this.stopExtendedInteractions(t)},t.clickOnVertex=function(t,e){this.changeMode(u.modes.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:u.cursors.MOVE})},t.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},t.clickOnFeature=function(t,e){var n=this,t=(a.disable(this),this.stopExtendedInteractions(t),r.isShiftDown(e)),o=this.getSelectedIds(),e=e.featureTarget.properties.id,i=this.isSelected(e);if(!t&&i&&this.getFeature(e).type!==u.geojsonTypes.POINT)return this.changeMode(u.modes.DIRECT_SELECT,{featureId:e});i&&t?(this.deselect(e),this.updateUIClasses({mouse:u.cursors.POINTER}),1===o.length&&a.enable(this)):!i&&t?(this.select(e),this.updateUIClasses({mouse:u.cursors.MOVE})):i||t||(o.forEach(function(t){return n.doRender(t)}),this.setSelected(e),this.updateUIClasses({mouse:u.cursors.MOVE})),this.doRender(e)},t.onMouseDown=function(t,e){return r.isActiveFeature(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&r.isShiftMousedown(e)?this.startBoxSelect(t,e):void 0},t.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=s(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},t.onTouchStart=function(t,e){if(r.isActiveFeature(e))return this.startOnActiveFeature(t,e)},t.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},t.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:u.cursors.ADD}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(u.classes.BOX_SELECT),this.map.getContainer().appendChild(t.boxSelectElement));var e=s(e.originalEvent,this.map.getContainer()),n=Math.min(t.boxSelectStartLocation.x,e.x),o=Math.max(t.boxSelectStartLocation.x,e.x),i=Math.min(t.boxSelectStartLocation.y,e.y),e=Math.max(t.boxSelectStartLocation.y,e.y),r="translate(".concat(n,"px, ").concat(i,"px)");t.boxSelectElement.style.transform=r,t.boxSelectElement.style.WebkitTransform=r,t.boxSelectElement.style.width="".concat(o-n,"px"),t.boxSelectElement.style.height="".concat(e-i,"px")},t.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};c(this.getSelected(),n),t.dragMoveLocation=e.lngLat},t.onMouseUp=function(t,e){var n=this;t.dragMoving?this.fireUpdate():t.boxSelecting&&(e=[t.boxSelectStartLocation,s(e.originalEvent,this.map.getContainer())],e=this.featuresAt(null,e,"click"),(e=this.getUniqueIds(e).filter(function(t){return!n.isSelected(t)})).length)&&(this.select(e),e.forEach(function(t){return n.doRender(t)}),this.updateUIClasses({mouse:u.cursors.MOVE})),this.stopExtendedInteractions(t)},t.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?u.activeStates.ACTIVE:u.activeStates.INACTIVE,n(e),this.fireActionable(),e.properties.active===u.activeStates.ACTIVE&&e.geometry.type!==u.geojsonTypes.POINT&&o(e).forEach(n)},t.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},t.onCombineFeatures=function(){var t=this.getSelected();if(!(0===t.length||t.length<2)){for(var e,n=[],o=[],i=t[0].type.replace("Multi",""),r=0;r<t.length;r++){var s=t[r];if(s.type.replace("Multi","")!==i)return;s.type.includes("Multi")?s.getCoordinates().forEach(function(t){n.push(t)}):n.push(s.getCoordinates()),o.push(s.toGeoJSON())}1<o.length&&(e=this.newFeature({type:u.geojsonTypes.FEATURE,properties:o[0].properties,geometry:{type:"Multi".concat(i),coordinates:n}}),this.addFeature(e),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([e.id]),this.map.fire(u.events.COMBINE_FEATURES,{createdFeatures:[e.toGeoJSON()],deletedFeatures:o})),this.fireActionable()}},t.onUncombineFeatures=function(){var n=this,o=this.getSelected();if(0!==o.length){for(var i=[],r=[],t=0;t<o.length;t++)!function(t){var e=o[t];n.isInstanceOf("MultiFeature",e)&&(e.getFeatures().forEach(function(t){n.addFeature(t),t.properties=e.properties,i.push(t.toGeoJSON()),n.select([t.id])}),n.deleteFeature(e.id,{silent:!0}),r.push(e.toGeoJSON()))}(t);1<i.length&&this.map.fire(u.events.UNCOMBINE_FEATURES,{createdFeatures:i,deletedFeatures:r}),this.fireActionable()}},e.exports=t},{"../constants":23,"../lib/common_selectors":30,"../lib/create_supplementary_points":33,"../lib/double_click_zoom":35,"../lib/mouse_event_point":44,"../lib/move_features":45,"../lib/string_set":47}],61:[function(t,e,n){"use strict";var o=t("xtend"),i=t("./constants"),r={defaultMode:i.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:t("./lib/theme"),modes:t("./modes"),controls:{},userProperties:!1},s={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},a={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function c(t,e){return t.map(function(t){return t.source?t:o(t,{id:"".concat(t.id,".").concat(e),source:"hot"===e?i.sources.HOT:i.sources.COLD})})}e.exports=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=o(t);return t.controls||(e.controls={}),!1===t.displayControlsDefault?e.controls=o(a,t.controls):e.controls=o(s,t.controls),(e=o(r,e)).styles=c(e.styles,"cold").concat(c(e.styles,"hot")),e}},{"./constants":23,"./lib/theme":49,"./modes":56,xtend:21}],62:[function(t,e,n){"use strict";var a=t("./constants");e.exports=function(){var n=this;if(!n.ctx.map||void 0===n.ctx.map.getSource(a.sources.HOT))return s();var o=n.ctx.events.currentModeName(),e=(n.ctx.ui.queueMapClasses({mode:o}),[]),t=[],t=n.isDirty?n.getAllIds():(e=n.getChangedIds().filter(function(t){return void 0!==n.get(t)}),n.sources.hot.filter(function(t){return t.properties.id&&-1===e.indexOf(t.properties.id)&&void 0!==n.get(t.properties.id)}).map(function(t){return t.properties.id})),i=(n.sources.hot=[],n.sources.cold.length),i=(n.sources.cold=n.isDirty?[]:n.sources.cold.filter(function(t){t=t.properties.id||t.properties.parent;return-1===e.indexOf(t)}),i!==n.sources.cold.length||0<t.length);function r(t,e){t=n.get(t).internal(o);n.ctx.events.currentModeRender(t,function(t){n.sources[e].push(t)})}function s(){n.isDirty=!1,n.clearChangedIds()}e.forEach(function(t){return r(t,"hot")}),t.forEach(function(t){return r(t,"cold")}),i&&n.ctx.map.getSource(a.sources.COLD).setData({type:a.geojsonTypes.FEATURE_COLLECTION,features:n.sources.cold}),n.ctx.map.getSource(a.sources.HOT).setData({type:a.geojsonTypes.FEATURE_COLLECTION,features:n.sources.hot}),n._emitSelectionChange&&(n.ctx.map.fire(a.events.SELECTION_CHANGE,{features:n.getSelected().map(function(t){return t.toGeoJSON()}),points:n.getSelectedCoordinates().map(function(t){return{type:a.geojsonTypes.FEATURE,properties:{},geometry:{type:a.geojsonTypes.POINT,coordinates:t.coordinates}}})}),n._emitSelectionChange=!1),n._deletedFeaturesToEmit.length&&(t=n._deletedFeaturesToEmit.map(function(t){return t.toGeoJSON()}),n._deletedFeaturesToEmit=[],n.ctx.map.fire(a.events.DELETE,{features:t})),s(),n.ctx.map.fire(a.events.RENDER,{})}},{"./constants":23}],63:[function(t,e,n){"use strict";var s=t("./events"),a=t("./store"),c=t("./ui"),o=t("./constants"),u=t("xtend");e.exports=function(e){var t=null,n=null,r={onRemove:function(){return e.map.off("load",r.connect),clearInterval(n),r.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",r.connect),clearInterval(n),r.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){var i=o.fire;return o.fire=function(t,e){var n=arguments;return 1===i.length&&1!==arguments.length&&(n=[u({},{type:t},e)]),i.apply(o,n)},e.map=o,e.events=s(e),e.ui=c(e),e.container=o.getContainer(),e.store=new a(e),t=e.ui.addButtons(),e.options.boxSelect&&(o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?r.connect():(o.on("load",r.connect),n=setInterval(function(){o.loaded()&&r.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(o.sources.COLD,{data:{type:o.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(o.sources.HOT,{data:{type:o.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(function(t){e.map.addLayer(t)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(function(t){e.map.getLayer(t.id)&&e.map.removeLayer(t.id)}),e.map.getSource(o.sources.COLD)&&e.map.removeSource(o.sources.COLD),e.map.getSource(o.sources.HOT)&&e.map.removeSource(o.sources.HOT)}};return e.setup=r}},{"./constants":23,"./events":24,"./store":64,"./ui":65,xtend:21}],64:[function(t,e,n){"use strict";var o=t("./lib/throttle"),i=t("./lib/to_dense_array"),r=t("./lib/string_set"),s=t("./render"),a=t("./constants").interactions,t=e.exports=function(t){this._features={},this._featureIds=new r,this._selectedFeatureIds=new r,this._selectedCoordinates=[],this._changedFeatureIds=new r,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=o(s,16,this),this.isDirty=!1};function c(t){var e=this,n=this._selectedCoordinates.filter(function(t){return e._selectedFeatureIds.has(t.feature_id)});this._selectedCoordinates.length===n.length||t.silent||(this._emitSelectionChange=!0),this._selectedCoordinates=n}t.prototype.createRenderBatch=function(){var t=this,e=this.render,n=0;return this.render=function(){n++},function(){t.render=e,0<n&&t.render()}},t.prototype.setDirty=function(){return this.isDirty=!0,this},t.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this},t.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},t.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},t.prototype.getAllIds=function(){return this._featureIds.values()},t.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this},t.prototype.delete=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return i(t).forEach(function(t){e._featureIds.has(t)&&(e._featureIds.delete(t),e._selectedFeatureIds.delete(t),n.silent||-1===e._deletedFeaturesToEmit.indexOf(e._features[t])&&e._deletedFeaturesToEmit.push(e._features[t]),delete e._features[t],e.isDirty=!0)}),c.call(this,n),this},t.prototype.get=function(t){return this._features[t]},t.prototype.getAll=function(){var e=this;return Object.keys(this._features).map(function(t){return e._features[t]})},t.prototype.select=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return i(t).forEach(function(t){e._selectedFeatureIds.has(t)||(e._selectedFeatureIds.add(t),e._changedFeatureIds.add(t),n.silent)||(e._emitSelectionChange=!0)}),this},t.prototype.deselect=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return i(t).forEach(function(t){e._selectedFeatureIds.has(t)&&(e._selectedFeatureIds.delete(t),e._changedFeatureIds.add(t),n.silent||(e._emitSelectionChange=!0))}),c.call(this,n),this},t.prototype.clearSelected=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},t.prototype.setSelected=function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e=i(e),this.deselect(this._selectedFeatureIds.values().filter(function(t){return-1===e.indexOf(t)}),{silent:t.silent}),this.select(e.filter(function(t){return!n._selectedFeatureIds.has(t)}),{silent:t.silent}),this},t.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},t.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},t.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},t.prototype.getSelected=function(){var e=this;return this._selectedFeatureIds.values().map(function(t){return e.get(t)})},t.prototype.getSelectedCoordinates=function(){var e=this;return this._selectedCoordinates.map(function(t){return{coordinates:e.get(t.feature_id).getCoordinate(t.coord_path)}})},t.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},t.prototype.setFeatureProperty=function(t,e,n){this.get(t).setProperty(e,n),this.featureChanged(t)},t.prototype.storeMapConfig=function(){var e=this;a.forEach(function(t){e.ctx.map[t]&&(e._mapInitialConfig[t]=e.ctx.map[t].isEnabled())})},t.prototype.restoreMapConfig=function(){var e=this;Object.keys(this._mapInitialConfig).forEach(function(t){e._mapInitialConfig[t]?e.ctx.map[t].enable():e.ctx.map[t].disable()})},t.prototype.getInitialConfigValue=function(t){return void 0===this._mapInitialConfig[t]||this._mapInitialConfig[t]}},{"./constants":23,"./lib/string_set":47,"./lib/throttle":50,"./lib/to_dense_array":51,"./render":62}],65:[function(t,e,n){"use strict";var l=t("xtend"),p=t("./constants"),h=["mode","feature","mouse"];e.exports=function(o){var n={},i=null,r={mode:null,feature:null,mouse:null},s={mode:null,feature:null,mouse:null};function t(t){s=l(s,t)}function e(){var e,n;o.container&&(e=[],n=[],h.forEach(function(t){s[t]!==r[t]&&(e.push("".concat(t,"-").concat(r[t])),null!==s[t])&&n.push("".concat(t,"-").concat(s[t]))}),0<e.length&&o.container.classList.remove.apply(o.container.classList,e),0<n.length&&o.container.classList.add.apply(o.container.classList,n),r=l(r,s))}function a(e,t){var n=1<arguments.length&&void 0!==t?t:{},t=document.createElement("button");return t.className="".concat(p.classes.CONTROL_BUTTON," ").concat(n.className),t.setAttribute("title",n.title),n.container.appendChild(t),t.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),t.target!==i?(u(e),n.onActivate()):c()},!0),t}function c(){i&&(i.classList.remove(p.classes.ACTIVE_BUTTON),i=null)}function u(t){c();var e=n[t];e&&"trash"!==t&&(e.classList.add(p.classes.ACTIVE_BUTTON),i=e)}return{setActiveButton:u,queueMapClasses:t,updateMapClasses:e,clearMapClasses:function(){t({mode:null,feature:null,mouse:null}),e()},addButtons:function(){var t=o.options.controls,e=document.createElement("div");return e.className="".concat(p.classes.CONTROL_GROUP," ").concat(p.classes.CONTROL_BASE),t&&(t[p.types.LINE]&&(n[p.types.LINE]=a(p.types.LINE,{container:e,className:p.classes.CONTROL_BUTTON_LINE,title:"LineString tool ".concat(o.options.keybindings?"(l)":""),onActivate:function(){return o.events.changeMode(p.modes.DRAW_LINE_STRING)}})),t[p.types.POLYGON]&&(n[p.types.POLYGON]=a(p.types.POLYGON,{container:e,className:p.classes.CONTROL_BUTTON_POLYGON,title:"Polygon tool ".concat(o.options.keybindings?"(p)":""),onActivate:function(){return o.events.changeMode(p.modes.DRAW_POLYGON)}})),t[p.types.POINT]&&(n[p.types.POINT]=a(p.types.POINT,{container:e,className:p.classes.CONTROL_BUTTON_POINT,title:"Marker tool ".concat(o.options.keybindings?"(m)":""),onActivate:function(){return o.events.changeMode(p.modes.DRAW_POINT)}})),t.trash&&(n.trash=a("trash",{container:e,className:p.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){o.events.trash()}})),t.combine_features&&(n.combine_features=a("combineFeatures",{container:e,className:p.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){o.events.combineFeatures()}})),t.uncombine_features)&&(n.uncombine_features=a("uncombineFeatures",{container:e,className:p.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){o.events.uncombineFeatures()}})),e},removeButtons:function(){Object.keys(n).forEach(function(t){var e=n[t];e.parentNode&&e.parentNode.removeChild(e),delete n[t]})}}}},{"./constants":23,xtend:21}]},{},[1])(1)}.call(this,n("yLpj"))},K79h:function(t,e,n){"use strict";var o=n("Iv0b");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function i(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach(function(t){var e,n;e=o,n=i[t=t],(t=function(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}var a="sm-component-message",c=o.default.config;c({prefixCls:a}),o.default.config=function(t){t.prefixCls&&t.prefixCls!==a&&o.default.destroy(),c(i(i({},t),{},{prefixCls:t.prefixCls||a}))},e.a=o.default},Kwrx:function(t,e,n){"use strict";var o=n("oCYn"),i=n("YKMj"),r={name:"SmCollapseCard",mixins:[n("oTir").a],props:{iconPosition:{type:String,default:"top-left"},iconClass:{type:String},autoRotate:{type:Boolean,default:!1},headerName:{type:String},collapsed:{type:Boolean,default:!1},splitLine:{type:Boolean,default:!0}},data:function(){return{isShow:!0,transform:null}},computed:{getCardStyle:function(){return this.iconClass||this.headerName?this.collapseCardBackgroundStyle:{background:"transparent"}},iconStyle:function(){return{transform:this.transform}},position:function(){return this.iconPosition},rotateDeg:function(){return{"top-right":["rotate(-45deg)","rotate(135deg)"],"top-left":["rotate(-135deg)","rotate(45deg)"],"bottom-left":["rotate(135deg)","rotate(-45deg)"],"bottom-right":["rotate(45deg)","rotate(-135deg)"]}},hasHeaderRotateDeg:function(){return{"top-right":["rotate(-45deg)","rotate(135deg)"],"top-left":["rotate(-135deg)","rotate(45deg)"],"bottom-left":["rotate(-135deg)","rotate(45deg)"],"bottom-right":["rotate(-45deg)","rotate(135deg)"]}}},watch:{iconClass:function(t,e){t&&!e?(this.isShow=!this.collapsed,this.toggleTransition(this.collapsed?"leave":"enter")):t||(this.isShow=!0)},iconPosition:function(){this.resetIconTransform()}},created:function(){this.iconClass&&(this.isShow=!this.collapsed),this.resetIconTransform()},mounted:function(){this.toggleTransition(this.collapsed?"leave":"enter")},methods:{iconClicked:function(){this.isShow=!this.isShow,this.resetIconTransform(),this.$emit("content-show-state",this.isShow)},toggleTransition:function(e){var n=this;this.$nextTick(function(){var t=n.$el.querySelector(".sm-component-collapse-card__icon");t&&(t.style.position="leave"===e?"relative":"absolute")})},resetIconTransform:function(){var t=this.headerName?this.hasHeaderRotateDeg:this.rotateDeg;this.autoRotate&&(this.transform=t[this.position][this.isShow?1:0])}}},n=n("KHd+"),n=Object(n.a)(r,function(){var t,e=this,n=e.$createElement,n=e._self._c||n;return n("div",{staticClass:"sm-component-collapse-card",style:e.getTextColorStyle},[e.iconClass?n("div",{class:((t={})["sm-component-collapse-card__icon"]=!0,t["is-"+e.position]=!0,t["is-click-"+(e.isShow?"out":"in")]=!0,t["is-not-header"]=!e.headerName,t["icon-box-shadow"]=!e.isShow,t),style:[e.collapseCardHeaderBgStyle,e.headingTextColorStyle],on:{click:e.iconClicked}},[n("i",{class:((t={})[e.iconClass]=!0,t["is-auto-rotate"]=e.autoRotate,t),style:e.iconStyle})]):e._e(),e._v(" "),n("transition",{attrs:{name:"sm-component-zoom-in"},on:{"after-leave":function(t){return e.toggleTransition("leave")},enter:function(t){return e.toggleTransition("enter")}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],class:((t={})["sm-component-collapse-card__content"]=!0,t["is-not-header"]=!e.headerName,t["is-"+e.position]=!0,t["is-icon"]=e.iconClass,t),style:e.getCardStyle},[e.headerName?n("div",{class:((t={"sm-component-collapse-card__header":!0,"with-split-line":e.splitLine})["is-"+e.position]=!0,t),style:[e.collapseCardHeaderBgStyle,e.headingTextColorStyle]},[n("span",{staticClass:"sm-component-collapse-card__header-name"},[e._v(e._s(e.headerName))])]):e._e(),e._v(" "),n("div",{staticClass:"sm-component-collapse-card__body",style:e.getCardStyle},[e._t("default")],2)])])],1)},[],!1,null,null,null).exports;function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===l(t)?t:String(t)}(o.key),o)}}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u(n),e=(t=o?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r=function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(s=(r<3?i(s):3<r?i(e,n,s):i(e,n))||s);return 3<r&&s&&Object.defineProperty(e,n,s),s},o=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t);var n,o,i=c(r);function r(){var t=this,e=r;if(t instanceof e)return i.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,n&&s(e.prototype,n),o&&s(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}(o.default);r([Object(i.Prop)({default:"top-left",validator:function(t){return-1!==["top-left","top-right","bottom-left","bottom-right"].indexOf(t)}})],o.prototype,"position",void 0),r([Object(i.Prop)()],o.prototype,"headerName",void 0),r([Object(i.Prop)()],o.prototype,"iconClass",void 0),r([Object(i.Prop)({default:!1})],o.prototype,"autoRotate",void 0),r([Object(i.Prop)({default:!0})],o.prototype,"collapsed",void 0),r([Object(i.Prop)({default:!0})],o.prototype,"splitLine",void 0),o=r([Object(i.Component)({components:{SmCollapseCard:n}})],o),e.a=o},fNy0:function(F,t,e){"use strict";e.r(t);var n=e("oTir"),o=e("rn6b"),i=e("CKgU"),r=e("Kwrx"),s=e("r4D+"),a=e("nW8p"),c=e("hdLw"),u=e.n(c),l=e("RwN2"),p=e("0wsv");var h=function(t,e,n){void 0===n&&(n={});var t=Object(l.a)(t),e=Object(l.a)(e),o=Object(p.c)(e[1]-t[1]),i=Object(p.c)(e[0]-t[0]),t=Object(p.c)(t[1]),e=Object(p.c)(e[1]),o=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(t)*Math.cos(e);return Object(p.k)(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),n.units)},d=e("Nwvx");function f(t,n){return void 0===n&&(n={}),Object(d.e)(t,function(t,e){e=e.geometry.coordinates;return t+h(e[0],e[1],n)},0)}var m=6378137;function y(t){return Object(d.d)(t,function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return g(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=g(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)},0)}function g(t){var e=0;if(t&&0<t.length){e+=Math.abs(v(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(v(t[n]))}return e}function v(t){var e,n,o,i,r,s,a=0,c=t.length;if(2<c){for(s=0;s<c;s++)r=s===c-2?(o=c-2,i=c-1,0):s===c-1?(o=c-1,i=0,1):(i=(o=s)+1,s+2),e=t[o],n=t[i],a+=(_(t[r][0])-_(e[0]))*Math.sin(_(n[1]));a=a*m*m/2}return a}function _(t){return t*Math.PI/180}var b=e("7mrb"),w=e("qAG6"),E=e("kzZv"),c=e("oCYn"),S=e("INC6"),T=e.n(S),D=e("FuRH"),S=e("lx9i"),O=e.n(S),S=e("XaGS"),R=e.n(S);function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function M(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach(function(t){var e,n;e=o,n=i[t=t],(t=function(t){t=function(t,e){if("object"!==x(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===x(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}var S="#f75564",L={"line-static":{"line-color":S,"line-width":3},"line-hover":{"line-color":S,"line-width":33,"line-opacity":.2},"line-drawing":{"line-color":S,"line-dasharray":[.4,2],"line-width":3},"fill-static":{"fill-color":S,"fill-outline-color":S,"fill-opacity":.4},"fill-drawing":{"fill-color":S,"fill-outline-color":S,"fill-opacity":.6},"vertex-static":{"circle-radius":4,"circle-color":S},"vertex-halo-static":{"circle-radius":6,"circle-color":"#fff"},"circle-static":{"circle-radius":6,"circle-color":S},"circle-drawing":{"circle-radius":4,"circle-color":"#fff"},"circle-halo-drawing":{"circle-radius":6,"circle-color":S}},P=new c.default({mapList:{},drawList:{},drawStates:{},_createDraw:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:L,e={displayControlsDefault:!1,touchEnabled:!1,boxSelect:!1,modes:M(M({},T.a.modes),{},{simple_select:O()(T.a.modes.simple_select,{dragMove:function(){},clickOnVertex:function(){},clickOnFeature:function(t,e){var n=this,t=(this.stopExtendedInteractions(t),e.originalEvent&&e.originalEvent.shiftKey),o=this.getSelectedIds(),e=e.featureTarget.properties.id;this.isSelected(e)||t||(o.forEach(function(t){return n.doRender(t)}),this.setSelected(e)),this.doRender(e)}}),direct_select:O()(T.a.modes.direct_select,{dragFeature:function(){}})}),styles:[{id:"draw-line-static",type:"line",filter:["any",["==","active","false"],["all",["==","active","true"],["==","mode","simple_select"]]],layout:{"line-cap":"round","line-join":"round"},paint:M(M({},L["line-static"]),e["line-static"])},{id:"draw-line-hover",type:"line",filter:["all",["==","$type","LineString"],["==","id",""]],layout:{"line-cap":"round","line-join":"round"},paint:M(M({},L["line-hover"]),e["line-hover"])},{id:"draw-line-drawing",type:"line",filter:["all",["==","active","true"],["!=","mode","simple_select"]],layout:{"line-cap":"round","line-join":"round"},paint:M(M({},L["line-drawing"]),e["line-drawing"])},{id:"draw-line-dashed",type:"line",filter:["all",["==","id",""]],layout:{"line-cap":"round","line-join":"round"},paint:M(M({},L["line-drawing"]),e["line-drawing"])},{id:"draw-polygon-active",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","true"],["!=","mode","simple_select"]],paint:M(M({},L["fill-drawing"]),e["fill-drawing"])},{id:"draw-polygon-static",type:"fill",filter:["all",["==","$type","Polygon"],["any",["==","active","false"],["all",["==","active","true"],["==","mode","simple_select"]]]],paint:M(M({},L["fill-static"]),e["fill-static"])},{id:"draw-vertex-halo-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"]],paint:M(M({},L["vertex-halo-static"]),e["vertex-halo-static"])},{id:"draw-vertex-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"]],paint:M(M({},L["vertex-static"]),e["vertex-static"])},{id:"draw-point-static",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","false"]],paint:M(M({},L["circle-static"]),e["circle-static"])},{id:"draw-point-halo-static-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","true"]],paint:M(M({},L["circle-halo-drawing"]),e["circle-halo-drawing"])},{id:"draw-point-static-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","true"]],paint:M(M({},L["circle-drawing"]),e["circle-drawing"])}]},e=new T.a(e);return this.drawList[t]=e},getDraw:function(t){var e=t.mapTarget,n=t.create,n=void 0===n||n,t=t.styles,t=void 0===t?L:t,o=this.drawList[e],i=D.a.$options.getMap(e),r=this.mapList[e],r=R()(i,r);return i&&!r&&n&&((o=this._createDraw(e,t)).onAdd(i),this.mapList[e]=i),o},getDrawingState:function(t,e){return this.drawStates[t]&&this.drawStates[t][e]},setDrawingState:function(t,e,n){if(this.drawStates[t]=this.drawStates[t]||{},n)for(var o in this.drawStates[t])this.drawStates[t][o]=!1;this.drawStates[t][e]=n},deleteDrawingState:function(t,e){var n=this.drawStates[t];n&&(e in n&&delete n[e],Object.keys(this.drawStates[t]).length||this.deleteDrawOfMap(t))},deleteDrawOfMap:function(t){var e=this.getDraw({mapTarget:t,create:!1}),n=this.mapList[t];e&&n&&(e.onRemove(n),delete this.drawList[t],delete this.mapList[t],delete this.drawStates[t])}});function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==N(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===N(t)?t:String(t)}(o.key),o)}}function I(t,e){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function U(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=A(n),e=(t=o?(t=A(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t);var n,o=U(i);function i(t){var e;if(this instanceof i)return(e=o.call(this)).lenTipNodesList={},e.areaTipNodesList={},e.cacheLengthUnitList={},e.cachePolygonUnit={},e.componentName=t.componentName,e.continueDraw=t.continueDraw,e;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"setMap",value:function(t){var e=t.map,t=t.mapTarget;this.map=e,this.mapTarget=t,this._addDrawControl()}},{key:"_addDrawControl",value:function(){this.draw=P.$options.getDraw({mapTarget:this.mapTarget}),P.$options.setDrawingState(this.mapTarget,this.componentName,!1),this._finishDrawBind=this._finishDraw.bind(this),this._changeModeBind=this._changeMode.bind(this),this.map.on("draw.create",this._finishDrawBind),this.map.on("draw.modechange",this._changeModeBind)}},{key:"_finishDraw",value:function(t){if(this._isDrawing()){switch(this._resetEvent(),this.activeMode){case"draw_line_string":var e=f(t.features[0],"kilometers");this.result=Object(p.b)(e,"kilometers",this.activeUnit),this._updateLenPopupNodes(t.features[0].id),this._removeHoverPopup();break;case"draw_polygon":e=y(t.features[0]);this.result=Object(p.a)(e,"meters",this.activeUnit),this._updateAreaPopupNodes(this.result,t.features[0])}this.ids=this.ids||[],this.ids.push((t.features[0]||{}).id),this.fire("measure-finished",{result:this._getFormatResult(this.result)})}}},{key:"_changeMode",value:function(){this._isDrawing()&&this.continueDraw&&this.isEditing&&(this.draw.changeMode(this.mode),this.continueDrawBind=this._continueDraw.bind(this),this.map.on("mousedown",this.continueDrawBind),this.map.on("mousedown",this.measureNodeDistanceBind),this.fire("measure-finished",{result:this._getFormatResult(this.result)}))}},{key:"openDraw",value:function(t,e,n){this.setPopupStyle=n,P.$options.setDrawingState(this.mapTarget,this.componentName,!0),this._resetDraw(),this._resetEvent(),this.isEditing=!0,this.mode=t,this.activeMode=t,this.activeUnit=e,this.draw.changeMode(t),this.measureNodeDistanceBind=this._measureNodeDistance.bind(this),this.map.on("mousedown",this.measureNodeDistanceBind)}},{key:"updateUnit",value:function(t){if(Object.values(this.lenTipNodesList).length){for(var e in this.lenTipNodesList){var n=this.lenTipNodesList[e];if(n&&n.length&&(this.continueDraw&&"id"!==e||"id"===e))for(var o=1;o<n.length;o++){var i,r=Object(p.b)(this.cacheLengthUnitList[e][o-1].value,this.cacheLengthUnitList[e][o-1].unit,t),r=this._getFormatResult(r);this.cacheLengthUnitList[e][o-1].value=r,this.cacheLengthUnitList[e][o-1].unit=t,"draw_line_string"===this.activeMode&&(i=Object(E.a)().t("unit.".concat(t)),n[o])&&n[o].setText("".concat(r," ").concat(i))}}this.result&&(this.result=Object(p.b)(this.result,this.activeUnit,t))}else{var s,a;this.cachePolygonUnit.value&&this.cachePolygonUnit.unit&&(s=Object(p.a)(this.cachePolygonUnit.value,this.cachePolygonUnit.unit,t),a=Object(E.a)().t("unit.square".concat(t)),this.tipHoverDiv&&this.tipHoverDiv.setText("".concat(s," ").concat(a)),this.result)&&(this.result=Object(p.a)(this.result,this.activeUnit,t))}this.result&&this.fire("update-unit",{result:this._getFormatResult(this.result),mode:this.mode}),this.activeUnit=t}},{key:"_resetDraw",value:function(t){this.draw&&this.continueDraw&&(this.ids&&this.draw.delete(this.ids),this.ids=null,this._removePopups(),this._removeHoverPopup()),this.isOpenMoveEvent=!0,this.cacheLengthUnitList={},this.measureNodes=[],this.result=0,t||(this.activeMode=null,this.mode=null),this.fire("measure-start",{result:this._getFormatResult(this.result)})}},{key:"_continueDraw",value:function(){this._isDrawing()&&(this._resetDraw(!0),this.map.off("mousemove",this.popupFollowMouseBind),this.map.off("mousedown",this.continueDrawBind))}},{key:"_measureNodeDistance",value:function(t){var e;this._isDrawing()&&(e=[(e=t.lngLat).lng,e.lat],this.isOpenMoveEvent&&(this.popupFollowMouseBind=this._popupFollowMouse.bind(this),this.map.on("mousemove",this.popupFollowMouseBind),this.isOpenMoveEvent=!1),this.measureNodes.push(e),"draw_line_string"===this.activeMode)&&this._renderPopupTip(t)}},{key:"_popupFollowMouse",value:function(t){if(this._isDrawing()){var e,t=t.lngLat,t=[t.lng,t.lat],n=this.tipHoverDiv,t=((n=n||new u.a.Popup({closeButton:!1,closeOnClick:!1,className:"sm-component-measure__popup sm-mapboxgl-tabel-popup"})).setLngLat(t),[].concat(this.measureNodes,[t])),o={type:"Feature",geometry:{type:"".concat("draw_line_string"===this.activeMode?"LineString":"Polygon"),coordinates:"draw_line_string"===this.activeMode?t:[t]}};switch(this.activeMode){case"draw_line_string":var i=f(o,"kilometers");this.result=Object(p.b)(i,"kilometers",this.activeUnit);break;case"draw_polygon":i=y(o);this.result=Object(p.a)(i,"meters",this.activeUnit)}"draw_line_string"===this.activeMode?e=Object(E.a)().t("unit.".concat(this.activeUnit)):"draw_polygon"===this.activeMode&&(e=Object(E.a)().t("unit.square".concat(this.activeUnit))),n.setText("".concat(this._getFormatResult(this.result)," ").concat(e)),n.addTo(this.map),this.setPopupStyle&&this.setPopupStyle(),this.cachePolygonUnit.value=this.result,this.cachePolygonUnit.unit=this.activeUnit,this.tipHoverDiv=n}}},{key:"_renderPopupTip",value:function(t){var e,n,t=t.lngLat,o=t.lng,t=t.lat,i=new u.a.Popup({closeButton:!1,closeOnClick:!1,className:"sm-component-measure__popup sm-mapboxgl-tabel-popup"});1<this.measureNodes.length?(e=f({type:"Feature",geometry:{type:"LineString",coordinates:this.measureNodes}},"kilometers"),e=Object(p.b)(e,"kilometers",this.activeUnit),"draw_line_string"===this.activeMode?n=Object(E.a)().t("unit.".concat(this.activeUnit)):"draw_polygon"===this.activeMode&&(n=Object(E.a)().t("unit.square".concat(this.activeUnit))),n="".concat(this._getFormatResult(e)," ").concat(n),this.cacheLengthUnitList.id=this.cacheLengthUnitList.id||[],this.cacheLengthUnitList.id.push({value:this._getFormatResult(e),unit:this.activeUnit}),i.setText(n)):(i.setText(Object(E.a)().t("measure.startingPoint")),this.cacheLengthUnitList.id=this.cacheLengthUnitList.id||[]),i.setLngLat([o,t]),i&&i.addTo(this.map),this.setPopupStyle&&setTimeout(this.setPopupStyle,0),this.lenTipNodesList.id=this.lenTipNodesList.id||[],this.lenTipNodesList.id.push(i)}},{key:"_getFormatResult",value:function(t){return Object(w.s)(t||this.result,4)}},{key:"_isDrawing",value:function(){return P.$options.getDrawingState(this.mapTarget,this.componentName)&&this.draw}},{key:"_updateLenPopupNodes",value:function(t){for(var e in this.cacheLengthUnitList[t]=this.cacheLengthUnitList.id||[],delete this.cacheLengthUnitList.id,this.lenTipNodesList[t]=this.lenTipNodesList.id||[],delete this.lenTipNodesList.id,this.lenTipNodesList){var n=this.lenTipNodesList[e];n&&!n.length&&(delete this.lenTipNodesList[e],delete this.cacheLengthUnitList[e])}}},{key:"_updateAreaPopupNodes",value:function(t,e){var n,o=Object(b.default)(e),i=Object(E.a)().t("unit.square".concat(this.activeUnit)),t=this._getFormatResult(t);this.continueDraw?this.tipHoverDiv&&this.tipHoverDiv.setLngLat(o.geometry.coordinates).setText("".concat(t," ").concat(i)):(this._removeHoverPopup(),(n=new u.a.Popup({closeButton:!1,closeOnClick:!1,className:"sm-component-measure__popup sm-mapboxgl-tabel-popup"})).setLngLat(o.geometry.coordinates).setText("".concat(t," ").concat(i)).addTo(this.map),this.areaTipNodesList[e.id]=n),this.setPopupStyle&&setTimeout(this.setPopupStyle,0)}},{key:"_resetEvent",value:function(){this.map.off("mousemove",this.popupFollowMouseBind),this.map.off("mousedown",this.measureNodeDistanceBind),this.map.off("mousedown",this.continueDrawBind)}},{key:"_clearEvent",value:function(){this._resetEvent(),this.map.off("draw.create",this._finishDrawBind),this.map.off("draw.modechange",this._changeModeBind)}},{key:"_removePopups",value:function(){for(var t in this.lenTipNodesList){t=this.lenTipNodesList[t];t&&t.length&&t.forEach(function(t){return t.remove()})}for(var e in this.areaTipNodesList){e=this.areaTipNodesList[e];e&&e.remove()}this.lenTipNodesList={},this.areaTipNodesList={}}},{key:"_removeHoverPopup",value:function(){this.tipHoverDiv&&this.tipHoverDiv.remove(),this.tipHoverDiv=null}},{key:"trash",value:function(){var n=this;this.draw.getSelectedIds().forEach(function(e){var t=n.ids.findIndex(function(t){return t===e});-1<t&&(n.ids.splice(t,1),n.draw.delete(e),t=n.lenTipNodesList[e]||n.areaTipNodesList[e],Array.isArray(t)?t.forEach(function(t){return t.remove()}):t.remove())})}},{key:"removeDraw",value:function(t){this.isEditing=!1,this.draw.changeMode("simple_select"),this.ids&&this.draw.delete(this.ids),this.ids=[],this._resetDraw(t),this._resetEvent(),this._removePopups(),this._removeHoverPopup()}},{key:"removed",value:function(){this.isEditing=!1,this.ids&&this.draw.delete(this.ids),this.ids=[],this.cacheLengthUnitList={},this.cachePolygonUnit={},this._clearEvent(),this._removePopups(),this._removeHoverPopup(),this.draw=null}},{key:"clearAllFeatures",value:function(){this.removeDraw()}}])&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(u.a.Evented),S=e("9csQ"),B=e.n(S),k=(e("G3Xi"),e("K79h")),c={name:"SmMeasure",components:{SmSelect:s.a,SmSelectOption:a.a},mixins:[i.a,o.a,n.a,r.a],props:{iconClass:{type:String,default:"sm-components-icon-measure"},headerName:{type:String,default:function(){return this.$t("measure.mapMeasure")}},showUnitSelect:{type:Boolean,default:!0},distanceDefaultUnit:{type:String,default:"kilometers"},areaDefaultUnit:{type:String,default:"kilometers"},continueDraw:{type:Boolean,default:!0}},data:function(){return{unitOptions:{draw_line_string:{kilometers:this.$t("unit.kilometers"),miles:this.$t("unit.miles"),meters:this.$t("unit.meters"),feet:this.$t("unit.feet"),yards:this.$t("unit.yards")},draw_polygon:{kilometers:this.$t("unit.squarekilometers"),miles:this.$t("unit.squaremiles"),meters:this.$t("unit.squaremeters"),feet:this.$t("unit.squarefeet"),yards:this.$t("unit.squareyards")}},modeGroups:[{mode:"draw_line_string",title:this.$t("measure.distance"),iconClass:"sm-components-icon-line"},{mode:"draw_polygon",title:this.$t("measure.area"),iconClass:"sm-components-icon-ploygon"},{mode:"delete",title:this.$t("measure.delete"),iconClass:"sm-components-icon-delete"}],activeMode:"",result:"",activeDistanceUnit:this.distanceDefaultUnit,activeAreaUnit:this.areaDefaultUnit,modeUnitMap:{draw_line_string:"activeDistanceUnit",draw_polygon:"activeAreaUnit"},layerId:""}},computed:{getUnitOptions:function(){return this.unitOptions[this.activeMode]||[]},getResult:function(){var t;return this.result&&this.measureFinished?(t="".concat(this.result," ").concat(this.getUnitLabel),this.resetActiveMode(),t):""},getUnitLabel:function(){return this.getUnitOptions[this[this.modeUnitMap[this.activeMode]]]},getAreaSelect:function(){return"draw_polygon"===this.activeMode&&this.showUnitSelect},getDistanceSelect:function(){return"draw_line_string"===this.activeMode&&this.showUnitSelect},popupStyle:function(){return{background:this.tablePopupBgStyle.background,color:this.getTextColorStyle.color}}},watch:{distanceDefaultUnit:function(t){this.activeDistanceUnit=t,this.updateUnit(t)},areaDefaultUnit:function(t){this.activeAreaUnit=t,this.updateUnit(t)},popupStyle:function(t){this.setPopupStyle(t)}},created:function(){this.componentName=B()(this.$options.name),this.viewModel=new $({continueDraw:this.continueDraw,componentName:this.componentName}),this.viewModel.on("measure-finished",this.measureFinishedFn),this.viewModel.on("measure-start",this.measureStartFn),this.viewModel.on("update-unit",this.updateUnitFn)},mounted:function(){P.$on("draw-reset",this.drawResetFn)},beforeDestroy:function(){this.viewModel.off("measure-finished",this.measureFinishedFn),this.viewModel.off("measure-start",this.measureStartFn),this.viewModel.off("update-unit",this.updateUnitFn),P.$off("draw-reset",this.drawResetFn)},removed:function(t,e){P.$options.deleteDrawingState(e,this.componentName),this.resetData(e)},methods:{measureFinishedFn:function(t){this.result=t.result,this.measureFinished=!0},measureStartFn:function(){this.result="",this.measureFinished=!1},updateUnitFn:function(t){this.result=t.result},drawResetFn:function(t){t.componentName!==this.componentName&&(this.activeMode=null,this.result="")},changeMeasureMode:function(e){var n=this;setTimeout(function(){var t;n.mapNotLoadedTip()||(n.map.loaded()?(t=n.modeUnitMap[e],t=n[t],"delete"===e?(n.viewModel.trash(),n.activeMode=null,n.result=""):n.activeMode===e&&n.continueDraw?(n.viewModel.removeDraw(n.continueDraw),n.activeMode=null):(n.viewModel.openDraw(e,t,n.setPopupStyle),n.activeMode=e,n.continueDraw&&P.$emit("draw-reset",{componentName:n.componentName}))):(k.a.destroy(),k.a.warning(n.$t("warning.mapNotLoaded"))))},0)},updateUnit:function(t){this.viewModel&&this.viewModel.updateUnit(t),this.setPopupStyle()},getPopupContainer:function(){return this.$el.querySelector(".sm-component-measure__panelContent")},resetActiveMode:function(){this.activeModeCache||(this.activeModeCache=this.activeMode),this.measureFinished&&!this.continueDraw&&(this.activeMode=null),!this.measureFinished&&this.continueDraw&&(this.activeMode=this.activeModeCache)},resetData:function(){this.activeMode=null,this.result="",this.continueDraw&&P.$emit("draw-reset",{componentName:this.componentName})},clear:function(){this.activeMode=null,this.result="",this.viewModel&&this.viewModel.clearAllFeatures()},setPopupStyle:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.popupStyle;this.$nextTick(function(){var t=document.querySelectorAll(".sm-component-measure__popup .mapboxgl-popup-content");t&&t.forEach(function(t){t.style.color=e.color,t.style.background=e.background}),Object(w.t)(e.background)})}}},S=e("KHd+"),s=Object(S.a)(c,function(){var o=this,t=o.$createElement,i=o._self._c||t;return i("sm-collapse-card",{directives:[{name:"show",rawName:"v-show",value:o.isShow,expression:"isShow"}],staticClass:"sm-component-measure",attrs:{"icon-class":o.iconClass,"icon-position":o.position,"header-name":o.headerName,"auto-rotate":o.autoRotate,collapsed:o.collapsed,background:o.background,textColor:o.textColor,"split-line":o.splitLine}},[i("div",{staticClass:"sm-component-measure__panel",style:o.headingTextColorStyle},[i("div",{staticClass:"sm-component-measure__panelContent"},[o._l(o.modeGroups,function(e){return i("span",{directives:[{name:"show",rawName:"v-show",value:"delete"!==e.mode||!o.continueDraw&&"delete"===e.mode,expression:"group.mode !== 'delete' || (!continueDraw && group.mode === 'delete')"}],key:e.mode,class:{"sm-component-measure__modeIcon":!0,"is-active":o.activeMode===e.mode},style:o.subComponentSpanBgStyle,attrs:{title:e.title},on:{click:function(t){return o.changeMeasureMode(e.mode)}}},[i("i",{class:e.iconClass})])}),o._v(" "),i("sm-select",{directives:[{name:"show",rawName:"v-show",value:o.getDistanceSelect,expression:"getDistanceSelect"}],staticClass:"sm-component-measure__unit",style:o.getTextColorStyle,attrs:{placeholder:o.$t("measure.selectPlaceholder"),"get-popup-container":o.getPopupContainer},on:{change:o.updateUnit},model:{value:o.activeDistanceUnit,callback:function(t){o.activeDistanceUnit=t},expression:"activeDistanceUnit"}},o._l(o.getUnitOptions,function(t,e,n){return i("sm-select-option",{key:n,attrs:{title:t,value:e}},[o._v("\n          "+o._s(t)+"\n        ")])}),1),o._v(" "),i("sm-select",{directives:[{name:"show",rawName:"v-show",value:o.getAreaSelect,expression:"getAreaSelect"}],staticClass:"sm-component-measure__unit",style:o.getTextColorStyle,attrs:{placeholder:o.$t("measure.selectPlaceholder"),"get-popup-container":o.getPopupContainer},on:{change:o.updateUnit},model:{value:o.activeAreaUnit,callback:function(t){o.activeAreaUnit=t},expression:"activeAreaUnit"}},o._l(o.getUnitOptions,function(t,e,n){return i("sm-select-option",{key:n,attrs:{title:t,value:e}},[o._v("\n          "+o._s(t)+"\n        ")])}),1),o._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!o.showUnitSelect&&o.activeMode,expression:"!showUnitSelect && activeMode"}],staticClass:"sm-component-measure__unit sm-component-measure__default"},[o._v("\n        "+o._s(o.getUnitLabel)+"\n      ")])],2),o._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:o.getResult,expression:"getResult"}],staticClass:"sm-component-measure__calculateResult"},[i("div",{staticClass:"sm-component-measure__calcuTitle",style:o.headingTextColorStyle},[o._v(o._s(o.$t("measure.measureResult")))]),o._v(" "),i("div",{staticClass:"sm-component-measure__result",style:o.getTextColorStyle},[o._v(o._s(o.getResult))])])])])},[],!1,null,null,null);t.default=s.exports},lx9i:function(t,e){var n=9007199254740991,a="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",r=/^(?:0|[1-9]\d*)$/;var c=Object.prototype,l=c.hasOwnProperty,u=c.toString,p=c.propertyIsEnumerable,h=Math.max;function s(t,e){var n,o,i=v(t)||function(t){return function(t){return t&&"object"==typeof t}(t)&&_(t)}(n=t)&&l.call(n,"callee")&&(!p.call(n,"callee")||u.call(n)==a)?function(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}(t.length,String):[],r=i.length,s=!!r;for(o in t)!e&&!l.call(t,o)||s&&("length"==o||y(o,r))||i.push(o);return i}function d(t){if(!b(t)){var e=t,n=[];if(null!=e)for(var o in Object(e))n.push(o);return n}i="function"==typeof(i=(e=t)&&e.constructor)&&i.prototype||c;var i,r,s=e===i,a=[];for(r in t)("constructor"!=r||!s&&l.call(t,r))&&a.push(r);return a}function f(c,u){return u=h(void 0===u?c.length-1:u,0),function(){for(var t=arguments,e=-1,n=h(t.length-u,0),o=Array(n);++e<n;)o[e]=t[u+e];for(var e=-1,i=Array(u+1);++e<u;)i[e]=t[e];i[u]=o;var r=c,s=this,a=i;switch(a.length){case 0:return r.call(s);case 1:return r.call(s,a[0]);case 2:return r.call(s,a[0],a[1]);case 3:return r.call(s,a[0],a[1],a[2])}return r.apply(s,a)}}function m(t,e,n,o){n=n||{};for(var i,r,s=-1,a=e.length;++s<a;){var c=e[s],u=o?o(n[c],t[c],c,n,t):void 0;i=n,r=c,c=void 0===u?t[c]:u,u=void 0,u=i[r],l.call(i,r)&&g(u,c)&&(void 0!==c||r in i)||(i[r]=c)}}function y(t,e){return(e=null==e?n:e)&&("number"==typeof t||r.test(t))&&-1<t&&t%1==0&&t<e}function g(t,e){return t===e||t!=t&&e!=e}var v=Array.isArray;function _(t){return null!=t&&"number"==typeof(e=t.length)&&-1<e&&e%1==0&&e<=n&&!function(t){t=b(t)?u.call(t):"";return t==o||t==i}(t);var e}function b(t){var e=typeof t;return t&&("object"==e||"function"==e)}w=function(t,e){m(e,_(e=e)?s(e,!0):d(e),t)};var w,E=f(function(t,e){var n=-1,o=e.length,i=1<o?e[o-1]:void 0,r=2<o?e[2]:void 0,i=3<w.length&&"function"==typeof i?(o--,i):void 0;for(r&&function(t,e,n){if(b(n)){var o=typeof e;if("number"==o?_(n)&&y(e,n.length):"string"==o&&e in n)return g(n[e],t)}return}(e[0],e[1],r)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=e[n];s&&w(t,s,n,i)}return t});t.exports=E},nW8p:function(t,e,n){"use strict";var o=n("tmlv"),i=n("ghbr"),r=n("oTir"),s=n("tmJK"),i={disabled:i.a.bool,key:i.a.string,title:i.a.string,value:i.a.oneOfType([i.a.string,i.a.number])},o={name:"SmSelectOption",isSelectOption:!0,defaultComponent:o.default.Option,mixins:[r.a,s.a],inheritAttrs:!1,props:i},r=n("KHd+"),s=Object(r.a)(o,void 0,void 0,!1,null,null,null);e.a=s.exports},"r4D+":function(t,e,n){"use strict";var o=n("tmlv"),i=n("ghbr"),r=n("oTir"),s=n("tmJK"),i=Object.assign(Object.assign({},o.SelectProps),{showSearch:i.a.bool.def(!1),transitionName:i.a.string.def("slide-up"),choiceTransitionName:i.a.string.def("zoom"),size:i.a.oneOf(["small","large","default","middle"])}),o={name:"SmSelect",defaultComponent:o.default,mixins:[r.a,s.a],inheritAttrs:!1,model:{prop:"value",event:"change"},props:i,computed:{extralListeners:function(){var e=this;return{change:function(t){e.$emit("change",t)}}},extralProps:function(){return{size:"middle"===this.size?void 0:this.size}},componentClass:function(){return{"sm-component-select-md":"middle"===this.size}}}},r=n("KHd+"),s=Object(r.a)(o,void 0,void 0,!1,null,null,null);e.a=s.exports},rn6b:function(t,e,n){"use strict";var o=n("oCYn"),i=n("YKMj"),r=n("FuRH");function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===l(t)?t:String(t)}(o.key),o)}}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u(n),e=(t=o?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n=function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(s=(r<3?i(s):3<r?i(e,n,s):i(e,n))||s);return 3<r&&s&&Object.defineProperty(e,n,s),s},o=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t);var n,o=c(i);function i(){var t=this,e=i;if(t instanceof e)return(t=o.apply(this,arguments)).isShow=!0,t;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"positionChanged",value:function(){this.$el&&this.parentIsWebMapOrMap&&(this.remove(),this.addTo())}},{key:"created",value:function(){var t=this.$parent.$options.name;this.parentIsWebMapOrMap=t&&-1!==["smwebmap","smncpmap"].indexOf(this.$parent.$options.name.toLowerCase())}},{key:"mounted",value:function(){var t;this.filterDelayLoad=!(-1!==["smwebmap","smminimap","smncpmap"].indexOf(this.$options.name&&this.$options.name.toLowerCase())),this.$el&&this.parentIsWebMapOrMap&&(this.filterDelayLoad&&(this.isShow=!1,(t=this.$el).style)&&(t.style.display="none"),t=this.getControlMapName(),r.a.$options.getMap(t)&&this.mapLoaded(r.a.$options.getMap(t)),r.a.$on("load-map",this.controlLoadMapSucceed))}},{key:"beforeDestroy",value:function(){this.remove(),r.a.$off("load-map",this.controlLoadMapSucceed)}},{key:"initControl",value:function(){var t=this;return{onAdd:function(){return t.$el},onRemove:function(){return t.map}}}},{key:"addTo",value:function(){this.control=this.initControl(),this.map.addControl(this.control,this.position),this.$el&&this.$el.classList&&this.$el.classList.add("mapboxgl-ctrl")}},{key:"remove",value:function(){this.control&&this.map&&this.map.removeControl(this.control)}},{key:"getControlMapName",value:function(){var t=this.$parent,t=t&&t.$options.name&&"smwebmap"===t.$options.name.toLowerCase()&&t.target;return this.mapTarget||t||Object.keys(r.a.$options.getAllMaps())[0]}},{key:"controlLoadMapSucceed",value:function(t,e){e===this.getControlMapName()&&this.mapLoaded(t)}},{key:"mapLoaded",value:function(t){this.map=t,this.addTo(),this.filterDelayLoad&&(this.isShow=!0,t=this.$el)&&t.style&&(t.style.display="block")}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(o.default);n([Object(i.Prop)()],o.prototype,"mapTarget",void 0),n([Object(i.Prop)({default:"top-left",validator:function(t){return-1!==["top-left","top-right","bottom-left","bottom-right"].indexOf(t)}})],o.prototype,"position",void 0),n([Object(i.Watch)("position")],o.prototype,"positionChanged",null),o=n([i.Component],o),e.a=o}}]);