(window.webpackJsonp=window.webpackJsonp||[]).push([[57,18],{DjmO:function(t,e,r){"use strict";r.r(e);var n=r("EBC7"),i=r("M7pi"),s=r("70Dg"),a=r("XaGS"),c=r.n(a),a=r("zT9C"),o=r.n(a),a=r("wd/R"),p=r.n(a);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function m(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach(function(t){var e,r;e=n,r=a[t=t],(t=function(t){t=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))})}return n}a={mixins:[n.default],data:function(){return{currentProps:o()(this.renderProps),timeParams:{lastIndex:0},playState:!1,eventList:[]}},computed:{currentDataCache:function(){var t=this.defaultParams.props.controledDatas;return this.$store.getters.getDataCache(t&&t[0])},getControlData:function(){var t=this.currentDataCache||{},e=t.dataInfo||{};return{start:e.start,end:e.end,step:e.step,timing:t.timing,currentProps:this.renderProps}},uuid:function(){for(var t in this.$store.getters.getAllDataCacheByHashId(this.component.componentId))return t;return null},triggers:function(){return this.$store.getters.getActionsByComponentId(this.component.componentId)}},watch:{getControlData:{handler:function(t,e){var r,n,a,o;c()(t,e)||(n=(t=this.getControlData).start,a=t.end,o=t.step,r=t.timing,t=t.currentProps,e=e&&e.timing,n=this.getData(n,a,o),e!==r&&r&&(this.timeParams.lastIndex=0<n.length?n.length-1:0),t=Object.assign({},t,{data:n,currentIndex:this.timeParams.lastIndex}),o=-1===(a=this.timeParams.lastIndex)?-1:a+1<=n.length?a+1:a,delete t.duration,this.currentProps=t,e=this.currentProps.data?parseInt(this.currentProps.data[a]+"000"):"",(t.controledDatas&&t.controledDatas.length||t.data&&t.data.length)&&this.timePlayer&&this.timePlayer.$emit("timeplayerchanged",{currentTimeStamp:e,lastIndex:a,nextIndex:o}))},deep:!0,immediate:!0},"currentProps.autoPlay":function(){this.playState=this.currentProps.autoPlay},"renderProps.formatter":{handler:function(t){var e=this.currentProps.data;this.currentProps.label=this.getLabel(e)},immediate:!0},"renderProps.data":{handler:function(t){var e=this.currentProps.data;this.currentProps.label=this.getLabel(e)},immediate:!0},triggers:{handler:function(t,e){this.handleTriggers(t),this.timePlayer&&this.timePlayer.$emit("timeplayerchanged",this.timeParams)},deep:!0}},beforeDestroy:function(){this.offTriggerEvent()},methods:{timeFormatter:function(t,e,r,n){e=i.a.timestamp2Date(e||t[r]);return"auto"!==n&&p()(e,"YYYY-MM--DD HH:mm:ss").isValid()?p()(e,"YYYY-MM--DD HH:mm:ss").format(n):e},getLabel:function(r){var n=this,t=this.currentProps,a=t.formatter;return m({formatter:function(t,e){return n.timeFormatter(r,t,e,a)}},t.labelStyle||{})},timePlayerplaychanged:function(t){this.playState=t},getData:function(t,e,r){var n=[];if(t&&e&&r&&r.value)for(var a=i.a.getSecondsByStep(r),o=parseInt(t);o<=parseInt(e);)n.push(o),o+=a;return n},initTriggers:function(){var t=this;this.timePlayer=this.$refs.timePlayer,this.triggers&&this.handleTriggers(this.triggers),setTimeout(function(){return t.timePlayer.$emit("timeplayerchanged",t.timeParams)},3e3)},handleTriggers:function(e){var i=this;if(this.offTriggerEvent(),this.eventList=[],e&&this.timePlayer)for(var t in e)!function(a){var t=s.b[a].events||[],o=e[a];t.forEach(function(t){var e="handleTrigger".concat(t.replace(t[0],t[0].toUpperCase()));i[e]=function(r){var n=[];o.forEach(function(t){var e=s.b[a].callback(r,t,i);n.push(m({actionId:t.actionId},e))}),i.$store.dispatch("UPDATE_ACTION",{componentId:i.component.componentId,type:a,datas:n,status:"active"})},i.timePlayer.$on(t,i[e]),i.eventList.push({eventName:t,listenerName:e})})}(t)},offTriggerEvent:function(){var r=this;this.eventList&&this.timePlayer&&this.eventList.forEach(function(t){var e=t.eventName,t=t.listenerName;r[t]&&(r.timePlayer.$off(e,r[t]),r[t]=null)})}}},n=r("KHd+"),r=Object(n.a)(a,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({ref:"timePlayer",tag:"component",style:t.defaultParams.style,on:{timeplayerplaychanged:t.timePlayerplaychanged,"hook:mounted":t.initTriggers}},"component",t.currentProps,!1))],1)},[],!1,null,null,null);e.default=r.exports},EBC7:function(t,e,r){"use strict";r.r(e);var n=r("oCYn"),a=r("3Dh3"),o=r("zT9C"),i=r.n(o),o=r("XaGS"),s=r.n(o),c=r("GSdF"),p=r("FuRH"),o=r("6G66"),u=r("QCDS"),o={mixins:[o.a],props:{pageId:{type:String},component:{type:Object,required:!0},defaultParams:{type:Object}},data:function(){return{componentId:null,renderProps:null}},computed:{background:function(){return-1!==this.excludeComponentsBackground.indexOf(this.component.componentType)?{}:Object(c.a)(this.component.propDatas)},subComponentList:function(){var t=this.$store.getters.components;return Object.values(t.mapSubComponent).map(function(t){return t.type})},excludeComponentsBackground:function(){return this.subComponentList.concat("Container")},mapsOnScreen:function(){return this.$store.getters.mapsOnScreen[this.pageId]},firstMapTarget:function(){return(this.mapsOnScreen[0]||{}).value}},watch:{component:{handler:function(){var t=Object(a.d)(this.component.uri);this.componentId=n.default.component(t)?t:null},deep:!0,immediate:!0},"defaultParams.props":{handler:function(t,e){s()(t,e)||(this.renderProps=i()(this.defaultParams.props),-1===this.excludeComponentsBackground.indexOf(this.component.componentType)&&(this.renderProps.background=""),"Iframe"===this.component.componentType&&(this.renderProps.src=Object(u.c)(this.renderProps.src)),-1!==["LiquidFill","TimeRange"].indexOf(this.component.componentType)&&(this.renderProps.backgroundColor=this.renderProps.backgroundColorReplacer,delete this.renderProps.backgroundColorReplacer))},immediate:!0},mapsOnScreen:function(t,e){s()(t,e)||this.renderProps.mapTarget&&!p.a.$options.getMap(this.renderProps.mapTarget)&&(this.renderProps.mapTarget=this.firstMapTarget)}},created:function(){this.setDefaultMapTarget()},methods:{setDefaultMapTarget:function(){this.renderProps&&this.renderProps.hasOwnProperty("mapTarget")&&!this.renderProps.mapTarget&&(this.renderProps.mapTarget=this.getRelatedMapTarget())},getRelatedMapTarget:function(){var t=this.$store.getters,e=t.componentsOnScreen,t=t.activeComponentId,r=this.$store.getters.getGridLayoutByPageId(this.pageId,this.$store.getters.mode);return Object(a.i)(e,r.content||[],t)}}},r=r("KHd+"),r=Object(r.a)(o,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({tag:"component",style:t.defaultParams.style,attrs:{componentId:t.component.componentId}},"component",t.renderProps,!1)),t._v(" "),t._t("fullScreen")],2)},[],!1,null,null,null);e.default=r.exports}}]);