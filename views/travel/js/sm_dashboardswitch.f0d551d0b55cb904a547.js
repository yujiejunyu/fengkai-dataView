(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"tM/8":function(t,e,n){"use strict";n("yxLr")},uO9G:function(t,e,n){"use strict";n.r(e);var F=n("QCDS"),r=n("egfl"),q=n("G1rW"),i=n("3Dh3"),J=n("wyqS"),a=n("tpcZ"),W=n.n(a),z=n("M7pi"),a=n("zT9C"),B=n.n(a);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(t,e,n){return(e=function(t){t=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===o(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U=["searchControl","queryControl","layers"],V=["NcpMap","WebMap","Search","Query","Chart","Progress","LiquidFill","Text","TextList","Indicator"];function u(t,o){var i,a,c,e,s,n,r,u,d,t=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Object(F.j)(),r=t.rootUrl;return r?(e=JSON.stringify(t),r=new RegExp("".concat(r),"g"),e=e.replace(r,n),JSON.parse(e)):t}(t),l=t.version,p=t.components,f=t.gridLayout,h=t.setting,m=t.datas,g=R({},t),y=h.background,b={mobile:[],pc:[],pad:[]},v={mobile:[],pc:[],pad:[]},I=(h.theme&&!h.theme.style&&(h.theme.style="dark"),"string"==typeof y&&(g.setting.background={backgroundColor:y,backgroundGradient:!1,gradientDirection:"left",backgroundImage:"",backgroundRepeat:"noRepeat"}),l&&!W.a.compare("".concat(l),"2.1.1","<")||(i=t.datas||{},o=o||"self",!t.datas&&Array.isArray(p)&&(p=p.map(function(t){var n,r,e=t.propDatas,a=t.componentType;return-1!==V.indexOf(a)&&("WebMap"===a&&Object(J.f)(e),(a=function(t){var e,n=Object.keys(t);if(-1!==n.indexOf("restMap")||-1!==n.indexOf("restData")||-1!==n.indexOf("iportalData")||-1!==n.indexOf("addressMatch"))return tt(t);if(-1!==n.indexOf("layers")||-1!==n.indexOf("searchControl")||-1!==n.indexOf("queryControl"))return function(n){var o=[];return["layers","searchControl","queryControl"].forEach(function(t){var a,e=n[t];e&&("layers"===t?e.map(function(t){var e=t.dataset,n=t.propDatas,r=t.type;e&&"{}"!==JSON.stringify(e)&&(a=et(e,n),n.maxFeatures=e.maxFeatures,n.attributeFilter=e.attributeFilter,o.push(a)),t.componentType=r,delete t.dataset}):(a=tt(e),o=o.concat(a)))}),o}(t);-1!==n.indexOf("dataset")&&(e=t.dataset,t.dataset={maxFeatures:t.dataset.maxFeatures});-1!==n.indexOf("url")&&((e=JSON.parse(JSON.stringify(t))).type="rest");n=e&&et(e,t);return n?[n]:null}(e))&&(i=function(o,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"self";return t&&t.forEach(function(t){var e,n,r=o[t.hashId],a=t.dataInfo;a&&(t.MDIds=t.MDIds||[],t.MDIds.push(i),a.id||(a.id=t.hashId)),r?(e=!r.timing&&a.timing,n=!r.proxy&&a.proxy,e&&(r.timing=a.timing,r.frequency=a.frequency),n&&(r.proxy=a.proxy)):o[t.hashId]=t}),o}(i,a,o)),a=(e=t).componentType,r=e.propDatas,"WebMap"===a?(n={},U.forEach(function(e){r[e]&&("layers"===e?r[e].forEach(function(t){n[e+"_"+t.ref]=t.propDatas.dataIds||[],delete t.propDatas.dataIds}):(n[e]=r[e].dataIds||[],delete r[e].dataIds))})):(n=r.dataIds,delete r.dataIds),e.dataIds=n),t})),-1!==Object.keys(t.gridLayout).indexOf("base")&&(f={pc:t.gridLayout,pad:{mode:"auto",base:{width:0,height:0},content:[]},mobile:{mode:"auto",base:{width:0,height:0},content:[]}}),Array.isArray(t.components)&&(p={pc:t.components,pad:[],mobile:[]}),g=R(R({},t),{},{datas:i,gridLayout:f,components:p})),l&&!W.a.compare("".concat(l),"2.2.0","<")||(a=(h=g).gridLayout,y=h.name,d=h.setting,d=B()(d),A=[],c={gridLayout:{},name:y||"我的地图大屏",id:z.a.uuid(),setting:d,ratioX:1,ratioY:1,cols:0,rows:0},Object.keys(a).forEach(function(t){r=a[n=t],e=z.a.uuid(),(r=r||R({content:[]},H[n])).id=e;var e,n={layout:r,id:e},r=n.id;a[t]=[n.layout],c.gridLayout[t]=r}),A.push(c),h.pages=A,h.defaultPageId=c.id,h.currentPageId=c.id,delete d.gestureControl,delete d.gestureControlVideoShow,d.enterAnimation||(d.enterAnimation={type:"",direction:"",suffix:"",duration:1,delay:1}),d.leaveAnimation)||(d.leaveAnimation={type:"",direction:"",suffix:"",duration:1,delay:1}),e=p,s=f,Object.keys(e).forEach(function(a){e[a].forEach(function(e){var n,t,r;"Attributes"===e.componentType&&e.propDatas.fieldConfigs[0]&&!e.propDatas.fieldConfigs[0].hasOwnProperty("colWidth")&&(n=s[a].find(function(t){return t.content.find(function(t){return t.componentId===e.componentId})}),t=e.propDatas.fieldConfigs.length,r=Math.max((n.w-61)/t,128),e.propDatas.fieldConfigs.forEach(function(t){t.width?t.colWidth=Math.min(n.w*(t.width/100),n.w):t.colWidth=r,delete t.width}))})}),t),S=g,w=(I.code&&0<Object.keys(I.code).length&&!I.code.pc&&!Array.isArray(I.code)&&(I.code={pc:R({libraries:[]},I.code),pad:X,mobile:X}),S.pages&&I.code&&!Array.isArray(I.code)?(S.code=[],["pc","pad","mobile"].forEach(function(t){var e={content:R({},I.code[t]),id:z.a.uuid()};S.pages[0].code=S.pages[0].code||{},S.pages[0].code[t]=e.id,S.code=S.code.concat(e)})):I.code&&0===Object.keys(I.code).length&&(S.code=[]),p),O=m,y=l;if(!y||W.a.compare("".concat(y),"2.1.4","<")){var x,D=[],T=function(){var t,e,n,o,r,i,c,s,u,d=w[x];d&&(t=Z(d),n=Z(d,["TimePlayer","TimeRange"]),e=Y(t,"time"),n=Y(n),o=function(r,a,o){var i,c={};for(i in o)!function(){var e,n,t;"mapComponent"===o[i].type&&(e=o[i].target,n=r.find(function(t){t=t.propDatas;return e===t.target}))&&(t=a.find(function(t){t=t.propDatas;return"customizeMap"===t.timeType&&n.propDatas.target===t.mapTarget}))&&(c[i]={dataId:i,mapComponentId:n.componentId,componentId:t.componentId})}();return c}(d,t,O),c=O,s={},u=[],d.forEach(function(t){var e=-1<t.componentType.indexOf("DataSwitcher"),n=-1<t.componentType.indexOf("TimeLine")&&"customize"===t.propDatas.timeType;if(e||n){var r,e=t.propDatas.options||t.propDatas.data,a=e&&e[0]&&(e[0].value||t.dataIds&&t.dataIds[0]);for(r in c)c[r].hashId!==t.componentId&&c[r].dataInfo.id!==t.componentId||(s[r]={dataId:a,componentId:t.componentId},u.push(r))}}),i=(r={dataSwitcher:s,delDatas:u}).dataSwitcher,D=D.concat(r.delDatas),i=R(R(R({},i),e),n),function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"md-data-label";t.forEach(function(t){var t=t.actions,n=t&&t.dataSelection;n&&n.forEach(function(t,e){"label"===t.config.dataField&&(n[e].config.dataField=r),t.config.sourceData&&"label"===t.config.sourceData.field&&(n[e].config.sourceData.field=r)})})}(t),d.forEach(function(t){var e=t.componentType,n=t.dataIds,r=t.componentId;if(-1!==q.a.indexOf(e))for(var a in!function(a,o,i){var c,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";for(c in o)!function(){var t,e=o[c],n=e.dataId,r=e.componentId,e=e.mapComponentId;a===e&&((t=(e=i.find(function(t){return t.componentId===r})).actions)&&t.dataSelection&&(e.actions.mapSelection=t.dataSelection,delete t.dataSelection),K(i,r,{targetId:a,sourceDataId:n,targetDataId:s,targetAction:"switchMap",triggerType:"mapSelection"}))}()}(r,o,d),n)n[a]=Q(n[a],r,e,i,d,a);else Q(n,r,e,i,d)}))};for(x in w)T();!function(t,e){for(var n in e)-1!==t.indexOf(n)&&delete e[n]}(D,O)}var E,C=m;for(E in C){var j=C[E];if(j&&j.mapDatas)if(j.mapStatus)C[E].mapStatus=j.mapStatus.map(function(t){return{key:t.key,status:!1}});else{var L,j=j.mapDatas;for(L in C[E].mapStatus=[],j)C[E].mapStatus.push({key:L,status:!1})}}var P,k=p,M=b,G=v;function $(e){var t=k[e],o={};t&&(t.forEach(function(t){-1<t.componentType.indexOf("Map")&&(o[t.propDatas.target]=t.componentId,M[e].push(t)),-1!==["TimeLine","TimeRange","TimePlayer","DataSwitcher"].indexOf(t.componentType)&&G[e].push(t)}),t.forEach(function(t){var e=t.componentType,n=t.propDatas,r=t.dataIds,a=t.actions;"Chart"===e&&n.associatedMap&&n.mapTarget&&(r={targetId:o[n.mapTarget],targetAction:"addToMap",config:{sourceData:{dataId:r&&r[0]},targetData:{dataId:r&&r[0]}}},t.actions=a||{featureSelection:[]},t.actions.featureSelection=t.actions.featureSelection||[],t.actions.featureSelection.push(r),delete n.associatedMap,delete n.mapTarget),-1!==q.a.indexOf(e)&&a&&(t.actions=function(r){if(r){var t,e;for(e in r)if(t=function(n){var t;if("boundsChange"===n)return(t=r[n])&&t.map(function(t,e){"addToMap"===t.targetAction&&r[n].splice(e)}),{v:r}}(e))return t.v;return r}}(a))}),"pc"===e)&&t.forEach(function(t){var e=t.componentType,n=t.propDatas;-1!==["WebMap","NcpMap"].indexOf(e)&&n.hasOwnProperty("controlComponents")&&((t=Object.keys(n.controlComponents)).length&&t.forEach(function(t){n[t]&&(n[t].show=!0)}),delete n.controlComponents)})}for(P in k)$(P);var N=v,_=b,A=l;if(!A||W.a.compare("".concat(A),"2.1.5","<")){for(n in N)!function(i){var n=N[i];n.forEach(function(t,e){t=(t.actions||{}).dataSelection;t&&(n[e].actions.dataSelection=t.map(function(t){var n,e=t.config||{},r=e.targetData,a=e.sourceData,o=r.dataId;return o&&-1!==o.indexOf("self_layers_")&&(t.config.targetData.dataId=o.replace("self_layers_",""),_[i]=_[i].map(function(t){var e=t.propDatas.layersIdField;return n=e[o],t.associateAction={dataId:o,sourceDataId:a&&a.dataId},t}),t.config.targetData.mergeField=n),t}))})}(n);for(r in _)_[r]=_[r].map(function(t){var e,n;return t.associateAction&&(e=(n=t.associateAction).dataId,n=n.sourceDataId,t.propDatas.layersIdField[e]="",t.dataIds[e]&&-1!==t.dataIds[e].indexOf(n)&&delete t.dataIds[e],delete t.associateAction),t})}h=g;return h.hasOwnProperty("appliedMasterPageId")&&(u=h.appliedMasterPageId,h.pages.forEach(function(t){t.masterPageId=u}),delete h.appliedMasterPageId),(g=function(t){var n=t.setting,r=t.pages;n.hasOwnProperty("fullScreen")||(n.fullScreen={color:"",backgroundColor:""});return t.pages=r.map(function(t,e){return t.hasOwnProperty("fullScreen")||(r[e].setting.fullScreen=B()(n.fullScreen)||{color:"",backgroundColor:""}),r[e]}),t}(g)).setting={gestureControl:(d=g).setting.gestureControl,gestureControlVideoShow:d.setting.gestureControlVideoShow,theme:d.setting.theme},g.components=p,g}var H={pc:{base:{width:0,height:0}},pad:{mode:"auto",base:{width:0,height:0}},mobile:{mode:"auto",base:{width:0,height:0}}};var X={htmlCode:null,jsCode:null,cssCode:null,lifeCycleCode:null,libraries:null};function Y(t,n){var r={};return t.forEach(function(e){n&&e.propDatas.timeType!==n||e.propDatas.controledDatas.forEach(function(t){r[t]={dataId:t,componentId:e.componentId}})}),r}function K(t,e,n){var r=n.targetId,a=n.sourceDataId,o=n.targetDataId,i=n.targetAction,n=n.triggerType,n=void 0===n?"dataSelection":n,r={targetId:r,targetAction:void 0===i?"switchDataSource":i,config:{sourceData:{dataId:a},targetData:{dataId:o}}},i=t.find(function(t){return t.componentId===e});i.actions=i.actions||s({},n,[]),i.actions[n]=i.actions[n]||[],i.actions[n].push(r)}function Q(r,a,t,o,i,e,n){var c=5<arguments.length&&void 0!==e?e:"",e=6<arguments.length&&void 0!==n?n:["TimeLine"];if(r&&"{}"!==JSON.stringify(o)&&-1===e.indexOf(t))return r&&r.forEach&&r.forEach(function(t,e){var t=o[t]||{},n=t.dataId,t=t.componentId;t&&(r.splice(e,1,n),"trackLayers"===c&&1!==e&&(e=i.find(function(t){return t.componentId===a}).propDatas.trackLayers[e],c=e&&e.ref),K(i,t,{targetId:a,sourceDataId:n,targetDataId:c}))}),r}function Z(t,e){var n=1<arguments.length&&void 0!==e?e:["TimeLine"],r=[];return t.forEach(function(t){-1!==n.indexOf(t.componentType)&&r.push(t)}),r}function tt(n){var r=[];return["restMap","restData","iportalData","addressMatch"].forEach(function(e){(n[e]||[]).forEach(function(t){r.push(et(t,n,e))})}),r}function et(t,e,n){var r,a,o,i,c,s,u,d,l,p,f,h,m;return"iPortal"===(n=t.type||n)&&(r=e,o=(m=t).url,a=t.type,i=t.id,c=t.name,s=t.dataItemServices,u=t.updateTime,d=t.withCredentials,l=t.epsgCode,m=t.proxy,h=r.startTiming,f=r.frequency,p=(i||o.substring(o.lastIndexOf("/")+1,o.length)).toString(),r.dataIds?r.dataIds.push(p):r.dataIds=[p],o=function(t,e){if(t&&e)return Object(F.p)(t,"/web/datas/",e)}(o,i||p),delete r.startTiming,delete r.frequency,r={dataInfo:{url:o,type:a,id:i,name:c,dataItemServices:s,updateTime:u,withCredentials:d,epsgCode:l},hashId:p,frequency:f,timing:h,proxy:Boolean(m)}),"rest"===n&&(r=g(t,e)),"iServer"===n&&(o=e,i=(a=t).url,c=t.type,s=t.name,u=t.withCredentials,d=t.proxy,l=t.dataName,p=t.layerName,a=t.epsgCode,f=o.startTiming,h=o.frequency,m=i+s,i={url:i,type:c,name:s,withCredentials:u,epsgCode:a},l&&(i.dataName=l),p&&(i.layerName=p),o.dataIds?o.dataIds.push(m):o.dataIds=[m],delete o.startTiming,delete o.frequency,r={dataInfo:i,hashId:m,frequency:h,timing:f,proxy:Boolean(d)}),r="addressMatch"===n?g(t,e,"addressMatch"):r}function g(t,e,n){var r,a,n=2<arguments.length&&void 0!==n?n:"rest",o=t.url,t=t.proxy,i=e.startTiming,c=e.frequency;return o&&(a=(r=o).lastIndexOf("/"),a="rest"===n?o.substring(a+1,o.length):"addressMatch",o={url:o,name:a,withCredentials:!1,type:n},e.dataIds?e.dataIds.push(r):e.dataIds=[r],a={dataInfo:o,hashId:r,frequency:c,timing:i,proxy:t}),delete e.url,delete e.startTiming,delete e.frequency,delete e.proxy,a}var a=n("QZgE"),d=n("wd/R"),l=n.n(d);function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */j=function(){return i};var s,i={},t=Object.prototype,u=t.hasOwnProperty,d=Object.defineProperty||function(t,e,n){t[e]=n.value},e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",a=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(s){o=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a,o,i,c,e=e&&e.prototype instanceof y?e:y,e=Object.create(e.prototype),r=new T(r||[]);return d(e,"_invoke",{value:(a=t,o=n,i=r,c=p,function(t,e){if(c===h)throw new Error("Generator is already running");if(c===m){if("throw"===t)throw e;return{value:s,done:!0}}for(i.method=t,i.arg=e;;){var n=i.delegate;if(n){n=function t(e,n){var r=n.method,a=e.iterator[r];if(a===s)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=s,t(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;r=l(a,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=s),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}(n,i);if(n){if(n===g)continue;return n}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===p)throw c=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=h;n=l(a,o,i);if("normal"===n.type){if(c=i.done?m:f,n.arg===g)continue;return{value:n.arg,done:i.done}}"throw"===n.type&&(c=m,i.method="throw",i.arg=n.arg)}})}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var p="suspendedStart",f="suspendedYield",h="executing",m="completed",g={};function y(){}function b(){}function v(){}var e={},I=(o(e,r,function(){return this}),Object.getPrototypeOf),I=I&&I(I(E([]))),S=(I&&I!==t&&u.call(I,r)&&(e=I),v.prototype=y.prototype=Object.create(e));function w(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function O(i,c){var e;d(this,"_invoke",{value:function(n,r){function t(){return new c(function(t,e){!function e(t,n,r,a){var o,t=l(i[t],i,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==C(n)&&u.call(n,"__await")?c.resolve(n.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):c.resolve(n).then(function(t){o.value=t,r(o)},function(t){return e("throw",t,r,a)});a(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}})}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function E(e){if(e||""===e){var n,t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(C(e)+" is not iterable")}return d(S,"constructor",{value:b.prototype=v,configurable:!0}),d(v,"constructor",{value:b,configurable:!0}),b.displayName=o(v,a,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,o(t,a,"GeneratorFunction")),t.prototype=Object.create(S),t},i.awrap=function(t){return{__await:t}},w(O.prototype),o(O.prototype,n,function(){return this}),i.AsyncIterator=O,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var o=new O(c(t,e,n,r),a);return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},w(S),o(S,a,"Generator"),o(S,r,function(){return this}),o(S,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e,n=Object(t),r=[];for(e in n)r.push(e);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=E,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(D),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return o.type="throw",o.arg=n,r.next=t,e&&(r.method="next",r.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var a=this.tryEntries[e],o=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var i=u.call(a,"catchLoc"),c=u.call(a,"finallyLoc");if(i&&c){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return t(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}var o=(a=a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc?null:a)?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,r,a=this.tryEntries[e];if(a.tryLoc===t)return"throw"===(n=a.completion).type&&(r=n.arg,D(a)),r}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=s),g}},i}function p(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function f(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach(function(t){var e,n;e=r,n=a[t=t],(t=function(t){t=function(t,e){if("object"!==C(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===C(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}function h(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,a)}d={name:"DashboardSwitch",mixins:[a.a],inheritAttrs:!1,props:{templates:{type:Array},arrangement:{type:String,default:"horizontal"},timerSwitchType:{type:String},pollingTime:{type:Number},btnType:{type:String},fontStyle:{type:Object},colorStyle:{type:Object}},data:function(){return{appId:"",timer:null,bgSizeMap:{all:"100% 100%",contain:"contain",cover:"cover"}}},computed:{mode:function(){return this.$store.getters.mode},templateWithImg:function(){return this.templates.filter(function(t){return t.thumbImg})},templateNoImg:function(){return this.templates.filter(function(t){return!t.thumbImg})},getScreenIndex:function(){return this.$store.getters.getScreenIndex},isPreview:function(){return"preview"===this.$store.getters.getAction},dataCache:function(){return this.$store.getters.dataCache},createStyle:function(){return{"font-weight":this.fontStyle.fontWeight,"font-family":this.fontStyle.fontFamily,"font-size":this.fontStyle.fontSize,color:this.colorStyle.color,background:this.colorStyle.background,"border-color":this.colorStyle.borderColor}},activeStyle:function(){return{background:this.colorStyle.activeBackground,color:this.colorStyle.activeColor,"border-color":this.colorStyle.activeBorderColor}},btnWrapStyle:function(){return function(t){return{margin:"".concat(+t.yGap,"% 0 0 ").concat(+t.xGap,"%"),"text-align":"".concat(t.textAlign)}}},getDashboardName:function(){return this.$store.getters.getDashboardName},displayStatus:function(){return this.$store.getters.displayStatus}},created:function(){var e=this;this.$watch(function(){return{pollingTime:this.pollingTime,templates:this.templates,timerSwitchType:this.timerSwitchType}},function(t){"none"===t.timerSwitchType&&e.timer&&clearInterval(e.timer),e.isPreview&&("polling"===t.timerSwitchType?e.handlePollingDashboard():"timing"===t.timerSwitchType&&e.handleTimingDashboard())},{immediate:!0})},mounted:function(){window.DashboardSwtich={changePrevScreen:this.changePrevScreen.bind(this),changeNextScreen:this.changeNextScreen.bind(this)}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{changePrevScreen:function(){var e=this,t=this.templateNoImg.findIndex(function(t){return t.appId===e.getScreenIndex}),t=Math.max(0,t);--t<0&&(t=this.templateNoImg.length-1),this.templateNoImg[t]&&this.changeScreen(this.templateNoImg[t])},changeNextScreen:function(){var e=this,t=this.templateNoImg.findIndex(function(t){return t.appId===e.getScreenIndex}),t=Math.max(0,t);++t>=this.templateNoImg.length&&(t=0),this.templateNoImg[t]&&this.changeScreen(this.templateNoImg[t])},changeScreen:function(a){var c,o=this;return c=j().mark(function t(){var e,n,r;return j().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a=B()(a)).appId===o.getScreenIndex)return t.abrupt("return");t.next=3;break;case 3:1!==a.appId?t.next=10:(e=JSON.parse(window.sessionStorage.getItem("template")),o.handleTemplateDataCache({template:e}),o.$store.dispatch("CHANGE_DISPLAY_STATUS",!1),o.$store.dispatch("SET_SCREEN_INDEX",1),t.next=30);break;case 10:if(o.displayStatus||(e=Object(F.n)(window.location.href,"id"),window.sessionStorage.setItem("template",JSON.stringify(f(f({},o.$store.getters.template),{},{id:e})))),o.$store.dispatch("DEACTIVATE_GRID"),o.$store.dispatch("DEACTIVATE_COMPONENT"),a.url||a.config){t.next=15;break}return t.abrupt("return");case 15:if(a.config){t.next=20;break}return t.next=18,Object(F.b)(a.url,{},"get",!0,!1);case 18:n=t.sent,a.config=n.content;case 20:Object(i.j)(a.config)?(r=o.fixDataCacheSameUUID(a.config),t.next=27):t.next=24;break;case 24:return t.next=26,Object(q.c)(a);case 26:r=t.sent;case 27:r=u(r,a.appId),r=o.filterOtherDashboardSwitch(r),o.transformToTemplate(r,a);case 30:case"end":return t.stop()}},t)}),function(){var t=this,i=arguments;return new Promise(function(e,n){var r=c.apply(t,i);function a(t){h(r,e,n,a,o,"next",t)}function o(t){h(r,e,n,a,o,"throw",t)}a(void 0)})}()},transformToTemplate:function(t,e){this.appId=e.appId,t.gridLayout=Object(r.a)(t.gridLayout,this.GLOBAL.pixels);e=this.displayStatus?JSON.parse(window.sessionStorage.getItem("template")):this.$store.getters.template;t=this.appendDashboardSwitchComponent(t,e),this.handleTemplateDataCache({template:t,appId:this.appId}),this.$store.dispatch("CHANGE_DISPLAY_STATUS",!0)},fixDataCacheSameUUID:function(t){var e=JSON.parse(t),n=Object.keys(e.datas),r=Object.keys(this.dataCache);if(r.length&&n.length){for(var a=0;a<r.length;a++)for(var o=0;o<n.length;o++)if(r[a]===n[o]){var i=z.a.uuid();t=t.replaceAll(n[o],i);break}return e=JSON.parse(t)}return e},initTemplate:function(t){t={components:t.components||[],gridLayout:t.gridLayout||{},code:t.code,background:t.setting.background,theme:t.setting.theme,gestureControl:t.setting.gestureControl,gestureControlVideoShow:t.setting.gestureControlVideoShow,name:this.getDashboardName,tags:t.tags||[],description:t.description||"",maps:t.maps||[],tdtKey:t.tdtKey||"",version:t.version,pages:t.pages,defaultPageId:t.defaultPageId};this.$store.dispatch("ADD_TEMPLATE",t),this.$store.dispatch("SET_SCREEN_INDEX",this.appId),this.$store.dispatch("SET_MAP_KEEP_BOUNDS",{keepBounds:!0})},filterOtherDashboardSwitch:function(n){var t;return W.a.compare("".concat(n.version),"2.1.1","<")?(-1!==(t=n.components.findIndex(function(t){return"DashboardSwitch"===t.componentType}))&&n.components.splice(t,1),-1!==(t=n.gridLayout.content.findIndex(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")}))&&n.gridLayout.content.splice(t,1)):(Object.keys(n.components).forEach(function(t){var e=n.components[t].findIndex(function(t){return"DashboardSwitch"===t.componentType});-1!==e&&n.components[t].splice(e,1)}),Object.keys(n.gridLayout).forEach(function(t){n.gridLayout[t].forEach(function(t){var e=t.content.findIndex(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")});-1!==e&&t.content.splice(e,1)})})),n},handlePollingDashboard:function(){var e=this;this.timer&&clearInterval(this.timer),this.templates.length<=1||0===this.pollingTime||(this.timer=setInterval(function(){var t;1<=e.templates.length&&(e.$store.getters.templateIndex>=e.templates.length-1?e.$store.dispatch("CHANGE_TEMPLATE_INDEX",0):(t=e.$store.getters.templateIndex,e.$store.dispatch("CHANGE_TEMPLATE_INDEX",t+1)),e.changeScreen(e.templates[e.$store.getters.templateIndex]))},1e3*this.pollingTime))},handleTimingDashboard:function(){var r,a=this;this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){var t=l()().hour(),e=l()().minute(),n=l()().second(),t=a.concatTime(t),e=a.concatTime(e),n=a.concatTime(n),t=(r="".concat(t,":").concat(e,":").concat(n),a.templates.find(function(t){return r===t.timing}));t&&a.changeScreen(t)},1e3)},concatTime:function(t){return t<10?"".concat(t).padStart(2,"0"):t},findGrid:function(t,e,n){for(var r,a=0;a<t.length;a++){if(t[a].name===e||n&&-1!==t[a].componentId.indexOf(e)){r=t[a];break}t[a].children&&t[a].children.length&&!r&&(r=this.findGrid(t[a].children,e,n))}return r},appendDashboardSwitchComponent:function(t,e){var n,r=t.gridLayout,a=t.components,o=t.pages,i=e.gridLayout,e=e.components,c=e[this.mode].find(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")})||e.pc.find(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")}),s=(c&&Object.keys(a).forEach(function(t){a[t].push(c)}),B()(this.findGrid(this.getGridLayoutContentsByMode(i,this.mode),"DashboardSwitch",!0)||this.findGrid(this.getGridLayoutContentsByMode(i,"pc"),"DashboardSwitch",!0)));return s&&(e=o&&o.filter(function(t){return t.masterPageId}),n=e&&e.map(function(t){return t.gridLayout}),Object.keys(r).forEach(function(e){r[e].forEach(function(t){n.length&&!n.find(function(t){return t[e]!==t.id})||t.content.push(s)})})),t.gridLayout=r,t.components=a,t},getGridLayoutContentsByMode:function(t,e){var n=[];return t[e].forEach(function(t){n=n.concat(t.content)}),n}}},n("tM/8"),a=n("KHd+"),n=Object(a.a)(d,function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("div",{staticClass:"sm-dashboard-switch",style:{"flex-direction":"horizontal"===n.arrangement?"row":"column"}},[n._l(n.templates,function(e){return[e.thumbImg?r("a-card",{key:e.appId,staticClass:"sm-dashboard-switch__board",style:{display:"inline-block","vertical-align":"top",margin:+e.yGap+"% 0 0 "+ +e.xGap+"%"},on:{click:function(t){return n.changeScreen(e)}}},[r("div",{staticClass:"sm-dashboard-switch__image",style:{"background-image":n.getScreenIndex===e.appId&&e.selectThumbImg?"url("+e.selectThumbImg+")":"url("+e.thumbImg+")","background-size":n.bgSizeMap[e.imgSizeType]||"100% 100%","background-position":""+e.textAlign},attrs:{slot:"cover",title:e.name},slot:"cover"})]):r("div",{key:e.appId,staticClass:"sm-dashboard-switch__board",style:n.btnWrapStyle(e)},[r("button",{class:["dashboard-btn","dashboard-btn__"+n.btnType,n.getScreenIndex===e.appId?"dashboard-btn__active-"+n.btnType:""],style:[n.createStyle,n.getScreenIndex===e.appId?n.activeStyle:""],on:{click:function(t){return n.changeScreen(e)}}},[r("span",[n._v(n._s(e.name))])])])]})],2)},[],!1,null,null,null);e.default=n.exports},yxLr:function(t,e,n){}}]);