(window.webpackJsonp=window.webpackJsonp||[]).push([[54,18],{"3TvT":function(t,e,n){"use strict";n.r(e);var r=n("EBC7"),o=n("GAzf"),i=n("l6bU"),a=n("vC+N"),d=n("2jOV"),f=n("4zwu"),s=n("XaGS"),h=n.n(s),s=n("9csQ"),c=n.n(s),s=n("zT9C"),l=n.n(s),u=n("QCDS");function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function m(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?g(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var b=["highlight","flyTo","addToMap","appendDatas"],s={mixins:[r.default,o.a,i.a],data:function(){return{filterActionData:{},eventList:[],repeatOption:{center:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"},noRepeat:{backgroundSize:"100% 100%",backgroundRepeat:"no-repeat"},repeatX:{backgroundRepeat:"repeat-x",backgroundSize:"auto 100%"},repeatY:{backgroundRepeat:"repeat-Y",backgroundSize:"100% auto"},repeatXY:{backgroundRepeat:"repeat",backgroundSize:"auto"}}}},computed:{currentProps:function(){var t,e=this.renderProps,n=Object.assign({},e.dataset,this.getDatasetProps(e));for(t in e=Object.assign({},e,{dataset:n}),this.filterActionData)this.filterActionData[t]&&(e[t]&&e[t]instanceof Object?e[t]=Object.assign({},m({},e[t]),m({},this.filterActionData[t])):this.$set(e,t,this.filterActionData[t]));return e.background="",this.dealWithSlot(e),e},dataId:function(){return this.dataIds[0]},currentDataCache:function(){var t=this.$store.getters.getDataCache(this.dataId)||{};return Object.assign({},t,this.filterActionData.dataInfo||{})},triggers:function(){return this.$store.getters.getActionsByComponentId(this.component.componentId)},listeners:function(){var t=this.component.componentId;return this.$store.getters.getListensByComponentId(t)},resetTrigger:function(){return this.$store.getters.getResetActionByComponentId(this.component.componentId)},resetTriggerActionIds:function(){return this.resetTrigger.map(function(t){return t.actionId})},isClearHighlight:function(){var e=this;return!this.resetTrigger.some(function(t){return t.fromComponentId===e.component.componentId})},slotConfigs:function(){var e=[];return this.currentProps.columns.forEach(function(t){"text"!==t.slotConfig.type&&e.push({slotName:t.slots.customRender,slotConfig:t.slotConfig})}),e}},watch:{listeners:function(t,e){var n;t?t&&!h()(t,e)&&(n=this.getDatasetProps(),this.getActionsData(e,t,n&&n.geoJSON)):this.filterActionData={}},resetTriggerActionIds:{handler:function(t,e){t&&t.length&&!h()(t,e)&&this.reset()},immediate:!0},triggers:{handler:function(t){this.handleTriggers(t)},deep:!0}},beforeDestroy:function(){this.offTriggerEvent()},methods:{isValidUri:function(t){return Object(u.c)(t)},getDatasetProps:function(t){return this.dataId?this.updateDataPropsHandler(t):{}},updateDataPropsHandler:function(){var t=this.getDatasetFeatures();return Object(a.j)(t)},getFeatures:function(t){var e=this.$store.getters.getDataCache(t),t=this.getFeatureId(t),e=e&&e.type&&-1!==e.type.indexOf("time")&&this.currentProps.filterCategoryValue?f.a.$options.getDataByCategory(e,[this.currentProps.filterCategoryValue],this.labelConfig)||{}:f.a.$options.getData(t)||{};return e.features.features},getDatasetFeatures:function(){var t;return this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time")?f.a.$options.getDataByCategory(this.currentDataCache).features:(t=this.currentDataCache.data,(f.a.$options.getData(t)||{}).features||[])},reset:function(){var e=this;this.triggerEvent=Array.from(new Set(this.triggerEvent)),this.triggerEvent.forEach(function(t){e.$store.dispatch("UPDATE_ACTION",{componentId:e.component.componentId,type:t,datas:[]})}),this.isClearHighlight&&this.clearHighlightOptions()},clearHighlightOptions:function(){this.$delete(this.filterActionData,"highlightOptions")},getTriggerDatas:function(n,t,r,o){var i,a=this,s=(n=n||{}).dataIndex,c=[],e=o&&o[s],u=f.a.$options.updateFeature(e,"".concat(this.component.componentId,"-").concat(r));return t.forEach(function(t){var e=Object.assign({},n.target,{dataIndex:s,features:o}),e=d.c[r].callback(m({},e),t,a);i=e.passingActionInfo,e&&("featureSelection"===r&&e.highlightOptions&&(a.oldHighlightOptions=l()(e.highlightOptions),delete e.highlightOptions.properties),a.$set(a.filterActionData,"highlightOptions",e.highlightOptions)),c.push({actionId:t.actionId,data:e&&e.data,featureId:-1!==b.indexOf(t.targetAction)&&u})}),{datas:c,passingActionInfo:i}},handleTriggers:function(n){var s=this;this.offTriggerEvent(),this.eventList=[],this.triggerEvent=[],this.isResetTriggerEvents={},this.$nextTick(function(){if(n&&Object.keys(n).length)for(var t in n)!function(i){var t=d.c[i].events||[],a=n[i],e=s.currentProps.dataset.geoJSON&&s.currentProps.dataset.geoJSON.features||[];s.triggerEvent.push(i),s.monitorEventLinkage(d.c,i,a,e,b),t.forEach(function(t){var o=t,e="handleTrigger".concat(t.replace(t[0],t[0].toUpperCase()));s[e]=function(t,e,n){var r=s.currentProps.dataset.geoJSON&&s.currentProps.dataset.geoJSON.features||[],t=s.getTriggerDatas({features:r,dataIndex:e,item:t},a,i,r),r=t.datas,t=t.passingActionInfo;s.isResetTriggerEvents=s.clearTriggerEvent(s.isResetTriggerEvents,i,o,r,e),void 0!==s.isResetTriggerEvents[o]&&s.$store.dispatch("UPDATE_ACTION",{componentId:s.component.componentId,type:i,status:"active",datas:r,passingActionInfo:t})},s.$refs.textList.$on(t,s[e]),s.eventList.push({eventName:t,listenerName:e})})}(t)})},clearTriggerEvent:function(t,e,n,r,o){return t[n]===o?(this.clearHighlightOptions(),r=r.map(function(t){return m(m({},t),{},{data:void 0})}),this.$store.dispatch("UPDATE_ACTION",{componentId:this.component.componentId,type:e,status:"active",datas:r}),t[n]=void 0):t[n]=o,t},getActionsData:function(c,t,u){var p=this,g={};return this.listeners&&this.listeners.find(function(t){return d.b[t.type].reset})&&(c&&c.find(function(t){return d.b[t.type].reset})||this.triggerEvent&&this.triggerEvent.forEach(function(t){p.$store.dispatch("UPDATE_ACTION",{componentId:p.component.componentId,type:t,status:"reset",datas:[]})})),t.forEach(function(t){var o,e=t.type,n=t.targetData,r=t.actionId,i=t.timestamp,a=t.blockEventLinkage,n=n&&n.dataId,s=c&&c.find(function(t){return t.actionId===r});s&&s.timestamp===i||a||(s=(Boolean(g.dataset&&g.dataset.geoJSON.features)?g.dataset.geoJSON:u||{}).features,i=d.b[t.type].callback(m(m({},t),{},{feature:f.a.$options.getData(t.featureId)}),s,p),"filter"===e&&!p.isFilterFirst&&p.oldHighlightOptions&&0<p.oldHighlightOptions.length&&(a=i.dataset&&i.dataset.geoJSON.features||[],o=[],a.forEach(function(n,r){p.oldHighlightOptions.forEach(function(t,e){t&&n&&h()(t.properties,n.properties)&&o.push({dataIndex:r})})}),i.highlightOptions=o),"highlight"===e&&(p.oldHighlightOptions=l()(i.highlightOptions),i.highlightOptions)&&i.highlightOptions.length&&i.highlightOptions.forEach(function(t){delete t.properties}),g=Object.assign(g,i),p.emitEventLinkage(e,r,n,i))}),this.filterActionData=m(m({},this.filterActionData),g),this.filterActionData},dealWithSlot:function(t){var e=[].concat(t.columns);e.forEach(function(t){var e;"text"!==t.slotConfig.type&&(e=c()(),e=t.slotConfig.type+e,t.slots={customRender:e})}),t.columns=e},offTriggerEvent:function(){var n=this;this.eventList&&this.$refs.textList&&this.eventList.forEach(function(t){var e=t.eventName,t=t.listenerName;n.$refs.textList.$off(e,n[t]),n[t]=null})}}},r=(n("NKio"),n("KHd+")),o=Object(r.a)(s,function(){var r=this,t=r.$createElement,o=r._self._c||t;return o("div",{style:r.background},[o(r.componentId,r._b({ref:"textList",tag:"component",style:r.defaultParams.style,attrs:{componentId:r.component.componentId},on:{"hook:mounted":function(t){return r.handleTriggers(r.triggers)}},scopedSlots:r._u([r._l(r.slotConfigs,function(e,n){return{key:e.slotName,fn:function(t){t=t.text;return["link"===e.slotConfig.type?o("a",{key:n,staticClass:"textList_link",attrs:{title:e.slotConfig.linkTitle||r.isValidUri(t),href:r.isValidUri(t),target:e.slotConfig.linkTarget}},[r._v("\n        "+r._s(e.slotConfig.linkTitle||r.isValidUri(t))+"\n      ")]):o("div",{key:n,style:Object.assign({},{minWidth:"70%",height:"100%",backgroundImage:"url("+t+")"},r.repeatOption[e.slotConfig.imageRepeat])})]}}})],null,!0)},"component",r.currentProps,!1))],1)},[],!1,null,null,null);e.default=o.exports},EBC7:function(t,e,n){"use strict";n.r(e);var r=n("oCYn"),o=n("3Dh3"),i=n("zT9C"),a=n.n(i),i=n("XaGS"),s=n.n(i),c=n("GSdF"),u=n("FuRH"),i=n("6G66"),p=n("QCDS"),i={mixins:[i.a],props:{pageId:{type:String},component:{type:Object,required:!0},defaultParams:{type:Object}},data:function(){return{componentId:null,renderProps:null}},computed:{background:function(){return-1!==this.excludeComponentsBackground.indexOf(this.component.componentType)?{}:Object(c.a)(this.component.propDatas)},subComponentList:function(){var t=this.$store.getters.components;return Object.values(t.mapSubComponent).map(function(t){return t.type})},excludeComponentsBackground:function(){return this.subComponentList.concat("Container")},mapsOnScreen:function(){return this.$store.getters.mapsOnScreen[this.pageId]},firstMapTarget:function(){return(this.mapsOnScreen[0]||{}).value}},watch:{component:{handler:function(){var t=Object(o.d)(this.component.uri);this.componentId=r.default.component(t)?t:null},deep:!0,immediate:!0},"defaultParams.props":{handler:function(t,e){s()(t,e)||(this.renderProps=a()(this.defaultParams.props),-1===this.excludeComponentsBackground.indexOf(this.component.componentType)&&(this.renderProps.background=""),"Iframe"===this.component.componentType&&(this.renderProps.src=Object(p.c)(this.renderProps.src)),-1!==["LiquidFill","TimeRange"].indexOf(this.component.componentType)&&(this.renderProps.backgroundColor=this.renderProps.backgroundColorReplacer,delete this.renderProps.backgroundColorReplacer))},immediate:!0},mapsOnScreen:function(t,e){s()(t,e)||this.renderProps.mapTarget&&!u.a.$options.getMap(this.renderProps.mapTarget)&&(this.renderProps.mapTarget=this.firstMapTarget)}},created:function(){this.setDefaultMapTarget()},methods:{setDefaultMapTarget:function(){this.renderProps&&this.renderProps.hasOwnProperty("mapTarget")&&!this.renderProps.mapTarget&&(this.renderProps.mapTarget=this.getRelatedMapTarget())},getRelatedMapTarget:function(){var t=this.$store.getters,e=t.componentsOnScreen,t=t.activeComponentId,n=this.$store.getters.getGridLayoutByPageId(this.pageId,this.$store.getters.mode);return Object(o.i)(e,n.content||[],t)}}},n=n("KHd+"),n=Object(n.a)(i,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({tag:"component",style:t.defaultParams.style,attrs:{componentId:t.component.componentId}},"component",t.renderProps,!1)),t._v(" "),t._t("fullScreen")],2)},[],!1,null,null,null);e.default=n.exports},GAzf:function(t,e,n){"use strict";var r=n("4zwu"),o=n("FuRH"),i=n("3Dh3"),a=n("+NyJ");e.a={data:function(){return{listenMapLoad:!1}},computed:{dataIds:function(){return this.component.dataIds||[]},dataId:function(){return this.dataIds[0]},currentDataCache:function(){return this.$store.getters.getDataCache(this.dataId)},components:function(){return this.$store.getters.components},componentType:function(){return this.component.componentType},mapTarget:function(){return this.component.propDatas.mapTarget},currentProps:function(){var t,e;return"server"===(t=this.renderProps).dataType&&0<this.dataIds.length&&(e=this.getValueProps(t),Object.assign(t,e)),t},labelConfig:function(){return Object(a.f)(this.component.componentId,this.dataId)}},beforeCreate:function(){this.watcher=[]},mounted:function(){this.listenMapLoad&&o.a.$on("load-map",this.loadMapSucceed)},beforeDestroy:function(){this.listenMapLoad&&o.a.$off("load-map",this.loadMapSucceed)},methods:{cleanWatcher:function(){this.watcher.forEach(function(t){t()}),this.watcher=[]},loadMapSucceed:function(t,e){e===this.mapTarget&&this.loadMap(e)},loadMap:function(){},getValueProps:function(t){var e=this.getFeatureId(this.dataId),e=this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time")&&t.filterCategoryValue?r.a.$options.getDataByCategory(this.currentDataCache,[t.filterCategoryValue])||{}:r.a.$options.getData(e)||{};return this.updateDataPropsHandler(t,{features:e})},getValueByField:function(t,e){var n=this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time"),t=t&&t.features&&t.features.features,n=n?t&&t.length-1:0,t=t&&0<=n&&t[n]&&t[n].properties[e];return t||0===t?t.toString():""},hasField:function(t,e){return t&&t.features&&t.features.features[0]&&t.features.features[0].properties.hasOwnProperty(e)},getFeatureId:function(t){return Object(i.g)(this.$store.getters.getDataCache,t)}}}},Lb6U:function(t,e,n){"use strict";e.a={highlight:"featureSelection"}},NKio:function(t,e,n){"use strict";n("vVxV")},l6bU:function(t,e,n){"use strict";var o=n("Lb6U"),l=n("4zwu"),r=n("zT9C"),m=n.n(r);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function b(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}r={data:function(){return{}},methods:{monitorEventLinkage:function(n,r,o,i,a){var s=this,t="linkage-".concat(r);this.$off("actionEventLinkage".concat(r),this[t]),this[t]=function(t){var e;r===t.triggerType&&(e=(t=s._getEventLinkageData(t,o,n,r,i,a)).datas,t=t.passingActionInfo,s.$store.dispatch("UPDATE_ACTION",{componentId:s.component.componentId,type:r,status:"active",datas:e,passingActionInfo:t}))},this.$on("actionEventLinkage".concat(r),this[t])},emitEventLinkage:function(t,e,n,r){t=o.a[t];!t||4<arguments.length&&void 0!==arguments[4]&&!arguments[4]||(e=this.$store.getters.getPassingActionInfoByActionId(e,t),this.$emit("actionEventLinkage".concat(t),{triggerType:t,dataId:n,data:r,from:e}))},getUpdateCondition:function(t,e,n){var r=this.$store.getters.getTargetIdBySourceId(this.component.componentId,e.actionId,t,e.targetAction);return!(n&&r&&n.find(function(t){return t.componentId===r}))},_getEventLinkageData:function(i,a,s,c,u,p){for(var g,d=this,t=this.$store.getters.getTriggerEventByComponentIdAndType(this.component.componentId,c)||{},f=(f=m()(t.datas)||[]).map(function(t){return t.blockEventLinkage=!0,t}),h=0;h<a.length;h++)!function(){var e=a[h];if(e.config.sourceData.dataId!==i.dataId)return;var t,n=s[c].callback({features:u,actionEventParams:i},e,d),r=l.a.$options.updateFeature(n.feature,"".concat(d.component.componentId,"-").concat(c)),o=d.getUpdateCondition(c,e,n.passingActionInfo);g=n.passingActionInfo,delete n.feature,delete n.passingActionInfo,delete n.highlightOptions,o&&(t=-1<(o=f.findIndex(function(t){return t.actionId===e.actionId}))?1:0,o=-1<o?o:0,n=b(b({actionId:e.actionId},n),{},{featureId:(!p||-1!==p.indexOf(e.targetAction))&&r}),f.splice(o,t,n))}();return{datas:f,passingActionInfo:g}}}},n=n("KHd+"),n=Object(n.a)(r,void 0,void 0,!1,null,null,null);e.a=n.exports},vVxV:function(t,e,n){}}]);